import{r as e,a as t,R as s}from"./vendor-D-XgqoRR.js";import{C as r,A as a,U as n,L as i,E as l,a as o,M as c,b as d,D as u,S as m,T as h,P as x,c as p,d as f,e as g,F as b,f as v,B as y,g as w,h as j,i as N,j as _,X as k,k as C,l as S,m as T,n as A,o as E,p as R,q as P,r as M,s as L,t as O,R as I,u as D,G as F,v as B,w as z,x as V,y as U,z as W,H,I as G,J as q,K as Y,N as K,Z as X,O as J,Q as Z,V as Q,W as ee,Y as te,_ as se,$ as re,a0 as ae,a1 as ne,a2 as ie,a3 as le,a4 as oe,a5 as ce,a6 as de,a7 as ue,a8 as me,a9 as he,aa as xe,ab as pe,ac as fe,ad as ge,ae as be,af as ve}from"./icons-BIpDX3kj.js";import{R as ye,L as we,C as je,X as Ne,Y as _e,T as ke,a as Ce,b as Se,P as Te,c as Ae,d as Ee}from"./charts-C9J2RbNN.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Re={exports:{}},Pe={},Me=e,Le=Symbol.for("react.element"),Oe=Symbol.for("react.fragment"),Ie=Object.prototype.hasOwnProperty,De=Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function Be(e,t,s){var r,a={},n=null,i=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)Ie.call(t,r)&&!Fe.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:Le,type:e,key:n,ref:i,props:a,_owner:De.current}}Pe.Fragment=Oe,Pe.jsx=Be,Pe.jsxs=Be,Re.exports=Pe;var $e=Re.exports,ze={},Ve=t;ze.createRoot=Ve.createRoot,ze.hydrateRoot=Ve.hydrateRoot;var Ue=e=>"checkbox"===e.type,We=e=>e instanceof Date,He=e=>null==e;const Ge=e=>"object"==typeof e;var qe=e=>!He(e)&&!Array.isArray(e)&&Ge(e)&&!We(e),Ye="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function Ke(e){let t;const s=Array.isArray(e),r="undefined"!=typeof FileList&&e instanceof FileList;if(e instanceof Date)t=new Date(e);else{if(Ye&&(e instanceof Blob||r)||!s&&!qe(e))return e;if(t=s?[]:Object.create(Object.getPrototypeOf(e)),s||(e=>{const t=e.constructor&&e.constructor.prototype;return qe(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const s in e)e.hasOwnProperty(s)&&(t[s]=Ke(e[s]));else t=e}return t}var Xe=e=>/^\w*$/.test(e),Je=e=>void 0===e,Ze=e=>Array.isArray(e)?e.filter(Boolean):[],Qe=e=>Ze(e.replace(/["|']|\]/g,"").split(/\.|\[/)),et=(e,t,s)=>{if(!t||!qe(e))return s;const r=(Xe(t)?[t]:Qe(t)).reduce((e,t)=>He(e)?e:e[t],e);return Je(r)||r===e?Je(e[t])?s:e[t]:r},tt=e=>"boolean"==typeof e,st=(e,t,s)=>{let r=-1;const a=Xe(t)?[t]:Qe(t),n=a.length,i=n-1;for(;++r<n;){const t=a[r];let n=s;if(r!==i){const s=e[t];n=qe(s)||Array.isArray(s)?s:isNaN(+a[r+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=n,e=e[t]}};const rt="blur",at="focusout",nt="onBlur",it="onChange",lt="onSubmit",ot="onTouched",ct="all",dt="max",ut="min",mt="maxLength",ht="minLength",xt="pattern",pt="required",ft="validate";s.createContext(null).displayName="HookFormContext";const gt="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;var bt=e=>"string"==typeof e,vt=e=>He(e)||!Ge(e);function yt(e,t,s=new WeakSet){if(vt(e)||vt(t))return e===t;if(We(e)&&We(t))return e.getTime()===t.getTime();const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;if(s.has(e)||s.has(t))return!0;s.add(e),s.add(t);for(const n of r){const r=e[n];if(!a.includes(n))return!1;if("ref"!==n){const e=t[n];if(We(r)&&We(e)||qe(r)&&qe(e)||Array.isArray(r)&&Array.isArray(e)?!yt(r,e,s):r!==e)return!1}}return!0}var wt=(e,t,s,r,a)=>t?{...s[e],types:{...s[e]&&s[e].types?s[e].types:{},[r]:a||!0}}:{},jt=e=>Array.isArray(e)?e:[e],Nt=()=>{let e=[];return{get observers(){return e},next:t=>{for(const s of e)s.next&&s.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}};function _t(e,t){const s={};for(const r in e)if(e.hasOwnProperty(r)){const a=e[r],n=t[r];if(a&&qe(a)&&n){const e=_t(a,n);qe(e)&&(s[r]=e)}else e[r]&&(s[r]=n)}return s}var kt=e=>qe(e)&&!Object.keys(e).length,Ct=e=>"file"===e.type,St=e=>"function"==typeof e,Tt=e=>{if(!Ye)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},At=e=>"select-multiple"===e.type,Et=e=>"radio"===e.type,Rt=e=>Tt(e)&&e.isConnected;function Pt(e,t){const s=Array.isArray(t)?t:Xe(t)?[t]:Qe(t),r=1===s.length?e:function(e,t){const s=t.slice(0,-1).length;let r=0;for(;r<s;)e=Je(e)?r++:e[t[r++]];return e}(e,s),a=s.length-1,n=s[a];return r&&delete r[n],0!==a&&(qe(r)&&kt(r)||Array.isArray(r)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!Je(e[t]))return!1;return!0}(r))&&Pt(e,s.slice(0,-1)),e}function Mt(e){return Array.isArray(e)||qe(e)&&!(e=>{for(const t in e)if(St(e[t]))return!0;return!1})(e)}function Lt(e,t={}){for(const s in e)Mt(e[s])?(t[s]=Array.isArray(e[s])?[]:{},Lt(e[s],t[s])):Je(e[s])||(t[s]=!0);return t}function Ot(e,t,s){s||(s=Lt(t));for(const r in e)Mt(e[r])?Je(t)||vt(s[r])?s[r]=Lt(e[r],Array.isArray(e[r])?[]:{}):Ot(e[r],He(t)?{}:t[r],s[r]):s[r]=!yt(e[r],t[r]);return s}const It={value:!1,isValid:!1},Dt={value:!0,isValid:!0};var Ft=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Je(e[0].attributes.value)?Je(e[0].value)||""===e[0].value?Dt:{value:e[0].value,isValid:!0}:Dt:It}return It},Bt=(e,{valueAsNumber:t,valueAsDate:s,setValueAs:r})=>Je(e)?e:t?""===e?NaN:e?+e:e:s&&bt(e)?new Date(e):r?r(e):e;const $t={isValid:!1,value:null};var zt=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,$t):$t;function Vt(e){const t=e.ref;return Ct(t)?t.files:Et(t)?zt(e.refs).value:At(t)?[...t.selectedOptions].map(({value:e})=>e):Ue(t)?Ft(e.refs).value:Bt(Je(t.value)?e.ref.value:t.value,e)}var Ut=e=>e instanceof RegExp,Wt=e=>Je(e)?e:Ut(e)?e.source:qe(e)?Ut(e.value)?e.value.source:e.value:e,Ht=e=>({isOnSubmit:!e||e===lt,isOnBlur:e===nt,isOnChange:e===it,isOnAll:e===ct,isOnTouch:e===ot});const Gt="AsyncFunction";var qt=e=>!!e&&!!e.validate&&!!(St(e.validate)&&e.validate.constructor.name===Gt||qe(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===Gt)),Yt=(e,t,s)=>!s&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));const Kt=(e,t,s,r)=>{for(const a of s||Object.keys(e)){const s=et(e,a);if(s){const{_f:e,...n}=s;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],a)&&!r)return!0;if(e.ref&&t(e.ref,e.name)&&!r)return!0;if(Kt(n,t))break}else if(qe(n)&&Kt(n,t))break}}};function Xt(e,t,s){const r=et(e,s);if(r||Xe(s))return{error:r,name:s};const a=s.split(".");for(;a.length;){const r=a.join("."),n=et(t,r),i=et(e,r);if(n&&!Array.isArray(n)&&s!==r)return{name:s};if(i&&i.type)return{name:r,error:i};if(i&&i.root&&i.root.type)return{name:`${r}.root`,error:i.root};a.pop()}return{name:s}}var Jt=(e,t,s)=>{const r=jt(et(e,s));return st(r,"root",t[s]),st(e,s,r),e};function Zt(e,t,s="validate"){if(bt(e)||Array.isArray(e)&&e.every(bt)||tt(e)&&!e)return{type:s,message:bt(e)?e:"",ref:t}}var Qt=e=>qe(e)&&!Ut(e)?e:{value:e,message:""},es=async(e,t,s,r,a,n)=>{const{ref:i,refs:l,required:o,maxLength:c,minLength:d,min:u,max:m,pattern:h,validate:x,name:p,valueAsNumber:f,mount:g}=e._f,b=et(s,p);if(!g||t.has(p))return{};const v=l?l[0]:i,y=e=>{a&&v.reportValidity&&(v.setCustomValidity(tt(e)?"":e||""),v.reportValidity())},w={},j=Et(i),N=Ue(i),_=j||N,k=(f||Ct(i))&&Je(i.value)&&Je(b)||Tt(i)&&""===i.value||""===b||Array.isArray(b)&&!b.length,C=wt.bind(null,p,r,w),S=(e,t,s,r=mt,a=ht)=>{const n=e?t:s;w[p]={type:e?r:a,message:n,ref:i,...C(e?r:a,n)}};if(n?!Array.isArray(b)||!b.length:o&&(!_&&(k||He(b))||tt(b)&&!b||N&&!Ft(l).isValid||j&&!zt(l).isValid)){const{value:e,message:t}=bt(o)?{value:!!o,message:o}:Qt(o);if(e&&(w[p]={type:pt,message:t,ref:v,...C(pt,t)},!r))return y(t),w}if(!(k||He(u)&&He(m))){let e,t;const s=Qt(m),a=Qt(u);if(He(b)||isNaN(b)){const r=i.valueAsDate||new Date(b),n=e=>new Date((new Date).toDateString()+" "+e),l="time"==i.type,o="week"==i.type;bt(s.value)&&b&&(e=l?n(b)>n(s.value):o?b>s.value:r>new Date(s.value)),bt(a.value)&&b&&(t=l?n(b)<n(a.value):o?b<a.value:r<new Date(a.value))}else{const r=i.valueAsNumber||(b?+b:b);He(s.value)||(e=r>s.value),He(a.value)||(t=r<a.value)}if((e||t)&&(S(!!e,s.message,a.message,dt,ut),!r))return y(w[p].message),w}if((c||d)&&!k&&(bt(b)||n&&Array.isArray(b))){const e=Qt(c),t=Qt(d),s=!He(e.value)&&b.length>+e.value,a=!He(t.value)&&b.length<+t.value;if((s||a)&&(S(s,e.message,t.message),!r))return y(w[p].message),w}if(h&&!k&&bt(b)){const{value:e,message:t}=Qt(h);if(Ut(e)&&!b.match(e)&&(w[p]={type:xt,message:t,ref:i,...C(xt,t)},!r))return y(t),w}if(x)if(St(x)){const e=Zt(await x(b,s),v);if(e&&(w[p]={...e,...C(ft,e.message)},!r))return y(e.message),w}else if(qe(x)){let e={};for(const t in x){if(!kt(e)&&!r)break;const a=Zt(await x[t](b,s),v,t);a&&(e={...a,...C(t,a.message)},y(a.message),r&&(w[p]=e))}if(!kt(e)&&(w[p]={ref:v,...e},!r))return w}return y(!0),w};const ts={mode:lt,reValidateMode:it,shouldFocusError:!0};function ss(e={}){let t,s={...ts,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:St(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},n=(qe(s.defaultValues)||qe(s.values))&&Ke(s.defaultValues||s.values)||{},i=s.shouldUnregister?{}:Ke(n),l={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let u={...d};const m={array:Nt(),state:Nt()},h=s.criteriaMode===ct,x=async e=>{if(!s.disabled&&(d.isValid||u.isValid||e)){const e=s.resolver?kt((await v()).errors):await y(a,!0);e!==r.isValid&&m.state.next({isValid:e})}},p=(e,t)=>{!s.disabled&&(d.isValidating||d.validatingFields||u.isValidating||u.validatingFields)&&((e||Array.from(o.mount)).forEach(e=>{e&&(t?st(r.validatingFields,e,t):Pt(r.validatingFields,e))}),m.state.next({validatingFields:r.validatingFields,isValidating:!kt(r.validatingFields)}))},f=(e,t,s,r)=>{const o=et(a,e);if(o){const a=et(i,e,Je(s)?et(n,e):s);Je(a)||r&&r.defaultChecked||t?st(i,e,t?a:Vt(o._f)):N(e,a),l.mount&&x()}},g=(e,t,a,i,l)=>{let o=!1,c=!1;const h={name:e};if(!s.disabled){if(!a||i){(d.isDirty||u.isDirty)&&(c=r.isDirty,r.isDirty=h.isDirty=w(),o=c!==h.isDirty);const s=yt(et(n,e),t);c=!!et(r.dirtyFields,e),s?Pt(r.dirtyFields,e):st(r.dirtyFields,e,!0),h.dirtyFields=r.dirtyFields,o=o||(d.dirtyFields||u.dirtyFields)&&c!==!s}if(a){const t=et(r.touchedFields,e);t||(st(r.touchedFields,e,a),h.touchedFields=r.touchedFields,o=o||(d.touchedFields||u.touchedFields)&&t!==a)}o&&l&&m.state.next(h)}return o?h:{}},b=(e,a,n,i)=>{const l=et(r.errors,e),o=(d.isValid||u.isValid)&&tt(a)&&r.isValid!==a;var h;if(s.delayError&&n?(h=()=>((e,t)=>{st(r.errors,e,t),m.state.next({errors:r.errors})})(e,n),t=e=>{clearTimeout(c),c=setTimeout(h,e)},t(s.delayError)):(clearTimeout(c),t=null,n?st(r.errors,e,n):Pt(r.errors,e)),(n?!yt(l,n):l)||!kt(i)||o){const t={...i,...o&&tt(a)?{isValid:a}:{},errors:r.errors,name:e};r={...r,...t},m.state.next(t)}},v=async e=>{p(e,!0);const t=await s.resolver(i,s.context,((e,t,s,r)=>{const a={};for(const n of e){const e=et(t,n);e&&st(a,n,e._f)}return{criteriaMode:s,names:[...e],fields:a,shouldUseNativeValidation:r}})(e||o.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return p(e),t},y=async(e,t,a={valid:!0})=>{for(const n in e){const l=e[n];if(l){const{_f:e,...n}=l;if(e){const n=o.array.has(e.name),c=l._f&&qt(l._f);c&&d.validatingFields&&p([e.name],!0);const u=await es(l,o.disabled,i,h,s.shouldUseNativeValidation&&!t,n);if(c&&d.validatingFields&&p([e.name]),u[e.name]&&(a.valid=!1,t))break;!t&&(et(u,e.name)?n?Jt(r.errors,u,e.name):st(r.errors,e.name,u[e.name]):Pt(r.errors,e.name))}!kt(n)&&await y(n,t,a)}}return a.valid},w=(e,t)=>!s.disabled&&(e&&t&&st(i,e,t),!yt(A(),n)),j=(e,t,s)=>((e,t,s,r,a)=>bt(e)?(r&&t.watch.add(e),et(s,e,a)):Array.isArray(e)?e.map(e=>(r&&t.watch.add(e),et(s,e))):(r&&(t.watchAll=!0),s))(e,o,{...l.mount?i:Je(t)?n:bt(e)?{[e]:t}:t},s,t),N=(e,t,s={})=>{const r=et(a,e);let n=t;if(r){const s=r._f;s&&(!s.disabled&&st(i,e,Bt(t,s)),n=Tt(s.ref)&&He(t)?"":t,At(s.ref)?[...s.ref.options].forEach(e=>e.selected=n.includes(e.value)):s.refs?Ue(s.ref)?s.refs.forEach(e=>{e.defaultChecked&&e.disabled||(Array.isArray(n)?e.checked=!!n.find(t=>t===e.value):e.checked=n===e.value||!!n)}):s.refs.forEach(e=>e.checked=e.value===n):Ct(s.ref)?s.ref.value="":(s.ref.value=n,s.ref.type||m.state.next({name:e,values:Ke(i)})))}(s.shouldDirty||s.shouldTouch)&&g(e,n,s.shouldTouch,s.shouldDirty,!0),s.shouldValidate&&T(e)},_=(e,t,s)=>{for(const r in t){if(!t.hasOwnProperty(r))return;const n=t[r],i=e+"."+r,l=et(a,i);(o.array.has(e)||qe(n)||l&&!l._f)&&!We(n)?_(i,n,s):N(i,n,s)}},k=(e,t,s={})=>{const c=et(a,e),h=o.array.has(e),x=Ke(t);st(i,e,x),h?(m.array.next({name:e,values:Ke(i)}),(d.isDirty||d.dirtyFields||u.isDirty||u.dirtyFields)&&s.shouldDirty&&m.state.next({name:e,dirtyFields:Ot(n,i),isDirty:w(e,x)})):!c||c._f||He(x)?N(e,x,s):_(e,x,s),Yt(e,o)&&m.state.next({...r,name:e}),m.state.next({name:l.mount?e:void 0,values:Ke(i)})},C=async e=>{l.mount=!0;const n=e.target;let c=n.name,f=!0;const w=et(a,c),j=e=>{f=Number.isNaN(e)||We(e)&&isNaN(e.getTime())||yt(e,et(i,c,e))},N=Ht(s.mode),_=Ht(s.reValidateMode);if(w){let l,C;const S=n.type?Vt(w._f):(e=>qe(e)&&e.target?Ue(e.target)?e.target.checked:e.target.value:e)(e),A=e.type===rt||e.type===at,E=!((k=w._f).mount&&(k.required||k.min||k.max||k.maxLength||k.minLength||k.pattern||k.validate)||s.resolver||et(r.errors,c)||w._f.deps)||((e,t,s,r,a)=>!a.isOnAll&&(!s&&a.isOnTouch?!(t||e):(s?r.isOnBlur:a.isOnBlur)?!e:!(s?r.isOnChange:a.isOnChange)||e))(A,et(r.touchedFields,c),r.isSubmitted,_,N),R=Yt(c,o,A);st(i,c,S),A?n&&n.readOnly||(w._f.onBlur&&w._f.onBlur(e),t&&t(0)):w._f.onChange&&w._f.onChange(e);const P=g(c,S,A),M=!kt(P)||R;if(!A&&m.state.next({name:c,type:e.type,values:Ke(i)}),E)return(d.isValid||u.isValid)&&("onBlur"===s.mode?A&&x():A||x()),M&&m.state.next({name:c,...R?{}:P});if(!A&&R&&m.state.next({...r}),s.resolver){const{errors:e}=await v([c]);if(j(S),f){const t=Xt(r.errors,a,c),s=Xt(e,a,t.name||c);l=s.error,c=s.name,C=kt(e)}}else p([c],!0),l=(await es(w,o.disabled,i,h,s.shouldUseNativeValidation))[c],p([c]),j(S),f&&(l?C=!1:(d.isValid||u.isValid)&&(C=await y(a,!0)));f&&(w._f.deps&&(!Array.isArray(w._f.deps)||w._f.deps.length>0)&&T(w._f.deps),b(c,C,l,P))}var k},S=(e,t)=>{if(et(r.errors,t)&&e.focus)return e.focus(),1},T=async(e,t={})=>{let n,i;const l=jt(e);if(s.resolver){const t=await(async e=>{const{errors:t}=await v(e);if(e)for(const s of e){const e=et(t,s);e?st(r.errors,s,e):Pt(r.errors,s)}else r.errors=t;return t})(Je(e)?e:l);n=kt(t),i=e?!l.some(e=>et(t,e)):n}else e?(i=(await Promise.all(l.map(async e=>{const t=et(a,e);return await y(t&&t._f?{[e]:t}:t)}))).every(Boolean),(i||r.isValid)&&x()):i=n=await y(a);return m.state.next({...!bt(e)||(d.isValid||u.isValid)&&n!==r.isValid?{}:{name:e},...s.resolver||!e?{isValid:n}:{},errors:r.errors}),t.shouldFocus&&!i&&Kt(a,S,e?l:o.mount),i},A=(e,t)=>{let s={...l.mount?i:n};return t&&(s=_t(t.dirtyFields?r.dirtyFields:r.touchedFields,s)),Je(e)?s:bt(e)?et(s,e):e.map(e=>et(s,e))},E=(e,t)=>({invalid:!!et((t||r).errors,e),isDirty:!!et((t||r).dirtyFields,e),error:et((t||r).errors,e),isValidating:!!et(r.validatingFields,e),isTouched:!!et((t||r).touchedFields,e)}),R=(e,t,s)=>{const n=(et(a,e,{_f:{}})._f||{}).ref,i=et(r.errors,e)||{},{ref:l,message:o,type:c,...d}=i;st(r.errors,e,{...d,...t,ref:n}),m.state.next({name:e,errors:r.errors,isValid:!1}),s&&s.shouldFocus&&n&&n.focus&&n.focus()},P=e=>m.state.subscribe({next:t=>{var s,a,l;s=e.name,a=t.name,l=e.exact,s&&a&&s!==a&&!jt(s).some(e=>e&&(l?e===a:e.startsWith(a)||a.startsWith(e)))||!((e,t,s,r)=>{s(e);const{name:a,...n}=e;return kt(n)||Object.keys(n).length>=Object.keys(t).length||Object.keys(n).find(e=>t[e]===(!r||ct))})(t,e.formState||d,$,e.reRenderRoot)||e.callback({values:{...i},...r,...t,defaultValues:n})}}).unsubscribe,M=(e,t={})=>{for(const l of e?jt(e):o.mount)o.mount.delete(l),o.array.delete(l),t.keepValue||(Pt(a,l),Pt(i,l)),!t.keepError&&Pt(r.errors,l),!t.keepDirty&&Pt(r.dirtyFields,l),!t.keepTouched&&Pt(r.touchedFields,l),!t.keepIsValidating&&Pt(r.validatingFields,l),!s.shouldUnregister&&!t.keepDefaultValue&&Pt(n,l);m.state.next({values:Ke(i)}),m.state.next({...r,...t.keepDirty?{isDirty:w()}:{}}),!t.keepIsValid&&x()},L=({disabled:e,name:t})=>{(tt(e)&&l.mount||e||o.disabled.has(t))&&(e?o.disabled.add(t):o.disabled.delete(t))},O=(e,t={})=>{let r=et(a,e);const i=tt(t.disabled)||tt(s.disabled);return st(a,e,{...r||{},_f:{...r&&r._f?r._f:{ref:{name:e}},name:e,mount:!0,...t}}),o.mount.add(e),r?L({disabled:tt(t.disabled)?t.disabled:s.disabled,name:e}):f(e,!0,t.value),{...i?{disabled:t.disabled||s.disabled}:{},...s.progressive?{required:!!t.required,min:Wt(t.min),max:Wt(t.max),minLength:Wt(t.minLength),maxLength:Wt(t.maxLength),pattern:Wt(t.pattern)}:{},name:e,onChange:C,onBlur:C,ref:i=>{if(i){O(e,t),r=et(a,e);const s=Je(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,l=(e=>Et(e)||Ue(e))(s),o=r._f.refs||[];if(l?o.find(e=>e===s):s===r._f.ref)return;st(a,e,{_f:{...r._f,...l?{refs:[...o.filter(Rt),s,...Array.isArray(et(n,e))?[{}]:[]],ref:{type:s.type,name:e}}:{ref:s}}}),f(e,!1,void 0,s)}else r=et(a,e,{}),r._f&&(r._f.mount=!1),(s.shouldUnregister||t.shouldUnregister)&&(!((e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)))(o.array,e)||!l.action)&&o.unMount.add(e)}}},I=()=>s.shouldFocusError&&Kt(a,S,o.mount),D=(e,t)=>async n=>{let l;n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let c=Ke(i);if(m.state.next({isSubmitting:!0}),s.resolver){const{errors:e,values:t}=await v();r.errors=e,c=Ke(t)}else await y(a);if(o.disabled.size)for(const e of o.disabled)Pt(c,e);if(Pt(r.errors,"root"),kt(r.errors)){m.state.next({errors:{}});try{await e(c,n)}catch(d){l=d}}else t&&await t({...r.errors},n),I(),setTimeout(I);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:kt(r.errors)&&!l,submitCount:r.submitCount+1,errors:r.errors}),l)throw l},F=(e,t={})=>{const c=e?Ke(e):n,u=Ke(c),h=kt(e),x=h?n:u;if(t.keepDefaultValues||(n=c),!t.keepValues){if(t.keepDirtyValues){const e=new Set([...o.mount,...Object.keys(Ot(n,i))]);for(const t of Array.from(e))et(r.dirtyFields,t)?st(x,t,et(i,t)):k(t,et(x,t))}else{if(Ye&&Je(e))for(const e of o.mount){const t=et(a,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(Tt(e)){const t=e.closest("form");if(t){t.reset();break}}}}if(t.keepFieldsRef)for(const e of o.mount)k(e,et(x,e));else a={}}i=s.shouldUnregister?t.keepDefaultValues?Ke(n):{}:Ke(x),m.array.next({values:{...x}}),m.state.next({values:{...x}})}o={mount:t.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues,l.watch=!!s.shouldUnregister,m.state.next({submitCount:t.keepSubmitCount?r.submitCount:0,isDirty:!h&&(t.keepDirty?r.isDirty:!(!t.keepDefaultValues||yt(e,n))),isSubmitted:!!t.keepIsSubmitted&&r.isSubmitted,dirtyFields:h?{}:t.keepDirtyValues?t.keepDefaultValues&&i?Ot(n,i):r.dirtyFields:t.keepDefaultValues&&e?Ot(n,e):t.keepDirty?r.dirtyFields:{},touchedFields:t.keepTouched?r.touchedFields:{},errors:t.keepErrors?r.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&r.isSubmitSuccessful,isSubmitting:!1,defaultValues:n})},B=(e,t)=>F(St(e)?e(i):e,t),$=e=>{r={...r,...e}},z={control:{register:O,unregister:M,getFieldState:E,handleSubmit:D,setError:R,_subscribe:P,_runSchema:v,_focusError:I,_getWatch:j,_getDirty:w,_setValid:x,_setFieldArray:(e,t=[],o,c,h=!0,x=!0)=>{if(c&&o&&!s.disabled){if(l.action=!0,x&&Array.isArray(et(a,e))){const t=o(et(a,e),c.argA,c.argB);h&&st(a,e,t)}if(x&&Array.isArray(et(r.errors,e))){const t=o(et(r.errors,e),c.argA,c.argB);h&&st(r.errors,e,t),((e,t)=>{!Ze(et(e,t)).length&&Pt(e,t)})(r.errors,e)}if((d.touchedFields||u.touchedFields)&&x&&Array.isArray(et(r.touchedFields,e))){const t=o(et(r.touchedFields,e),c.argA,c.argB);h&&st(r.touchedFields,e,t)}(d.dirtyFields||u.dirtyFields)&&(r.dirtyFields=Ot(n,i)),m.state.next({name:e,isDirty:w(e,t),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else st(i,e,t)},_setDisabledField:L,_setErrors:e=>{r.errors=e,m.state.next({errors:r.errors,isValid:!1})},_getFieldArray:e=>Ze(et(l.mount?i:n,e,s.shouldUnregister?et(n,e,[]):[])),_reset:F,_resetDefaultValues:()=>St(s.defaultValues)&&s.defaultValues().then(e=>{B(e,s.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(const e of o.unMount){const t=et(a,e);t&&(t._f.refs?t._f.refs.every(e=>!Rt(e)):!Rt(t._f.ref))&&M(e)}o.unMount=new Set},_disableForm:e=>{tt(e)&&(m.state.next({disabled:e}),Kt(a,(t,s)=>{const r=et(a,s);r&&(t.disabled=r._f.disabled||e,Array.isArray(r._f.refs)&&r._f.refs.forEach(t=>{t.disabled=r._f.disabled||e}))},0,!1))},_subjects:m,_proxyFormState:d,get _fields(){return a},get _formValues(){return i},get _state(){return l},set _state(e){l=e},get _defaultValues(){return n},get _names(){return o},set _names(e){o=e},get _formState(){return r},get _options(){return s},set _options(e){s={...s,...e}}},subscribe:e=>(l.mount=!0,u={...u,...e.formState},P({...e,formState:u})),trigger:T,register:O,handleSubmit:D,watch:(e,t)=>St(e)?m.state.subscribe({next:s=>"values"in s&&e(j(void 0,t),s)}):j(e,t,!0),setValue:k,getValues:A,reset:B,resetField:(e,t={})=>{et(a,e)&&(Je(t.defaultValue)?k(e,Ke(et(n,e))):(k(e,t.defaultValue),st(n,e,Ke(t.defaultValue))),t.keepTouched||Pt(r.touchedFields,e),t.keepDirty||(Pt(r.dirtyFields,e),r.isDirty=t.defaultValue?w(e,Ke(et(n,e))):w()),t.keepError||(Pt(r.errors,e),d.isValid&&x()),m.state.next({...r}))},clearErrors:e=>{e&&jt(e).forEach(e=>Pt(r.errors,e)),m.state.next({errors:e?r.errors:{}})},unregister:M,setError:R,setFocus:(e,t={})=>{const s=et(a,e),r=s&&s._f;if(r){const e=r.refs?r.refs[0]:r.ref;e.focus&&(e.focus(),t.shouldSelect&&St(e.select)&&e.select())}},getFieldState:E};return{...z,formControl:z}}function rs(e={}){const t=s.useRef(void 0),r=s.useRef(void 0),[a,n]=s.useState({isDirty:!1,isValidating:!1,isLoading:St(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:St(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:a},e.defaultValues&&!St(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:s,...r}=ss(e);t.current={...r,formState:a}}const i=t.current.control;return i._options=e,gt(()=>{const e=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(e=>({...e,isReady:!0})),i._formState.isReady=!0,e},[i]),s.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),s.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),s.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),s.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),s.useEffect(()=>{if(i._proxyFormState.isDirty){const e=i._getDirty();e!==a.isDirty&&i._subjects.state.next({isDirty:e})}},[i,a.isDirty]),s.useEffect(()=>{e.values&&!yt(e.values,r.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),r.current=e.values,n(e=>({...e}))):i._resetDefaultValues()},[i,e.values]),s.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=((e,t,s,r=!0)=>{const a={defaultValues:t._defaultValues};for(const n in e)Object.defineProperty(a,n,{get:()=>{const s=n;return t._proxyFormState[s]!==ct&&(t._proxyFormState[s]=!r||ct),e[s]}});return a})(a,i),t.current}const as=({size:e="md",className:t=""})=>{const s={sm:"w-48 h-6",md:"w-80 h-8",lg:"w-96 h-12",xl:"w-120 h-16"};return $e.jsx("div",{className:`flex items-center justify-center ${t}`,children:$e.jsx("div",{className:`${s[e]} flex items-center justify-center`,children:$e.jsxs("svg",{viewBox:"0 200 1500 443.75",className:`${s[e]} fill-current text-primary-600`,xmlns:"http://www.w3.org/2000/svg",children:[$e.jsxs("defs",{children:[$e.jsx("g",{}),$e.jsx("clipPath",{id:"2c8be5d048",children:$e.jsx("path",{d:"M 341.261719 338.957031 L 413.082031 338.957031 L 413.082031 410.777344 L 341.261719 410.777344 Z M 341.261719 338.957031 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"b68e34554b",children:$e.jsx("path",{d:"M 377.171875 338.957031 C 357.339844 338.957031 341.261719 355.035156 341.261719 374.867188 C 341.261719 394.699219 357.339844 410.777344 377.171875 410.777344 C 397.003906 410.777344 413.082031 394.699219 413.082031 374.867188 C 413.082031 355.035156 397.003906 338.957031 377.171875 338.957031 Z M 377.171875 338.957031 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"708a5a267b",children:$e.jsx("path",{d:"M 289 385 L 360 385 L 360 451 L 289 451 Z M 289 385 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"8fbdbcaafab",children:$e.jsx("path",{d:"M 343.511719 385.902344 L 359.589844 405.160156 L 305.277344 450.507812 L 289.195312 431.246094 Z M 343.511719 385.902344 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"8d46f64bcf",children:$e.jsx("path",{d:"M 241.535156 413.492188 L 313.355469 413.492188 L 313.355469 485.3125 L 241.535156 485.3125 Z M 241.535156 413.492188 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"02e7ad6ee2",children:$e.jsx("path",{d:"M 277.445312 413.492188 C 257.613281 413.492188 241.535156 429.570312 241.535156 449.402344 C 241.535156 469.234375 257.613281 485.3125 277.445312 485.3125 C 297.277344 485.3125 313.355469 469.234375 313.355469 449.402344 C 313.355469 429.570312 297.277344 413.492188 277.445312 413.492188 Z M 277.445312 413.492188 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"6830cf57e2",children:$e.jsx("path",{d:"M 194 371 L 267 371 L 267 444 L 194 444 Z M 194 371 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"f82154d106",children:$e.jsx("path",{d:"M 194.226562 389.089844 L 211.96875 371.347656 L 266.070312 425.449219 L 248.328125 443.191406 Z M 194.226562 389.089844 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"086c9953ef",children:$e.jsx("path",{d:"M 146.421875 325.171875 L 218.242188 325.171875 L 218.242188 396.992188 L 146.421875 396.992188 Z M 146.421875 325.171875 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"04627f0c31",children:$e.jsx("path",{d:"M 182.332031 325.171875 C 162.496094 325.171875 146.421875 341.25 146.421875 361.082031 C 146.421875 380.917969 162.496094 396.992188 182.332031 396.992188 C 202.164062 396.992188 218.242188 380.917969 218.242188 361.082031 C 218.242188 341.25 202.164062 325.171875 182.332031 325.171875 Z M 182.332031 325.171875 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"c678edc625",children:$e.jsx("path",{d:"M 97 375 L 178 375 L 178 470 L 97 470 Z M 97 375 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"3f34925230",children:$e.jsx("path",{d:"M 157.613281 375.53125 L 177.492188 390.839844 L 117.25 469.058594 L 97.371094 453.75 Z M 157.613281 375.53125 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"31c86be19e",children:$e.jsx("path",{d:"M 51.449219 446.507812 L 123.269531 446.507812 L 123.269531 518.328125 L 51.449219 518.328125 Z M 51.449219 446.507812 ",clipRule:"nonzero"})}),$e.jsx("clipPath",{id:"ca6b13c185",children:$e.jsx("path",{d:"M 87.359375 446.507812 C 67.527344 446.507812 51.449219 462.582031 51.449219 482.417969 C 51.449219 502.25 67.527344 518.328125 87.359375 518.328125 C 107.191406 518.328125 123.269531 502.25 123.269531 482.417969 C 123.269531 462.582031 107.191406 446.507812 87.359375 446.507812 Z M 87.359375 446.507812 ",clipRule:"nonzero"})})]}),$e.jsx("g",{clipPath:"url(#2c8be5d048)",children:$e.jsx("g",{clipPath:"url(#b68e34554b)",children:$e.jsx("path",{d:"M 341.261719 338.957031 L 413.082031 338.957031 L 413.082031 410.777344 L 341.261719 410.777344 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#708a5a267b)",children:$e.jsx("g",{clipPath:"url(#8fbdbcafab)",children:$e.jsx("path",{d:"M 343.511719 385.902344 L 359.589844 405.160156 L 305.273438 450.511719 L 289.191406 431.25 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#8d46f64bcf)",children:$e.jsx("g",{clipPath:"url(#02e7ad6ee2)",children:$e.jsx("path",{d:"M 241.535156 413.492188 L 313.355469 413.492188 L 313.355469 485.3125 L 241.535156 485.3125 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#6830cf57e2)",children:$e.jsx("g",{clipPath:"url(#f82154d106)",children:$e.jsx("path",{d:"M 194.226562 389.089844 L 211.96875 371.347656 L 266.089844 425.472656 L 248.351562 443.210938 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#086c9953ef)",children:$e.jsx("g",{clipPath:"url(#04627f0c31)",children:$e.jsx("path",{d:"M 146.421875 325.171875 L 218.242188 325.171875 L 218.242188 396.992188 L 146.421875 396.992188 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#c678edc625)",children:$e.jsx("g",{clipPath:"url(#3f34925230)",children:$e.jsx("path",{d:"M 157.613281 375.53125 L 177.492188 390.839844 L 117.273438 469.03125 L 97.394531 453.722656 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{clipPath:"url(#31c86be19e)",children:$e.jsx("g",{clipPath:"url(#ca6b13c185)",children:$e.jsx("path",{d:"M 51.449219 446.507812 L 123.269531 446.507812 L 123.269531 518.328125 L 51.449219 518.328125 Z",fillOpacity:"1",fillRule:"nonzero"})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(439.375398, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 117.890625 0 L 102.4375 0 L 102.296875 -74.109375 L 70.984375 -10.34375 L 60.078125 -10.34375 L 28.765625 -74.109375 L 28.765625 0 L 13.03125 0 L 13.03125 -99.1875 L 32.875 -99.1875 L 65.59375 -33.296875 L 98.1875 -99.1875 L 117.890625 -99.1875 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(570.429838, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 75.9375 -75.375 L 41.65625 10.34375 C 37.03125 22.25 28.859375 28.203125 17.140625 28.203125 C 10.628906 28.203125 4.820312 26.070312 -0.28125 21.8125 L 6.65625 9.203125 C 10.0625 11.660156 13.320312 12.890625 16.4375 12.890625 C 21.539062 12.890625 25.363281 10.101562 27.90625 4.53125 L 30.46875 -1.140625 L -0.703125 -75.375 L 16.15625 -75.375 L 38.6875 -18.28125 L 59.65625 -75.375 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(645.662176, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 117.890625 0 L 102.4375 0 L 102.296875 -74.109375 L 70.984375 -10.34375 L 60.078125 -10.34375 L 28.765625 -74.109375 L 28.765625 0 L 13.03125 0 L 13.03125 -99.1875 L 32.875 -99.1875 L 65.59375 -33.296875 L 98.1875 -99.1875 L 117.890625 -99.1875 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(776.716616, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 43.078125 -75.9375 C 56.015625 -75.9375 65.382812 -72.039062 71.1875 -64.25 C 77 -56.457031 79.390625 -45.523438 78.359375 -31.453125 L 21.390625 -31.453125 C 22.710938 -25.597656 25.453125 -20.992188 29.609375 -17.640625 C 33.765625 -14.285156 38.816406 -12.609375 44.765625 -12.609375 C 53.273438 -12.609375 60.363281 -15.535156 66.03125 -21.390625 L 74.671875 -12.1875 C 66.921875 -3.6875 56.53125 0.5625 43.5 0.5625 C 31.882812 0.5625 22.554688 -2.953125 15.515625 -9.984375 C 8.472656 -17.023438 4.953125 -26.210938 4.953125 -37.546875 C 4.953125 -48.878906 8.492188 -58.085938 15.578125 -65.171875 C 22.671875 -72.253906 31.835938 -75.84375 43.078125 -75.9375 Z M 21.109375 -43.359375 L 64.1875 -43.359375 C 63.90625 -49.398438 61.875 -54.164062 58.09375 -57.65625 C 54.3125 -61.15625 49.351562 -62.90625 43.21875 -62.90625 C 37.257812 -62.90625 32.320312 -61.15625 28.40625 -57.65625 C 24.488281 -54.164062 22.054688 -49.398438 21.109375 -43.359375 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(860.024721, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 50.578125 -17.28125 L 54.6875 -4.8125 C 48.457031 -1.132812 42.269531 0.703125 36.125 0.703125 C 29.988281 0.703125 24.9375 -1.132812 20.96875 -4.8125 C 17 -8.5 15.015625 -13.976562 15.015625 -21.25 L 15.015625 -60.359375 L 4.390625 -60.359375 L 4.390625 -72.546875 L 15.015625 -72.546875 L 15.015625 -93.234375 L 31.171875 -93.234375 L 31.171875 -72.546875 L 53.421875 -72.546875 L 53.421875 -60.359375 L 31.171875 -60.359375 L 31.171875 -24.234375 C 31.171875 -20.453125 31.832031 -17.804688 33.15625 -16.296875 C 34.476562 -14.785156 36.507812 -14.03125 39.25 -14.03125 C 42.269531 -14.03125 46.046875 -15.113281 50.578125 -17.28125 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(917.688703, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 28.34375 -75.375 L 28.34375 -60.359375 C 33.53125 -70.742188 42.21875 -75.9375 54.40625 -75.9375 L 54.40625 -60.359375 C 46.945312 -60.734375 40.898438 -58.984375 36.265625 -55.109375 C 31.640625 -51.242188 29 -46.003906 28.34375 -39.390625 L 28.34375 0 L 12.046875 0 L 12.046875 -75.375 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(973.510825, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 13.3125 -104.0625 C 15.113281 -105.90625 17.382812 -106.828125 20.125 -106.828125 C 22.863281 -106.828125 25.128906 -105.90625 26.921875 -104.0625 C 28.710938 -102.226562 29.609375 -99.847656 29.609375 -96.921875 C 29.609375 -94.078125 28.710938 -91.734375 26.921875 -89.890625 C 25.128906 -88.054688 22.863281 -87.140625 20.125 -87.140625 C 17.382812 -87.140625 15.113281 -88.054688 13.3125 -89.890625 C 11.519531 -91.734375 10.625 -94.078125 10.625 -96.921875 C 10.625 -99.847656 11.519531 -102.226562 13.3125 -104.0625 Z M 28.203125 0 L 12.046875 0 L 12.046875 -75.375 L 28.203125 -75.375 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(1013.748076, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 42.9375 -75.9375 C 56.53125 -75.9375 66.921875 -71.832031 74.109375 -63.625 L 65.171875 -53.125 C 59.503906 -58.894531 52.328125 -61.734375 43.640625 -61.640625 C 37.117188 -61.640625 31.753906 -59.394531 27.546875 -54.90625 C 23.347656 -50.414062 21.25 -44.628906 21.25 -37.546875 C 21.25 -30.460938 23.347656 -24.675781 27.546875 -20.1875 C 31.753906 -15.695312 37.117188 -13.453125 43.640625 -13.453125 C 53.273438 -13.453125 60.691406 -16.476562 65.890625 -22.53125 L 74.953125 -13.453125 C 67.867188 -4.109375 57.195312 0.5625 42.9375 0.5625 C 31.695312 0.5625 22.554688 -2.953125 15.515625 -9.984375 C 8.472656 -17.023438 4.953125 -26.210938 4.953125 -37.546875 C 4.953125 -48.972656 8.472656 -58.226562 15.515625 -65.3125 C 22.554688 -72.394531 31.695312 -75.9375 42.9375 -75.9375 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(1093.670509, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 101.453125 0 L 76.234375 0 L 76.234375 -38.53125 L 35.140625 -38.53125 L 35.140625 0 L 9.921875 0 L 9.921875 -99.1875 L 35.140625 -99.1875 L 35.140625 -58.375 L 76.234375 -58.375 L 76.234375 -99.1875 L 101.453125 -99.1875 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(1205.031361, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 99.1875 -99.1875 L 99.1875 -41.65625 C 99.1875 -28.53125 95.125 -18.113281 87 -10.40625 C 78.875 -2.707031 67.867188 1.140625 53.984375 1.140625 C 40.003906 1.140625 28.878906 -2.707031 20.609375 -10.40625 C 12.347656 -18.113281 8.21875 -28.53125 8.21875 -41.65625 L 8.21875 -99.1875 L 33.4375 -99.1875 L 33.4375 -41.65625 C 33.4375 -35.039062 35.347656 -29.773438 39.171875 -25.859375 C 43.003906 -21.941406 47.988281 -19.984375 54.125 -19.984375 C 60.164062 -19.984375 65.003906 -21.914062 68.640625 -25.78125 C 72.285156 -29.65625 74.109375 -34.945312 74.109375 -41.65625 L 74.109375 -99.1875 Z"})})})}),$e.jsx("g",{fill:"#000000",fillOpacity:"1",children:$e.jsx("g",{transform:"translate(1312.425162, 476.79183)",children:$e.jsx("g",{children:$e.jsx("path",{d:"M 9.921875 -99.1875 L 56.8125 -99.1875 C 67.957031 -99.1875 76.8125 -96.941406 83.375 -92.453125 C 89.945312 -87.960938 93.234375 -81.941406 93.234375 -74.390625 C 93.234375 -69.191406 91.71875 -64.628906 88.6875 -60.703125 C 85.664062 -56.785156 81.515625 -54.070312 76.234375 -52.5625 C 82.460938 -51.332031 87.414062 -48.453125 91.09375 -43.921875 C 94.78125 -39.390625 96.625 -33.910156 96.625 -27.484375 C 96.625 -19.078125 93.203125 -12.394531 86.359375 -7.4375 C 79.515625 -2.476562 70.234375 0 58.515625 0 L 9.921875 0 Z M 35 -79.90625 L 35 -59.515625 L 55.40625 -59.515625 C 59.082031 -59.515625 62.003906 -60.429688 64.171875 -62.265625 C 66.347656 -64.109375 67.4375 -66.640625 67.4375 -69.859375 C 67.4375 -72.972656 66.347656 -75.425781 64.171875 -77.21875 C 62.003906 -79.007812 59.082031 -79.90625 55.40625 -79.90625 Z M 35 -41.375 L 35 -19.40625 L 55.40625 -19.40625 C 60.125 -19.40625 63.828125 -20.394531 66.515625 -22.375 C 69.210938 -24.363281 70.5625 -27.109375 70.5625 -30.609375 C 70.5625 -33.910156 69.210938 -36.53125 66.515625 -38.46875 C 63.828125 -40.40625 60.125 -41.375 55.40625 -41.375 Z"})})})})]})})})},ns="undefined"!=typeof window&&window.location.origin.includes("localhost")?"/api":"https://api.mymetric.app",is=e=>!(!e||""===e.trim())&&"all"!==e,ls={async login(e){try{const t=await fetch(`${ns}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw 401===t.status?new Error("Credenciais inválidas. Verifique seu usuário e senha."):403===t.status?new Error("Acesso negado. Verifique suas permissões."):t.status>=500?new Error("Erro interno do servidor. Tente novamente mais tarde."):0!==t.status&&navigator.onLine?new Error(`Erro na requisição: ${t.status} - ${e}`):new Error("Erro de conexão. Verifique sua internet e se a API está rodando.")}return await t.json()}catch(t){if(t instanceof Error&&"Erro ao conectar com o servidor. Verifique se a API está rodando."!==t.message)throw t;if(t instanceof TypeError&&t.message.includes("Failed to fetch"))throw new Error("Erro ao conectar com o servidor. Verifique se a API está rodando.");throw new Error("Erro inesperado ao fazer login. Tente novamente.")}},async refreshToken(e){try{const t=await fetch(`${ns}/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!t.ok){const e=await t.text();throw new Error(`HTTP error! status: ${t.status} - ${e}`)}return await t.json()}catch(t){throw new Error("Erro ao renovar token de autenticação.")}},async getProfile(e){try{const t=await fetch(`${ns}/profile`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw new Error("Erro ao buscar perfil do usuário.")}},async getMetrics(e,t){try{const s=await fetch(`${ns}/metrics/basic-data`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar métricas.")}},async getFunnelData(e,t){try{const s=await fetch(`${ns}/metrics/daily-metrics`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados do funil.")}},async getOrders(e,t,s){try{const r=await fetch(`${ns}/metrics/orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t),signal:s});if(!r.ok){const e=await r.text();throw new Error(`HTTP error! status: ${r.status} - ${e}`)}return await r.json()}catch(r){if(r instanceof Error&&"AbortError"===r.name)throw r;throw new Error("Erro ao buscar pedidos.")}},async getLeadsOrders(e,t,s){try{const a=setTimeout(()=>{null==s||s.aborted},6e4);try{const r=await fetch(`${ns}/metrics/leads_orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t),signal:s});if(clearTimeout(a),!r.ok){const e=await r.text();throw new Error(`HTTP error! status: ${r.status} - ${e}`)}return await r.json()}catch(r){throw clearTimeout(a),r}}catch(a){if(a instanceof Error&&"AbortError"===a.name)throw a;if(a instanceof TypeError&&a.message.includes("Failed to fetch"))throw new Error("Network error: Falha ao conectar com o servidor. Verifique sua conexão.");throw a instanceof Error?a:new Error("Erro ao buscar leads e pedidos.")}},async getGoals(e,t){try{const s=await fetch(`${ns}/metrics/goals`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar metas.")}},async getTrafficCategories(e,t){try{const s=await fetch(`${ns}/admin/load-traffic-categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar categorias de tráfego.")}},async deleteGoal(e,t){try{const s=await fetch(`${ns}/admin/delete-goal`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}}catch(s){throw new Error("Erro ao deletar meta.")}},async deleteTrafficCategory(e,t){try{const s=await fetch(`${ns}/admin/traffic-categories`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}}catch(s){throw new Error("Erro ao deletar categoria de tráfego.")}},async saveMonthlyGoal(e,t){try{const s=await fetch(`${ns}/admin/save-monthly-goal`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}}catch(s){throw new Error("Erro ao salvar meta.")}},async saveTrafficCategory(e,t){try{const s=await fetch(`${ns}/admin/traffic-categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}}catch(s){throw new Error("Erro ao salvar categoria de tráfego.")}},async getDetailedData(e,t){try{const s=await fetch(`${ns}/metrics/detailed-data`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados detalhados.")}},async getHavaianasData(e,t){try{const s=await fetch(`${ns}/havaianas/items-scoring`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados da Havaianas.")}},async getProductTrend(e,t){try{const s=await fetch(`${ns}/metrics/product-trend`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados de tendência de produtos.")}},async getAdsCampaigns(e,t){try{const s=await fetch(`${ns}/metrics/ads-campaigns-results`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text(),t=new Error(`HTTP error! status: ${s.status} - ${e}`);throw t.status=s.status,t}return await s.json()}catch(s){if(s instanceof TypeError&&s.message.includes("Failed to fetch")){const e=new Error(`Network error: ${s.message}`);throw e.originalError=s,e.isNetworkError=!0,e}throw new Error("Erro ao buscar dados de campanhas de ads.")}},async getRealtimeData(e,t){try{const s=await fetch(`${ns}/metrics/realtime`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados em tempo real.")}},async getUsers(e,t){try{const s=await fetch(`${ns}/users?table_name=${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar usuários.")}},async createUser(e,t){try{const s=await fetch(`${ns}/create-user`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao criar usuário.")}},async deleteUser(e,t){try{const s=await fetch(`${ns}/users/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}}catch(s){throw new Error("Erro ao remover usuário.")}},async getFreteData(e,t){try{const s=await fetch(`${ns}/metrics/shipping-calc-analytics`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text();throw new Error(`HTTP error! status: ${s.status} - ${e}`)}return await s.json()}catch(s){throw new Error("Erro ao buscar dados de frete.")}},async forgotPassword(e){try{const t=await fetch(`${ns}/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw new Error(`HTTP error! status: ${t.status} - ${e}`)}return await t.json()}catch(t){throw new Error("Erro ao solicitar recuperação de senha.")}},async getAdsCreatives(e,t){try{const s=await fetch(`${ns}/metrics/ads-creatives-results`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(t)});if(!s.ok){const e=await s.text(),t=new Error(`HTTP error! status: ${s.status} - ${e}`);throw t.status=s.status,t}return await s.json()}catch(s){if(s instanceof TypeError&&s.message.includes("Failed to fetch")){const e=new Error(`Network error: ${s.message}`);throw e.originalError=s,e.isNetworkError=!0,e}throw new Error("Erro ao buscar dados de criativos de ads.")}}},os=({onLogin:t})=>{const[s,u]=e.useState(!1),[m,h]=e.useState(!1),[x,p]=e.useState("idle"),[f,g]=e.useState(""),[b,v]=e.useState(!1),[y,w]=e.useState(!1),[j,N]=e.useState(!1),[_,k]=e.useState("idle"),[C,S]=e.useState(""),[T,A]=e.useState(!1),{register:E,handleSubmit:R,formState:{errors:P},reset:M}=rs(),{register:L,handleSubmit:O,formState:{errors:I},reset:D}=rs();return $e.jsxs("div",{className:"w-full max-w-lg relative",children:[b&&$e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-500/20 backdrop-blur-sm rounded-2xl z-10 animate-fade-in"}),$e.jsxs("div",{className:"login-container bg-white/90 backdrop-blur-lg rounded-2xl shadow-2xl p-8 border border-white/20 transition-all duration-800 ease-in-out relative z-20",children:[$e.jsxs("div",{className:"text-center mb-8",children:[$e.jsx("div",{className:"flex justify-center mb-6",children:$e.jsx(as,{size:"xl"})}),$e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:j?"Recuperar Senha":"Bem-vindo"}),$e.jsx("p",{className:"text-gray-600",children:j?"Digite seu email para criar uma nova senha":"Faça login para acessar sua conta"})]}),!j&&"success"===x&&$e.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3 animate-slide-up",children:[$e.jsx(r,{className:"w-5 h-5 text-green-600 animate-bounce"}),$e.jsx("span",{className:"text-green-800 font-medium",children:"Login realizado com sucesso!"}),$e.jsx("div",{className:"success-particles"})]}),!j&&"error"===x&&$e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 animate-slide-up",children:[$e.jsx(a,{className:"w-5 h-5 text-red-600"}),$e.jsx("span",{className:"text-red-800 font-medium",children:f})]}),j&&"success"===_&&$e.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3 animate-slide-up",children:[$e.jsx(r,{className:"w-5 h-5 text-green-600 animate-bounce"}),$e.jsx("span",{className:"text-green-800 font-medium",children:C})]}),j&&"error"===_&&$e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 animate-slide-up",children:[$e.jsx(a,{className:"w-5 h-5 text-red-600"}),$e.jsx("span",{className:"text-red-800 font-medium",children:C})]}),j?$e.jsxs("form",{onSubmit:O(async e=>{A(!0),k("idle"),S("");try{await ls.forgotPassword({email:e.email});k("success"),S("Nova senha foi criada e enviada para seu email."),D()}catch(t){k("error"),S(t instanceof Error?t.message:"Erro ao solicitar recuperação de senha.")}A(!1)}),className:"space-y-6",children:[$e.jsxs("div",{children:[$e.jsx("label",{htmlFor:"forgotEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),$e.jsxs("div",{className:"relative",children:[$e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),$e.jsx("input",{...L("email",{required:"Email é obrigatório",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Email inválido"}}),type:"email",id:"forgotEmail",placeholder:"Digite seu email",className:"input-field pl-10",disabled:T})]}),I.email&&$e.jsx("p",{className:"mt-1 text-sm text-red-600 animate-slide-up",children:I.email.message})]}),$e.jsx("button",{type:"submit",disabled:T,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:T?$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Criando..."]}):"Criar Nova Senha"}),$e.jsxs("button",{type:"button",onClick:()=>{N(!1),k("idle"),S(""),D()},className:"w-full flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-800 transition-colors py-2",disabled:T,children:[$e.jsx(d,{className:"w-4 h-4"}),"Voltar ao login"]})]}):$e.jsxs("form",{onSubmit:R(async e=>{h(!0),p("idle"),g("");try{const s=await ls.login({email:e.username,password:e.password});s.access_token&&s.refresh_token?(p("success"),localStorage.setItem("auth-token",s.access_token),localStorage.setItem("login-response",JSON.stringify(s)),setTimeout(()=>{v(!0);const s=document.querySelector(".login-container");s&&s.classList.add("animate-login-success"),setTimeout(()=>{t(e.username,y),M(),w(!1),p("idle"),v(!1)},800)},1200)):(p("error"),g("Credenciais inválidas. Tente novamente."))}catch(s){p("error"),g(s instanceof Error?s.message:"Erro ao fazer login. Tente novamente.")}h(!1)}),className:"space-y-6",children:[$e.jsxs("div",{children:[$e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuário ou Email"}),$e.jsxs("div",{className:"relative",children:[$e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),$e.jsx("input",{...E("username",{required:"Usuário ou email é obrigatório",minLength:{value:3,message:"Deve ter pelo menos 3 caracteres"}}),type:"text",id:"username",placeholder:"Digite seu usuário ou email",className:"input-field pl-10",disabled:m})]}),P.username&&$e.jsx("p",{className:"mt-1 text-sm text-red-600 animate-slide-up",children:P.username.message})]}),$e.jsxs("div",{children:[$e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),$e.jsxs("div",{className:"relative",children:[$e.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),$e.jsx("input",{...E("password",{required:"Senha é obrigatória",minLength:{value:4,message:"Senha deve ter pelo menos 4 caracteres"}}),type:s?"text":"password",id:"password",placeholder:"Digite sua senha",className:"input-field pl-10 pr-10",disabled:m}),$e.jsx("button",{type:"button",onClick:()=>u(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",disabled:m,children:s?$e.jsx(l,{className:"w-5 h-5"}):$e.jsx(o,{className:"w-5 h-5"})})]}),P.password&&$e.jsx("p",{className:"mt-1 text-sm text-red-600 animate-slide-up",children:P.password.message})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("input",{...E("rememberMe"),type:"checkbox",id:"rememberMe",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:y,onChange:e=>{w(e.target.checked)}}),$e.jsx("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-700",children:"Lembrar de mim"})]}),$e.jsx("button",{type:"button",onClick:()=>{N(!0),k("idle"),S(""),D()},className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",disabled:m,children:"Esqueci minha senha"})]}),$e.jsx("button",{type:"submit",disabled:m,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none "+("success"===x?"animate-pulse":""),children:m?$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):"Entrar"})]}),$e.jsx("div",{className:"mt-8 text-center",children:$e.jsx("p",{className:"text-sm text-gray-500",children:"© 2025 MyMetricHUB. Todos os direitos reservados."})})]}),$e.jsx("style",{children:"\n        .login-container {\n          transform: scale(1);\n          opacity: 1;\n        }\n        \n        .animate-login-success {\n          animation: loginSuccess 0.8s ease-in-out forwards;\n        }\n        \n        @keyframes loginSuccess {\n          0% {\n            transform: scale(1) translateY(0);\n            opacity: 1;\n          }\n          50% {\n            transform: scale(1.05) translateY(-10px);\n            opacity: 0.8;\n          }\n          100% {\n            transform: scale(0.8) translateY(-50px);\n            opacity: 0;\n          }\n        }\n        \n        .animate-slide-up {\n          animation: slideUp 0.3s ease-out;\n          }\n          \n          @keyframes slideUp {\n            from {\n              opacity: 0;\n              transform: translateY(10px);\n            }\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n          \n          .success-particles {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            overflow: hidden;\n          }\n          \n          .success-particles::before,\n          .success-particles::after {\n            content: '';\n            position: absolute;\n            width: 4px;\n            height: 4px;\n            background: #10b981;\n            border-radius: 50%;\n            animation: particle 1s ease-out infinite;\n          }\n          \n          .success-particles::before {\n            top: 20%;\n            left: 20%;\n            animation-delay: 0s;\n          }\n          \n          .success-particles::after {\n            top: 30%;\n            right: 20%;\n            animation-delay: 0.3s;\n          }\n          \n          @keyframes particle {\n            0% {\n              transform: translateY(0) scale(1);\n              opacity: 1;\n            }\n            100% {\n              transform: translateY(-20px) scale(0);\n              opacity: 0;\n            }\n          }\n          \n          .animate-fade-in {\n            animation: fadeIn 0.5s ease-out;\n          }\n          \n          @keyframes fadeIn {\n            from {\n              opacity: 0;\n            }\n            to {\n              opacity: 1;\n            }\n          }\n        "})]})},cs=({message:t="Carregando...",showAuthStatus:s=!1})=>{const[r,a]=e.useState(0),[n,i]=e.useState(!0),l=["O dado não erra. Ele só reflete o que você não quis ver.","Insight sem execução é só ego bem alimentado.","Métrica bonita sem lucro é arte abstrata.","Quem entende a jornada, não precisa de remarketing.","Atribuição não é sobre o último clique — é sobre o primeiro impacto.","O cliente não some. Ele apenas encontrou alguém que o entendeu melhor.","O funil não acabou. Ele só ficou invisível.","Você não escala tráfego. Você escala verdade.","Dados contam histórias. Performance reescreve finais.","A diferença entre um analista e um estrategista? Contexto.","Se tudo parece performar, alguém não está medindo direito.","O pixel rastreia. Mas o propósito converte.","O GA4 não é confuso. Você que ainda pensa com mentalidade de UA.","Quem controla o dado controla o discurso.","O dado mostra o que aconteceu. Mas o setup mostra quem você é.","Branding é o funil que não tem CTA.","Growth é o encontro entre dado e desejo.","O criativo certo não escala. Ele transborda.","A marca que entende o algoritmo ganha o jogo. A que entende o ser humano muda as regras.","Enquanto uns tentam vender, outros criam contexto.","Performance é só a superfície. Profundidade é o que fideliza.","Nem toda campanha é pra vender. Algumas são pra fazer o cliente pensar.","O público não é um número. É uma conversa estatisticamente previsível.","Os dados são frios. O que você faz com eles define a temperatura da marca.","O que o algoritmo entende como relevância é o reflexo da sua consistência.","Venda é neurociência com planilhas.","Toda compra começa muito antes do carrinho.","A emoção decide, o dado justifica.","A melhor landing page é a mente do cliente.","Conversão é só o ponto final de uma história bem contada.","O checkout é o espelho do quanto você entendeu o comportamento humano.","Ninguém quer comprar. As pessoas querem se reconhecer em algo.","O vendedor do futuro é o algoritmo com empatia.","Se o cliente precisou pensar demais, você já perdeu a venda.","O gatilho mais forte é o da coerência.","Dado é só verdade sem legenda.","O banco de dados é o inconsciente do negócio.","Quem entende o ruído, entende o mercado.","A base não mente — mas quem a alimenta mente pra si mesmo.","Cada tabela conta uma história que o marketing tenta simplificar demais.","Os melhores dashboards são os que incomodam.","O insight chega quando o ego sai.","KPI não é objetivo. É sintoma.","Você não analisa dados. Você decodifica comportamentos.","Todo erro de medição nasce de uma pergunta mal feita."];return e.useEffect(()=>{const e=setInterval(()=>{i(!1),setTimeout(()=>{a(e=>(e+1)%l.length),i(!0)},300)},3e3);return()=>clearInterval(e)},[]),$e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"mb-8",children:$e.jsx(as,{size:"xl"})}),$e.jsx("div",{className:"mb-6",children:$e.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto"})}),$e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:t}),$e.jsx("div",{className:"mb-4 px-4",children:$e.jsx("div",{className:"min-h-[2.5rem] flex items-center justify-center",children:$e.jsxs("p",{className:"text-sm text-gray-600 italic transition-all duration-300 ease-in-out "+(n?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-2"),children:['"',l[r],'"']})})}),s&&$e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg max-w-sm mx-auto",children:[$e.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),$e.jsx("span",{className:"text-sm",children:"Verificando autenticação..."})]}),$e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Restaurando sua sessão anterior"})]}),$e.jsx("div",{className:"mt-6 w-48 bg-gray-200 rounded-full h-1 mx-auto overflow-hidden",children:$e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full animate-pulse"})})]})})},ds=({currentTable:t,onTableChange:s,activeTab:r,onTabChange:a,availableTables:n=[],useCSV:i=!0,hideClientName:l=!1,user:o})=>{const[c,d]=e.useState(!1),[_,k]=e.useState(""),[C,S]=e.useState(0),[T,A]=e.useState("clients"),E=e.useRef(null),R=e.useRef(null),{clients:P,isLoading:M,error:L}=((t=!0)=>{const[s,r]=e.useState([]),[a,n]=e.useState(t),[i,l]=e.useState(null);return e.useEffect(()=>{t?(async()=>{var e;try{n(!0),l(null);const t=await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQQNqKWaGX0EUBtFGSaMnHoHJSoLKFqjPrjydOtcSexU3xVGyoEnhgKQh8A6-6_hOOQ0CfmV-IfoC8d/pub?gid=771281747&single=true&output=csv");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=(await t.text()).split("\n"),a=[];for(let r=1;r<s.length;r++){const t=s[r].trim();if(t&&"slug"!==t){const s=null==(e=t.split(",")[0])?void 0:e.trim();s&&a.push(s)}}r(a)}catch(t){l(t instanceof Error?t.message:"Erro ao buscar lista de clientes"),r([])}finally{n(!1)}})():n(!1)},[t]),{clients:s,isLoading:a,error:i}})(i);e.useEffect(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),d(!0),k(""),S(0),A("clients"),setTimeout(()=>{var e;null==(e=E.current)||e.focus()},100)),"Escape"===e.key&&c&&(e.preventDefault(),d(!1),k(""),S(0),A("clients"))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c]);const O=e.useMemo(()=>i&&P.length>0?P:n.length>0?n:[],[P,n,i]),I={"visao-geral":{label:"Visão Geral",icon:y,description:"Métricas gerais e KPIs"},"midia-paga":{label:"Mídia Paga",icon:v,description:"Análise de campanhas pagas"},"funil-conversao":{label:"Funil de Conversão",icon:b,description:"Jornada do cliente"},"dados-detalhados":{label:"Dados Detalhados",icon:u,description:"Dados brutos e análises"},frete:{label:"Frete",icon:g,description:"Análise de frete e logística"},produtos:{label:"Produtos",icon:f,description:"Performance de produtos"},"tempo-real":{label:"Tempo Real",icon:p,description:"Dados em tempo real"},havaianas:{label:"Product Scoring",icon:x,description:"Scoring de produtos (Havaianas)"},"ab-testing":{label:"Testes A/B",icon:h,description:"Experimentos e testes"},configuracao:{label:"Configuração",icon:m,description:"Configurações do sistema"}},D=["visao-geral","midia-paga","funil-conversao","dados-detalhados","tempo-real",...[..."havaianas"===t?["havaianas"]:[],"frete","ab-testing","produtos",...(null==o?void 0:o.admin)?["configuracao"]:[]]],F=e.useMemo(()=>{const e=[];return l||O.forEach(t=>{e.push({id:`client-${t}`,label:t,description:"Cliente",icon:u,category:"clients",action:()=>{s(t),d(!1),k(""),S(0)}})}),D.forEach(t=>{const s=I[t];s&&e.push({id:`tab-${t}`,label:s.label,description:s.description,icon:s.icon,category:"tabs",action:()=>{a(t),d(!1),k(""),S(0)}})}),e},[O,D,l,s,a]),B=e.useMemo(()=>{let e=F;return e=_.trim()?e.filter(e=>{const t=_.toLowerCase();return e.label.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}):e.filter(e=>e.category===T),e.slice(0,12)},[F,T,_]);e.useEffect(()=>{if(!_.trim()&&0===B.length){const e="clients"===T?"tabs":"clients";F.filter(t=>t.category===e).length>0&&A(e)}},[B.length,T,_,F]),e.useEffect(()=>{S(0)},[T,_]),e.useEffect(()=>{C>=B.length&&B.length>0&&S(0)},[B.length,C]);const $=!!i&&M;return $e.jsxs($e.Fragment,{children:[$e.jsxs("button",{onClick:()=>{d(!0),k(""),S(0),A("clients"),setTimeout(()=>{var e;return null==(e=E.current)?void 0:e.focus()},100)},className:"flex items-center gap-2 px-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-lg shadow-sm hover:bg-white hover:shadow-md transition-all duration-200 min-w-[140px] group",disabled:$,title:"Spotlight - Clientes e Abas (⌘K)",children:[$e.jsx(w,{className:"w-4 h-4 text-gray-500 group-hover:text-gray-700 transition-colors"}),$e.jsx("div",{className:"flex-1 text-left",children:$?$e.jsxs("div",{className:"flex items-center gap-1.5",children:[$e.jsx(j,{className:"w-3 h-3 animate-spin text-gray-500"}),$e.jsx("span",{className:"text-gray-500 text-xs",children:"Carregando..."})]}):$e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:l?"Spotlight":t})}),$e.jsx("div",{className:"text-xs text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded text-[10px]",children:"⌘K"})]}),c&&$e.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-20",children:[$e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>{d(!1),k(""),S(0),A("clients")}}),$e.jsxs("div",{ref:R,className:"relative w-full max-w-2xl mx-4 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-200/50 overflow-hidden animate-in fade-in-0 zoom-in-95 duration-200",children:[$e.jsx("div",{className:"p-6 border-b border-gray-100",children:$e.jsxs("div",{className:"relative",children:[$e.jsx(w,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Buscar em todos os clientes e abas...",value:_,onChange:e=>k(e.target.value),onKeyDown:e=>{if(c&&0!==B.length)switch(e.key){case"ArrowDown":e.preventDefault(),S(e=>{const t=e<B.length-1?e+1:0;return Math.min(t,B.length-1)});break;case"ArrowUp":e.preventDefault(),S(e=>{const t=e>0?e-1:B.length-1;return Math.max(t,0)});break;case"Enter":e.preventDefault(),B.length>0&&B[C]&&B[C].action();break;case"Escape":e.preventDefault(),d(!1),k(""),S(0),A("clients");break;case"Tab":e.preventDefault(),A(e=>"clients"===e?"tabs":"clients"),S(0)}},className:"w-full pl-12 pr-4 py-4 text-lg bg-transparent border-none outline-none placeholder-gray-400",autoFocus:!0,ref:E})]})}),$e.jsx("div",{className:"px-6 py-3 border-b border-gray-100",children:$e.jsxs("div",{className:"flex gap-2",children:[F.some(e=>"clients"===e.category)&&$e.jsxs("button",{onClick:()=>{A("clients"),S(0)},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors "+("clients"===T?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[$e.jsx(u,{className:"w-4 h-4 inline mr-2"}),"Clientes"]}),$e.jsxs("button",{onClick:()=>{A("tabs"),S(0)},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors "+("tabs"===T?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[$e.jsx(y,{className:"w-4 h-4 inline mr-2"}),"Abas"]}),_.trim()&&$e.jsxs("div",{className:"px-3 py-1.5 rounded-lg text-sm font-medium bg-green-100 text-green-700",children:[$e.jsx(w,{className:"w-4 h-4 inline mr-2"}),"Busca Global"]})]})}),$e.jsx("div",{className:"max-h-80 overflow-y-auto",children:$?$e.jsx("div",{className:"p-8 text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-500",children:[$e.jsx(j,{className:"w-5 h-5 animate-spin"}),$e.jsx("span",{children:"Carregando clientes..."})]})}):L?$e.jsxs("div",{className:"p-8 text-center text-red-500",children:[$e.jsx("div",{className:"font-medium",children:"Erro ao carregar clientes"}),$e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:L})]}):B.length>0?B.map((e,t)=>{const s=e.icon,r=t===C;return $e.jsxs("button",{onClick:e.action,className:"w-full flex items-center gap-4 px-6 py-4 text-left hover:bg-gray-50/50 transition-colors group "+(r?"bg-blue-100 border-r-4 border-blue-500 shadow-sm":""),children:[$e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-semibold text-sm "+("clients"===e.category?"bg-gradient-to-br from-blue-500 to-purple-600":"bg-gradient-to-br from-green-500 to-teal-600"),children:"clients"===e.category?e.label.charAt(0).toUpperCase():$e.jsx(s,{className:"w-5 h-5"})}),$e.jsxs("div",{className:"flex-1 min-w-0",children:[$e.jsx("div",{className:"font-medium text-gray-900 truncate",children:e.label}),$e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[$e.jsx("span",{children:e.description}),_.trim()&&$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium "+("clients"===e.category?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:"clients"===e.category?"Cliente":"Aba"})]})]}),$e.jsx(N,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors "+(r?"text-blue-500":"")})]},e.id)}):$e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[$e.jsx(u,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),$e.jsx("div",{className:"font-medium",children:0===F.length?"Nenhum item disponível":"Nenhum item encontrado"}),$e.jsx("div",{className:"text-sm mt-1",children:_?`Tente buscar por "${_}"`:"Digite para buscar"})]})}),$e.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-100 text-xs text-gray-500 text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[$e.jsx("span",{children:"↑↓ Navegar"}),$e.jsx("span",{children:"•"}),$e.jsx("span",{children:"Tab Alternar"}),$e.jsx("span",{children:"•"}),$e.jsx("span",{children:"Enter Selecionar"}),$e.jsx("span",{children:"•"}),$e.jsx("span",{children:"Esc Fechar"}),!_.trim()&&$e.jsxs($e.Fragment,{children:[$e.jsx("span",{children:"•"}),$e.jsx("span",{children:"Digite para busca global"})]})]})})]})]})]})},us=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,ms=()=>us(new Date),hs=()=>{const e=new Date,t=e.getFullYear(),s=e.getMonth(),r=e.getDate();return{today:{start:us(new Date(t,s,r)),end:us(new Date(t,s,r)),label:"Hoje"},yesterday:{start:us(new Date(t,s,r-1)),end:us(new Date(t,s,r-1)),label:"Ontem"},last7days:{start:us(new Date(t,s,r-6)),end:us(new Date(t,s,r)),label:"Últimos 7 dias"},last30days:{start:us(new Date(t,s,r-29)),end:us(new Date(t,s,r)),label:"Últimos 30 dias"},last90days:{start:us(new Date(t,s,r-89)),end:us(new Date(t,s,r)),label:"Últimos 90 dias"},last12months:{start:us(new Date(t,s,r-364)),end:us(new Date(t,s,r)),label:"Últimos 12 meses"},thisWeek:{start:us(new Date(t,s,r-e.getDay())),end:us(new Date(t,s,r)),label:"Esta semana"},thisMonth:{start:us(new Date(t,s,1)),end:us(new Date(t,s,r)),label:"Este mês"},lastMonth:{start:us(new Date(t,s-1,1)),end:us(new Date(t,s,0)),label:"Mês passado"}}},xs=e=>{const t=hs();switch(e){case"visao-geral":default:return{start:t.thisMonth.start,end:t.thisMonth.end};case"funil-conversao":return{start:t.last30days.start,end:t.last30days.end};case"dados-detalhados":return{start:t.last7days.start,end:t.last7days.end};case"pedidos":return{start:t.today.start,end:t.today.end};case"leads":return{start:t.last12months.start,end:t.last12months.end}}},ps=e=>{if(!e)return!1;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())},fs=e=>{const[t,s,r]=e.split("-").map(Number);return new Date(t,s-1,r)},gs=({startDate:t,endDate:s,onDateRangeChange:r})=>{const[a,n]=e.useState(!1),[i,l]=e.useState(t),[o,c]=e.useState(s),[d,u]=e.useState({}),m=e.useRef(null);e.useEffect(()=>{l(t),c(s)},[t,s]),e.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const h=e=>{if(!e)return"";const[t,s,r]=e.split("-").map(Number);return new Date(t,s-1,r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})},x=(e,t)=>{const s=((e,t)=>{const s={},r=ms();return e&&!ps(e)&&(s.start="Data inicial inválida"),t&&!ps(t)&&(s.end="Data final inválida"),e&&e>r&&(s.start="Data inicial não pode ser futura"),t&&t>r&&(s.end="Data final não pode ser futura"),e&&t&&e>t&&(s.end="Data final deve ser posterior à inicial"),{isValid:0===Object.keys(s).length,errors:s}})(e,t);return u(s.errors),s.isValid},p=()=>{l(""),c(""),u({}),r("","")},f=Object.keys(d).length>0,g=i&&o,b=[{key:"today",label:"Hoje",icon:S},{key:"yesterday",label:"Ontem",icon:T},{key:"last7days",label:"Últimos 7 dias",icon:_},{key:"last30days",label:"Últimos 30 dias",icon:_},{key:"last90days",label:"Últimos 90 dias",icon:_},{key:"thisWeek",label:"Esta semana",icon:_},{key:"thisMonth",label:"Este mês",icon:_},{key:"lastMonth",label:"Mês passado",icon:_}];return $e.jsxs("div",{className:"relative",ref:m,children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Período"}),$e.jsxs("button",{onClick:()=>n(!a),className:"w-full flex items-center justify-between px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white hover:bg-gray-50 transition-colors min-w-0 "+(f?"border-red-300 bg-red-50":"border-gray-300"),children:[$e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[$e.jsx(_,{className:"w-4 h-4 flex-shrink-0 "+(f?"text-red-500":"text-gray-500")}),$e.jsx("span",{className:"truncate "+(f?"text-red-700":"text-gray-900"),children:g?`${h(i)} - ${h(o)}`:"Selecionar período"})]}),$e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[g&&$e.jsx("button",{onClick:e=>{e.stopPropagation(),p()},className:"text-gray-400 hover:text-gray-600 p-1",title:"Limpar seleção",children:$e.jsx(k,{className:"w-3 h-3"})}),$e.jsx(C,{className:"w-4 h-4 text-gray-500 transition-transform "+(a?"rotate-180":"")})]})]}),f&&$e.jsxs("div",{className:"mt-1 text-xs text-red-600",children:[d.start&&$e.jsxs("div",{children:["• ",d.start]}),d.end&&$e.jsxs("div",{children:["• ",d.end]})]}),a&&$e.jsxs("div",{className:"absolute z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-xl p-4 min-w-[320px] max-w-[400px] left-0 md:left-auto md:right-0",children:[$e.jsxs("div",{className:"mb-6",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Períodos rápidos"}),$e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.map(({key:e,label:t,icon:s})=>$e.jsxs("button",{onClick:()=>(e=>{const t=hs()[e];t&&(l(t.start),c(t.end),r(t.start,t.end),n(!1))})(e),className:"flex items-center gap-2 px-3 py-2 text-xs text-left bg-gray-50 hover:bg-blue-50 hover:text-blue-700 rounded-lg transition-colors border border-transparent hover:border-blue-200",children:[$e.jsx(s,{className:"w-3 h-3 flex-shrink-0"}),$e.jsx("span",{className:"truncate",children:t})]},e))})]}),$e.jsxs("div",{className:"space-y-4",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Período personalizado"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Data inicial"}),$e.jsx("input",{type:"date",value:i||"",onChange:e=>{return t=e.target.value,l(t),void(x(t,o)&&(r(t,o),t&&o&&n(!1)));var t},max:ms(),className:"w-full px-3 py-2 text-xs border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(d.start?"border-red-300 bg-red-50":"border-gray-300")})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Data final"}),$e.jsx("input",{type:"date",value:o||"",onChange:e=>{return t=e.target.value,c(t),void(x(i,t)&&(r(i,t),i&&t&&n(!1)));var t},min:i,max:ms(),className:"w-full px-3 py-2 text-xs border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(d.end?"border-red-300 bg-red-50":"border-gray-300")})]})]})]}),$e.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t border-gray-200",children:[$e.jsx("button",{onClick:p,className:"text-xs text-gray-600 hover:text-gray-800 transition-colors",children:"Limpar tudo"}),$e.jsx("button",{onClick:()=>n(!1),className:"px-4 py-2 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Aplicar"})]})]})]})},bs=({field:e,currentSortField:t,currentSortDirection:s,onSort:r,children:a,className:n=""})=>{const i=t===e;return $e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors ${n}`,onClick:()=>r(e),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("span",{children:a}),$e.jsxs("div",{className:"flex flex-col",children:[$e.jsx(A,{className:"w-3 h-3 "+(i&&"asc"===s?"text-blue-600":"text-gray-300")}),$e.jsx(C,{className:"w-3 h-3 "+(i&&"desc"===s?"text-blue-600":"text-gray-300")})]})]})})},vs=({metrics:t,selectedTable:s,isLoading:r,isTableLoading:a})=>{const[n,i]=e.useState(!1);return null},ys=[{key:"sessions",label:"Sessões",color:"#3b82f6",icon:E,yAxisId:"left",category:"Comportamento"},{key:"clicks",label:"Cliques",color:"#8b5cf6",icon:h,yAxisId:"left",category:"Comportamento"},{key:"addToCart",label:"Carrinho",color:"#f59e0b",icon:f,yAxisId:"left",category:"Comportamento"},{key:"leads",label:"Leads",color:"#ec4899",icon:h,yAxisId:"left",category:"Comportamento"},{key:"orders",label:"Pedidos",color:"#ef4444",icon:x,yAxisId:"left",category:"Conversão"},{key:"paidOrders",label:"Pedidos Pagos",color:"#84cc16",icon:x,yAxisId:"left",category:"Conversão"},{key:"newCustomers",label:"Novos Clientes",color:"#06b6d4",icon:E,yAxisId:"left",category:"Conversão"},{key:"revenue",label:"Receita",color:"#10b981",icon:R,yAxisId:"right",category:"Receita"},{key:"paidRevenue",label:"Receita Paga",color:"#059669",icon:R,yAxisId:"right",category:"Receita"},{key:"newCustomerRevenue",label:"Receita Novos",color:"#7c3aed",icon:R,yAxisId:"right",category:"Receita"},{key:"investment",label:"Investimento",color:"#dc2626",icon:R,yAxisId:"right",category:"Investimento"},{key:"averageTicket",label:"Ticket Médio",color:"#f97316",icon:R,yAxisId:"right",category:"Receita"},{key:"sessionsMA",label:"Sessões (MM)",color:"#1d4ed8",icon:E,yAxisId:"left",isMovingAverage:!0,category:"Comportamento"},{key:"revenueMA",label:"Receita (MM)",color:"#047857",icon:R,yAxisId:"right",isMovingAverage:!0,category:"Receita"},{key:"clicksMA",label:"Cliques (MM)",color:"#6b21a8",icon:h,yAxisId:"left",isMovingAverage:!0,category:"Comportamento"},{key:"addToCartMA",label:"Carrinho (MM)",color:"#d97706",icon:f,yAxisId:"left",isMovingAverage:!0,category:"Comportamento"},{key:"ordersMA",label:"Pedidos (MM)",color:"#dc2626",icon:x,yAxisId:"left",isMovingAverage:!0,category:"Conversão"},{key:"newCustomersMA",label:"Novos Clientes (MM)",color:"#0891b2",icon:E,yAxisId:"left",isMovingAverage:!0,category:"Conversão"},{key:"paidOrdersMA",label:"Pedidos Pagos (MM)",color:"#65a30d",icon:x,yAxisId:"left",isMovingAverage:!0,category:"Conversão"},{key:"paidRevenueMA",label:"Receita Paga (MM)",color:"#065f46",icon:R,yAxisId:"right",isMovingAverage:!0,category:"Receita"},{key:"newCustomerRevenueMA",label:"Receita Novos (MM)",color:"#7c2d12",icon:R,yAxisId:"right",isMovingAverage:!0,category:"Receita"},{key:"investmentMA",label:"Investimento (MM)",color:"#991b1b",icon:R,yAxisId:"right",isMovingAverage:!0,category:"Investimento"},{key:"leadsMA",label:"Leads (MM)",color:"#be185d",icon:h,yAxisId:"left",isMovingAverage:!0,category:"Comportamento"},{key:"averageTicketMA",label:"Ticket Médio (MM)",color:"#ea580c",icon:R,yAxisId:"right",isMovingAverage:!0,category:"Receita"}],ws=({data:t,title:s,showMovingAverage:r=!1})=>{const[a,n]=e.useState("sessions"),[i,l]=e.useState(""),[o,c]=e.useState(""),[d,u]=e.useState(""),[m,h]=e.useState(!0),[x,p]=e.useState(!1),[f,g]=e.useState(!1),b=ys.filter(e=>!e.isMovingAverage&&(e.key!==a&&(e.key!==i&&(!o||e.label.toLowerCase().includes(o.toLowerCase())||e.key.toLowerCase().includes(o.toLowerCase()))))),y=ys.filter(e=>!e.isMovingAverage&&(e.key!==i&&(e.key!==a&&(!d||e.label.toLowerCase().includes(d.toLowerCase())||e.key.toLowerCase().includes(d.toLowerCase()))))),j=ys.filter(e=>!e.isMovingAverage&&e.key!==i),N=ys.filter(e=>!e.isMovingAverage&&e.key!==a);if(!t||0===t.length)return $e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[$e.jsx(v,{className:"w-5 h-5 text-gray-600"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s})]}),$e.jsx("div",{className:"text-center py-8",children:$e.jsx("p",{className:"text-gray-500",children:"Nenhum dado disponível para a timeline"})})]});const _=t.map(e=>({...e,date:(()=>{const[t,s,r]=e.date.split("-").map(Number);return new Date(t,s-1,r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})(),sessionsFormatted:new Intl.NumberFormat("pt-BR").format(e.sessions),revenueFormatted:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e.revenue),clicksFormatted:new Intl.NumberFormat("pt-BR").format(e.clicks),addToCartFormatted:new Intl.NumberFormat("pt-BR").format(e.addToCart),ordersFormatted:new Intl.NumberFormat("pt-BR").format(e.orders),newCustomersFormatted:new Intl.NumberFormat("pt-BR").format(e.newCustomers),paidOrdersFormatted:new Intl.NumberFormat("pt-BR").format(e.paidOrders),paidRevenueFormatted:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e.paidRevenue),newCustomerRevenueFormatted:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e.newCustomerRevenue),investmentFormatted:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e.investment),leadsFormatted:new Intl.NumberFormat("pt-BR").format(e.leads||0),averageTicketFormatted:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(e.averageTicket)})),C=t.reduce((e,t)=>r?{sessions:e.sessions+(t.sessionsMA||0),revenue:e.revenue+(t.revenueMA||0),clicks:e.clicks+(t.clicksMA||0),addToCart:e.addToCart+(t.addToCartMA||0),orders:e.orders+(t.ordersMA||0),newCustomers:e.newCustomers+(t.newCustomersMA||0),paidOrders:e.paidOrders+(t.paidOrdersMA||0),paidRevenue:e.paidRevenue+(t.paidRevenueMA||0),newCustomerRevenue:e.newCustomerRevenue+(t.newCustomerRevenueMA||0),investment:e.investment+(t.investmentMA||0),leads:e.leads+(t.leadsMA||0),averageTicket:e.averageTicket+(t.averageTicketMA||0)}:{sessions:e.sessions+(t.sessions||0),revenue:e.revenue+(t.revenue||0),clicks:e.clicks+(t.clicks||0),addToCart:e.addToCart+(t.addToCart||0),orders:e.orders+(t.orders||0),newCustomers:e.newCustomers+(t.newCustomers||0),paidOrders:e.paidOrders+(t.paidOrders||0),paidRevenue:e.paidRevenue+(t.paidRevenue||0),newCustomerRevenue:e.newCustomerRevenue+(t.newCustomerRevenue||0),investment:e.investment+(t.investment||0),leads:e.leads+(t.leads||0),averageTicket:e.averageTicket+(t.averageTicket||0)},{sessions:0,revenue:0,clicks:0,addToCart:0,orders:0,newCustomers:0,paidOrders:0,paidRevenue:0,newCustomerRevenue:0,investment:0,leads:0,averageTicket:0}),S=({active:e,payload:t,label:s})=>e&&t&&t.length?$e.jsxs("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-lg",children:[$e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:s}),$e.jsx("div",{className:"space-y-1",children:t.map((e,t)=>{const s=ys.find(t=>t.key===e.dataKey);if(!s)return null;let r;return r="right"===s.yAxisId?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e.value):new Intl.NumberFormat("pt-BR").format(e.value),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),$e.jsxs("span",{className:"text-sm text-gray-600",children:[s.label,":"]}),$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r})]},t)})})]}):null,T=ys.filter(e=>{const t=e.key===a||e.key===i;e.isMovingAverage;const s=!e.isMovingAverage;if(r){if(t&&s){const t=e.key+"MA";return ys.some(e=>e.key===t)}return!1}return t&&s}).map(e=>{let t=e;if(r&&!e.isMovingAverage){const s=e.key+"MA";t=ys.find(e=>e.key===s)||e}const s=(r&&t.key.endsWith("MA")?t.key.replace("MA",""):t.key)===i;return{...t,yAxisId:s?"right":"left"}});return $e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"mb-6 bg-white border border-gray-200 rounded-lg "+(m?"p-3":"p-2"),children:[$e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>h(!m),children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Selecionar Métricas"}),$e.jsxs("span",{className:"text-xs text-gray-500",children:["(",[a,i].filter(Boolean).length,")"]})]}),$e.jsx("div",{className:"text-xs font-medium text-gray-600",children:m?"▲":"▼"})]}),m&&$e.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200",children:[$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("div",{className:"relative flex-1",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Buscar métricas...",value:o,onChange:e=>{c(e.target.value),p(!0)},onFocus:()=>p(!0),className:"w-full pl-9 pr-9 py-1.5 bg-white border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o&&$e.jsx("button",{onClick:()=>{c(""),p(!1)},className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:$e.jsx(k,{className:"w-4 h-4 text-gray-400 hover:text-gray-600"})}),x&&$e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:(o?b:j).map(e=>{const t=e.icon,s=e.key===a;return $e.jsxs("button",{onClick:()=>(e=>{const t=ys.find(t=>t.key===e);(null==t?void 0:t.isMovingAverage)||(n(e),c(""),p(!1))})(e.key),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-left "+(s?"bg-blue-50":""),children:[$e.jsx(t,{className:"w-4 h-4 text-gray-600"}),$e.jsx("span",{className:"text-sm text-gray-700",children:e.label}),s&&$e.jsx("span",{className:"ml-auto text-xs text-blue-600",children:"✓"})]},e.key)})})]}),$e.jsxs("div",{className:"relative flex-1",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Métricas secundárias...",value:d,onChange:e=>{u(e.target.value),g(!0)},onFocus:()=>g(!0),className:"w-full pl-9 pr-9 py-1.5 bg-white border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d&&$e.jsx("button",{onClick:()=>{u(""),g(!1)},className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:$e.jsx(k,{className:"w-4 h-4 text-gray-400 hover:text-gray-600"})}),f&&$e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:(d?y:N).map(e=>{const t=e.icon,s=e.key===i;return $e.jsxs("button",{onClick:()=>(e=>{const t=ys.find(t=>t.key===e);(null==t?void 0:t.isMovingAverage)||(l(e),u(""),g(!1))})(e.key),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-left "+(s?"bg-purple-50":""),children:[$e.jsx(t,{className:"w-4 h-4 text-gray-600"}),$e.jsx("span",{className:"text-sm text-gray-700",children:e.label}),s&&$e.jsx("span",{className:"ml-auto text-xs text-purple-600",children:"✓"})]},e.key)})})]})]}),(a||i)&&$e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a&&(()=>{const e=ys.find(e=>e.key===a&&!e.isMovingAverage);if(!e)return null;const t=e.icon;return $e.jsxs("div",{className:"flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs bg-blue-50 border border-blue-200",children:[$e.jsx(t,{className:"w-2.5 h-2.5 text-blue-600"}),$e.jsx("span",{className:"text-blue-700 font-medium",children:e.label}),$e.jsx("div",{className:"w-1 h-1 rounded-full ml-0.5",style:{backgroundColor:e.color}}),$e.jsx("button",{onClick:()=>n(""),className:"ml-0.5 text-blue-600 hover:text-blue-800",children:$e.jsx(k,{className:"w-2.5 h-2.5"})})]})})(),i&&(()=>{const e=ys.find(e=>e.key===i&&!e.isMovingAverage);if(!e)return null;const t=e.icon;return $e.jsxs("div",{className:"flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs bg-purple-50 border border-purple-200",children:[$e.jsx(t,{className:"w-2.5 h-2.5 text-purple-600"}),$e.jsx("span",{className:"text-purple-700 font-medium",children:e.label}),$e.jsx("div",{className:"w-1 h-1 rounded-full ml-0.5",style:{backgroundColor:e.color}}),$e.jsx("button",{onClick:()=>l(""),className:"ml-0.5 text-purple-600 hover:text-purple-800",children:$e.jsx(k,{className:"w-2.5 h-2.5"})})]})})()]})]})]}),$e.jsx("div",{className:"h-80 mb-6",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:_,margin:{top:5,right:30,left:20,bottom:5},children:[$e.jsx(je,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),$e.jsx(Ne,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1}),$e.jsx(_e,{yAxisId:"left",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>new Intl.NumberFormat("pt-BR").format(e)}),$e.jsx(_e,{yAxisId:"right",orientation:"right",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,notation:"compact"}).format(e)}),$e.jsx(ke,{content:$e.jsx(S,{})}),T.map(e=>$e.jsx(Ce,{yAxisId:e.yAxisId,type:"monotone",dataKey:e.key,stroke:e.color,strokeWidth:3,dot:!1,activeDot:{r:7,stroke:e.color,strokeWidth:2}},e.key))]})})}),!r&&$e.jsx("div",{className:"grid grid-cols-2 gap-6 pt-4 border-t border-gray-200",children:T.map(e=>{const s=C[e.key];return $e.jsxs("div",{className:"text-center",children:[$e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[$e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),$e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Total ",e.label]})]}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.key.includes("revenue")||"investment"===e.key?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(s):"averageTicket"===e.key?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(s/t.length):new Intl.NumberFormat("pt-BR").format(s)})]},e.key)})})]})};function js(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function Ns(e,t){void 0===e&&(e={}),void 0===t&&(t={});const s=["__proto__","constructor","prototype"];Object.keys(t).filter(e=>s.indexOf(e)<0).forEach(s=>{void 0===e[s]?e[s]=t[s]:js(t[s])&&js(e[s])&&Object.keys(t[s]).length>0&&Ns(e[s],t[s])})}const _s={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector:()=>null,querySelectorAll:()=>[],getElementById:()=>null,createEvent:()=>({initEvent(){}}),createElement:()=>({children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName:()=>[]}),createElementNS:()=>({}),importNode:()=>null,location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function ks(){const e="undefined"!=typeof document?document:{};return Ns(e,_s),e}const Cs={document:_s,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle:()=>({getPropertyValue:()=>""}),Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia:()=>({}),requestAnimationFrame:e=>"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0),cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function Ss(){const e="undefined"!=typeof window?window:{};return Ns(e,Cs),e}function Ts(e,t){return void 0===t&&(t=0),setTimeout(e,t)}function As(){return Date.now()}function Es(e,t){void 0===t&&(t="x");const s=Ss();let r,a,n;const i=function(e){const t=Ss();let s;return t.getComputedStyle&&(s=t.getComputedStyle(e,null)),!s&&e.currentStyle&&(s=e.currentStyle),s||(s=e.style),s}(e);return s.WebKitCSSMatrix?(a=i.transform||i.webkitTransform,a.split(",").length>6&&(a=a.split(", ").map(e=>e.replace(",",".")).join(", ")),n=new s.WebKitCSSMatrix("none"===a?"":a)):(n=i.MozTransform||i.OTransform||i.MsTransform||i.msTransform||i.transform||i.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),r=n.toString().split(",")),"x"===t&&(a=s.WebKitCSSMatrix?n.m41:16===r.length?parseFloat(r[12]):parseFloat(r[4])),"y"===t&&(a=s.WebKitCSSMatrix?n.m42:16===r.length?parseFloat(r[13]):parseFloat(r[5])),a||0}function Rs(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)}function Ps(e){return"undefined"!=typeof window&&void 0!==window.HTMLElement?e instanceof HTMLElement:e&&(1===e.nodeType||11===e.nodeType)}function Ms(){const e=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let s=1;s<arguments.length;s+=1){const r=s<0||arguments.length<=s?void 0:arguments[s];if(null!=r&&!Ps(r)){const s=Object.keys(Object(r)).filter(e=>t.indexOf(e)<0);for(let t=0,a=s.length;t<a;t+=1){const a=s[t],n=Object.getOwnPropertyDescriptor(r,a);void 0!==n&&n.enumerable&&(Rs(e[a])&&Rs(r[a])?r[a].__swiper__?e[a]=r[a]:Ms(e[a],r[a]):!Rs(e[a])&&Rs(r[a])?(e[a]={},r[a].__swiper__?e[a]=r[a]:Ms(e[a],r[a])):e[a]=r[a])}}}return e}function Ls(e,t,s){e.style.setProperty(t,s)}function Os(e){let{swiper:t,targetPosition:s,side:r}=e;const a=Ss(),n=-t.translate;let i,l=null;const o=t.params.speed;t.wrapperEl.style.scrollSnapType="none",a.cancelAnimationFrame(t.cssModeFrameID);const c=s>n?"next":"prev",d=(e,t)=>"next"===c&&e>=t||"prev"===c&&e<=t,u=()=>{i=(new Date).getTime(),null===l&&(l=i);const e=Math.max(Math.min((i-l)/o,1),0),c=.5-Math.cos(e*Math.PI)/2;let m=n+c*(s-n);if(d(m,s)&&(m=s),t.wrapperEl.scrollTo({[r]:m}),d(m,s))return t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout(()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[r]:m})}),void a.cancelAnimationFrame(t.cssModeFrameID);t.cssModeFrameID=a.requestAnimationFrame(u)};u()}function Is(e,t){void 0===t&&(t="");const s=Ss(),r=[...e.children];return s.HTMLSlotElement&&e instanceof HTMLSlotElement&&r.push(...e.assignedElements()),t?r.filter(e=>e.matches(t)):r}function Ds(e){try{return}catch(t){}}function Fs(e,t){void 0===t&&(t=[]);const s=document.createElement(e);return s.classList.add(...Array.isArray(t)?t:function(e){return void 0===e&&(e=""),e.trim().split(" ").filter(e=>!!e.trim())}(t)),s}function Bs(e,t){return Ss().getComputedStyle(e,null).getPropertyValue(t)}function $s(e){let t,s=e;if(s){for(t=0;null!==(s=s.previousSibling);)1===s.nodeType&&(t+=1);return t}}function zs(e,t){const s=[];let r=e.parentElement;for(;r;)t?r.matches(t)&&s.push(r):s.push(r),r=r.parentElement;return s}function Vs(e,t,s){const r=Ss();return e["width"===t?"offsetWidth":"offsetHeight"]+parseFloat(r.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-right":"margin-top"))+parseFloat(r.getComputedStyle(e,null).getPropertyValue("width"===t?"margin-left":"margin-bottom"))}function Us(e){return(Array.isArray(e)?e:[e]).filter(e=>!!e)}function Ws(e,t){void 0===t&&(t=""),"undefined"!=typeof trustedTypes?e.innerHTML=trustedTypes.createPolicy("html",{createHTML:e=>e}).createHTML(t):e.innerHTML=t}let Hs,Gs,qs;function Ys(){return Hs||(Hs=function(){const e=Ss(),t=ks();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}()),Hs}function Ks(e){return void 0===e&&(e={}),Gs||(Gs=function(e){let{userAgent:t}=void 0===e?{}:e;const s=Ys(),r=Ss(),a=r.navigator.platform,n=t||r.navigator.userAgent,i={ios:!1,android:!1},l=r.screen.width,o=r.screen.height,c=n.match(/(Android);?[\s\/]+([\d.]+)?/);let d=n.match(/(iPad).*OS\s([\d_]+)/);const u=n.match(/(iPod)(.*OS\s([\d_]+))?/),m=!d&&n.match(/(iPhone\sOS|iOS)\s([\d_]+)/),h="Win32"===a;let x="MacIntel"===a;return!d&&x&&s.touch&&["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"].indexOf(`${l}x${o}`)>=0&&(d=n.match(/(Version)\/([\d.]+)/),d||(d=[0,1,"13_0_0"]),x=!1),c&&!h&&(i.os="android",i.android=!0),(d||m||u)&&(i.os="ios",i.ios=!0),i}(e)),Gs}function Xs(){return qs||(qs=function(){const e=Ss(),t=Ks();let s=!1;function r(){const t=e.navigator.userAgent.toLowerCase();return t.indexOf("safari")>=0&&t.indexOf("chrome")<0&&t.indexOf("android")<0}if(r()){const t=String(e.navigator.userAgent);if(t.includes("Version/")){const[e,r]=t.split("Version/")[1].split(" ")[0].split(".").map(e=>Number(e));s=e<16||16===e&&r<2}}const a=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),n=r();return{isSafari:s||n,needPerspectiveFix:s,need3dFix:n||a&&t.ios,isWebView:a}}()),qs}const Js=(e,t,s)=>{t&&!e.classList.contains(s)?e.classList.add(s):!t&&e.classList.contains(s)&&e.classList.remove(s)};const Zs=(e,t,s)=>{t&&!e.classList.contains(s)?e.classList.add(s):!t&&e.classList.contains(s)&&e.classList.remove(s)};const Qs=(e,t)=>{if(!e||e.destroyed||!e.params)return;const s=t.closest(e.isElement?"swiper-slide":`.${e.params.slideClass}`);if(s){let t=s.querySelector(`.${e.params.lazyPreloaderClass}`);!t&&e.isElement&&(s.shadowRoot?t=s.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{s.shadowRoot&&(t=s.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`),t&&t.remove())})),t&&t.remove()}},er=(e,t)=>{if(!e.slides[t])return;const s=e.slides[t].querySelector('[loading="lazy"]');s&&s.removeAttribute("loading")},tr=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const s=e.slides.length;if(!s||!t||t<0)return;t=Math.min(t,s);const r="auto"===e.params.slidesPerView?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),a=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const s=a,n=[s-t];return n.push(...Array.from({length:t}).map((e,t)=>s+r+t)),void e.slides.forEach((t,s)=>{n.includes(t.column)&&er(e,s)})}const n=a+r-1;if(e.params.rewind||e.params.loop)for(let i=a-t;i<=n+t;i+=1){const t=(i%s+s)%s;(t<a||t>n)&&er(e,t)}else for(let i=Math.max(a-t,0);i<=Math.min(n+t,s-1);i+=1)i!==a&&(i>n||i<a)&&er(e,i)};function sr(e){let{swiper:t,runCallbacks:s,direction:r,step:a}=e;const{activeIndex:n,previousIndex:i}=t;let l=r;l||(l=n>i?"next":n<i?"prev":"reset"),t.emit(`transition${a}`),s&&"reset"===l?t.emit(`slideResetTransition${a}`):s&&n!==i&&(t.emit(`slideChangeTransition${a}`),"next"===l?t.emit(`slideNextTransition${a}`):t.emit(`slidePrevTransition${a}`))}function rr(e,t,s){const r=Ss(),{params:a}=e,n=a.edgeSwipeDetection,i=a.edgeSwipeThreshold;return!n||!(s<=i||s>=r.innerWidth-i)||"prevent"===n&&(t.preventDefault(),!0)}function ar(e){const t=this,s=ks();let r=e;r.originalEvent&&(r=r.originalEvent);const a=t.touchEventsData;if("pointerdown"===r.type){if(null!==a.pointerId&&a.pointerId!==r.pointerId)return;a.pointerId=r.pointerId}else"touchstart"===r.type&&1===r.targetTouches.length&&(a.touchId=r.targetTouches[0].identifier);if("touchstart"===r.type)return void rr(t,r,r.targetTouches[0].pageX);const{params:n,touches:i,enabled:l}=t;if(!l)return;if(!n.simulateTouch&&"mouse"===r.pointerType)return;if(t.animating&&n.preventInteractionOnTransition)return;!t.animating&&n.cssMode&&n.loop&&t.loopFix();let o=r.target;if("wrapper"===n.touchEventsTarget&&!function(e,t){const s=Ss();let r=t.contains(e);!r&&s.HTMLSlotElement&&t instanceof HTMLSlotElement&&(r=[...t.assignedElements()].includes(e),r||(r=function(e,t){const s=[t];for(;s.length>0;){const t=s.shift();if(e===t)return!0;s.push(...t.children,...t.shadowRoot?t.shadowRoot.children:[],...t.assignedElements?t.assignedElements():[])}}(e,t)));return r}(o,t.wrapperEl))return;if("which"in r&&3===r.which)return;if("button"in r&&r.button>0)return;if(a.isTouched&&a.isMoved)return;const c=!!n.noSwipingClass&&""!==n.noSwipingClass,d=r.composedPath?r.composedPath():r.path;c&&r.target&&r.target.shadowRoot&&d&&(o=d[0]);const u=n.noSwipingSelector?n.noSwipingSelector:`.${n.noSwipingClass}`,m=!(!r.target||!r.target.shadowRoot);if(n.noSwiping&&(m?function(e,t){return void 0===t&&(t=this),function t(s){if(!s||s===ks()||s===Ss())return null;s.assignedSlot&&(s=s.assignedSlot);const r=s.closest(e);return r||s.getRootNode?r||t(s.getRootNode().host):null}(t)}(u,o):o.closest(u)))return void(t.allowClick=!0);if(n.swipeHandler&&!o.closest(n.swipeHandler))return;i.currentX=r.pageX,i.currentY=r.pageY;const h=i.currentX,x=i.currentY;if(!rr(t,r,h))return;Object.assign(a,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),i.startX=h,i.startY=x,a.touchStartTime=As(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,n.threshold>0&&(a.allowThresholdMove=!1);let p=!0;o.matches(a.focusableElements)&&(p=!1,"SELECT"===o.nodeName&&(a.isTouched=!1)),s.activeElement&&s.activeElement.matches(a.focusableElements)&&s.activeElement!==o&&("mouse"===r.pointerType||"mouse"!==r.pointerType&&!o.matches(a.focusableElements))&&s.activeElement.blur();const f=p&&t.allowTouchMove&&n.touchStartPreventDefault;!n.touchStartForcePreventDefault&&!f||o.isContentEditable||r.preventDefault(),n.freeMode&&n.freeMode.enabled&&t.freeMode&&t.animating&&!n.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",r)}function nr(e){const t=ks(),s=this,r=s.touchEventsData,{params:a,touches:n,rtlTranslate:i,enabled:l}=s;if(!l)return;if(!a.simulateTouch&&"mouse"===e.pointerType)return;let o,c=e;if(c.originalEvent&&(c=c.originalEvent),"pointermove"===c.type){if(null!==r.touchId)return;if(c.pointerId!==r.pointerId)return}if("touchmove"===c.type){if(o=[...c.changedTouches].find(e=>e.identifier===r.touchId),!o||o.identifier!==r.touchId)return}else o=c;if(!r.isTouched)return void(r.startMoving&&r.isScrolling&&s.emit("touchMoveOpposite",c));const d=o.pageX,u=o.pageY;if(c.preventedByNestedSwiper)return n.startX=d,void(n.startY=u);if(!s.allowTouchMove)return c.target.matches(r.focusableElements)||(s.allowClick=!1),void(r.isTouched&&(Object.assign(n,{startX:d,startY:u,currentX:d,currentY:u}),r.touchStartTime=As()));if(a.touchReleaseOnEdges&&!a.loop)if(s.isVertical()){if(u<n.startY&&s.translate<=s.maxTranslate()||u>n.startY&&s.translate>=s.minTranslate())return r.isTouched=!1,void(r.isMoved=!1)}else{if(i&&(d>n.startX&&-s.translate<=s.maxTranslate()||d<n.startX&&-s.translate>=s.minTranslate()))return;if(!i&&(d<n.startX&&s.translate<=s.maxTranslate()||d>n.startX&&s.translate>=s.minTranslate()))return}if(t.activeElement&&t.activeElement.matches(r.focusableElements)&&t.activeElement!==c.target&&"mouse"!==c.pointerType&&t.activeElement.blur(),t.activeElement&&c.target===t.activeElement&&c.target.matches(r.focusableElements))return r.isMoved=!0,void(s.allowClick=!1);r.allowTouchCallbacks&&s.emit("touchMove",c),n.previousX=n.currentX,n.previousY=n.currentY,n.currentX=d,n.currentY=u;const m=n.currentX-n.startX,h=n.currentY-n.startY;if(s.params.threshold&&Math.sqrt(m**2+h**2)<s.params.threshold)return;if(void 0===r.isScrolling){let e;s.isHorizontal()&&n.currentY===n.startY||s.isVertical()&&n.currentX===n.startX?r.isScrolling=!1:m*m+h*h>=25&&(e=180*Math.atan2(Math.abs(h),Math.abs(m))/Math.PI,r.isScrolling=s.isHorizontal()?e>a.touchAngle:90-e>a.touchAngle)}if(r.isScrolling&&s.emit("touchMoveOpposite",c),void 0===r.startMoving&&(n.currentX===n.startX&&n.currentY===n.startY||(r.startMoving=!0)),r.isScrolling||"touchmove"===c.type&&r.preventTouchMoveFromPointerMove)return void(r.isTouched=!1);if(!r.startMoving)return;s.allowClick=!1,!a.cssMode&&c.cancelable&&c.preventDefault(),a.touchMoveStopPropagation&&!a.nested&&c.stopPropagation();let x=s.isHorizontal()?m:h,p=s.isHorizontal()?n.currentX-n.previousX:n.currentY-n.previousY;a.oneWayMovement&&(x=Math.abs(x)*(i?1:-1),p=Math.abs(p)*(i?1:-1)),n.diff=x,x*=a.touchRatio,i&&(x=-x,p=-p);const f=s.touchesDirection;s.swipeDirection=x>0?"prev":"next",s.touchesDirection=p>0?"prev":"next";const g=s.params.loop&&!a.cssMode,b="next"===s.touchesDirection&&s.allowSlideNext||"prev"===s.touchesDirection&&s.allowSlidePrev;if(!r.isMoved){if(g&&b&&s.loopFix({direction:s.swipeDirection}),r.startTranslate=s.getTranslate(),s.setTransition(0),s.animating){const e=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});s.wrapperEl.dispatchEvent(e)}r.allowMomentumBounce=!1,!a.grabCursor||!0!==s.allowSlideNext&&!0!==s.allowSlidePrev||s.setGrabCursor(!0),s.emit("sliderFirstMove",c)}if((new Date).getTime(),!1!==a._loopSwapReset&&r.isMoved&&r.allowThresholdMove&&f!==s.touchesDirection&&g&&b&&Math.abs(x)>=1)return Object.assign(n,{startX:d,startY:u,currentX:d,currentY:u,startTranslate:r.currentTranslate}),r.loopSwapReset=!0,void(r.startTranslate=r.currentTranslate);s.emit("sliderMove",c),r.isMoved=!0,r.currentTranslate=x+r.startTranslate;let v=!0,y=a.resistanceRatio;if(a.touchReleaseOnEdges&&(y=0),x>0?(g&&b&&r.allowThresholdMove&&r.currentTranslate>(a.centeredSlides?s.minTranslate()-s.slidesSizesGrid[s.activeIndex+1]-("auto"!==a.slidesPerView&&s.slides.length-a.slidesPerView>=2?s.slidesSizesGrid[s.activeIndex+1]+s.params.spaceBetween:0)-s.params.spaceBetween:s.minTranslate())&&s.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),r.currentTranslate>s.minTranslate()&&(v=!1,a.resistance&&(r.currentTranslate=s.minTranslate()-1+(-s.minTranslate()+r.startTranslate+x)**y))):x<0&&(g&&b&&r.allowThresholdMove&&r.currentTranslate<(a.centeredSlides?s.maxTranslate()+s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween+("auto"!==a.slidesPerView&&s.slides.length-a.slidesPerView>=2?s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween:0):s.maxTranslate())&&s.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:s.slides.length-("auto"===a.slidesPerView?s.slidesPerViewDynamic():Math.ceil(parseFloat(a.slidesPerView,10)))}),r.currentTranslate<s.maxTranslate()&&(v=!1,a.resistance&&(r.currentTranslate=s.maxTranslate()+1-(s.maxTranslate()-r.startTranslate-x)**y))),v&&(c.preventedByNestedSwiper=!0),!s.allowSlideNext&&"next"===s.swipeDirection&&r.currentTranslate<r.startTranslate&&(r.currentTranslate=r.startTranslate),!s.allowSlidePrev&&"prev"===s.swipeDirection&&r.currentTranslate>r.startTranslate&&(r.currentTranslate=r.startTranslate),s.allowSlidePrev||s.allowSlideNext||(r.currentTranslate=r.startTranslate),a.threshold>0){if(!(Math.abs(x)>a.threshold||r.allowThresholdMove))return void(r.currentTranslate=r.startTranslate);if(!r.allowThresholdMove)return r.allowThresholdMove=!0,n.startX=n.currentX,n.startY=n.currentY,r.currentTranslate=r.startTranslate,void(n.diff=s.isHorizontal()?n.currentX-n.startX:n.currentY-n.startY)}a.followFinger&&!a.cssMode&&((a.freeMode&&a.freeMode.enabled&&s.freeMode||a.watchSlidesProgress)&&(s.updateActiveIndex(),s.updateSlidesClasses()),a.freeMode&&a.freeMode.enabled&&s.freeMode&&s.freeMode.onTouchMove(),s.updateProgress(r.currentTranslate),s.setTranslate(r.currentTranslate))}function ir(e){const t=this,s=t.touchEventsData;let r,a=e;a.originalEvent&&(a=a.originalEvent);if("touchend"===a.type||"touchcancel"===a.type){if(r=[...a.changedTouches].find(e=>e.identifier===s.touchId),!r||r.identifier!==s.touchId)return}else{if(null!==s.touchId)return;if(a.pointerId!==s.pointerId)return;r=a}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(a.type)){if(!(["pointercancel","contextmenu"].includes(a.type)&&(t.browser.isSafari||t.browser.isWebView)))return}s.pointerId=null,s.touchId=null;const{params:n,touches:i,rtlTranslate:l,slidesGrid:o,enabled:c}=t;if(!c)return;if(!n.simulateTouch&&"mouse"===a.pointerType)return;if(s.allowTouchCallbacks&&t.emit("touchEnd",a),s.allowTouchCallbacks=!1,!s.isTouched)return s.isMoved&&n.grabCursor&&t.setGrabCursor(!1),s.isMoved=!1,void(s.startMoving=!1);n.grabCursor&&s.isMoved&&s.isTouched&&(!0===t.allowSlideNext||!0===t.allowSlidePrev)&&t.setGrabCursor(!1);const d=As(),u=d-s.touchStartTime;if(t.allowClick){const e=a.path||a.composedPath&&a.composedPath();t.updateClickedSlide(e&&e[0]||a.target,e),t.emit("tap click",a),u<300&&d-s.lastClickTime<300&&t.emit("doubleTap doubleClick",a)}if(s.lastClickTime=As(),Ts(()=>{t.destroyed||(t.allowClick=!0)}),!s.isTouched||!s.isMoved||!t.swipeDirection||0===i.diff&&!s.loopSwapReset||s.currentTranslate===s.startTranslate&&!s.loopSwapReset)return s.isTouched=!1,s.isMoved=!1,void(s.startMoving=!1);let m;if(s.isTouched=!1,s.isMoved=!1,s.startMoving=!1,m=n.followFinger?l?t.translate:-t.translate:-s.currentTranslate,n.cssMode)return;if(n.freeMode&&n.freeMode.enabled)return void t.freeMode.onTouchEnd({currentPos:m});const h=m>=-t.maxTranslate()&&!t.params.loop;let x=0,p=t.slidesSizesGrid[0];for(let y=0;y<o.length;y+=y<n.slidesPerGroupSkip?1:n.slidesPerGroup){const e=y<n.slidesPerGroupSkip-1?1:n.slidesPerGroup;void 0!==o[y+e]?(h||m>=o[y]&&m<o[y+e])&&(x=y,p=o[y+e]-o[y]):(h||m>=o[y])&&(x=y,p=o[o.length-1]-o[o.length-2])}let f=null,g=null;n.rewind&&(t.isBeginning?g=n.virtual&&n.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(f=0));const b=(m-o[x])/p,v=x<n.slidesPerGroupSkip-1?1:n.slidesPerGroup;if(u>n.longSwipesMs){if(!n.longSwipes)return void t.slideTo(t.activeIndex);"next"===t.swipeDirection&&(b>=n.longSwipesRatio?t.slideTo(n.rewind&&t.isEnd?f:x+v):t.slideTo(x)),"prev"===t.swipeDirection&&(b>1-n.longSwipesRatio?t.slideTo(x+v):null!==g&&b<0&&Math.abs(b)>n.longSwipesRatio?t.slideTo(g):t.slideTo(x))}else{if(!n.shortSwipes)return void t.slideTo(t.activeIndex);t.navigation&&(a.target===t.navigation.nextEl||a.target===t.navigation.prevEl)?a.target===t.navigation.nextEl?t.slideTo(x+v):t.slideTo(x):("next"===t.swipeDirection&&t.slideTo(null!==f?f:x+v),"prev"===t.swipeDirection&&t.slideTo(null!==g?g:x))}}function lr(){const e=this,{params:t,el:s}=e;if(s&&0===s.offsetWidth)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:r,allowSlidePrev:a,snapGrid:n}=e,i=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const l=i&&t.loop;!("auto"===t.slidesPerView||t.slidesPerView>1)||!e.isEnd||e.isBeginning||e.params.centeredSlides||l?e.params.loop&&!i?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0):e.slideTo(e.slides.length-1,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout(()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()},500)),e.allowSlidePrev=a,e.allowSlideNext=r,e.params.watchOverflow&&n!==e.snapGrid&&e.checkOverflow()}function or(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function cr(){const e=this,{wrapperEl:t,rtlTranslate:s,enabled:r}=e;if(!r)return;let a;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,0===e.translate&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();const n=e.maxTranslate()-e.minTranslate();a=0===n?0:(e.translate-e.minTranslate())/n,a!==e.progress&&e.updateProgress(s?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function dr(e){const t=this;Qs(t,e.target),t.params.cssMode||"auto"!==t.params.slidesPerView&&!t.params.autoHeight||t.update()}function ur(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const mr=(e,t)=>{const s=ks(),{params:r,el:a,wrapperEl:n,device:i}=e,l=!!r.nested,o="on"===t?"addEventListener":"removeEventListener",c=t;a&&"string"!=typeof a&&(s[o]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:l}),a[o]("touchstart",e.onTouchStart,{passive:!1}),a[o]("pointerdown",e.onTouchStart,{passive:!1}),s[o]("touchmove",e.onTouchMove,{passive:!1,capture:l}),s[o]("pointermove",e.onTouchMove,{passive:!1,capture:l}),s[o]("touchend",e.onTouchEnd,{passive:!0}),s[o]("pointerup",e.onTouchEnd,{passive:!0}),s[o]("pointercancel",e.onTouchEnd,{passive:!0}),s[o]("touchcancel",e.onTouchEnd,{passive:!0}),s[o]("pointerout",e.onTouchEnd,{passive:!0}),s[o]("pointerleave",e.onTouchEnd,{passive:!0}),s[o]("contextmenu",e.onTouchEnd,{passive:!0}),(r.preventClicks||r.preventClicksPropagation)&&a[o]("click",e.onClick,!0),r.cssMode&&n[o]("scroll",e.onScroll),r.updateOnWindowResize?e[c](i.ios||i.android?"resize orientationchange observerUpdate":"resize observerUpdate",lr,!0):e[c]("observerUpdate",lr,!0),a[o]("load",e.onLoad,{capture:!0}))};const hr=(e,t)=>e.grid&&t.grid&&t.grid.rows>1;var xr={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function pr(e,t){return function(s){void 0===s&&(s={});const r=Object.keys(s)[0],a=s[r];"object"==typeof a&&null!==a?(!0===e[r]&&(e[r]={enabled:!0}),"navigation"===r&&e[r]&&e[r].enabled&&!e[r].prevEl&&!e[r].nextEl&&(e[r].auto=!0),["pagination","scrollbar"].indexOf(r)>=0&&e[r]&&e[r].enabled&&!e[r].el&&(e[r].auto=!0),r in e&&"enabled"in a?("object"!=typeof e[r]||"enabled"in e[r]||(e[r].enabled=!0),e[r]||(e[r]={enabled:!1}),Ms(t,s)):Ms(t,s)):Ms(t,s)}}const fr={eventsEmitter:{on(e,t,s){const r=this;if(!r.eventsListeners||r.destroyed)return r;if("function"!=typeof t)return r;const a=s?"unshift":"push";return e.split(" ").forEach(e=>{r.eventsListeners[e]||(r.eventsListeners[e]=[]),r.eventsListeners[e][a](t)}),r},once(e,t,s){const r=this;if(!r.eventsListeners||r.destroyed)return r;if("function"!=typeof t)return r;function a(){r.off(e,a),a.__emitterProxy&&delete a.__emitterProxy;for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];t.apply(r,n)}return a.__emitterProxy=t,r.on(e,a,s)},onAny(e,t){const s=this;if(!s.eventsListeners||s.destroyed)return s;if("function"!=typeof e)return s;const r=t?"unshift":"push";return s.eventsAnyListeners.indexOf(e)<0&&s.eventsAnyListeners[r](e),s},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed)return t;if(!t.eventsAnyListeners)return t;const s=t.eventsAnyListeners.indexOf(e);return s>=0&&t.eventsAnyListeners.splice(s,1),t},off(e,t){const s=this;return!s.eventsListeners||s.destroyed?s:s.eventsListeners?(e.split(" ").forEach(e=>{void 0===t?s.eventsListeners[e]=[]:s.eventsListeners[e]&&s.eventsListeners[e].forEach((r,a)=>{(r===t||r.__emitterProxy&&r.__emitterProxy===t)&&s.eventsListeners[e].splice(a,1)})}),s):s},emit(){const e=this;if(!e.eventsListeners||e.destroyed)return e;if(!e.eventsListeners)return e;let t,s,r;for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];"string"==typeof n[0]||Array.isArray(n[0])?(t=n[0],s=n.slice(1,n.length),r=e):(t=n[0].events,s=n[0].data,r=n[0].context||e),s.unshift(r);return(Array.isArray(t)?t:t.split(" ")).forEach(t=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach(e=>{e.apply(r,[t,...s])}),e.eventsListeners&&e.eventsListeners[t]&&e.eventsListeners[t].forEach(e=>{e.apply(r,s)})}),e}},update:{updateSize:function(){const e=this;let t,s;const r=e.el;t=void 0!==e.params.width&&null!==e.params.width?e.params.width:r.clientWidth,s=void 0!==e.params.height&&null!==e.params.height?e.params.height:r.clientHeight,0===t&&e.isHorizontal()||0===s&&e.isVertical()||(t=t-parseInt(Bs(r,"padding-left")||0,10)-parseInt(Bs(r,"padding-right")||0,10),s=s-parseInt(Bs(r,"padding-top")||0,10)-parseInt(Bs(r,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(s)&&(s=0),Object.assign(e,{width:t,height:s,size:e.isHorizontal()?t:s}))},updateSlides:function(){const e=this;function t(t,s){return parseFloat(t.getPropertyValue(e.getDirectionLabel(s))||0)}const s=e.params,{wrapperEl:r,slidesEl:a,size:n,rtlTranslate:i,wrongRTL:l}=e,o=e.virtual&&s.virtual.enabled,c=o?e.virtual.slides.length:e.slides.length,d=Is(a,`.${e.params.slideClass}, swiper-slide`),u=o?e.virtual.slides.length:d.length;let m=[];const h=[],x=[];let p=s.slidesOffsetBefore;"function"==typeof p&&(p=s.slidesOffsetBefore.call(e));let f=s.slidesOffsetAfter;"function"==typeof f&&(f=s.slidesOffsetAfter.call(e));const g=e.snapGrid.length,b=e.slidesGrid.length;let v=s.spaceBetween,y=-p,w=0,j=0;if(void 0===n)return;"string"==typeof v&&v.indexOf("%")>=0?v=parseFloat(v.replace("%",""))/100*n:"string"==typeof v&&(v=parseFloat(v)),e.virtualSize=-v,d.forEach(e=>{i?e.style.marginLeft="":e.style.marginRight="",e.style.marginBottom="",e.style.marginTop=""}),s.centeredSlides&&s.cssMode&&(Ls(r,"--swiper-centered-offset-before",""),Ls(r,"--swiper-centered-offset-after",""));const N=s.grid&&s.grid.rows>1&&e.grid;let _;N?e.grid.initSlides(d):e.grid&&e.grid.unsetSlides();const k="auto"===s.slidesPerView&&s.breakpoints&&Object.keys(s.breakpoints).filter(e=>void 0!==s.breakpoints[e].slidesPerView).length>0;for(let C=0;C<u;C+=1){let r;if(_=0,d[C]&&(r=d[C]),N&&e.grid.updateSlide(C,r,d),!d[C]||"none"!==Bs(r,"display")){if("auto"===s.slidesPerView){k&&(d[C].style[e.getDirectionLabel("width")]="");const a=getComputedStyle(r),n=r.style.transform,i=r.style.webkitTransform;if(n&&(r.style.transform="none"),i&&(r.style.webkitTransform="none"),s.roundLengths)_=e.isHorizontal()?Vs(r,"width"):Vs(r,"height");else{const e=t(a,"width"),s=t(a,"padding-left"),n=t(a,"padding-right"),i=t(a,"margin-left"),l=t(a,"margin-right"),o=a.getPropertyValue("box-sizing");if(o&&"border-box"===o)_=e+i+l;else{const{clientWidth:t,offsetWidth:a}=r;_=e+s+n+i+l+(a-t)}}n&&(r.style.transform=n),i&&(r.style.webkitTransform=i),s.roundLengths&&(_=Math.floor(_))}else _=(n-(s.slidesPerView-1)*v)/s.slidesPerView,s.roundLengths&&(_=Math.floor(_)),d[C]&&(d[C].style[e.getDirectionLabel("width")]=`${_}px`);d[C]&&(d[C].swiperSlideSize=_),x.push(_),s.centeredSlides?(y=y+_/2+w/2+v,0===w&&0!==C&&(y=y-n/2-v),0===C&&(y=y-n/2-v),Math.abs(y)<.001&&(y=0),s.roundLengths&&(y=Math.floor(y)),j%s.slidesPerGroup===0&&m.push(y),h.push(y)):(s.roundLengths&&(y=Math.floor(y)),(j-Math.min(e.params.slidesPerGroupSkip,j))%e.params.slidesPerGroup===0&&m.push(y),h.push(y),y=y+_+v),e.virtualSize+=_+v,w=_,j+=1}}if(e.virtualSize=Math.max(e.virtualSize,n)+f,i&&l&&("slide"===s.effect||"coverflow"===s.effect)&&(r.style.width=`${e.virtualSize+v}px`),s.setWrapperSize&&(r.style[e.getDirectionLabel("width")]=`${e.virtualSize+v}px`),N&&e.grid.updateWrapperSize(_,m),!s.centeredSlides){const t=[];for(let r=0;r<m.length;r+=1){let a=m[r];s.roundLengths&&(a=Math.floor(a)),m[r]<=e.virtualSize-n&&t.push(a)}m=t,Math.floor(e.virtualSize-n)-Math.floor(m[m.length-1])>1&&m.push(e.virtualSize-n)}if(o&&s.loop){const t=x[0]+v;if(s.slidesPerGroup>1){const r=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/s.slidesPerGroup),a=t*s.slidesPerGroup;for(let e=0;e<r;e+=1)m.push(m[m.length-1]+a)}for(let r=0;r<e.virtual.slidesBefore+e.virtual.slidesAfter;r+=1)1===s.slidesPerGroup&&m.push(m[m.length-1]+t),h.push(h[h.length-1]+t),e.virtualSize+=t}if(0===m.length&&(m=[0]),0!==v){const t=e.isHorizontal()&&i?"marginLeft":e.getDirectionLabel("marginRight");d.filter((e,t)=>!(s.cssMode&&!s.loop)||t!==d.length-1).forEach(e=>{e.style[t]=`${v}px`})}if(s.centeredSlides&&s.centeredSlidesBounds){let e=0;x.forEach(t=>{e+=t+(v||0)}),e-=v;const t=e>n?e-n:0;m=m.map(e=>e<=0?-p:e>t?t+f:e)}if(s.centerInsufficientSlides){let e=0;x.forEach(t=>{e+=t+(v||0)}),e-=v;const t=(s.slidesOffsetBefore||0)+(s.slidesOffsetAfter||0);if(e+t<n){const s=(n-e-t)/2;m.forEach((e,t)=>{m[t]=e-s}),h.forEach((e,t)=>{h[t]=e+s})}}if(Object.assign(e,{slides:d,snapGrid:m,slidesGrid:h,slidesSizesGrid:x}),s.centeredSlides&&s.cssMode&&!s.centeredSlidesBounds){Ls(r,"--swiper-centered-offset-before",-m[0]+"px"),Ls(r,"--swiper-centered-offset-after",e.size/2-x[x.length-1]/2+"px");const t=-e.snapGrid[0],s=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map(e=>e+t),e.slidesGrid=e.slidesGrid.map(e=>e+s)}if(u!==c&&e.emit("slidesLengthChange"),m.length!==g&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),h.length!==b&&e.emit("slidesGridLengthChange"),s.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!(o||s.cssMode||"slide"!==s.effect&&"fade"!==s.effect)){const t=`${s.containerModifierClass}backface-hidden`,r=e.el.classList.contains(t);u<=s.maxBackfaceHiddenSlides?r||e.el.classList.add(t):r&&e.el.classList.remove(t)}},updateAutoHeight:function(e){const t=this,s=[],r=t.virtual&&t.params.virtual.enabled;let a,n=0;"number"==typeof e?t.setTransition(e):!0===e&&t.setTransition(t.params.speed);const i=e=>r?t.slides[t.getSlideIndexByData(e)]:t.slides[e];if("auto"!==t.params.slidesPerView&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach(e=>{s.push(e)});else for(a=0;a<Math.ceil(t.params.slidesPerView);a+=1){const e=t.activeIndex+a;if(e>t.slides.length&&!r)break;s.push(i(e))}else s.push(i(t.activeIndex));for(a=0;a<s.length;a+=1)if(void 0!==s[a]){const e=s[a].offsetHeight;n=e>n?e:n}(n||0===n)&&(t.wrapperEl.style.height=`${n}px`)},updateSlidesOffset:function(){const e=this,t=e.slides,s=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let r=0;r<t.length;r+=1)t[r].swiperSlideOffset=(e.isHorizontal()?t[r].offsetLeft:t[r].offsetTop)-s-e.cssOverflowAdjustment()},updateSlidesProgress:function(e){void 0===e&&(e=this&&this.translate||0);const t=this,s=t.params,{slides:r,rtlTranslate:a,snapGrid:n}=t;if(0===r.length)return;void 0===r[0].swiperSlideOffset&&t.updateSlidesOffset();let i=-e;a&&(i=e),t.visibleSlidesIndexes=[],t.visibleSlides=[];let l=s.spaceBetween;"string"==typeof l&&l.indexOf("%")>=0?l=parseFloat(l.replace("%",""))/100*t.size:"string"==typeof l&&(l=parseFloat(l));for(let o=0;o<r.length;o+=1){const e=r[o];let c=e.swiperSlideOffset;s.cssMode&&s.centeredSlides&&(c-=r[0].swiperSlideOffset);const d=(i+(s.centeredSlides?t.minTranslate():0)-c)/(e.swiperSlideSize+l),u=(i-n[0]+(s.centeredSlides?t.minTranslate():0)-c)/(e.swiperSlideSize+l),m=-(i-c),h=m+t.slidesSizesGrid[o],x=m>=0&&m<=t.size-t.slidesSizesGrid[o],p=m>=0&&m<t.size-1||h>1&&h<=t.size||m<=0&&h>=t.size;p&&(t.visibleSlides.push(e),t.visibleSlidesIndexes.push(o)),Js(e,p,s.slideVisibleClass),Js(e,x,s.slideFullyVisibleClass),e.progress=a?-d:d,e.originalProgress=a?-u:u}},updateProgress:function(e){const t=this;if(void 0===e){const s=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*s||0}const s=t.params,r=t.maxTranslate()-t.minTranslate();let{progress:a,isBeginning:n,isEnd:i,progressLoop:l}=t;const o=n,c=i;if(0===r)a=0,n=!0,i=!0;else{a=(e-t.minTranslate())/r;const s=Math.abs(e-t.minTranslate())<1,l=Math.abs(e-t.maxTranslate())<1;n=s||a<=0,i=l||a>=1,s&&(a=0),l&&(a=1)}if(s.loop){const s=t.getSlideIndexByData(0),r=t.getSlideIndexByData(t.slides.length-1),a=t.slidesGrid[s],n=t.slidesGrid[r],i=t.slidesGrid[t.slidesGrid.length-1],o=Math.abs(e);l=o>=a?(o-a)/i:(o+i-n)/i,l>1&&(l-=1)}Object.assign(t,{progress:a,progressLoop:l,isBeginning:n,isEnd:i}),(s.watchSlidesProgress||s.centeredSlides&&s.autoHeight)&&t.updateSlidesProgress(e),n&&!o&&t.emit("reachBeginning toEdge"),i&&!c&&t.emit("reachEnd toEdge"),(o&&!n||c&&!i)&&t.emit("fromEdge"),t.emit("progress",a)},updateSlidesClasses:function(){const e=this,{slides:t,params:s,slidesEl:r,activeIndex:a}=e,n=e.virtual&&s.virtual.enabled,i=e.grid&&s.grid&&s.grid.rows>1,l=e=>Is(r,`.${s.slideClass}${e}, swiper-slide${e}`)[0];let o,c,d;if(n)if(s.loop){let t=a-e.virtual.slidesBefore;t<0&&(t=e.virtual.slides.length+t),t>=e.virtual.slides.length&&(t-=e.virtual.slides.length),o=l(`[data-swiper-slide-index="${t}"]`)}else o=l(`[data-swiper-slide-index="${a}"]`);else i?(o=t.find(e=>e.column===a),d=t.find(e=>e.column===a+1),c=t.find(e=>e.column===a-1)):o=t[a];o&&(i||(d=function(e,t){const s=[];for(;e.nextElementSibling;){const r=e.nextElementSibling;t?r.matches(t)&&s.push(r):s.push(r),e=r}return s}(o,`.${s.slideClass}, swiper-slide`)[0],s.loop&&!d&&(d=t[0]),c=function(e,t){const s=[];for(;e.previousElementSibling;){const r=e.previousElementSibling;t?r.matches(t)&&s.push(r):s.push(r),e=r}return s}(o,`.${s.slideClass}, swiper-slide`)[0],s.loop&&0===!c&&(c=t[t.length-1]))),t.forEach(e=>{Zs(e,e===o,s.slideActiveClass),Zs(e,e===d,s.slideNextClass),Zs(e,e===c,s.slidePrevClass)}),e.emitSlidesClasses()},updateActiveIndex:function(e){const t=this,s=t.rtlTranslate?t.translate:-t.translate,{snapGrid:r,params:a,activeIndex:n,realIndex:i,snapIndex:l}=t;let o,c=e;const d=e=>{let s=e-t.virtual.slidesBefore;return s<0&&(s=t.virtual.slides.length+s),s>=t.virtual.slides.length&&(s-=t.virtual.slides.length),s};if(void 0===c&&(c=function(e){const{slidesGrid:t,params:s}=e,r=e.rtlTranslate?e.translate:-e.translate;let a;for(let n=0;n<t.length;n+=1)void 0!==t[n+1]?r>=t[n]&&r<t[n+1]-(t[n+1]-t[n])/2?a=n:r>=t[n]&&r<t[n+1]&&(a=n+1):r>=t[n]&&(a=n);return s.normalizeSlideIndex&&(a<0||void 0===a)&&(a=0),a}(t)),r.indexOf(s)>=0)o=r.indexOf(s);else{const e=Math.min(a.slidesPerGroupSkip,c);o=e+Math.floor((c-e)/a.slidesPerGroup)}if(o>=r.length&&(o=r.length-1),c===n&&!t.params.loop)return void(o!==l&&(t.snapIndex=o,t.emit("snapIndexChange")));if(c===n&&t.params.loop&&t.virtual&&t.params.virtual.enabled)return void(t.realIndex=d(c));const u=t.grid&&a.grid&&a.grid.rows>1;let m;if(t.virtual&&a.virtual.enabled&&a.loop)m=d(c);else if(u){const e=t.slides.find(e=>e.column===c);let s=parseInt(e.getAttribute("data-swiper-slide-index"),10);Number.isNaN(s)&&(s=Math.max(t.slides.indexOf(e),0)),m=Math.floor(s/a.grid.rows)}else if(t.slides[c]){const e=t.slides[c].getAttribute("data-swiper-slide-index");m=e?parseInt(e,10):c}else m=c;Object.assign(t,{previousSnapIndex:l,snapIndex:o,previousRealIndex:i,realIndex:m,previousIndex:n,activeIndex:c}),t.initialized&&tr(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(i!==m&&t.emit("realIndexChange"),t.emit("slideChange"))},updateClickedSlide:function(e,t){const s=this,r=s.params;let a=e.closest(`.${r.slideClass}, swiper-slide`);!a&&s.isElement&&t&&t.length>1&&t.includes(e)&&[...t.slice(t.indexOf(e)+1,t.length)].forEach(e=>{!a&&e.matches&&e.matches(`.${r.slideClass}, swiper-slide`)&&(a=e)});let n,i=!1;if(a)for(let l=0;l<s.slides.length;l+=1)if(s.slides[l]===a){i=!0,n=l;break}if(!a||!i)return s.clickedSlide=void 0,void(s.clickedIndex=void 0);s.clickedSlide=a,s.virtual&&s.params.virtual.enabled?s.clickedIndex=parseInt(a.getAttribute("data-swiper-slide-index"),10):s.clickedIndex=n,r.slideToClickedSlide&&void 0!==s.clickedIndex&&s.clickedIndex!==s.activeIndex&&s.slideToClickedSlide()}},translate:{getTranslate:function(e){void 0===e&&(e=this.isHorizontal()?"x":"y");const{params:t,rtlTranslate:s,translate:r,wrapperEl:a}=this;if(t.virtualTranslate)return s?-r:r;if(t.cssMode)return r;let n=Es(a,e);return n+=this.cssOverflowAdjustment(),s&&(n=-n),n||0},setTranslate:function(e,t){const s=this,{rtlTranslate:r,params:a,wrapperEl:n,progress:i}=s;let l,o=0,c=0;s.isHorizontal()?o=r?-e:e:c=e,a.roundLengths&&(o=Math.floor(o),c=Math.floor(c)),s.previousTranslate=s.translate,s.translate=s.isHorizontal()?o:c,a.cssMode?n[s.isHorizontal()?"scrollLeft":"scrollTop"]=s.isHorizontal()?-o:-c:a.virtualTranslate||(s.isHorizontal()?o-=s.cssOverflowAdjustment():c-=s.cssOverflowAdjustment(),n.style.transform=`translate3d(${o}px, ${c}px, 0px)`);const d=s.maxTranslate()-s.minTranslate();l=0===d?0:(e-s.minTranslate())/d,l!==i&&s.updateProgress(e),s.emit("setTranslate",s.translate,t)},minTranslate:function(){return-this.snapGrid[0]},maxTranslate:function(){return-this.snapGrid[this.snapGrid.length-1]},translateTo:function(e,t,s,r,a){void 0===e&&(e=0),void 0===t&&(t=this.params.speed),void 0===s&&(s=!0),void 0===r&&(r=!0);const n=this,{params:i,wrapperEl:l}=n;if(n.animating&&i.preventInteractionOnTransition)return!1;const o=n.minTranslate(),c=n.maxTranslate();let d;if(d=r&&e>o?o:r&&e<c?c:e,n.updateProgress(d),i.cssMode){const e=n.isHorizontal();if(0===t)l[e?"scrollLeft":"scrollTop"]=-d;else{if(!n.support.smoothScroll)return Os({swiper:n,targetPosition:-d,side:e?"left":"top"}),!0;l.scrollTo({[e?"left":"top"]:-d,behavior:"smooth"})}return!0}return 0===t?(n.setTransition(0),n.setTranslate(d),s&&(n.emit("beforeTransitionStart",t,a),n.emit("transitionEnd"))):(n.setTransition(t),n.setTranslate(d),s&&(n.emit("beforeTransitionStart",t,a),n.emit("transitionStart")),n.animating||(n.animating=!0,n.onTranslateToWrapperTransitionEnd||(n.onTranslateToWrapperTransitionEnd=function(e){n&&!n.destroyed&&e.target===this&&(n.wrapperEl.removeEventListener("transitionend",n.onTranslateToWrapperTransitionEnd),n.onTranslateToWrapperTransitionEnd=null,delete n.onTranslateToWrapperTransitionEnd,n.animating=!1,s&&n.emit("transitionEnd"))}),n.wrapperEl.addEventListener("transitionend",n.onTranslateToWrapperTransitionEnd))),!0}},transition:{setTransition:function(e,t){const s=this;s.params.cssMode||(s.wrapperEl.style.transitionDuration=`${e}ms`,s.wrapperEl.style.transitionDelay=0===e?"0ms":""),s.emit("setTransition",e,t)},transitionStart:function(e,t){void 0===e&&(e=!0);const s=this,{params:r}=s;r.cssMode||(r.autoHeight&&s.updateAutoHeight(),sr({swiper:s,runCallbacks:e,direction:t,step:"Start"}))},transitionEnd:function(e,t){void 0===e&&(e=!0);const s=this,{params:r}=s;s.animating=!1,r.cssMode||(s.setTransition(0),sr({swiper:s,runCallbacks:e,direction:t,step:"End"}))}},slide:{slideTo:function(e,t,s,r,a){void 0===e&&(e=0),void 0===s&&(s=!0),"string"==typeof e&&(e=parseInt(e,10));const n=this;let i=e;i<0&&(i=0);const{params:l,snapGrid:o,slidesGrid:c,previousIndex:d,activeIndex:u,rtlTranslate:m,wrapperEl:h,enabled:x}=n;if(!x&&!r&&!a||n.destroyed||n.animating&&l.preventInteractionOnTransition)return!1;void 0===t&&(t=n.params.speed);const p=Math.min(n.params.slidesPerGroupSkip,i);let f=p+Math.floor((i-p)/n.params.slidesPerGroup);f>=o.length&&(f=o.length-1);const g=-o[f];if(l.normalizeSlideIndex)for(let w=0;w<c.length;w+=1){const e=-Math.floor(100*g),t=Math.floor(100*c[w]),s=Math.floor(100*c[w+1]);void 0!==c[w+1]?e>=t&&e<s-(s-t)/2?i=w:e>=t&&e<s&&(i=w+1):e>=t&&(i=w)}if(n.initialized&&i!==u){if(!n.allowSlideNext&&(m?g>n.translate&&g>n.minTranslate():g<n.translate&&g<n.minTranslate()))return!1;if(!n.allowSlidePrev&&g>n.translate&&g>n.maxTranslate()&&(u||0)!==i)return!1}let b;i!==(d||0)&&s&&n.emit("beforeSlideChangeStart"),n.updateProgress(g),b=i>u?"next":i<u?"prev":"reset";const v=n.virtual&&n.params.virtual.enabled;if(!(v&&a)&&(m&&-g===n.translate||!m&&g===n.translate))return n.updateActiveIndex(i),l.autoHeight&&n.updateAutoHeight(),n.updateSlidesClasses(),"slide"!==l.effect&&n.setTranslate(g),"reset"!==b&&(n.transitionStart(s,b),n.transitionEnd(s,b)),!1;if(l.cssMode){const e=n.isHorizontal(),s=m?g:-g;if(0===t)v&&(n.wrapperEl.style.scrollSnapType="none",n._immediateVirtual=!0),v&&!n._cssModeVirtualInitialSet&&n.params.initialSlide>0?(n._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{h[e?"scrollLeft":"scrollTop"]=s})):h[e?"scrollLeft":"scrollTop"]=s,v&&requestAnimationFrame(()=>{n.wrapperEl.style.scrollSnapType="",n._immediateVirtual=!1});else{if(!n.support.smoothScroll)return Os({swiper:n,targetPosition:s,side:e?"left":"top"}),!0;h.scrollTo({[e?"left":"top"]:s,behavior:"smooth"})}return!0}const y=Xs().isSafari;return v&&!a&&y&&n.isElement&&n.virtual.update(!1,!1,i),n.setTransition(t),n.setTranslate(g),n.updateActiveIndex(i),n.updateSlidesClasses(),n.emit("beforeTransitionStart",t,r),n.transitionStart(s,b),0===t?n.transitionEnd(s,b):n.animating||(n.animating=!0,n.onSlideToWrapperTransitionEnd||(n.onSlideToWrapperTransitionEnd=function(e){n&&!n.destroyed&&e.target===this&&(n.wrapperEl.removeEventListener("transitionend",n.onSlideToWrapperTransitionEnd),n.onSlideToWrapperTransitionEnd=null,delete n.onSlideToWrapperTransitionEnd,n.transitionEnd(s,b))}),n.wrapperEl.addEventListener("transitionend",n.onSlideToWrapperTransitionEnd)),!0},slideToLoop:function(e,t,s,r){if(void 0===e&&(e=0),void 0===s&&(s=!0),"string"==typeof e){e=parseInt(e,10)}const a=this;if(a.destroyed)return;void 0===t&&(t=a.params.speed);const n=a.grid&&a.params.grid&&a.params.grid.rows>1;let i=e;if(a.params.loop)if(a.virtual&&a.params.virtual.enabled)i+=a.virtual.slidesBefore;else{let e;if(n){const t=i*a.params.grid.rows;e=a.slides.find(e=>1*e.getAttribute("data-swiper-slide-index")===t).column}else e=a.getSlideIndexByData(i);const t=n?Math.ceil(a.slides.length/a.params.grid.rows):a.slides.length,{centeredSlides:s}=a.params;let l=a.params.slidesPerView;"auto"===l?l=a.slidesPerViewDynamic():(l=Math.ceil(parseFloat(a.params.slidesPerView,10)),s&&l%2==0&&(l+=1));let o=t-e<l;if(s&&(o=o||e<Math.ceil(l/2)),r&&s&&"auto"!==a.params.slidesPerView&&!n&&(o=!1),o){const r=s?e<a.activeIndex?"prev":"next":e-a.activeIndex-1<a.params.slidesPerView?"next":"prev";a.loopFix({direction:r,slideTo:!0,activeSlideIndex:"next"===r?e+1:e-t+1,slideRealIndex:"next"===r?a.realIndex:void 0})}if(n){const e=i*a.params.grid.rows;i=a.slides.find(t=>1*t.getAttribute("data-swiper-slide-index")===e).column}else i=a.getSlideIndexByData(i)}return requestAnimationFrame(()=>{a.slideTo(i,t,s,r)}),a},slideNext:function(e,t,s){void 0===t&&(t=!0);const r=this,{enabled:a,params:n,animating:i}=r;if(!a||r.destroyed)return r;void 0===e&&(e=r.params.speed);let l=n.slidesPerGroup;"auto"===n.slidesPerView&&1===n.slidesPerGroup&&n.slidesPerGroupAuto&&(l=Math.max(r.slidesPerViewDynamic("current",!0),1));const o=r.activeIndex<n.slidesPerGroupSkip?1:l,c=r.virtual&&n.virtual.enabled;if(n.loop){if(i&&!c&&n.loopPreventsSliding)return!1;if(r.loopFix({direction:"next"}),r._clientLeft=r.wrapperEl.clientLeft,r.activeIndex===r.slides.length-1&&n.cssMode)return requestAnimationFrame(()=>{r.slideTo(r.activeIndex+o,e,t,s)}),!0}return n.rewind&&r.isEnd?r.slideTo(0,e,t,s):r.slideTo(r.activeIndex+o,e,t,s)},slidePrev:function(e,t,s){void 0===t&&(t=!0);const r=this,{params:a,snapGrid:n,slidesGrid:i,rtlTranslate:l,enabled:o,animating:c}=r;if(!o||r.destroyed)return r;void 0===e&&(e=r.params.speed);const d=r.virtual&&a.virtual.enabled;if(a.loop){if(c&&!d&&a.loopPreventsSliding)return!1;r.loopFix({direction:"prev"}),r._clientLeft=r.wrapperEl.clientLeft}function u(e){return e<0?-Math.floor(Math.abs(e)):Math.floor(e)}const m=u(l?r.translate:-r.translate),h=n.map(e=>u(e)),x=a.freeMode&&a.freeMode.enabled;let p=n[h.indexOf(m)-1];if(void 0===p&&(a.cssMode||x)){let e;n.forEach((t,s)=>{m>=t&&(e=s)}),void 0!==e&&(p=x?n[e]:n[e>0?e-1:e])}let f=0;if(void 0!==p&&(f=i.indexOf(p),f<0&&(f=r.activeIndex-1),"auto"===a.slidesPerView&&1===a.slidesPerGroup&&a.slidesPerGroupAuto&&(f=f-r.slidesPerViewDynamic("previous",!0)+1,f=Math.max(f,0))),a.rewind&&r.isBeginning){const a=r.params.virtual&&r.params.virtual.enabled&&r.virtual?r.virtual.slides.length-1:r.slides.length-1;return r.slideTo(a,e,t,s)}return a.loop&&0===r.activeIndex&&a.cssMode?(requestAnimationFrame(()=>{r.slideTo(f,e,t,s)}),!0):r.slideTo(f,e,t,s)},slideReset:function(e,t,s){void 0===t&&(t=!0);const r=this;if(!r.destroyed)return void 0===e&&(e=r.params.speed),r.slideTo(r.activeIndex,e,t,s)},slideToClosest:function(e,t,s,r){void 0===t&&(t=!0),void 0===r&&(r=.5);const a=this;if(a.destroyed)return;void 0===e&&(e=a.params.speed);let n=a.activeIndex;const i=Math.min(a.params.slidesPerGroupSkip,n),l=i+Math.floor((n-i)/a.params.slidesPerGroup),o=a.rtlTranslate?a.translate:-a.translate;if(o>=a.snapGrid[l]){const e=a.snapGrid[l];o-e>(a.snapGrid[l+1]-e)*r&&(n+=a.params.slidesPerGroup)}else{const e=a.snapGrid[l-1];o-e<=(a.snapGrid[l]-e)*r&&(n-=a.params.slidesPerGroup)}return n=Math.max(n,0),n=Math.min(n,a.slidesGrid.length-1),a.slideTo(n,e,t,s)},slideToClickedSlide:function(){const e=this;if(e.destroyed)return;const{params:t,slidesEl:s}=e,r="auto"===t.slidesPerView?e.slidesPerViewDynamic():t.slidesPerView;let a,n=e.getSlideIndexWhenGrid(e.clickedIndex);const i=e.isElement?"swiper-slide":`.${t.slideClass}`,l=e.grid&&e.params.grid&&e.params.grid.rows>1;if(t.loop){if(e.animating)return;a=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?e.slideToLoop(a):n>(l?(e.slides.length-r)/2-(e.params.grid.rows-1):e.slides.length-r)?(e.loopFix(),n=e.getSlideIndex(Is(s,`${i}[data-swiper-slide-index="${a}"]`)[0]),Ts(()=>{e.slideTo(n)})):e.slideTo(n)}else e.slideTo(n)}},loop:{loopCreate:function(e,t){const s=this,{params:r,slidesEl:a}=s;if(!r.loop||s.virtual&&s.params.virtual.enabled)return;const n=()=>{Is(a,`.${r.slideClass}, swiper-slide`).forEach((e,t)=>{e.setAttribute("data-swiper-slide-index",t)})},i=s.grid&&r.grid&&r.grid.rows>1;r.loopAddBlankSlides&&(r.slidesPerGroup>1||i)&&(()=>{const e=Is(a,`.${r.slideBlankClass}`);e.forEach(e=>{e.remove()}),e.length>0&&(s.recalcSlides(),s.updateSlides())})();const l=r.slidesPerGroup*(i?r.grid.rows:1),o=s.slides.length%l!==0,c=i&&s.slides.length%r.grid.rows!==0,d=e=>{for(let t=0;t<e;t+=1){const e=s.isElement?Fs("swiper-slide",[r.slideBlankClass]):Fs("div",[r.slideClass,r.slideBlankClass]);s.slidesEl.append(e)}};if(o){if(r.loopAddBlankSlides){d(l-s.slides.length%l),s.recalcSlides(),s.updateSlides()}else Ds();n()}else if(c){if(r.loopAddBlankSlides){d(r.grid.rows-s.slides.length%r.grid.rows),s.recalcSlides(),s.updateSlides()}else Ds();n()}else n();s.loopFix({slideRealIndex:e,direction:r.centeredSlides?void 0:"next",initial:t})},loopFix:function(e){let{slideRealIndex:t,slideTo:s=!0,direction:r,setTranslate:a,activeSlideIndex:n,initial:i,byController:l,byMousewheel:o}=void 0===e?{}:e;const c=this;if(!c.params.loop)return;c.emit("beforeLoopFix");const{slides:d,allowSlidePrev:u,allowSlideNext:m,slidesEl:h,params:x}=c,{centeredSlides:p,initialSlide:f}=x;if(c.allowSlidePrev=!0,c.allowSlideNext=!0,c.virtual&&x.virtual.enabled)return s&&(x.centeredSlides||0!==c.snapIndex?x.centeredSlides&&c.snapIndex<x.slidesPerView?c.slideTo(c.virtual.slides.length+c.snapIndex,0,!1,!0):c.snapIndex===c.snapGrid.length-1&&c.slideTo(c.virtual.slidesBefore,0,!1,!0):c.slideTo(c.virtual.slides.length,0,!1,!0)),c.allowSlidePrev=u,c.allowSlideNext=m,void c.emit("loopFix");let g=x.slidesPerView;"auto"===g?g=c.slidesPerViewDynamic():(g=Math.ceil(parseFloat(x.slidesPerView,10)),p&&g%2==0&&(g+=1));const b=x.slidesPerGroupAuto?g:x.slidesPerGroup;let v=p?Math.max(b,Math.ceil(g/2)):b;v%b!==0&&(v+=b-v%b),v+=x.loopAdditionalSlides,c.loopedSlides=v;const y=c.grid&&x.grid&&x.grid.rows>1;(d.length<g+v||"cards"===c.params.effect&&d.length<g+2*v||y&&"row"===x.grid.fill)&&Ds();const w=[],j=[],N=y?Math.ceil(d.length/x.grid.rows):d.length,_=i&&N-f<g&&!p;let k=_?f:c.activeIndex;void 0===n?n=c.getSlideIndex(d.find(e=>e.classList.contains(x.slideActiveClass))):k=n;const C="next"===r||!r,S="prev"===r||!r;let T=0,A=0;const E=(y?d[n].column:n)+(p&&void 0===a?-g/2+.5:0);if(E<v){T=Math.max(v-E,b);for(let e=0;e<v-E;e+=1){const t=e-Math.floor(e/N)*N;if(y){const e=N-t-1;for(let t=d.length-1;t>=0;t-=1)d[t].column===e&&w.push(t)}else w.push(N-t-1)}}else if(E+g>N-v){A=Math.max(E-(N-2*v),b),_&&(A=Math.max(A,g-N+f+1));for(let e=0;e<A;e+=1){const t=e-Math.floor(e/N)*N;y?d.forEach((e,s)=>{e.column===t&&j.push(s)}):j.push(t)}}if(c.__preventObserver__=!0,requestAnimationFrame(()=>{c.__preventObserver__=!1}),"cards"===c.params.effect&&d.length<g+2*v&&(j.includes(n)&&j.splice(j.indexOf(n),1),w.includes(n)&&w.splice(w.indexOf(n),1)),S&&w.forEach(e=>{d[e].swiperLoopMoveDOM=!0,h.prepend(d[e]),d[e].swiperLoopMoveDOM=!1}),C&&j.forEach(e=>{d[e].swiperLoopMoveDOM=!0,h.append(d[e]),d[e].swiperLoopMoveDOM=!1}),c.recalcSlides(),"auto"===x.slidesPerView?c.updateSlides():y&&(w.length>0&&S||j.length>0&&C)&&c.slides.forEach((e,t)=>{c.grid.updateSlide(t,e,c.slides)}),x.watchSlidesProgress&&c.updateSlidesOffset(),s)if(w.length>0&&S){if(void 0===t){const e=c.slidesGrid[k],t=c.slidesGrid[k+T]-e;o?c.setTranslate(c.translate-t):(c.slideTo(k+Math.ceil(T),0,!1,!0),a&&(c.touchEventsData.startTranslate=c.touchEventsData.startTranslate-t,c.touchEventsData.currentTranslate=c.touchEventsData.currentTranslate-t))}else if(a){const e=y?w.length/x.grid.rows:w.length;c.slideTo(c.activeIndex+e,0,!1,!0),c.touchEventsData.currentTranslate=c.translate}}else if(j.length>0&&C)if(void 0===t){const e=c.slidesGrid[k],t=c.slidesGrid[k-A]-e;o?c.setTranslate(c.translate-t):(c.slideTo(k-A,0,!1,!0),a&&(c.touchEventsData.startTranslate=c.touchEventsData.startTranslate-t,c.touchEventsData.currentTranslate=c.touchEventsData.currentTranslate-t))}else{const e=y?j.length/x.grid.rows:j.length;c.slideTo(c.activeIndex-e,0,!1,!0)}if(c.allowSlidePrev=u,c.allowSlideNext=m,c.controller&&c.controller.control&&!l){const e={slideRealIndex:t,direction:r,setTranslate:a,activeSlideIndex:n,byController:!0};Array.isArray(c.controller.control)?c.controller.control.forEach(t=>{!t.destroyed&&t.params.loop&&t.loopFix({...e,slideTo:t.params.slidesPerView===x.slidesPerView&&s})}):c.controller.control instanceof c.constructor&&c.controller.control.params.loop&&c.controller.control.loopFix({...e,slideTo:c.controller.control.params.slidesPerView===x.slidesPerView&&s})}c.emit("loopFix")},loopDestroy:function(){const e=this,{params:t,slidesEl:s}=e;if(!t.loop||!s||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const r=[];e.slides.forEach(e=>{const t=void 0===e.swiperSlideIndex?1*e.getAttribute("data-swiper-slide-index"):e.swiperSlideIndex;r[t]=e}),e.slides.forEach(e=>{e.removeAttribute("data-swiper-slide-index")}),r.forEach(e=>{s.append(e)}),e.recalcSlides(),e.slideTo(e.realIndex,0)}},grabCursor:{setGrabCursor:function(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const s="container"===t.params.touchEventsTarget?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),s.style.cursor="move",s.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame(()=>{t.__preventObserver__=!1})},unsetGrabCursor:function(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e["container"===e.params.touchEventsTarget?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1}))}},events:{attachEvents:function(){const e=this,{params:t}=e;e.onTouchStart=ar.bind(e),e.onTouchMove=nr.bind(e),e.onTouchEnd=ir.bind(e),e.onDocumentTouchStart=ur.bind(e),t.cssMode&&(e.onScroll=cr.bind(e)),e.onClick=or.bind(e),e.onLoad=dr.bind(e),mr(e,"on")},detachEvents:function(){mr(this,"off")}},breakpoints:{setBreakpoint:function(){const e=this,{realIndex:t,initialized:s,params:r,el:a}=e,n=r.breakpoints;if(!n||n&&0===Object.keys(n).length)return;const i=ks(),l="window"!==r.breakpointsBase&&r.breakpointsBase?"container":r.breakpointsBase,o=["window","container"].includes(r.breakpointsBase)||!r.breakpointsBase?e.el:i.querySelector(r.breakpointsBase),c=e.getBreakpoint(n,l,o);if(!c||e.currentBreakpoint===c)return;const d=(c in n?n[c]:void 0)||e.originalParams,u=hr(e,r),m=hr(e,d),h=e.params.grabCursor,x=d.grabCursor,p=r.enabled;u&&!m?(a.classList.remove(`${r.containerModifierClass}grid`,`${r.containerModifierClass}grid-column`),e.emitContainerClasses()):!u&&m&&(a.classList.add(`${r.containerModifierClass}grid`),(d.grid.fill&&"column"===d.grid.fill||!d.grid.fill&&"column"===r.grid.fill)&&a.classList.add(`${r.containerModifierClass}grid-column`),e.emitContainerClasses()),h&&!x?e.unsetGrabCursor():!h&&x&&e.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(t=>{if(void 0===d[t])return;const s=r[t]&&r[t].enabled,a=d[t]&&d[t].enabled;s&&!a&&e[t].disable(),!s&&a&&e[t].enable()});const f=d.direction&&d.direction!==r.direction,g=r.loop&&(d.slidesPerView!==r.slidesPerView||f),b=r.loop;f&&s&&e.changeDirection(),Ms(e.params,d);const v=e.params.enabled,y=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),p&&!v?e.disable():!p&&v&&e.enable(),e.currentBreakpoint=c,e.emit("_beforeBreakpoint",d),s&&(g?(e.loopDestroy(),e.loopCreate(t),e.updateSlides()):!b&&y?(e.loopCreate(t),e.updateSlides()):b&&!y&&e.loopDestroy()),e.emit("breakpoint",d)},getBreakpoint:function(e,t,s){if(void 0===t&&(t="window"),!e||"container"===t&&!s)return;let r=!1;const a=Ss(),n="window"===t?a.innerHeight:s.clientHeight,i=Object.keys(e).map(e=>{if("string"==typeof e&&0===e.indexOf("@")){const t=parseFloat(e.substr(1));return{value:n*t,point:e}}return{value:e,point:e}});i.sort((e,t)=>parseInt(e.value,10)-parseInt(t.value,10));for(let l=0;l<i.length;l+=1){const{point:e,value:n}=i[l];"window"===t?a.matchMedia(`(min-width: ${n}px)`).matches&&(r=e):n<=s.clientWidth&&(r=e)}return r||"max"}},checkOverflow:{checkOverflow:function(){const e=this,{isLocked:t,params:s}=e,{slidesOffsetBefore:r}=s;if(r){const t=e.slides.length-1,s=e.slidesGrid[t]+e.slidesSizesGrid[t]+2*r;e.isLocked=e.size>s}else e.isLocked=1===e.snapGrid.length;!0===s.allowSlideNext&&(e.allowSlideNext=!e.isLocked),!0===s.allowSlidePrev&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}},classes:{addClasses:function(){const e=this,{classNames:t,params:s,rtl:r,el:a,device:n}=e,i=function(e,t){const s=[];return e.forEach(e=>{"object"==typeof e?Object.keys(e).forEach(r=>{e[r]&&s.push(t+r)}):"string"==typeof e&&s.push(t+e)}),s}(["initialized",s.direction,{"free-mode":e.params.freeMode&&s.freeMode.enabled},{autoheight:s.autoHeight},{rtl:r},{grid:s.grid&&s.grid.rows>1},{"grid-column":s.grid&&s.grid.rows>1&&"column"===s.grid.fill},{android:n.android},{ios:n.ios},{"css-mode":s.cssMode},{centered:s.cssMode&&s.centeredSlides},{"watch-progress":s.watchSlidesProgress}],s.containerModifierClass);t.push(...i),a.classList.add(...t),e.emitContainerClasses()},removeClasses:function(){const{el:e,classNames:t}=this;e&&"string"!=typeof e&&(e.classList.remove(...t),this.emitContainerClasses())}}},gr={};let br=class e{constructor(){let t,s;for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];1===a.length&&a[0].constructor&&"Object"===Object.prototype.toString.call(a[0]).slice(8,-1)?s=a[0]:[t,s]=a,s||(s={}),s=Ms({},s),t&&!s.el&&(s.el=t);const i=ks();if(s.el&&"string"==typeof s.el&&i.querySelectorAll(s.el).length>1){const t=[];return i.querySelectorAll(s.el).forEach(r=>{const a=Ms({},s,{el:r});t.push(new e(a))}),t}const l=this;l.__swiper__=!0,l.support=Ys(),l.device=Ks({userAgent:s.userAgent}),l.browser=Xs(),l.eventsListeners={},l.eventsAnyListeners=[],l.modules=[...l.__modules__],s.modules&&Array.isArray(s.modules)&&l.modules.push(...s.modules);const o={};l.modules.forEach(e=>{e({params:s,swiper:l,extendParams:pr(s,o),on:l.on.bind(l),once:l.once.bind(l),off:l.off.bind(l),emit:l.emit.bind(l)})});const c=Ms({},xr,o);return l.params=Ms({},c,gr,s),l.originalParams=Ms({},l.params),l.passedParams=Ms({},s),l.params&&l.params.on&&Object.keys(l.params.on).forEach(e=>{l.on(e,l.params.on[e])}),l.params&&l.params.onAny&&l.onAny(l.params.onAny),Object.assign(l,{enabled:l.params.enabled,el:t,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal:()=>"horizontal"===l.params.direction,isVertical:()=>"vertical"===l.params.direction,activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:l.params.allowSlideNext,allowSlidePrev:l.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:l.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:l.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),l.emit("_swiper"),l.params.init&&l.init(),l}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:t,params:s}=this,r=$s(Is(t,`.${s.slideClass}, swiper-slide`)[0]);return $s(e)-r}getSlideIndexByData(e){return this.getSlideIndex(this.slides.find(t=>1*t.getAttribute("data-swiper-slide-index")===e))}getSlideIndexWhenGrid(e){return this.grid&&this.params.grid&&this.params.grid.rows>1&&("column"===this.params.grid.fill?e=Math.floor(e/this.params.grid.rows):"row"===this.params.grid.fill&&(e%=Math.ceil(this.slides.length/this.params.grid.rows))),e}recalcSlides(){const{slidesEl:e,params:t}=this;this.slides=Is(e,`.${t.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,t){const s=this;e=Math.min(Math.max(e,0),1);const r=s.minTranslate(),a=(s.maxTranslate()-r)*e+r;s.translateTo(a,void 0===t?0:t),s.updateActiveIndex(),s.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=e.el.className.split(" ").filter(t=>0===t.indexOf("swiper")||0===t.indexOf(e.params.containerModifierClass));e.emit("_containerClasses",t.join(" "))}getSlideClasses(e){const t=this;return t.destroyed?"":e.className.split(" ").filter(e=>0===e.indexOf("swiper-slide")||0===e.indexOf(t.params.slideClass)).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const t=[];e.slides.forEach(s=>{const r=e.getSlideClasses(s);t.push({slideEl:s,classNames:r}),e.emit("_slideClass",s,r)}),e.emit("_slideClasses",t)}slidesPerViewDynamic(e,t){void 0===e&&(e="current"),void 0===t&&(t=!1);const{params:s,slides:r,slidesGrid:a,slidesSizesGrid:n,size:i,activeIndex:l}=this;let o=1;if("number"==typeof s.slidesPerView)return s.slidesPerView;if(s.centeredSlides){let e,t=r[l]?Math.ceil(r[l].swiperSlideSize):0;for(let s=l+1;s<r.length;s+=1)r[s]&&!e&&(t+=Math.ceil(r[s].swiperSlideSize),o+=1,t>i&&(e=!0));for(let s=l-1;s>=0;s-=1)r[s]&&!e&&(t+=r[s].swiperSlideSize,o+=1,t>i&&(e=!0))}else if("current"===e)for(let c=l+1;c<r.length;c+=1){(t?a[c]+n[c]-a[l]<i:a[c]-a[l]<i)&&(o+=1)}else for(let c=l-1;c>=0;c-=1){a[l]-a[c]<i&&(o+=1)}return o}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:t,params:s}=e;function r(){const t=e.rtlTranslate?-1*e.translate:e.translate,s=Math.min(Math.max(t,e.maxTranslate()),e.minTranslate());e.setTranslate(s),e.updateActiveIndex(),e.updateSlidesClasses()}let a;if(s.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(t=>{t.complete&&Qs(e,t)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),s.freeMode&&s.freeMode.enabled&&!s.cssMode)r(),s.autoHeight&&e.updateAutoHeight();else{if(("auto"===s.slidesPerView||s.slidesPerView>1)&&e.isEnd&&!s.centeredSlides){const t=e.virtual&&s.virtual.enabled?e.virtual.slides:e.slides;a=e.slideTo(t.length-1,0,!1,!0)}else a=e.slideTo(e.activeIndex,0,!1,!0);a||r()}s.watchOverflow&&t!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,t){void 0===t&&(t=!0);const s=this,r=s.params.direction;return e||(e="horizontal"===r?"vertical":"horizontal"),e===r||"horizontal"!==e&&"vertical"!==e||(s.el.classList.remove(`${s.params.containerModifierClass}${r}`),s.el.classList.add(`${s.params.containerModifierClass}${e}`),s.emitContainerClasses(),s.params.direction=e,s.slides.forEach(t=>{"vertical"===e?t.style.width="":t.style.height=""}),s.emit("changeDirection"),t&&s.update()),s}changeLanguageDirection(e){const t=this;t.rtl&&"rtl"===e||!t.rtl&&"ltr"===e||(t.rtl="rtl"===e,t.rtlTranslate="horizontal"===t.params.direction&&t.rtl,t.rtl?(t.el.classList.add(`${t.params.containerModifierClass}rtl`),t.el.dir="rtl"):(t.el.classList.remove(`${t.params.containerModifierClass}rtl`),t.el.dir="ltr"),t.update())}mount(e){const t=this;if(t.mounted)return!0;let s=e||t.params.el;if("string"==typeof s&&(s=document.querySelector(s)),!s)return!1;s.swiper=t,s.parentNode&&s.parentNode.host&&s.parentNode.host.nodeName===t.params.swiperElementNodeName.toUpperCase()&&(t.isElement=!0);const r=()=>`.${(t.params.wrapperClass||"").trim().split(" ").join(".")}`;let a=(()=>{if(s&&s.shadowRoot&&s.shadowRoot.querySelector){return s.shadowRoot.querySelector(r())}return Is(s,r())[0]})();return!a&&t.params.createElements&&(a=Fs("div",t.params.wrapperClass),s.append(a),Is(s,`.${t.params.slideClass}`).forEach(e=>{a.append(e)})),Object.assign(t,{el:s,wrapperEl:a,slidesEl:t.isElement&&!s.parentNode.host.slideSlots?s.parentNode.host:a,hostEl:t.isElement?s.parentNode.host:s,mounted:!0,rtl:"rtl"===s.dir.toLowerCase()||"rtl"===Bs(s,"direction"),rtlTranslate:"horizontal"===t.params.direction&&("rtl"===s.dir.toLowerCase()||"rtl"===Bs(s,"direction")),wrongRTL:"-webkit-box"===Bs(a,"display")}),!0}init(e){const t=this;if(t.initialized)return t;if(!1===t.mount(e))return t;t.emit("beforeInit"),t.params.breakpoints&&t.setBreakpoint(),t.addClasses(),t.updateSize(),t.updateSlides(),t.params.watchOverflow&&t.checkOverflow(),t.params.grabCursor&&t.enabled&&t.setGrabCursor(),t.params.loop&&t.virtual&&t.params.virtual.enabled?t.slideTo(t.params.initialSlide+t.virtual.slidesBefore,0,t.params.runCallbacksOnInit,!1,!0):t.slideTo(t.params.initialSlide,0,t.params.runCallbacksOnInit,!1,!0),t.params.loop&&t.loopCreate(void 0,!0),t.attachEvents();const s=[...t.el.querySelectorAll('[loading="lazy"]')];return t.isElement&&s.push(...t.hostEl.querySelectorAll('[loading="lazy"]')),s.forEach(e=>{e.complete?Qs(t,e):e.addEventListener("load",e=>{Qs(t,e.target)})}),tr(t),t.initialized=!0,tr(t),t.emit("init"),t.emit("afterInit"),t}destroy(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);const s=this,{params:r,el:a,wrapperEl:n,slides:i}=s;return void 0===s.params||s.destroyed||(s.emit("beforeDestroy"),s.initialized=!1,s.detachEvents(),r.loop&&s.loopDestroy(),t&&(s.removeClasses(),a&&"string"!=typeof a&&a.removeAttribute("style"),n&&n.removeAttribute("style"),i&&i.length&&i.forEach(e=>{e.classList.remove(r.slideVisibleClass,r.slideFullyVisibleClass,r.slideActiveClass,r.slideNextClass,r.slidePrevClass),e.removeAttribute("style"),e.removeAttribute("data-swiper-slide-index")})),s.emit("destroy"),Object.keys(s.eventsListeners).forEach(e=>{s.off(e)}),!1!==e&&(s.el&&"string"!=typeof s.el&&(s.el.swiper=null),function(e){const t=e;Object.keys(t).forEach(e=>{try{t[e]=null}catch(s){}try{delete t[e]}catch(s){}})}(s)),s.destroyed=!0),null}static extendDefaults(e){Ms(gr,e)}static get extendedDefaults(){return gr}static get defaults(){return xr}static installModule(t){e.prototype.__modules__||(e.prototype.__modules__=[]);const s=e.prototype.__modules__;"function"==typeof t&&s.indexOf(t)<0&&s.push(t)}static use(t){return Array.isArray(t)?(t.forEach(t=>e.installModule(t)),e):(e.installModule(t),e)}};Object.keys(fr).forEach(e=>{Object.keys(fr[e]).forEach(t=>{br.prototype[t]=fr[e][t]})}),br.use([function(e){let{swiper:t,on:s,emit:r}=e;const a=Ss();let n=null,i=null;const l=()=>{t&&!t.destroyed&&t.initialized&&(r("beforeResize"),r("resize"))},o=()=>{t&&!t.destroyed&&t.initialized&&r("orientationchange")};s("init",()=>{t.params.resizeObserver&&void 0!==a.ResizeObserver?t&&!t.destroyed&&t.initialized&&(n=new ResizeObserver(e=>{i=a.requestAnimationFrame(()=>{const{width:s,height:r}=t;let a=s,n=r;e.forEach(e=>{let{contentBoxSize:s,contentRect:r,target:i}=e;i&&i!==t.el||(a=r?r.width:(s[0]||s).inlineSize,n=r?r.height:(s[0]||s).blockSize)}),a===s&&n===r||l()})}),n.observe(t.el)):(a.addEventListener("resize",l),a.addEventListener("orientationchange",o))}),s("destroy",()=>{i&&a.cancelAnimationFrame(i),n&&n.unobserve&&t.el&&(n.unobserve(t.el),n=null),a.removeEventListener("resize",l),a.removeEventListener("orientationchange",o)})},function(e){let{swiper:t,extendParams:s,on:r,emit:a}=e;const n=[],i=Ss(),l=function(e,s){void 0===s&&(s={});const r=new(i.MutationObserver||i.WebkitMutationObserver)(e=>{if(t.__preventObserver__)return;if(1===e.length)return void a("observerUpdate",e[0]);const s=function(){a("observerUpdate",e[0])};i.requestAnimationFrame?i.requestAnimationFrame(s):i.setTimeout(s,0)});r.observe(e,{attributes:void 0===s.attributes||s.attributes,childList:t.isElement||(void 0===s.childList||s).childList,characterData:void 0===s.characterData||s.characterData}),n.push(r)};s({observer:!1,observeParents:!1,observeSlideChildren:!1}),r("init",()=>{if(t.params.observer){if(t.params.observeParents){const e=zs(t.hostEl);for(let t=0;t<e.length;t+=1)l(e[t])}l(t.hostEl,{childList:t.params.observeSlideChildren}),l(t.wrapperEl,{attributes:!1})}}),r("destroy",()=>{n.forEach(e=>{e.disconnect()}),n.splice(0,n.length)})}]);const vr=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function yr(e){return"object"==typeof e&&null!==e&&e.constructor&&"Object"===Object.prototype.toString.call(e).slice(8,-1)&&!e.__swiper__}function wr(e,t){const s=["__proto__","constructor","prototype"];Object.keys(t).filter(e=>s.indexOf(e)<0).forEach(s=>{void 0===e[s]?e[s]=t[s]:yr(t[s])&&yr(e[s])&&Object.keys(t[s]).length>0?t[s].__swiper__?e[s]=t[s]:wr(e[s],t[s]):e[s]=t[s]})}function jr(e){return void 0===e&&(e={}),e.navigation&&void 0===e.navigation.nextEl&&void 0===e.navigation.prevEl}function Nr(e){return void 0===e&&(e={}),e.pagination&&void 0===e.pagination.el}function _r(e){return void 0===e&&(e={}),e.scrollbar&&void 0===e.scrollbar.el}function kr(e){void 0===e&&(e="");const t=e.split(" ").map(e=>e.trim()).filter(e=>!!e),s=[];return t.forEach(e=>{s.indexOf(e)<0&&s.push(e)}),s.join(" ")}function Cr(e){return void 0===e&&(e=""),e?e.includes("swiper-wrapper")?e:`swiper-wrapper ${e}`:"swiper-wrapper"}function Sr(){return Sr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},Sr.apply(this,arguments)}function Tr(e){return e.type&&e.type.displayName&&e.type.displayName.includes("SwiperSlide")}function Ar(e){const t=[];return s.Children.toArray(e).forEach(e=>{Tr(e)?t.push(e):e.props&&e.props.children&&Ar(e.props.children).forEach(e=>t.push(e))}),t}function Er(e){const t=[],r={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return s.Children.toArray(e).forEach(e=>{if(Tr(e))t.push(e);else if(e.props&&e.props.slot&&r[e.props.slot])r[e.props.slot].push(e);else if(e.props&&e.props.children){const s=Ar(e.props.children);s.length>0?s.forEach(e=>t.push(e)):r["container-end"].push(e)}else r["container-end"].push(e)}),{slides:t,slots:r}}function Rr(t,s){return"undefined"==typeof window?e.useEffect(t,s):e.useLayoutEffect(t,s)}const Pr=e.createContext(null),Mr=e.createContext(null),Lr=e.forwardRef(function(t,r){let{className:a,tag:n="div",wrapperTag:i="div",children:l,onSwiper:o,...c}=void 0===t?{}:t,d=!1;const[u,m]=e.useState("swiper"),[h,x]=e.useState(null),[p,f]=e.useState(!1),g=e.useRef(!1),b=e.useRef(null),v=e.useRef(null),y=e.useRef(null),w=e.useRef(null),j=e.useRef(null),N=e.useRef(null),_=e.useRef(null),k=e.useRef(null),{params:C,passedParams:S,rest:T,events:A}=function(e,t){void 0===e&&(e={}),void 0===t&&(t=!0);const s={on:{}},r={},a={};wr(s,xr),s._emitClasses=!0,s.init=!1;const n={},i=vr.map(e=>e.replace(/_/,"")),l=Object.assign({},e);return Object.keys(l).forEach(l=>{void 0!==e[l]&&(i.indexOf(l)>=0?yr(e[l])?(s[l]={},a[l]={},wr(s[l],e[l]),wr(a[l],e[l])):(s[l]=e[l],a[l]=e[l]):0===l.search(/on[A-Z]/)&&"function"==typeof e[l]?t?r[`${l[2].toLowerCase()}${l.substr(3)}`]=e[l]:s.on[`${l[2].toLowerCase()}${l.substr(3)}`]=e[l]:n[l]=e[l])}),["navigation","pagination","scrollbar"].forEach(e=>{!0===s[e]&&(s[e]={}),!1===s[e]&&delete s[e]}),{params:s,passedParams:a,rest:n,events:r}}(c),{slides:E,slots:R}=Er(l),P=()=>{f(!p)};Object.assign(C.on,{_containerClasses(e,t){m(t)}});const M=()=>{Object.assign(C.on,A),d=!0;const e={...C};if(delete e.wrapperClass,v.current=new br(e),v.current.virtual&&v.current.params.virtual.enabled){v.current.virtual.slides=E;const e={cache:!1,slides:E,renderExternal:x,renderExternalUpdate:!1};wr(v.current.params.virtual,e),wr(v.current.originalParams.virtual,e)}};b.current||M(),v.current&&v.current.on("_beforeBreakpoint",P);return e.useEffect(()=>()=>{v.current&&v.current.off("_beforeBreakpoint",P)}),e.useEffect(()=>{!g.current&&v.current&&(v.current.emitSlidesClasses(),g.current=!0)}),Rr(()=>{if(r&&(r.current=b.current),b.current)return v.current.destroyed&&M(),function(e,t){let{el:s,nextEl:r,prevEl:a,paginationEl:n,scrollbarEl:i,swiper:l}=e;jr(t)&&r&&a&&(l.params.navigation.nextEl=r,l.originalParams.navigation.nextEl=r,l.params.navigation.prevEl=a,l.originalParams.navigation.prevEl=a),Nr(t)&&n&&(l.params.pagination.el=n,l.originalParams.pagination.el=n),_r(t)&&i&&(l.params.scrollbar.el=i,l.originalParams.scrollbar.el=i),l.init(s)}({el:b.current,nextEl:j.current,prevEl:N.current,paginationEl:_.current,scrollbarEl:k.current,swiper:v.current},C),o&&!v.current.destroyed&&o(v.current),()=>{v.current&&!v.current.destroyed&&v.current.destroy(!0,!1)}},[]),Rr(()=>{!d&&A&&v.current&&Object.keys(A).forEach(e=>{v.current.on(e,A[e])});const e=function(e,t,s,r,a){const n=[];if(!t)return n;const i=e=>{n.indexOf(e)<0&&n.push(e)};if(s&&r){const e=r.map(a),t=s.map(a);e.join("")!==t.join("")&&i("children"),r.length!==s.length&&i("children")}return vr.filter(e=>"_"===e[0]).map(e=>e.replace(/_/,"")).forEach(s=>{if(s in e&&s in t)if(yr(e[s])&&yr(t[s])){const r=Object.keys(e[s]),a=Object.keys(t[s]);r.length!==a.length?i(s):(r.forEach(r=>{e[s][r]!==t[s][r]&&i(s)}),a.forEach(r=>{e[s][r]!==t[s][r]&&i(s)}))}else e[s]!==t[s]&&i(s)}),n}(S,y.current,E,w.current,e=>e.key);return y.current=S,w.current=E,e.length&&v.current&&!v.current.destroyed&&function(e){let{swiper:t,slides:s,passedParams:r,changedParams:a,nextEl:n,prevEl:i,scrollbarEl:l,paginationEl:o}=e;const c=a.filter(e=>"children"!==e&&"direction"!==e&&"wrapperClass"!==e),{params:d,pagination:u,navigation:m,scrollbar:h,virtual:x,thumbs:p}=t;let f,g,b,v,y,w,j,N;a.includes("thumbs")&&r.thumbs&&r.thumbs.swiper&&!r.thumbs.swiper.destroyed&&d.thumbs&&(!d.thumbs.swiper||d.thumbs.swiper.destroyed)&&(f=!0),a.includes("controller")&&r.controller&&r.controller.control&&d.controller&&!d.controller.control&&(g=!0),a.includes("pagination")&&r.pagination&&(r.pagination.el||o)&&(d.pagination||!1===d.pagination)&&u&&!u.el&&(b=!0),a.includes("scrollbar")&&r.scrollbar&&(r.scrollbar.el||l)&&(d.scrollbar||!1===d.scrollbar)&&h&&!h.el&&(v=!0),a.includes("navigation")&&r.navigation&&(r.navigation.prevEl||i)&&(r.navigation.nextEl||n)&&(d.navigation||!1===d.navigation)&&m&&!m.prevEl&&!m.nextEl&&(y=!0);const _=e=>{t[e]&&(t[e].destroy(),"navigation"===e?(t.isElement&&(t[e].prevEl.remove(),t[e].nextEl.remove()),d[e].prevEl=void 0,d[e].nextEl=void 0,t[e].prevEl=void 0,t[e].nextEl=void 0):(t.isElement&&t[e].el.remove(),d[e].el=void 0,t[e].el=void 0))};a.includes("loop")&&t.isElement&&(d.loop&&!r.loop?w=!0:!d.loop&&r.loop?j=!0:N=!0),c.forEach(e=>{if(yr(d[e])&&yr(r[e]))Object.assign(d[e],r[e]),"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e||!("enabled"in r[e])||r[e].enabled||_(e);else{const t=r[e];!0!==t&&!1!==t||"navigation"!==e&&"pagination"!==e&&"scrollbar"!==e?d[e]=r[e]:!1===t&&_(e)}}),c.includes("controller")&&!g&&t.controller&&t.controller.control&&d.controller&&d.controller.control&&(t.controller.control=d.controller.control),a.includes("children")&&s&&x&&d.virtual.enabled?(x.slides=s,x.update(!0)):a.includes("virtual")&&x&&d.virtual.enabled&&(s&&(x.slides=s),x.update(!0)),a.includes("children")&&s&&d.loop&&(N=!0),f&&p.init()&&p.update(!0);g&&(t.controller.control=d.controller.control),b&&(!t.isElement||o&&"string"!=typeof o||(o=document.createElement("div"),o.classList.add("swiper-pagination"),o.part.add("pagination"),t.el.appendChild(o)),o&&(d.pagination.el=o),u.init(),u.render(),u.update()),v&&(!t.isElement||l&&"string"!=typeof l||(l=document.createElement("div"),l.classList.add("swiper-scrollbar"),l.part.add("scrollbar"),t.el.appendChild(l)),l&&(d.scrollbar.el=l),h.init(),h.updateSize(),h.setTranslate()),y&&(t.isElement&&(n&&"string"!=typeof n||(n=document.createElement("div"),n.classList.add("swiper-button-next"),Ws(n,t.hostEl.constructor.nextButtonSvg),n.part.add("button-next"),t.el.appendChild(n)),i&&"string"!=typeof i||(i=document.createElement("div"),i.classList.add("swiper-button-prev"),Ws(i,t.hostEl.constructor.prevButtonSvg),i.part.add("button-prev"),t.el.appendChild(i))),n&&(d.navigation.nextEl=n),i&&(d.navigation.prevEl=i),m.init(),m.update()),a.includes("allowSlideNext")&&(t.allowSlideNext=r.allowSlideNext),a.includes("allowSlidePrev")&&(t.allowSlidePrev=r.allowSlidePrev),a.includes("direction")&&t.changeDirection(r.direction,!1),(w||N)&&t.loopDestroy(),(j||N)&&t.loopCreate(),t.update()}({swiper:v.current,slides:E,passedParams:S,changedParams:e,nextEl:j.current,prevEl:N.current,scrollbarEl:k.current,paginationEl:_.current}),()=>{A&&v.current&&Object.keys(A).forEach(e=>{v.current.off(e,A[e])})}}),Rr(()=>{var e;!(e=v.current)||e.destroyed||!e.params.virtual||e.params.virtual&&!e.params.virtual.enabled||(e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.emit("_virtualUpdated"),e.parallax&&e.params.parallax&&e.params.parallax.enabled&&e.parallax.setTranslate())},[h]),s.createElement(n,Sr({ref:b,className:kr(`${u}${a?` ${a}`:""}`)},T),s.createElement(Mr.Provider,{value:v.current},R["container-start"],s.createElement(i,{className:Cr(C.wrapperClass)},R["wrapper-start"],C.virtual?function(e,t,r){if(!r)return null;const a=e=>{let s=e;return e<0?s=t.length+e:s>=t.length&&(s-=t.length),s},n=e.isHorizontal()?{[e.rtlTranslate?"right":"left"]:`${r.offset}px`}:{top:`${r.offset}px`},{from:i,to:l}=r,o=e.params.loop?-t.length:0,c=e.params.loop?2*t.length:t.length,d=[];for(let s=o;s<c;s+=1)s>=i&&s<=l&&d.push(t[a(s)]);return d.map((t,r)=>s.cloneElement(t,{swiper:e,style:n,key:t.props.virtualIndex||t.key||`slide-${r}`}))}(v.current,E,h):E.map((e,t)=>s.cloneElement(e,{swiper:v.current,swiperSlideIndex:t})),R["wrapper-end"]),jr(C)&&s.createElement(s.Fragment,null,s.createElement("div",{ref:N,className:"swiper-button-prev"}),s.createElement("div",{ref:j,className:"swiper-button-next"})),_r(C)&&s.createElement("div",{ref:k,className:"swiper-scrollbar"}),Nr(C)&&s.createElement("div",{ref:_,className:"swiper-pagination"}),R["container-end"]))});Lr.displayName="Swiper";const Or=e.forwardRef(function(t,r){let{tag:a="div",children:n,className:i="",swiper:l,zoom:o,lazy:c,virtualIndex:d,swiperSlideIndex:u,...m}=void 0===t?{}:t;const h=e.useRef(null),[x,p]=e.useState("swiper-slide"),[f,g]=e.useState(!1);function b(e,t,s){t===h.current&&p(s)}Rr(()=>{if(void 0!==u&&(h.current.swiperSlideIndex=u),r&&(r.current=h.current),h.current&&l){if(!l.destroyed)return l.on("_slideClass",b),()=>{l&&l.off("_slideClass",b)};"swiper-slide"!==x&&p("swiper-slide")}}),Rr(()=>{l&&h.current&&!l.destroyed&&p(l.getSlideClasses(h.current))},[l]);const v={isActive:x.indexOf("swiper-slide-active")>=0,isVisible:x.indexOf("swiper-slide-visible")>=0,isPrev:x.indexOf("swiper-slide-prev")>=0,isNext:x.indexOf("swiper-slide-next")>=0},y=()=>"function"==typeof n?n(v):n;return s.createElement(a,Sr({ref:h,className:kr(`${x}${i?` ${i}`:""}`),"data-swiper-slide-index":d,onLoad:()=>{g(!0)}},m),o&&s.createElement(Pr.Provider,{value:v},s.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":"number"==typeof o?o:void 0},y(),c&&!f&&s.createElement("div",{className:"swiper-lazy-preloader"}))),!o&&s.createElement(Pr.Provider,{value:v},y(),c&&!f&&s.createElement("div",{className:"swiper-lazy-preloader"})))});function Ir(e){return void 0===e&&(e=""),`.${e.trim().replace(/([\.:!+\/()[\]])/g,"\\$1").replace(/ /g,".")}`}function Dr(e){let{swiper:t,extendParams:s,on:r,emit:a}=e;const n="swiper-pagination";let i;s({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:e=>e,formatFractionTotal:e=>e,bulletClass:`${n}-bullet`,bulletActiveClass:`${n}-bullet-active`,modifierClass:`${n}-`,currentClass:`${n}-current`,totalClass:`${n}-total`,hiddenClass:`${n}-hidden`,progressbarFillClass:`${n}-progressbar-fill`,progressbarOppositeClass:`${n}-progressbar-opposite`,clickableClass:`${n}-clickable`,lockClass:`${n}-lock`,horizontalClass:`${n}-horizontal`,verticalClass:`${n}-vertical`,paginationDisabledClass:`${n}-disabled`}}),t.pagination={el:null,bullets:[]};let l=0;function o(){return!t.params.pagination.el||!t.pagination.el||Array.isArray(t.pagination.el)&&0===t.pagination.el.length}function c(e,s){const{bulletActiveClass:r}=t.params.pagination;e&&(e=e[("prev"===s?"previous":"next")+"ElementSibling"])&&(e.classList.add(`${r}-${s}`),(e=e[("prev"===s?"previous":"next")+"ElementSibling"])&&e.classList.add(`${r}-${s}-${s}`))}function d(e){const s=e.target.closest(Ir(t.params.pagination.bulletClass));if(!s)return;e.preventDefault();const r=$s(s)*t.params.slidesPerGroup;if(t.params.loop){if(t.realIndex===r)return;const e=(a=t.realIndex,n=r,i=t.slides.length,(n%=i)===1+(a%=i)?"next":n===a-1?"previous":void 0);"next"===e?t.slideNext():"previous"===e?t.slidePrev():t.slideToLoop(r)}else t.slideTo(r);var a,n,i}function u(){const e=t.rtl,s=t.params.pagination;if(o())return;let r,n,d=t.pagination.el;d=Us(d);const u=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.slides.length,m=t.params.loop?Math.ceil(u/t.params.slidesPerGroup):t.snapGrid.length;if(t.params.loop?(n=t.previousRealIndex||0,r=t.params.slidesPerGroup>1?Math.floor(t.realIndex/t.params.slidesPerGroup):t.realIndex):void 0!==t.snapIndex?(r=t.snapIndex,n=t.previousSnapIndex):(n=t.previousIndex||0,r=t.activeIndex||0),"bullets"===s.type&&t.pagination.bullets&&t.pagination.bullets.length>0){const a=t.pagination.bullets;let o,u,m;if(s.dynamicBullets&&(i=Vs(a[0],t.isHorizontal()?"width":"height"),d.forEach(e=>{e.style[t.isHorizontal()?"width":"height"]=i*(s.dynamicMainBullets+4)+"px"}),s.dynamicMainBullets>1&&void 0!==n&&(l+=r-(n||0),l>s.dynamicMainBullets-1?l=s.dynamicMainBullets-1:l<0&&(l=0)),o=Math.max(r-l,0),u=o+(Math.min(a.length,s.dynamicMainBullets)-1),m=(u+o)/2),a.forEach(e=>{const t=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(e=>`${s.bulletActiveClass}${e}`)].map(e=>"string"==typeof e&&e.includes(" ")?e.split(" "):e).flat();e.classList.remove(...t)}),d.length>1)a.forEach(e=>{const a=$s(e);a===r?e.classList.add(...s.bulletActiveClass.split(" ")):t.isElement&&e.setAttribute("part","bullet"),s.dynamicBullets&&(a>=o&&a<=u&&e.classList.add(...`${s.bulletActiveClass}-main`.split(" ")),a===o&&c(e,"prev"),a===u&&c(e,"next"))});else{const e=a[r];if(e&&e.classList.add(...s.bulletActiveClass.split(" ")),t.isElement&&a.forEach((e,t)=>{e.setAttribute("part",t===r?"bullet-active":"bullet")}),s.dynamicBullets){const e=a[o],t=a[u];for(let r=o;r<=u;r+=1)a[r]&&a[r].classList.add(...`${s.bulletActiveClass}-main`.split(" "));c(e,"prev"),c(t,"next")}}if(s.dynamicBullets){const r=Math.min(a.length,s.dynamicMainBullets+4),n=(i*r-i)/2-m*i,l=e?"right":"left";a.forEach(e=>{e.style[t.isHorizontal()?l:"top"]=`${n}px`})}}d.forEach((e,n)=>{if("fraction"===s.type&&(e.querySelectorAll(Ir(s.currentClass)).forEach(e=>{e.textContent=s.formatFractionCurrent(r+1)}),e.querySelectorAll(Ir(s.totalClass)).forEach(e=>{e.textContent=s.formatFractionTotal(m)})),"progressbar"===s.type){let a;a=s.progressbarOpposite?t.isHorizontal()?"vertical":"horizontal":t.isHorizontal()?"horizontal":"vertical";const n=(r+1)/m;let i=1,l=1;"horizontal"===a?i=n:l=n,e.querySelectorAll(Ir(s.progressbarFillClass)).forEach(e=>{e.style.transform=`translate3d(0,0,0) scaleX(${i}) scaleY(${l})`,e.style.transitionDuration=`${t.params.speed}ms`})}"custom"===s.type&&s.renderCustom?(Ws(e,s.renderCustom(t,r+1,m)),0===n&&a("paginationRender",e)):(0===n&&a("paginationRender",e),a("paginationUpdate",e)),t.params.watchOverflow&&t.enabled&&e.classList[t.isLocked?"add":"remove"](s.lockClass)})}function m(){const e=t.params.pagination;if(o())return;const s=t.virtual&&t.params.virtual.enabled?t.virtual.slides.length:t.grid&&t.params.grid.rows>1?t.slides.length/Math.ceil(t.params.grid.rows):t.slides.length;let r=t.pagination.el;r=Us(r);let n="";if("bullets"===e.type){let r=t.params.loop?Math.ceil(s/t.params.slidesPerGroup):t.snapGrid.length;t.params.freeMode&&t.params.freeMode.enabled&&r>s&&(r=s);for(let s=0;s<r;s+=1)e.renderBullet?n+=e.renderBullet.call(t,s,e.bulletClass):n+=`<${e.bulletElement} ${t.isElement?'part="bullet"':""} class="${e.bulletClass}"></${e.bulletElement}>`}"fraction"===e.type&&(n=e.renderFraction?e.renderFraction.call(t,e.currentClass,e.totalClass):`<span class="${e.currentClass}"></span> / <span class="${e.totalClass}"></span>`),"progressbar"===e.type&&(n=e.renderProgressbar?e.renderProgressbar.call(t,e.progressbarFillClass):`<span class="${e.progressbarFillClass}"></span>`),t.pagination.bullets=[],r.forEach(s=>{"custom"!==e.type&&Ws(s,n||""),"bullets"===e.type&&t.pagination.bullets.push(...s.querySelectorAll(Ir(e.bulletClass)))}),"custom"!==e.type&&a("paginationRender",r[0])}function h(){t.params.pagination=function(e,t,s,r){return e.params.createElements&&Object.keys(r).forEach(a=>{if(!s[a]&&!0===s.auto){let n=Is(e.el,`.${r[a]}`)[0];n||(n=Fs("div",r[a]),n.className=r[a],e.el.append(n)),s[a]=n,t[a]=n}}),s}(t,t.originalParams.pagination,t.params.pagination,{el:"swiper-pagination"});const e=t.params.pagination;if(!e.el)return;let s;"string"==typeof e.el&&t.isElement&&(s=t.el.querySelector(e.el)),s||"string"!=typeof e.el||(s=[...document.querySelectorAll(e.el)]),s||(s=e.el),s&&0!==s.length&&(t.params.uniqueNavElements&&"string"==typeof e.el&&Array.isArray(s)&&s.length>1&&(s=[...t.el.querySelectorAll(e.el)],s.length>1&&(s=s.find(e=>zs(e,".swiper")[0]===t.el))),Array.isArray(s)&&1===s.length&&(s=s[0]),Object.assign(t.pagination,{el:s}),s=Us(s),s.forEach(s=>{"bullets"===e.type&&e.clickable&&s.classList.add(...(e.clickableClass||"").split(" ")),s.classList.add(e.modifierClass+e.type),s.classList.add(t.isHorizontal()?e.horizontalClass:e.verticalClass),"bullets"===e.type&&e.dynamicBullets&&(s.classList.add(`${e.modifierClass}${e.type}-dynamic`),l=0,e.dynamicMainBullets<1&&(e.dynamicMainBullets=1)),"progressbar"===e.type&&e.progressbarOpposite&&s.classList.add(e.progressbarOppositeClass),e.clickable&&s.addEventListener("click",d),t.enabled||s.classList.add(e.lockClass)}))}function x(){const e=t.params.pagination;if(o())return;let s=t.pagination.el;s&&(s=Us(s),s.forEach(s=>{s.classList.remove(e.hiddenClass),s.classList.remove(e.modifierClass+e.type),s.classList.remove(t.isHorizontal()?e.horizontalClass:e.verticalClass),e.clickable&&(s.classList.remove(...(e.clickableClass||"").split(" ")),s.removeEventListener("click",d))})),t.pagination.bullets&&t.pagination.bullets.forEach(t=>t.classList.remove(...e.bulletActiveClass.split(" ")))}r("changeDirection",()=>{if(!t.pagination||!t.pagination.el)return;const e=t.params.pagination;let{el:s}=t.pagination;s=Us(s),s.forEach(s=>{s.classList.remove(e.horizontalClass,e.verticalClass),s.classList.add(t.isHorizontal()?e.horizontalClass:e.verticalClass)})}),r("init",()=>{!1===t.params.pagination.enabled?p():(h(),m(),u())}),r("activeIndexChange",()=>{void 0===t.snapIndex&&u()}),r("snapIndexChange",()=>{u()}),r("snapGridLengthChange",()=>{m(),u()}),r("destroy",()=>{x()}),r("enable disable",()=>{let{el:e}=t.pagination;e&&(e=Us(e),e.forEach(e=>e.classList[t.enabled?"remove":"add"](t.params.pagination.lockClass)))}),r("lock unlock",()=>{u()}),r("click",(e,s)=>{const r=s.target,n=Us(t.pagination.el);if(t.params.pagination.el&&t.params.pagination.hideOnClick&&n&&n.length>0&&!r.classList.contains(t.params.pagination.bulletClass)){if(t.navigation&&(t.navigation.nextEl&&r===t.navigation.nextEl||t.navigation.prevEl&&r===t.navigation.prevEl))return;const e=n[0].classList.contains(t.params.pagination.hiddenClass);a(!0===e?"paginationShow":"paginationHide"),n.forEach(e=>e.classList.toggle(t.params.pagination.hiddenClass))}});const p=()=>{t.el.classList.add(t.params.pagination.paginationDisabledClass);let{el:e}=t.pagination;e&&(e=Us(e),e.forEach(e=>e.classList.add(t.params.pagination.paginationDisabledClass))),x()};Object.assign(t.pagination,{enable:()=>{t.el.classList.remove(t.params.pagination.paginationDisabledClass);let{el:e}=t.pagination;e&&(e=Us(e),e.forEach(e=>e.classList.remove(t.params.pagination.paginationDisabledClass))),h(),m(),u()},disable:p,render:m,update:u,init:h,destroy:x})}Or.displayName="SwiperSlide";const Fr=({metrics:e})=>{const t={blue:"bg-gray-300",green:"bg-gray-300",purple:"bg-gray-300",orange:"bg-gray-300",red:"bg-gray-300"},s=({title:e,value:s,icon:r,growth:a,format:n="number",color:i="blue",onToggle:l,toggleLabel:o})=>$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100 transition-shadow "+(l?"cursor-pointer hover:shadow-xl":"hover:shadow-xl"),onClick:l,children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("div",{className:`p-2.5 rounded-lg ${t[i]} text-gray-700`,children:$e.jsx(r,{className:"w-5 h-5"})}),void 0!==a&&0!==a&&$e.jsxs("div",{className:"flex items-center gap-1",children:[a>0?$e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l9.2-9.2M17 17V7H7"})}):a<0?$e.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 7l-9.2 9.2M7 7v10h10"})}):null,$e.jsxs("span",{className:"text-sm font-medium "+(a>0?"text-green-600":a<0?"text-red-600":"text-gray-500"),children:[a>0?"+":"",a.toFixed(1),"%"]})]})]}),$e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:e}),$e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{switch(n){case"currency":return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(s);case"percentage":return`${s.toFixed(2)}%`;default:return new Intl.NumberFormat("pt-BR").format(s)}})()}),l&&$e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"Clique para alternar"})]})]});return $e.jsxs("div",{className:"md:hidden",children:[$e.jsx(Lr,{modules:[Dr],spaceBetween:16,slidesPerView:1.8,centeredSlides:!0,pagination:{clickable:!0,dynamicBullets:!0},className:"metrics-swiper",children:e.map((e,t)=>$e.jsx(Or,{children:$e.jsx(s,{...e})},t))}),$e.jsx("style",{children:"\n        .metrics-swiper {\n          padding-bottom: 40px;\n        }\n        .metrics-swiper .swiper-pagination {\n          bottom: 0;\n        }\n        .metrics-swiper .swiper-pagination-bullet {\n          background: #d1d5db;\n          opacity: 0.5;\n        }\n        .metrics-swiper .swiper-pagination-bullet-active {\n          background: #6b7280;\n          opacity: 1;\n        }\n\n      "})]})},Br=({selectedTable:t,startDate:s,endDate:a,attributionModel:n="Último Clique Não Direto",hideClientName:i=!1})=>{const[l,o]=e.useState([]),[c,d]=e.useState(!0),[u,m]=e.useState(null),[h,x]=e.useState({"Visualizações (absoluto)":!1,"Carrinho (absoluto)":!1,"Checkout (absoluto)":!1,"Frete (absoluto)":!1,"Pagamento (absoluto)":!1,"Pedidos (absoluto)":!1,"Visualização → Carrinho":!1,"Carrinho → Checkout":!1,"Checkout → Frete":!1,"Frete → Pagamento":!1,"Pagamento → Pedido":!1,"Checkout → Pedido":!1,"Visualização → Pedido":!0}),[p,g]=e.useState(!1),b=async(e,t,s=!1)=>{try{return await ls.getFunnelData(e,t)}catch(r){if(r instanceof Error&&(r.message.includes("timeout")||r.message.includes("Timeout")||r.message.includes("demorou muito tempo"))&&!s)return await new Promise(e=>setTimeout(e,5e3)),await b(e,t,!0);throw r}};e.useEffect(()=>{(async()=>{try{d(!0),m(null);const e=localStorage.getItem("auth-token");if(!e)return void m("Token de autenticação não encontrado");if(!is(t))return;const r={start_date:s,end_date:a,table_name:t,attribution_model:n},i=await b(e,r);o(i.data||[])}catch(e){m(e instanceof Error?e.message:"Erro ao carregar dados do funil")}finally{d(!1)}})()},[t,s,a,n]);const w=l.reduce((e,t)=>({visualizacoes:e.visualizacoes+t.Visualizacao_de_Item,adicoesCarrinho:e.adicoesCarrinho+t.Adicionar_ao_Carrinho,iniciarCheckout:e.iniciarCheckout+t.Iniciar_Checkout,adicionarFrete:e.adicionarFrete+t.Adicionar_Informacao_de_Frete,adicionarPagamento:e.adicionarPagamento+t.Adicionar_Informacao_de_Pagamento,pedidos:e.pedidos+t.Pedido}),{visualizacoes:0,adicoesCarrinho:0,iniciarCheckout:0,adicionarFrete:0,adicionarPagamento:0,pedidos:0}),j={visualizacaoParaCarrinho:w.visualizacoes>0?w.adicoesCarrinho/w.visualizacoes*100:0,carrinhoParaCheckout:w.adicoesCarrinho>0?w.iniciarCheckout/w.adicoesCarrinho*100:0,checkoutParaFrete:w.iniciarCheckout>0?w.adicionarFrete/w.iniciarCheckout*100:0,freteParaPagamento:w.adicionarFrete>0?w.adicionarPagamento/w.adicionarFrete*100:0,pagamentoParaPedido:w.adicionarPagamento>0?w.pedidos/w.adicionarPagamento*100:0,visualizacaoParaPedido:w.visualizacoes>0?w.pedidos/w.visualizacoes*100:0},N=e=>new Intl.NumberFormat("pt-BR").format(e),k=e=>`${e.toFixed(2)}%`,C=Math.max(w.visualizacoes,w.adicoesCarrinho,w.iniciarCheckout,w.adicionarFrete,w.adicionarPagamento,w.pedidos),S=e=>C>0?e/C*100:0,T=l.map(e=>{const t=e.Visualizacao_de_Item>0?e.Adicionar_ao_Carrinho/e.Visualizacao_de_Item*100:0,s=e.Adicionar_ao_Carrinho>0?e.Iniciar_Checkout/e.Adicionar_ao_Carrinho*100:0,r=e.Iniciar_Checkout>0?e.Adicionar_Informacao_de_Frete/e.Iniciar_Checkout*100:0,a=e.Adicionar_Informacao_de_Frete>0?e.Adicionar_Informacao_de_Pagamento/e.Adicionar_Informacao_de_Frete*100:0,n=e.Adicionar_Informacao_de_Pagamento>0?e.Pedido/e.Adicionar_Informacao_de_Pagamento*100:0,i=e.Iniciar_Checkout>0?e.Pedido/e.Iniciar_Checkout*100:0,l=e.Visualizacao_de_Item>0?e.Pedido/e.Visualizacao_de_Item*100:0;return{data:(o=e.Data,new Date(o).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})),"Visualizações (absoluto)":e.Visualizacao_de_Item,"Carrinho (absoluto)":e.Adicionar_ao_Carrinho,"Checkout (absoluto)":e.Iniciar_Checkout,"Frete (absoluto)":e.Adicionar_Informacao_de_Frete,"Pagamento (absoluto)":e.Adicionar_Informacao_de_Pagamento,"Pedidos (absoluto)":e.Pedido,"Visualização → Carrinho":parseFloat(t.toFixed(2)),"Carrinho → Checkout":parseFloat(s.toFixed(2)),"Checkout → Frete":parseFloat(r.toFixed(2)),"Frete → Pagamento":parseFloat(a.toFixed(2)),"Pagamento → Pedido":parseFloat(n.toFixed(2)),"Checkout → Pedido":parseFloat(i.toFixed(2)),"Visualização → Pedido":parseFloat(l.toFixed(2))};var o}),A=[{name:"Visualizações de Página de Produto",value:w.visualizacoes,percentage:100,funnelWidth:S(w.visualizacoes),color:"from-blue-400 to-blue-500",bgColor:"bg-blue-50",iconColor:"text-blue-600",icon:E},{name:"Adicionar ao Carrinho",value:w.adicoesCarrinho,percentage:j.visualizacaoParaCarrinho,funnelWidth:S(w.adicoesCarrinho),color:"from-blue-500 to-blue-600",bgColor:"bg-blue-50",iconColor:"text-blue-600",icon:f},{name:"Iniciar Checkout",value:w.iniciarCheckout,percentage:j.carrinhoParaCheckout,funnelWidth:S(w.iniciarCheckout),color:"from-blue-600 to-blue-700",bgColor:"bg-blue-50",iconColor:"text-blue-600",icon:P},{name:"Adicionar Informações de Frete",value:w.adicionarFrete,percentage:j.checkoutParaFrete,funnelWidth:S(w.adicionarFrete),color:"from-blue-700 to-blue-800",bgColor:"bg-blue-50",iconColor:"text-blue-600",icon:v},{name:"Adicionar Informações de Pagamento",value:w.adicionarPagamento,percentage:j.pagamentoParaPedido,funnelWidth:S(w.adicionarPagamento),color:"from-slate-600 to-slate-700",bgColor:"bg-slate-50",iconColor:"text-slate-600",icon:M},{name:"Pedidos",value:w.pedidos,percentage:j.visualizacaoParaPedido,funnelWidth:S(w.pedidos),color:"from-slate-800 to-slate-900",bgColor:"bg-slate-50",iconColor:"text-slate-600",icon:r}];if(c)return $e.jsx("div",{className:"space-y-6",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando dados do funil..."})]})});if(u)return $e.jsx("div",{className:"space-y-6",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(M,{className:"w-8 h-8 text-red-600"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar dados"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:u})]})});if(0===l.length)return $e.jsx("div",{className:"space-y-6",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(y,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsxs("p",{className:"text-gray-600 mb-4",children:["Não foram encontrados dados para a tabela ",$e.jsx("strong",{children:i?"Cliente Selecionado":t})," no período selecionado."]})]})});const R=(()=>{const e={};return Object.keys(h).filter(e=>h[e]).forEach(t=>{const s=T.map(e=>e[t]).filter(e=>"number"==typeof e),r=s.reduce((e,t)=>e+t,0)/(s.length||1),a=Math.sqrt(s.reduce((e,t)=>e+Math.pow(t-r,2),0)/(s.length||1));e[t]={mean:r,std:a}}),e})(),O=(e,t)=>s=>{const r="number"==typeof s.cx?s.cx:0,a="number"==typeof s.cy?s.cy:0,n="number"==typeof s.value?s.value:0,{mean:i,std:l}=R[e]||{mean:0,std:1};return n>i+2*l?$e.jsx("circle",{cx:r,cy:a,r:7,fill:"#60a5fa",stroke:t,strokeWidth:2}):n<i-2*l?$e.jsx("circle",{cx:r,cy:a,r:7,fill:"#64748b",stroke:t,strokeWidth:2}):$e.jsx("circle",{cx:r,cy:a,r:4,fill:t,strokeWidth:2})};return $e.jsxs("div",{className:"space-y-6",children:[$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsx("div",{className:"flex items-center justify-between mb-4",children:$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Funil de Conversão"})}),$e.jsx("div",{className:"flex flex-col items-center space-y-3",children:A.map((e,t)=>{const s=t===A.length-1;return $e.jsxs("div",{className:"w-full max-w-4xl",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:`w-8 h-8 ${e.bgColor} rounded-lg flex items-center justify-center`,children:$e.jsx(e.icon,{className:`w-4 h-4 ${e.iconColor}`})}),$e.jsxs("div",{children:[$e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:e.name}),$e.jsxs("p",{className:"text-xs text-gray-500",children:["Etapa ",t+1," de ",A.length]})]})]}),$e.jsxs("div",{className:"text-right",children:[$e.jsx("div",{className:"text-xl font-bold text-gray-900",children:N(e.value)}),$e.jsx("div",{className:"text-xs text-gray-500",children:k(e.percentage)})]})]}),$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"w-full bg-gray-100 rounded-xl h-12 overflow-hidden",children:$e.jsx("div",{className:`h-full bg-gradient-to-r ${e.color} rounded-xl flex items-center justify-center transition-all duration-1000 ease-out`,style:{width:`${e.funnelWidth}%`,minWidth:"40px"},children:$e.jsx("span",{className:"text-white font-bold text-sm px-2",children:N(e.value)})})}),!s&&$e.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2",children:$e.jsxs("div",{className:"flex items-center gap-1 text-red-500",children:[$e.jsx(L,{className:"w-3 h-3"}),$e.jsxs("span",{className:"text-xs font-medium",children:[k(100-e.percentage)," perdidos"]})]})})]}),!s&&$e.jsx("div",{className:"flex justify-center mt-6",children:$e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-gray-300 to-gray-100 rounded-full"})})]},t)})}),$e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-slate-50 rounded-xl",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Taxa de Conversão Geral"}),$e.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-slate-600 bg-clip-text text-transparent",children:k(j.visualizacaoParaPedido)}),$e.jsxs("p",{className:"text-gray-600 text-xs mt-1",children:[N(w.pedidos)," pedidos de ",N(w.visualizacoes)," visualizações"]})]})})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsx("div",{className:"flex items-center justify-between mb-6",children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:$e.jsx(_,{className:"w-4 h-4 text-blue-600"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Timeline das Taxas de Conversão"})]})}),$e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-r from-slate-50 to-blue-50 rounded-xl border border-slate-100",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Selecionar Métricas para Comparar"]}),$e.jsx("button",{onClick:()=>g(!p),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(p?"bg-green-100 text-green-700 border-2 border-green-300":"bg-blue-100 text-blue-700 border-2 border-blue-300"),children:p?"📊 Valores Absolutos":"📈 Taxas de Conversão"})]}),$e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(h).filter(e=>p?e.includes("(absoluto)"):!e.includes("(absoluto)")).map(e=>{const t=h[e];return $e.jsxs("button",{onClick:()=>(e=>{x(t=>({...t,[e]:!t[e]}))})(e),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(t?p?"bg-green-100 text-green-700 border-2 border-green-300":"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"),children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:(e=>{switch(e){case"Visualizações (absoluto)":case"Visualização → Carrinho":return"#3b82f6";case"Carrinho (absoluto)":case"Carrinho → Checkout":return"#1d4ed8";case"Checkout (absoluto)":case"Checkout → Frete":return"#6366f1";case"Frete (absoluto)":case"Frete → Pagamento":return"#475569";case"Pagamento (absoluto)":case"Pagamento → Pedido":return"#1e40af";case"Pedidos (absoluto)":case"Visualização → Pedido":return"#0f172a";case"Checkout → Pedido":return"#334155";default:return"#6b7280"}})(e)}}),$e.jsx("span",{children:e})]},e)})}),$e.jsx("p",{className:"text-xs text-gray-600 mt-3",children:p?"Clique nas métricas para selecionar/deselecionar. Compare valores absolutos de cada etapa do funil.":"Clique nas métricas para selecionar/deselecionar. Compare múltiplas taxas de conversão simultaneamente."})]}),$e.jsx("div",{className:"h-80",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:T,children:[$e.jsx(Ne,{dataKey:"data",tick:{fontSize:12},tickLine:!1,axisLine:!1}),$e.jsx(_e,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:e=>Object.keys(h).filter(e=>h[e]).some(e=>e.includes("(absoluto)"))?N(e):`${e}%`,domain:(()=>{const e=Object.keys(h).filter(e=>h[e]),t=e.some(e=>e.includes("(absoluto)"));let s=1/0,r=-1/0;return T.forEach(t=>{e.forEach(e=>{const a=t[e];"number"==typeof a&&(a<s&&(s=a),a>r&&(r=a))})}),isFinite(s)&&isFinite(r)?s===r?[Math.max(0,s-(t?10:5)),r+(t?10:5)]:t?[Math.max(0,Math.floor(.9*s)),Math.ceil(1.1*r)]:[Math.max(0,Math.floor(s)),Math.min(100,Math.ceil(r))]:t?[0,1e3]:[0,100]})()}),$e.jsx(ke,{formatter:(e,t)=>Object.keys(h).filter(e=>h[e]).some(e=>e.includes("(absoluto)"))?[N(e),t]:[`${e.toFixed(2)}%`,t],labelFormatter:e=>`Data: ${e}`}),h["Visualizações (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Visualizações (absoluto)",stroke:"#3b82f6",strokeWidth:2,dot:O("Visualizações (absoluto)","#3b82f6"),activeDot:{r:6}}),h["Carrinho (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Carrinho (absoluto)",stroke:"#1d4ed8",strokeWidth:2,dot:O("Carrinho (absoluto)","#1d4ed8"),activeDot:{r:6}}),h["Checkout (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Checkout (absoluto)",stroke:"#6366f1",strokeWidth:2,dot:O("Checkout (absoluto)","#6366f1"),activeDot:{r:6}}),h["Frete (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Frete (absoluto)",stroke:"#475569",strokeWidth:2,dot:O("Frete (absoluto)","#475569"),activeDot:{r:6}}),h["Pagamento (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Pagamento (absoluto)",stroke:"#1e40af",strokeWidth:2,dot:O("Pagamento (absoluto)","#1e40af"),activeDot:{r:6}}),h["Pedidos (absoluto)"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Pedidos (absoluto)",stroke:"#0f172a",strokeWidth:3,dot:O("Pedidos (absoluto)","#0f172a"),activeDot:{r:7}}),h["Visualização → Carrinho"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Visualização → Carrinho",stroke:"#3b82f6",strokeWidth:2,dot:O("Visualização → Carrinho","#3b82f6"),activeDot:{r:6}}),h["Carrinho → Checkout"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Carrinho → Checkout",stroke:"#1d4ed8",strokeWidth:2,dot:O("Carrinho → Checkout","#1d4ed8"),activeDot:{r:6}}),h["Checkout → Frete"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Checkout → Frete",stroke:"#6366f1",strokeWidth:2,dot:O("Checkout → Frete","#6366f1"),activeDot:{r:6}}),h["Frete → Pagamento"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Frete → Pagamento",stroke:"#475569",strokeWidth:2,dot:O("Frete → Pagamento","#475569"),activeDot:{r:6}}),h["Pagamento → Pedido"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Pagamento → Pedido",stroke:"#1e40af",strokeWidth:2,dot:O("Pagamento → Pedido","#1e40af"),activeDot:{r:6}}),h["Checkout → Pedido"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Checkout → Pedido",stroke:"#334155",strokeWidth:2,dot:O("Checkout → Pedido","#334155"),activeDot:{r:6}}),h["Visualização → Pedido"]&&$e.jsx(Ce,{type:"monotone",dataKey:"Visualização → Pedido",stroke:"#0f172a",strokeWidth:3,dot:O("Visualização → Pedido","#0f172a"),activeDot:{r:7}})]})})})]})]})},$r=new Map,zr=({isOpen:t,onClose:s,trafficCategory:r,startDate:a,endDate:i,tableName:l,attributionModel:o})=>{const[c,d]=e.useState([]),[u,m]=e.useState(!1),[h,p]=e.useState(null),[f,g]=e.useState(!0),[b,v]=e.useState(!1),y=e.useRef(null),w=()=>`${l}-${r}-${a}-${i}-${o}`;e.useEffect(()=>{if(t){const e=w(),t=$r.get(e);t&&t.orders.length>0?(d(t.orders),m(!1),p(null),g(!1)):j()}else d([]),p(null),g(!0);return()=>{y.current&&y.current.abort()}},[t,r,a,i,l,o]);const j=async()=>{const e=w(),t=$r.get(e);if(t&&Date.now()-t.timestamp<3e5)return d(t.orders),m(!1),p(null),void g(!1);if(null==t?void 0:t.isLoading)m(!0);else{$r.set(e,{orders:[],timestamp:Date.now(),isLoading:!0}),m(!0),p(null),g(!0);try{y.current&&y.current.abort(),y.current=new AbortController;const t=localStorage.getItem("auth-token");if(!t)throw new Error("Token de autenticação não encontrado");if(!is(l))return;const s={start_date:a,end_date:i,table_name:l,limit:100};"Primeiro Clique"===o?s.fs_traffic_category=r:s.traffic_category=r;const n=(await ls.getOrders(t,s,y.current.signal)).data||[];n.length,$r.set(e,{orders:n,timestamp:Date.now(),isLoading:!1}),d(n),p(null)}catch(s){if(s instanceof Error&&"AbortError"===s.name)return;p(s instanceof Error?s.message:"Erro ao buscar pedidos"),$r.delete(e)}finally{m(!1),g(!1)}}},N=()=>{const e=w();$r.delete(e),j()},C=e=>{if(!e||""===e.trim())return"Data não informada";try{let t;if(e.includes("T")||e.includes("Z"))t=new Date(e);else if(e.match(/^\d{4}-\d{2}-\d{2}/))t=new Date(e+"T00:00:00");else if(e.match(/^\d{2}\/\d{2}\/\d{4}/)){const[s,r,a]=e.split("/");t=new Date(parseInt(a),parseInt(r)-1,parseInt(s))}else t=/^\d+$/.test(e)?new Date(parseInt(e)):new Date(e);if(isNaN(t.getTime()))return e||"Data inválida";return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"Data inválida"}},S=e=>{if(!e)return"bg-gray-100 text-gray-800";switch(e.toLowerCase()){case"paid":case"pago":return"bg-green-100 text-green-800";case"pending":case"pendente":return"bg-yellow-100 text-yellow-800";case"cancelled":case"cancelado":return"bg-red-100 text-red-800";case"refunded":case"reembolsado":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},T=e=>{const t=["Horario","Data","created_at","data_criacao","timestamp","data_pedido","data_transacao","date","data","hora","time"];for(const r of t){const t=e[r];if(t&&""!==t.toString().trim()){return C(t.toString())}}const s=Object.keys(e);for(const r of s){const t=e[r];if(t&&""!==t.toString().trim()&&(r.toLowerCase().includes("data")||r.toLowerCase().includes("hora")||r.toLowerCase().includes("time")||r.toLowerCase().includes("date"))){return C(t.toString())}}return"Data não informada"},A=b?c.filter(e=>{const t=e.Categoria_de_Trafico,s=e.Categoria_de_Trafico_Primeiro_Clique;return!(!t||!s||""===t.trim()||""===s.trim())&&t!==s}):c;return t?$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[$e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(O,{className:"w-5 h-5 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Pedidos - ",r]}),$e.jsxs("p",{className:"text-sm text-gray-500",children:[a," a ",i," • ",l]})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsxs("div",{className:"flex items-center gap-2 mr-4",children:[$e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:b,onChange:e=>v(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"whitespace-nowrap",children:"Apenas atribuições diferentes"})]}),b&&$e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[A.length," de ",c.length]})]}),$e.jsx("button",{onClick:N,disabled:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Atualizar pedidos",children:$e.jsx(I,{className:"w-5 h-5 text-gray-500 "+(u?"animate-spin":"")})}),$e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:$e.jsx(k,{className:"w-5 h-5 text-gray-500"})})]})]}),$e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 scroll-smooth",children:u&&f?$e.jsx("div",{className:"flex items-center justify-center p-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando pedidos..."}),$e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Isso pode levar alguns segundos"})]})}):h?$e.jsx("div",{className:"flex items-center justify-center p-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(k,{className:"w-6 h-6 text-red-600"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar pedidos"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:h}),$e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mx-auto",children:[$e.jsx(I,{className:"w-4 h-4"}),"Tentar novamente"]})]})}):0===A.length?$e.jsx("div",{className:"flex items-center justify-center p-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(x,{className:"w-6 h-6 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:b?"Nenhum pedido com atribuição diferente":"Nenhum pedido encontrado"}),$e.jsx("p",{className:"text-gray-600",children:b?`Todos os ${c.length} pedidos têm a mesma atribuição entre primeiro e último clique.`:`Não foram encontrados pedidos para ${r} no período selecionado.`})]})}):$e.jsxs("div",{className:"p-6",children:[$e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[$e.jsxs("p",{className:"text-sm text-gray-600",children:[A.length," pedido",1!==A.length?"s":""," encontrado",1!==A.length?"s":"",b&&c.length!==A.length&&$e.jsxs("span",{className:"text-gray-500 ml-1",children:["(de ",c.length," total)"]})]}),$e.jsxs("div",{className:"flex items-center gap-3",children:[c.length>5&&$e.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:[$e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),$e.jsx("span",{children:"Role para ver mais"})]}),u&&!f&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[$e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),$e.jsx("span",{children:"Atualizando..."})]})]})]}),$e.jsx("div",{className:"space-y-4",children:A.map((e,t)=>{return $e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(x,{className:"w-4 h-4 text-gray-500"}),$e.jsx("span",{className:"font-medium text-gray-900",children:e.ID_da_Transacao})]}),$e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S(e.Status)}`,children:e.Status})]}),$e.jsxs("div",{className:"text-right",children:[$e.jsx("p",{className:"text-lg font-semibold text-green-600",children:(s=e.Receita,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s))}),$e.jsx("p",{className:"text-xs text-gray-500",children:T(e)})]})]}),$e.jsxs("div",{className:"flex items-center gap-4 mb-3 text-sm text-gray-600",children:[$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(n,{className:"w-4 h-4"}),$e.jsx("span",{children:e.Primeiro_Nome||"Nome não informado"})]}),$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(_,{className:"w-4 h-4"}),$e.jsx("span",{children:T(e)})]})]}),$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-blue-700 mb-2",children:"🔄 Último Clique Não Direto (Atribuição Atual):"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Categoria:"})," ",e.Categoria_de_Trafico]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Origem:"})," ",e.Origem]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Mídia:"})," ",e.Midia]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Canal:"})," ",e.Canal]})]}),$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Campanha:"})," ",e.Campanha]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Conteúdo:"})," ",e.Conteudo]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Página de Entrada:"}),$e.jsx("a",{href:e.Pagina_de_Entrada,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1",children:e.Pagina_de_Entrada})]})]})]})]}),$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"🎯 Primeiro Clique:"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Categoria:"})," ",e.Categoria_de_Trafico_Primeiro_Clique||"Não informado"]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Origem:"})," ",e.Origem_Primeiro_Clique||"Não informado"]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Mídia:"})," ",e.Midia_Primeiro_Clique||"Não informado"]})]}),$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Campanha:"})," ",e.Campanha_Primeiro_Clique||"Não informado"]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Conteúdo:"})," ",e.Conteudo_Primeiro_Clique||"Não informado"]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Página de Entrada:"}),e.Pagina_de_Entrada_Primeiro_Clique?$e.jsx("a",{href:e.Pagina_de_Entrada_Primeiro_Clique,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline ml-1",children:e.Pagina_de_Entrada_Primeiro_Clique}):$e.jsx("span",{className:"text-gray-500 ml-1",children:"Não informado"})]})]})]})]}),e.Categoria_de_Trafico_Primeiro_Lead&&""!==e.Categoria_de_Trafico_Primeiro_Lead.trim()&&$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-purple-700 mb-2",children:"📞 Primeiro Lead:"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Categoria:"})," ",e.Categoria_de_Trafico_Primeiro_Lead]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Origem:"})," ",e.Origem_Primeiro_Lead]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Mídia:"})," ",e.Midia_Primeiro_Lead]})]}),$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Campanha:"})," ",e.Campanha_Primeiro_Lead]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Conteúdo:"})," ",e.Conteudo_Primeiro_Lead]}),$e.jsxs("p",{className:"text-gray-600",children:[$e.jsx("strong",{children:"Página de Entrada:"}),e.Pagina_de_Entrada_Primeiro_Lead?$e.jsx("a",{href:e.Pagina_de_Entrada_Primeiro_Lead,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline ml-1",children:e.Pagina_de_Entrada_Primeiro_Lead}):$e.jsx("span",{className:"text-gray-500 ml-1",children:"Não informado"})]})]})]})]}),"Data não informada"===T(e)&&$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"Debug - Campos Disponíveis:"}),$e.jsx("div",{className:"bg-red-50 p-2 rounded text-xs",children:$e.jsx("pre",{className:"whitespace-pre-wrap overflow-x-auto",children:JSON.stringify(e,null,2)})})]}),$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"📊 Comparação de Atribuição:"}),$e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 rounded-lg",children:[$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-semibold text-blue-700 mb-1",children:"🔄 Último Clique Não Direto"}),$e.jsxs("div",{className:"bg-white p-2 rounded border border-blue-200",children:[$e.jsx("div",{className:"font-medium",children:e.Categoria_de_Trafico}),$e.jsx("div",{className:"text-gray-600",children:e.Campanha})]})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-semibold text-green-700 mb-1",children:"🎯 Primeiro Clique"}),$e.jsxs("div",{className:"bg-white p-2 rounded border border-green-200",children:[$e.jsx("div",{className:"font-medium",children:e.Categoria_de_Trafico_Primeiro_Clique||"Não informado"}),$e.jsx("div",{className:"text-gray-600",children:e.Campanha_Primeiro_Clique||"Não informado"})]})]})]}),e.Categoria_de_Trafico!==e.Categoria_de_Trafico_Primeiro_Clique&&$e.jsx("div",{className:"mt-2 text-center",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⚠️ Diferentes fontes de tráfego"})})]})]}),e.Parametros_de_URL&&$e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Parâmetros da URL:"}),$e.jsx("div",{className:"bg-gray-50 p-2 rounded text-xs font-mono break-all",children:e.Parametros_de_URL})]})]},e.ID_da_Transacao||t);var s})})]})})]})}):null},Vr=()=>({getUrlParams:e.useCallback(()=>{const e=new URLSearchParams(window.location.search);return{table:e.get("table")||void 0,startDate:e.get("startDate")||void 0,endDate:e.get("endDate")||void 0,tab:e.get("tab")||void 0,cluster:e.get("cluster")||void 0,detailedFilter:e.get("detailedFilter")||void 0,detailedFilterType:e.get("detailedFilterType")||void 0}},[]),updateUrlParams:e.useCallback(e=>{const t=new URL(window.location.href),s=t.searchParams;Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t?s.set(e,t):s.delete(e)}),window.history.replaceState({},"",t.toString())},[]),clearUrlParams:e.useCallback(()=>{window.history.replaceState({},"",window.location.pathname)},[]),getShareableUrl:e.useCallback(()=>window.location.href,[]),copyShareableUrl:e.useCallback(async()=>{try{return await navigator.clipboard.writeText(window.location.href),!0}catch(e){return!1}},[])}),Ur=t=>{e.useEffect(()=>{const e=document.title;return document.title=t,()=>{document.title=e}},[t])},Wr=({startDate:t,endDate:a,selectedTable:n,attributionModel:i})=>{var o;const{getUrlParams:c,updateUrlParams:d}=Vr(),[m,x]=e.useState([]),[p,f]=e.useState(!1),[g,v]=e.useState(""),[y,N]=e.useState(null),[_,k]=e.useState(""),[S,T]=e.useState(!1),[E,P]=e.useState({limit:1e4,offset:0,order_by:"Pedidos",has_more:!1}),[M,L]=e.useState(!1),[I,$]=e.useState(0),[q,Y]=e.useState(1),[K,X]=e.useState(!1),[J,Z]=e.useState("cluster"),[Q,ee]=e.useState(!1),[te,se]=e.useState("Receita_Paga"),[re,ae]=e.useState("desc"),[ne,ie]=e.useState([]),[le,oe]=e.useState([]);e.useEffect(()=>{const e=c();e.detailedFilter&&e.detailedFilterType&&(ie([{type:e.detailedFilterType,value:e.detailedFilter}]),Z(e.detailedFilterType)),T(!0)},[]);const ce=async(e,t,s=!1)=>{try{const s=new Promise((e,t)=>{setTimeout(()=>t(new Error("Timeout: A requisição demorou muito tempo")),3e4)}),r=ls.getDetailedData(e,t);return await Promise.race([r,s])}catch(r){if(r instanceof Error&&(r.message.includes("timeout")||r.message.includes("Timeout")||r.message.includes("demorou muito tempo"))&&!s)return await new Promise(e=>setTimeout(e,5e3)),await ce(e,t,!0);throw r}};e.useEffect(()=>{(async()=>{var e,s;if(n&&S&&is(n)){f(!0),v("Iniciando busca de dados..."),N(null),P(e=>({...e,offset:0,has_more:!1}));try{const r=localStorage.getItem("auth-token");if(!r)return;v("Conectando com o servidor..."),v("Buscando dados detalhados...");const l=await ce(r,{start_date:t,end_date:a,table_name:n,attribution_model:i,limit:E.limit,offset:0,order_by:E.order_by});x(l.data||[]),l.pagination&&P(l.pagination),(null==(e=l.pagination)?void 0:e.has_more)&&await de(r,(null==(s=l.data)?void 0:s.length)||0)}catch(r){r instanceof Error&&r.message.includes("Timeout")?N("A requisição demorou muito tempo. Tente novamente ou reduza o período de datas."):N("Erro ao carregar dados detalhados")}finally{f(!1),v("")}}})()},[t,a,n,i,S]);const de=async(e,s)=>{L(!0),v("Carregando dados automaticamente..."),$(0);try{let r=E.limit,l=!0,o=s,c=1;for(;l;){c++,r+=E.limit,v(`Carregando lote ${c}... (${o} registros carregados)`),Y(c);const s=await ce(e,{start_date:t,end_date:a,table_name:n,attribution_model:i,limit:E.limit,offset:r,order_by:E.order_by}),d=s.data||[];o+=d.length,x(e=>[...e,...d]);const u=Math.max(10,c+2),m=Math.min(c/u*100,95);$(m),s.pagination?(P(s.pagination),l=s.pagination.has_more||!1):l=!1,await new Promise(e=>setTimeout(e,100))}v("Carregamento concluído!"),setTimeout(()=>v(""),2e3)}catch(r){r instanceof Error&&r.message.includes("Timeout")?N("A requisição demorou muito tempo. Tente novamente."):N("Erro ao carregar todos os dados")}finally{L(!1),$(0)}};e.useEffect(()=>{if(m.length>0&&ne.length>0){let e=m.filter(e=>e.Data.toLowerCase().includes(_.toLowerCase())||e.Origem.toLowerCase().includes(_.toLowerCase())||e.Midia.toLowerCase().includes(_.toLowerCase())||e.Campanha.toLowerCase().includes(_.toLowerCase())||e.Cupom.toLowerCase().includes(_.toLowerCase())||e.Cluster.toLowerCase().includes(_.toLowerCase()));ne.forEach(t=>{switch(t.type){case"cluster":e=e.filter(e=>(e.Cluster||"Sem Cluster")===t.value);break;case"origemMidia":const[s,r]=t.value.split(" / ");e=e.filter(e=>(e.Origem||"Sem Origem")===s&&(e.Midia||"Sem Mídia")===r);break;case"campanha":e=e.filter(e=>(e.Campanha||"Sem Campanha")===t.value);break;case"paginaEntrada":e=e.filter(e=>(e.Pagina_de_Entrada||"Sem Página")===t.value);break;case"conteudo":e=e.filter(e=>(e.Conteudo||"Sem Conteúdo")===t.value);break;case"cupom":e=e.filter(e=>(e.Cupom||"Sem Cupom")===t.value)}}),oe(e)}else oe([])},[m,ne,_]);const ue=m.filter(e=>e.Data.toLowerCase().includes(_.toLowerCase())||e.Origem.toLowerCase().includes(_.toLowerCase())||e.Midia.toLowerCase().includes(_.toLowerCase())||e.Campanha.toLowerCase().includes(_.toLowerCase())||e.Cupom.toLowerCase().includes(_.toLowerCase())||e.Cluster.toLowerCase().includes(_.toLowerCase())),me=ne.length>0?le:ue,he=ne.length>0?le:ue,xe=()=>{if(p&&0===m.length)return"⏳ Carregando dados... | MyMetric Hub";if(M&&m.length>0){const e=Math.round(I);return`🔄 Lote ${q} (${e}%) | ${m.length} registros | MyMetric Hub`}return m.length>0?E.has_more?`${m.length} registros • Carregando mais... | MyMetric Hub`:`${m.length} registros • Completo | MyMetric Hub`:"MyMetric Hub"};Ur(xe()),e.useEffect(()=>{const e=xe();document.title=e},[p,M,I,m.length,E.has_more,q]);const pe=s.useMemo(()=>{const e={cluster:{},origemMidia:{},campanha:{},paginaEntrada:{},conteudo:{},cupom:{}};return me.forEach(t=>{const s=t.Cluster||"Sem Cluster";e.cluster[s]||(e.cluster[s]=[]),e.cluster[s].push(t);const r=`${t.Origem||"Sem Origem"} / ${t.Midia||"Sem Mídia"}`;e.origemMidia[r]||(e.origemMidia[r]=[]),e.origemMidia[r].push(t);const a=t.Campanha||"Sem Campanha";e.campanha[a]||(e.campanha[a]=[]),e.campanha[a].push(t);const n=t.Pagina_de_Entrada||"Sem Página";e.paginaEntrada[n]||(e.paginaEntrada[n]=[]),e.paginaEntrada[n].push(t);const i=t.Conteudo||"Sem Conteúdo";e.conteudo[i]||(e.conteudo[i]=[]),e.conteudo[i].push(t);const l=t.Cupom||"Sem Cupom";e.cupom[l]||(e.cupom[l]=[]),e.cupom[l].push(t)}),e},[me]),fe=e=>e.reduce((e,t)=>({Sessoes:e.Sessoes+(Number(t.Sessoes)||0),Adicoes_ao_Carrinho:e.Adicoes_ao_Carrinho+(Number(t.Adicoes_ao_Carrinho)||0),Pedidos:e.Pedidos+(Number(t.Pedidos)||0),Receita:e.Receita+(Number(t.Receita)||0),Pedidos_Pagos:e.Pedidos_Pagos+(Number(t.Pedidos_Pagos)||0),Receita_Paga:e.Receita_Paga+(Number(t.Receita_Paga)||0),Pedidos_Assinatura_Anual_Inicial:e.Pedidos_Assinatura_Anual_Inicial+(Number(t.Pedidos_Assinatura_Anual_Inicial)||0),Receita_Assinatura_Anual_Inicial:e.Receita_Assinatura_Anual_Inicial+(Number(t.Receita_Assinatura_Anual_Inicial)||0),Pedidos_Assinatura_Mensal_Inicial:e.Pedidos_Assinatura_Mensal_Inicial+(Number(t.Pedidos_Assinatura_Mensal_Inicial)||0),Receita_Assinatura_Mensal_Inicial:e.Receita_Assinatura_Mensal_Inicial+(Number(t.Receita_Assinatura_Mensal_Inicial)||0),Pedidos_Assinatura_Anual_Recorrente:e.Pedidos_Assinatura_Anual_Recorrente+(Number(t.Pedidos_Assinatura_Anual_Recorrente)||0),Receita_Assinatura_Anual_Recorrente:e.Receita_Assinatura_Anual_Recorrente+(Number(t.Receita_Assinatura_Anual_Recorrente)||0),Pedidos_Assinatura_Mensal_Recorrente:e.Pedidos_Assinatura_Mensal_Recorrente+(Number(t.Pedidos_Assinatura_Mensal_Recorrente)||0),Receita_Assinatura_Mensal_Recorrente:e.Receita_Assinatura_Mensal_Recorrente+(Number(t.Receita_Assinatura_Mensal_Recorrente)||0)}),{Sessoes:0,Adicoes_ao_Carrinho:0,Pedidos:0,Receita:0,Pedidos_Pagos:0,Receita_Paga:0,Pedidos_Assinatura_Anual_Inicial:0,Receita_Assinatura_Anual_Inicial:0,Pedidos_Assinatura_Mensal_Inicial:0,Receita_Assinatura_Mensal_Inicial:0,Pedidos_Assinatura_Anual_Recorrente:0,Receita_Assinatura_Anual_Recorrente:0,Pedidos_Assinatura_Mensal_Recorrente:0,Receita_Assinatura_Mensal_Recorrente:0}),ge=s.useMemo(()=>he.reduce((e,t)=>{const s=e.find(e=>e.date===t.Data);if(s)s.sessions+=t.Sessoes,s.revenue+=t.Receita,s.clicks+=t.Cliques||0,s.addToCart+=t.Adicoes_ao_Carrinho,s.orders+=t.Pedidos,s.newCustomers+=t.Novos_Clientes||0,s.paidOrders+=t.Pedidos_Pagos,s.paidRevenue+=t.Receita_Paga,s.newCustomerRevenue+=t.Receita_Novos_Clientes||0,s.investment+=t.Investimento||0,s.averageTicket=s.orders>0?s.revenue/s.orders:0;else{const s=t.Pedidos,r=t.Receita;e.push({date:t.Data,sessions:t.Sessoes,revenue:r,clicks:t.Cliques||0,addToCart:t.Adicoes_ao_Carrinho,orders:s,newCustomers:t.Novos_Clientes||0,paidOrders:t.Pedidos_Pagos,paidRevenue:t.Receita_Paga,newCustomerRevenue:t.Receita_Novos_Clientes||0,investment:t.Investimento||0,averageTicket:s>0?r/s:0})}return e},[]).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),[he]),be=s.useMemo(()=>he.reduce((e,t)=>({sessoes:e.sessoes+t.Sessoes,pedidos:e.pedidos+t.Pedidos,receita:e.receita+t.Receita,novosClientes:e.novosClientes+(t.Novos_Clientes||0),adicoesCarrinho:e.adicoesCarrinho+t.Adicoes_ao_Carrinho,receitaPaga:e.receitaPaga+t.Receita_Paga,pedidosPagos:e.pedidosPagos+t.Pedidos_Pagos,receitaNovosClientes:e.receitaNovosClientes+(t.Receita_Novos_Clientes||0),investimento:e.investimento+(t.Investimento||0),cliques:e.cliques+(t.Cliques||0)}),{sessoes:0,pedidos:0,receita:0,novosClientes:0,adicoesCarrinho:0,receitaPaga:0,pedidosPagos:0,receitaNovosClientes:0,investimento:0,cliques:0}),[he]),ve=s.useMemo(()=>({avgOrderValue:be.pedidos>0?be.receita/be.pedidos:0,conversionRate:be.sessoes>0?be.pedidos/be.sessoes*100:0,addToCartRate:be.sessoes>0?be.adicoesCarrinho/be.sessoes*100:0,revenuePerSession:be.sessoes>0?be.receita/be.sessoes:0,newCustomerRate:be.pedidos>0?be.novosClientes/be.pedidos*100:0}),[be]),ye=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(e),we=e=>new Intl.NumberFormat("pt-BR").format(e),je=({title:e,value:t,icon:s,format:r="number",color:a="blue"})=>$e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[$e.jsx("div",{className:"flex items-center justify-between mb-2",children:$e.jsx("div",{className:`p-2 rounded-lg ${{blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600",red:"bg-red-100 text-red-600"}[a]}`,children:$e.jsx(s,{className:"w-4 h-4"})})}),$e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:e}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:(()=>{switch(r){case"currency":return ye(t);case"percentage":return`${t.toFixed(2)}%`;default:return we(t)}})()})]});if(p&&0===m.length)return $e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:$e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[$e.jsxs("div",{className:"flex items-center mb-4",children:[$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),$e.jsx("span",{className:"text-gray-700 text-lg font-medium",children:g||"Carregando dados detalhados..."})]}),M&&$e.jsxs("div",{className:"w-full max-w-md mb-4",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Carregando dados automaticamente..."}),$e.jsxs("span",{className:"text-sm text-gray-500",children:["Lote ",q]})]}),$e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:$e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]}),$e.jsxs("div",{className:"text-center text-sm text-gray-500",children:[$e.jsx("p",{children:"Isso pode levar alguns segundos dependendo da quantidade de dados"}),$e.jsx("p",{className:"mt-2 text-xs",children:"Se demorar muito, tente reduzir o período de datas"})]})]})});if(y)return $e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(l,{className:"w-8 h-8 text-red-600"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar dados"}),$e.jsx("p",{className:"text-gray-600",children:y})]})});if(0===m.length&&!p&&S)return $e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(u,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsx("p",{className:"text-gray-600",children:"Não foram encontrados dados detalhados para o período selecionado."}),$e.jsx("div",{className:"mt-4 text-sm text-gray-500",children:$e.jsx("p",{children:"Tente selecionar um período menor ou verificar se há dados disponíveis."})})]})});if(!S)return null;const Ne=[{id:"cluster",label:"Por Cluster",icon:$e.jsx(U,{className:"w-4 h-4"})},{id:"origemMidia",label:"Por Origem/Mídia",icon:$e.jsx(F,{className:"w-4 h-4"})},{id:"campanha",label:"Por Campanha",icon:$e.jsx(h,{className:"w-4 h-4"})},{id:"paginaEntrada",label:"Por Página de Entrada",icon:$e.jsx(W,{className:"w-4 h-4"})},{id:"conteudo",label:"Por Conteúdo",icon:$e.jsx(H,{className:"w-4 h-4"})},{id:"cupom",label:"Por Cupom",icon:$e.jsx(G,{className:"w-4 h-4"})}],_e=e=>{const t=ne.findIndex(t=>t.type===J&&t.value===e);let s;if(s=t>=0?ne.filter((e,s)=>s!==t):[...ne,{type:J,value:e}],ie(s),s.length>0){const e=s[s.length-1];d({detailedFilter:e.value,detailedFilterType:e.type})}else d({detailedFilter:void 0,detailedFilterType:void 0});const r=(Ne.findIndex(e=>e.id===J)+1)%Ne.length,a=Ne[r];Z(a.id),X(!0),setTimeout(()=>X(!1),2e3),ee(!1),se("Receita_Paga"),ae("desc")},ke=({field:e,children:t})=>$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>(e=>{te===e?ae("asc"===re?"desc":"asc"):(se(e),ae("desc"))})(e),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[t,te===e&&("asc"===re?$e.jsx(A,{className:"w-4 h-4"}):$e.jsx(C,{className:"w-4 h-4"}))]})});return $e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Visão Detalhada"}),M&&$e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-50 border border-green-200 rounded-md",children:[$e.jsx(j,{className:"w-3 h-3 text-green-600 animate-spin"}),$e.jsxs("span",{className:"text-xs text-green-700 font-medium",children:["Carregando todos (",Math.round(I),"%)"]})]})]}),ne.length>0&&$e.jsx("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:ne.map((e,t)=>{var s;return $e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-blue-50 border border-blue-200 rounded-md",children:[$e.jsx(b,{className:"w-3 h-3 text-blue-600"}),$e.jsxs("span",{className:"text-sm text-blue-700 font-medium",children:[null==(s=Ne.find(t=>t.id===e.type))?void 0:s.label.replace("Por ",""),": ",e.value]})]},t)})}),m.length>0&&$e.jsx("div",{className:"flex items-center gap-2 mt-1",children:$e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-md",children:[$e.jsx(u,{className:"w-3 h-3 text-gray-600"}),$e.jsxs("span",{className:"text-xs text-gray-700 font-medium",children:[m.length," registros carregados",E.has_more&&" • Carregando mais...",!E.has_more&&" • Carregamento completo"]})]})})]}),$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm text-gray-600 font-medium",children:"Ordenar por:"}),$e.jsxs("select",{value:E.order_by,onChange:e=>(async e=>{if(n&&S){f(!0),v("Recarregando dados com nova ordenação..."),N(null),P(t=>({...t,offset:0,has_more:!1,order_by:e}));try{const s=localStorage.getItem("auth-token");if(!s)return;const r=await ce(s,{start_date:t,end_date:a,table_name:n,attribution_model:i,limit:E.limit,offset:0,order_by:e});x(r.data||[]),r.pagination&&P(r.pagination)}catch(s){s instanceof Error&&s.message.includes("Timeout")?N("A requisição demorou muito tempo. Tente novamente."):N("Erro ao recarregar dados")}finally{f(!1),v("")}}})(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:p,children:[$e.jsx("option",{value:"Pedidos",children:"Pedidos"}),$e.jsx("option",{value:"Receita",children:"Receita"}),$e.jsx("option",{value:"Receita_Paga",children:"Receita Paga"}),$e.jsx("option",{value:"Sessoes",children:"Sessões"}),$e.jsx("option",{value:"Adicoes_ao_Carrinho",children:"Adições ao Carrinho"}),$e.jsx("option",{value:"Pedidos_Pagos",children:"Pedidos Pagos"})]})]}),ne.length>0&&$e.jsxs("button",{onClick:()=>{ie([]),oe([]),d({detailedFilter:void 0,detailedFilterType:void 0})},className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",title:"Remover todos os filtros",children:[$e.jsx(b,{className:"w-4 h-4"}),"Limpar Filtros (",ne.length,")"]}),$e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:[$e.jsx(D,{className:"w-4 h-4"}),"Exportar"]})]})]}),$e.jsx("div",{className:"mt-4",children:$e.jsxs("div",{className:"relative",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Buscar por data, origem, mídia, campanha, cupom, cluster ou termo...",value:_,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})})]}),M&&m.length>0&&$e.jsx("div",{className:"px-6 py-3 bg-blue-50 border-b border-blue-200",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[$e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),$e.jsxs("span",{className:"text-sm text-blue-700 font-medium",children:["Carregando mais dados... Lote ",q]}),$e.jsx("div",{className:"w-32 bg-blue-200 rounded-full h-2",children:$e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]})}),$e.jsxs("div",{className:"px-6 py-4",children:[$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[$e.jsx(je,{title:"Sessões",value:be.sessoes,icon:F,color:"blue"}),$e.jsx(je,{title:"Pedidos Pagos",value:be.pedidosPagos,icon:r,color:"green"}),$e.jsx(je,{title:"Receita Paga",value:be.receitaPaga,icon:B,format:"currency",color:"purple"}),$e.jsx(je,{title:"Ticket Médio",value:ve.avgOrderValue,icon:R,format:"currency",color:"orange"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[$e.jsx(je,{title:"Taxa de Conversão",value:ve.conversionRate,icon:z,format:"percentage",color:"red"}),$e.jsx(je,{title:"Taxa de Adição ao Carrinho",value:ve.addToCartRate,icon:O,format:"percentage",color:"blue"}),$e.jsx(je,{title:"Receita por Sessão",value:ve.revenuePerSession,icon:V,format:"currency",color:"green"})]})]}),$e.jsx("div",{className:"px-6 py-4",children:$e.jsx(ws,{data:ge,title:"Evolução das Métricas"})}),$e.jsx("div",{className:"border-b border-gray-200",children:$e.jsx("nav",{className:"flex space-x-8 px-6",children:Ne.map(e=>$e.jsxs("button",{onClick:()=>{return t=e.id,Z(t),ee(!1),se("Receita_Paga"),void ae("desc");var t},className:"flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm relative transition-all duration-200 "+(J===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.icon,e.label,ne.some(t=>t.type===e.id)&&$e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 rounded-full animate-pulse"})]},e.id))})}),$e.jsxs("div",{className:"p-6",children:[ne.length>0&&$e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(b,{className:"w-4 h-4 text-blue-600"}),$e.jsxs("span",{className:"text-sm text-blue-700",children:[$e.jsx("strong",{children:"Filtros ativos:"})," ",ne.length," filtro(s) aplicado(s) globalmente"]})]})}),K&&$e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg animate-pulse",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full animate-bounce"}),$e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Mudou automaticamente para a próxima aba! 🚀"})]})}),0===Object.keys(pe[J]||{}).length?$e.jsxs("div",{className:"text-center py-8",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(b,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsxs("p",{className:"text-gray-600",children:['Não há dados para exibir na aba "',null==(o=Ne.find(e=>e.id===J))?void 0:o.label,'" com o filtro atual.']}),ne.length>0&&$e.jsx("button",{onClick:()=>{ie([]),oe([]),d({detailedFilter:void 0,detailedFilterType:void 0})},className:"mt-4 px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"Limpar Filtros"})]}):((e,t)=>{var s;const r=Object.entries(t).sort((e,t)=>{const s=fe(e[1]),r=fe(t[1]);let a,n;return"Taxa_Receita_Paga"===te?(a=s.Receita>0?s.Receita_Paga/s.Receita*100:0,n=r.Receita>0?r.Receita_Paga/r.Receita*100:0):(a=s[te],n=r[te]),"number"==typeof a&&"number"==typeof n?"asc"===re?a-n:n-a:0}),a=Q?r:r.slice(0,10),n=r.length>10;return $e.jsxs("div",{className:"space-y-4",children:[$e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48 max-w-48",children:[null==(s=Ne.find(t=>t.id===e))?void 0:s.label.replace("Por ",""),$e.jsx("span",{className:"ml-1 text-xs text-gray-400",children:"(clique para filtrar)"})]}),$e.jsx(ke,{field:"Sessoes",children:"Sessões"}),$e.jsx(ke,{field:"Adicoes_ao_Carrinho",children:"Adições ao Carrinho"}),$e.jsx(ke,{field:"Pedidos",children:"Pedidos"}),$e.jsx(ke,{field:"Receita",children:"Receita"}),$e.jsx(ke,{field:"Pedidos_Pagos",children:"Pedidos Pagos"}),$e.jsx(ke,{field:"Receita_Paga",children:"Receita Paga"}),$e.jsx(ke,{field:"Taxa_Receita_Paga",children:"% Receita Paga"}),m.some(e=>e.Pedidos_Assinatura_Anual_Inicial&&e.Pedidos_Assinatura_Anual_Inicial>0||e.Receita_Assinatura_Anual_Inicial&&e.Receita_Assinatura_Anual_Inicial>0||e.Pedidos_Assinatura_Mensal_Inicial&&e.Pedidos_Assinatura_Mensal_Inicial>0||e.Receita_Assinatura_Mensal_Inicial&&e.Receita_Assinatura_Mensal_Inicial>0||e.Pedidos_Assinatura_Anual_Recorrente&&e.Pedidos_Assinatura_Anual_Recorrente>0||e.Receita_Assinatura_Anual_Recorrente&&e.Receita_Assinatura_Anual_Recorrente>0||e.Pedidos_Assinatura_Mensal_Recorrente&&e.Pedidos_Assinatura_Mensal_Recorrente>0||e.Receita_Assinatura_Mensal_Recorrente&&e.Receita_Assinatura_Mensal_Recorrente>0)?$e.jsxs($e.Fragment,{children:[$e.jsx(ke,{field:"Pedidos_Assinatura_Anual_Inicial",children:"Novas Assinaturas Anuais"}),$e.jsx(ke,{field:"Receita_Assinatura_Anual_Inicial",children:"Receita Novas Anuais"}),$e.jsx(ke,{field:"Pedidos_Assinatura_Mensal_Inicial",children:"Novas Assinaturas Mensais"}),$e.jsx(ke,{field:"Receita_Assinatura_Mensal_Inicial",children:"Receita Novas Mensais"}),$e.jsx(ke,{field:"Pedidos_Assinatura_Anual_Recorrente",children:"Renovações Anuais"}),$e.jsx(ke,{field:"Receita_Assinatura_Anual_Recorrente",children:"Receita Renovações Anuais"}),$e.jsx(ke,{field:"Pedidos_Assinatura_Mensal_Recorrente",children:"Renovações Mensais"}),$e.jsx(ke,{field:"Receita_Assinatura_Mensal_Recorrente",children:"Receita Renovações Mensais"})]}):null]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(([e,t])=>{const s=fe(t);return $e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors group",onClick:()=>_e(e),title:"Clique para filtrar e ir para a próxima aba",children:[$e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 max-w-48 truncate group-hover:text-blue-600",title:e,children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{children:e}),$e.jsx(V,{className:"w-3 h-3 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:we(s.Sessoes)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:we(s.Adicoes_ao_Carrinho)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:we(s.Pedidos)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ye(s.Receita)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:we(s.Pedidos_Pagos)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ye(s.Receita_Paga)}),$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-cyan-600",children:[s.Receita>0?(s.Receita_Paga/s.Receita*100).toFixed(1):"0.0","%"]}),m.some(e=>e.Pedidos_Assinatura_Anual_Inicial&&e.Pedidos_Assinatura_Anual_Inicial>0||e.Receita_Assinatura_Anual_Inicial&&e.Receita_Assinatura_Anual_Inicial>0||e.Pedidos_Assinatura_Mensal_Inicial&&e.Pedidos_Assinatura_Mensal_Inicial>0||e.Receita_Assinatura_Mensal_Inicial&&e.Receita_Assinatura_Mensal_Inicial>0||e.Pedidos_Assinatura_Anual_Recorrente&&e.Pedidos_Assinatura_Anual_Recorrente>0||e.Receita_Assinatura_Anual_Recorrente&&e.Receita_Assinatura_Anual_Recorrente>0||e.Pedidos_Assinatura_Mensal_Recorrente&&e.Pedidos_Assinatura_Mensal_Recorrente>0||e.Receita_Assinatura_Mensal_Recorrente&&e.Receita_Assinatura_Mensal_Recorrente>0)?$e.jsxs($e.Fragment,{children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-purple-600",children:we(s.Pedidos_Assinatura_Anual_Inicial||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-purple-600",children:ye(s.Receita_Assinatura_Anual_Inicial||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-indigo-600",children:we(s.Pedidos_Assinatura_Mensal_Inicial||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-indigo-600",children:ye(s.Receita_Assinatura_Mensal_Inicial||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-cyan-600",children:we(s.Pedidos_Assinatura_Anual_Recorrente||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-cyan-600",children:ye(s.Receita_Assinatura_Anual_Recorrente||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-teal-600",children:we(s.Pedidos_Assinatura_Mensal_Recorrente||0)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-teal-600",children:ye(s.Receita_Assinatura_Mensal_Recorrente||0)})]}):null]},e)})})]})})}),n&&$e.jsx("div",{className:"flex justify-center",children:$e.jsx("button",{onClick:()=>ee(!Q),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:Q?$e.jsxs($e.Fragment,{children:["Ver menos (",r.length," grupos)"]}):$e.jsxs($e.Fragment,{children:["Ver mais (",r.length-10," grupos restantes)"]})})}),M&&$e.jsx("div",{className:"flex flex-col items-center gap-4 mt-6",children:$e.jsxs("div",{className:"w-full max-w-md",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Carregando dados automaticamente..."}),$e.jsxs("span",{className:"text-sm text-gray-500",children:["Lote ",q]})]}),$e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:$e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]})}),m.length>0&&$e.jsx("div",{className:"mt-4 text-center text-sm text-gray-500",children:$e.jsxs("p",{children:[m.length," registros carregados",E.has_more&&" • Carregando mais dados...",!E.has_more&&$e.jsx("span",{className:"text-green-600 font-medium",children:" • Carregamento completo! 🎉"})]})})]})})(J,pe[J])]})]})},Hr=({selectedTable:t,startDate:s,endDate:r})=>{const[a,n]=e.useState([]),[i,l]=e.useState([]),[o,c]=e.useState(""),[d,u]=e.useState(""),[m,h]=e.useState(!0),[p,f]=e.useState(null);e.useEffect(()=>{t&&(async()=>{try{h(!0),f(null);const e=localStorage.getItem("auth-token");if(!e)throw new Error("Token de autenticação não encontrado");const s=await ls.getHavaianasData(e,{table_name:t});n(s.data||[])}catch(e){f(e instanceof Error?e.message:"Erro desconhecido"),n([])}finally{h(!1)}})()},[t]);const g=a.filter(e=>{const[t,a,n]=e.event_date.split("-").map(Number),i=new Date(t,a-1,n),[l,o,c]=s.split("-").map(Number),d=new Date(l,o-1,c),[u,m,h]=r.split("-").map(Number),x=new Date(u,m-1,h);return i>=d&&i<=x}),b=g.reduce((e,t)=>{const s=e.find(e=>e.item_id===t.item_id);return s?(s.totalViews+=t.item_views,s.totalTransactions+=t.transactions,s.totalRevenue+=t.purchase_revenue,s.avgScore+=t.size_score,s.avgPromo+=t.promo_label,s.daysCount+=1):e.push({item_id:t.item_id,item_name:t.item_name,totalViews:t.item_views,totalTransactions:t.transactions,totalRevenue:t.purchase_revenue,avgScore:t.size_score,avgPromo:t.promo_label,daysCount:1}),e},[]).map(e=>({...e,avgScore:e.daysCount>0?e.avgScore/e.daysCount:0,avgPromo:e.daysCount>0?e.avgPromo/e.daysCount:0})).sort((e,t)=>t.totalRevenue-e.totalRevenue);e.useEffect(()=>{if(o.trim()){const e=b.filter(e=>e.item_name.toLowerCase().includes(o.toLowerCase())||e.item_id.toLowerCase().includes(o.toLowerCase()));l(e)}else l(b)},[b,o]);const y=(d?g.filter(e=>e.item_id===d):g).reduce((e,t)=>{const s=e.find(e=>e.date===t.event_date);return s?(s.totalViews+=t.item_views,s.totalTransactions+=t.transactions,s.totalRevenue+=t.purchase_revenue,s.avgScore+=t.size_score,s.avgPromo+=t.promo_label,s.itemCount+=1):e.push({date:t.event_date,totalViews:t.item_views,totalTransactions:t.transactions,totalRevenue:t.purchase_revenue,avgScore:t.size_score,avgPromo:t.promo_label,itemCount:1}),e},[]).sort((e,t)=>{const[s,r,a]=e.date.split("-").map(Number),[n,i,l]=t.date.split("-").map(Number),o=new Date(s,r-1,a),c=new Date(n,i-1,l);return o.getTime()-c.getTime()}).map(e=>({...e,avgScore:e.itemCount>0?e.avgScore/e.itemCount*100:0,avgPromo:e.itemCount>0?e.avgPromo/e.itemCount:0})),j=e=>new Intl.NumberFormat("pt-BR").format(e);return m?$e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando dados da Havaianas..."})]})}):p?$e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(M,{className:"w-8 h-8 text-red-600"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar dados"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:p})]})}):0===a.length?$e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(x,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsxs("p",{className:"text-gray-600",children:["Não foram encontrados dados para a tabela ",$e.jsx("strong",{children:t}),"."]})]})}):$e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:$e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:$e.jsx(v,{className:"w-4 h-4 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Evolução Temporal"}),$e.jsx("p",{className:"text-sm text-gray-600",children:d?"Métricas do produto selecionado por data":"Métricas agregadas por data"})]})]}),d&&$e.jsx("button",{onClick:()=>u(""),className:"px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Ver todos os produtos"})]}),$e.jsx("div",{className:"h-64",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:y,margin:{top:5,right:30,left:20,bottom:5},children:[$e.jsx(je,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),$e.jsx(Ne,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>{const[t,s,r]=e.split("-").map(Number);return new Date(t,s-1,r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}}),$e.jsx(_e,{yAxisId:"left",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,notation:"compact"}).format(e)}),$e.jsx(_e,{yAxisId:"right",orientation:"right",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>`${e.toFixed(0)}%`}),$e.jsx(ke,{formatter:(e,t)=>"Receita"===t?[new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e),t]:"Score de Grade"===t||"Score de Desconto"===t?[`${e.toFixed(1)}%`,t]:[e,t],labelFormatter:e=>{const[t,s,r]=e.split("-").map(Number);return new Date(t,s-1,r).toLocaleDateString("pt-BR")}}),$e.jsx(Ce,{yAxisId:"left",type:"monotone",dataKey:"totalRevenue",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:5},activeDot:{r:7,stroke:"#10b981",strokeWidth:2},name:"Receita"}),$e.jsx(Ce,{yAxisId:"right",type:"monotone",dataKey:"avgScore",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:5},activeDot:{r:7,stroke:"#3b82f6",strokeWidth:2},name:"Score de Grade"}),$e.jsx(Ce,{yAxisId:"right",type:"monotone",dataKey:"avgPromo",stroke:"#f59e0b",strokeWidth:3,dot:{fill:"#f59e0b",strokeWidth:2,r:5},activeDot:{r:7,stroke:"#f59e0b",strokeWidth:2},name:"Score de Desconto"})]})})})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-6 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:$e.jsx(x,{className:"w-6 h-6 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dados dos Produtos Havaianas"}),$e.jsxs("p",{className:"text-gray-600",children:["Análise detalhada por produto e data",i.length>0&&$e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["• ",i.length.toLocaleString()," de ",g.length.toLocaleString()," registros (",s," a ",r,")"]})]})]})]}),$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:$e.jsx(w,{className:"h-5 w-5 text-gray-400"})}),$e.jsx("input",{type:"text",placeholder:"Buscar por nome ou ID do produto...",value:o,onChange:e=>c(e.target.value),className:"block w-80 pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visualizações Totais"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score de Grade Médio"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score de Promoção Médio"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transações Totais"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita Total"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dias"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.slice(0,20).map((e,t)=>{return $e.jsxs("tr",{className:"hover:bg-gray-50",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{children:[$e.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.item_name}),$e.jsx("div",{className:"text-sm text-gray-500",children:e.item_id})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j(e.totalViews)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{children:e.avgScore.toFixed(2)}),$e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:$e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:100*e.avgScore+"%"}})})]})}),$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.avgPromo.toFixed(2),"%"]}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j(e.totalTransactions)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:(s=e.totalRevenue,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s))}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.daysCount}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsx("button",{onClick:()=>u(e.item_id),className:"px-3 py-1 text-xs font-medium rounded-lg transition-colors "+(d===e.item_id?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"),title:d===e.item_id?"Produto selecionado":"Ver na timeline",children:d===e.item_id?"Selecionado":"Ver na Timeline"})})]},t);var s})})]})}),i.length>20&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Mostrando 20 de ",i.length," registros filtrados"]})})]})]})})},Gr=({data:t,selectedExperimentId:s,onExperimentSelect:r})=>{const[a,n]=e.useState(["lift"]),[i,l]=e.useState(["mobile","desktop"]);if(!t||0===t.length)return $e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[$e.jsx(v,{className:"w-5 h-5 text-gray-600"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Timeline de Experimentos"})]}),$e.jsx("div",{className:"text-center py-8",children:$e.jsx("p",{className:"text-gray-500",children:"Nenhum dado disponível para a timeline"})})]});const o=Array.from(new Set(t.map(e=>e.experiment_id))).map(e=>{const s=t.find(t=>t.experiment_id===e);return{id:e,name:(null==s?void 0:s.experiment_name)||e}}),c=Array.from(new Set(t.map(e=>e.experiment_variant||"controle"))),d=Array.from(new Set(t.map(e=>e.category))),u=t.filter(e=>{const t=!s||e.experiment_id===s,r=i.includes(e.category);return t&&r}),m=(()=>{const e=new Map;u.forEach(t=>{const s=t.event_date,r=t.experiment_variant||"controle",a=`${t.category}_${r}`;e.has(s)||e.set(s,{date:s});const n=e.get(s);n[`${a}_sessions`]=(n[`${a}_sessions`]||0)+t.sessions,n[`${a}_revenue`]=(n[`${a}_revenue`]||0)+t.revenue,n[`${a}_transactions`]=(n[`${a}_transactions`]||0)+t.transactions});const t=Array.from(e.values()).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());return t.map((e,s)=>{const r={...e};if(0===s)return r;for(let a=0;a<s;a++){const e=t[a];Object.keys(e).forEach(t=>{"date"!==t&&"number"==typeof e[t]&&(r[t]=(r[t]||0)+e[t])})}return r}).map(e=>{const t={date:e.date};return d.forEach(s=>{const r=`${s}_controle`,a=e[`${r}_sessions`]||0,n=e[`${r}_revenue`]||0,i=e[`${r}_transactions`]||0,l=a>0?n/a:0;c.forEach(r=>{if("controle"!==r){const n=`${s}_${r}`,o=e[`${n}_sessions`]||0,c=e[`${n}_revenue`]||0,d=e[`${n}_transactions`]||0,u=l>0?((o>0?c/o:0)-l)/l*100:0;t[`${s}_${r}_lift`]=u;let m=1;if(a>0&&o>0&&(i>0||d>0)){const e=i/a,t=d/o,s=(i+d)/(a+o),r=s*(1-s),n=Math.sqrt(r*(1/a+1/o));if(n>0){const s=Math.abs((t-e)/n);m=s>=2.576?.01:s>=1.96?.05:s>=1.645?.1:s>=1.282?.2:.5}}t[`${s}_${r}_pvalue`]=m}})}),t}).map(e=>({...e,date:new Date(e.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}))})(),x=(()=>{const e=[];if(m.length>0){const t=m[m.length-1];i.forEach(s=>{c.filter(e=>"controle"!==e&&u.some(t=>t.category===s&&(t.experiment_variant||"controle")===e)).forEach(r=>{const a=`${s}_${r}_pvalue`,n=(null==t?void 0:t[`${s}_${r}_lift`])||0,i=(null==t?void 0:t[a])||1;n>0&&i<=.05&&e.push({category:s,variant:r,lift:n,pValue:i})})})}return e})(),p=[{key:"lift",label:"Lift Receita/Sessão",color:"#10b981",icon:v,yAxisId:"left"},{key:"pvalue",label:"P-Value (Significância)",color:"#ef4444",icon:h,yAxisId:"right"}],f=({active:e,payload:t,label:s})=>e&&t&&t.length?$e.jsxs("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-lg max-w-sm",children:[$e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:s}),$e.jsx("p",{className:"text-xs text-blue-600 mb-3",children:"📈 Métricas acumuladas vs Controle"}),$e.jsx("div",{className:"space-y-2",children:t.map((e,t)=>{const[s,r,a]=e.dataKey.split("_"),n=e.value;let i="",l="text-gray-600";return"lift"===a?(i=`${n>0?"+":""}${n.toFixed(2)}%`,l=n>0?"text-green-600":n<0?"text-red-600":"text-gray-600"):"pvalue"===a&&(i=n.toFixed(3),l=n<=.05?"text-green-600":n<=.1?"text-yellow-600":"text-red-600"),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),$e.jsxs("span",{className:"text-sm text-gray-600",children:["mobile"===s?"📱":"💻"," ",r," - ","lift"===a?"Lift":"P-Value"]})]}),$e.jsx("span",{className:`text-sm font-medium ${l}`,children:i})]},t)})})]}):null;return $e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(v,{className:"w-5 h-5 text-gray-600"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lift e Significância Estatística (Acumulado)"})]}),$e.jsx("div",{className:"text-sm text-gray-500 bg-green-50 px-3 py-1 rounded-lg",children:"📈 Lift e P-Value acumulados vs Controle"})]}),x.length>0&&$e.jsxs("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-4",children:[$e.jsx("div",{className:"flex items-center gap-3 mb-3",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-2xl",children:"🏆"}),$e.jsx("h4",{className:"text-lg font-bold text-green-800",children:"Testes Vencedores Detectados!"})]})}),$e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:x.map((e,t)=>$e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:["mobile"===e.category?$e.jsx(q,{className:"w-4 h-4 text-blue-600"}):$e.jsx(Y,{className:"w-4 h-4 text-green-600"}),$e.jsxs("span",{className:"font-medium text-gray-800",children:["mobile"===e.category?"Mobile":"Desktop"," - Variante ",e.variant]})]}),$e.jsxs("div",{className:"text-right",children:[$e.jsxs("div",{className:"text-sm font-bold text-green-600",children:["+",e.lift.toFixed(1),"%"]}),$e.jsxs("div",{className:"text-xs text-gray-600",children:["p = ",e.pValue.toFixed(3)]})]})]}),$e.jsxs("div",{className:"text-xs text-green-700 mt-2",children:["🎉 ",$e.jsx("strong",{children:"Recomendação:"})," Implementar esta variante em produção para maximizar a receita por sessão."]})]},t))})]}),o.length>1&&$e.jsxs("div",{className:"mb-6",children:[$e.jsx("label",{htmlFor:"experiment-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecione o Experimento:"}),$e.jsxs("select",{id:"experiment-select",value:s||"",onChange:e=>null==r?void 0:r(e.target.value),className:"w-full md:w-96 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[$e.jsx("option",{value:"",children:"Todos os Experimentos"}),o.map(e=>$e.jsx("option",{value:e.id,children:e.name},e.id))]})]}),$e.jsxs("div",{className:"mb-6",children:[$e.jsx("div",{className:"flex items-center gap-2 mb-3",children:$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Dispositivos:"})}),$e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(e=>{const t="mobile"===e?q:Y;return $e.jsxs("button",{onClick:()=>(e=>{l(t=>t.includes(e)?t.length>1?t.filter(t=>t!==e):t:[...t,e])})(e),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(i.includes(e)?"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"),children:[$e.jsx(t,{className:"w-4 h-4"}),$e.jsx("span",{className:"capitalize",children:e})]},e)})})]}),$e.jsxs("div",{className:"mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Métricas:"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"(Selecione 1 ou 2)"})]}),$e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(e=>{const t=e.icon;return $e.jsxs("button",{onClick:()=>{return t=e.key,void n(e=>e.includes(t)?e.length>1?e.filter(e=>e!==t):e:e.length<2?[...e,t]:[e[1],t]);var t},className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(a.includes(e.key)?"bg-blue-100 text-blue-700 border-2 border-blue-300":"bg-gray-100 text-gray-600 border-2 border-transparent hover:bg-gray-200"),children:[$e.jsx(t,{className:"w-4 h-4"}),$e.jsx("span",{children:e.label}),a.includes(e.key)&&$e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}})]},e.key)})})]}),$e.jsx("div",{className:"h-80 mb-6",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:m,margin:{top:5,right:30,left:20,bottom:5},children:[$e.jsx(je,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),$e.jsx(Ne,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1}),$e.jsx(_e,{yAxisId:"left",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>`${e.toFixed(1)}%`}),$e.jsx(_e,{yAxisId:"right",orientation:"right",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>e.toFixed(3)}),$e.jsx(ke,{content:$e.jsx(f,{})}),$e.jsx(Se,{}),(()=>{const e=[];return i.forEach(t=>{c.filter(e=>"controle"!==e&&u.some(s=>s.category===t&&(s.experiment_variant||"controle")===e)).forEach(s=>{a.forEach(r=>{const a=`${t}_${s}_${r}`,n="mobile"===t?"#3b82f6":"#10b981",i="pvalue"===r?"5 5":"0";e.push($e.jsx(Ce,{yAxisId:"pvalue"===r?"right":"left",type:"monotone",dataKey:a,stroke:n,strokeWidth:3,strokeDasharray:i,dot:{fill:n,strokeWidth:2,r:5},activeDot:{r:7,stroke:n,strokeWidth:2},name:`${"mobile"===t?"📱":"💻"} ${s} - ${"lift"===r?"Lift":"P-Value"}`},a))})})}),e})()]})})}),$e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:i.map(e=>{const t=c.filter(t=>"controle"!==t&&u.some(s=>s.category===e&&(s.experiment_variant||"controle")===t));return 0===t.length?null:$e.jsxs("div",{className:"text-center",children:[$e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:["mobile"===e?$e.jsx(q,{className:"w-4 h-4 text-blue-600"}):$e.jsx(Y,{className:"w-4 h-4 text-green-600"}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"mobile"===e?"Mobile":"Desktop"})]}),$e.jsx("div",{className:"space-y-2",children:t.map(t=>{const s=m[m.length-1],r=`${e}_${t}_pvalue`,a=(null==s?void 0:s[`${e}_${t}_lift`])||0,n=(null==s?void 0:s[r])||1,i=a>0&&n<=.05,l=a>0&&n<=.1,o=a<0&&n<=.05;return $e.jsxs("div",{className:"rounded-lg p-3 "+(i?"bg-green-50 border-2 border-green-200":l?"bg-yellow-50 border-2 border-yellow-200":o?"bg-red-50 border-2 border-red-200":"bg-gray-50"),children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Variante ",t]}),i&&$e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[$e.jsx("span",{className:"text-xs",children:"🏆"}),$e.jsx("span",{className:"text-xs font-medium",children:"VENCEDOR"})]}),l&&!i&&$e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[$e.jsx("span",{className:"text-xs",children:"⚡"}),$e.jsx("span",{className:"text-xs font-medium",children:"PROMISSOR"})]}),o&&$e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[$e.jsx("span",{className:"text-xs",children:"📉"}),$e.jsx("span",{className:"text-xs font-medium",children:"PERDEDOR"})]})]}),$e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[$e.jsx("span",{className:"text-xs text-gray-600",children:"Lift:"}),$e.jsxs("span",{className:"text-sm font-medium "+(a>0?"text-green-600":a<0?"text-red-600":"text-gray-600"),children:[a>0?"+":"",a.toFixed(2),"%"]})]}),$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("span",{className:"text-xs text-gray-600",children:"P-Value:"}),$e.jsx("span",{className:"text-sm font-medium "+(n<=.05?"text-green-600":n<=.1?"text-yellow-600":"text-red-600"),children:n.toFixed(3)})]}),i&&$e.jsxs("div",{className:"text-xs text-green-700 bg-green-100 rounded px-2 py-1 mt-2",children:["🎉 ",$e.jsx("strong",{children:"Teste vencedor!"})," Variante ",t," apresenta ",a.toFixed(1),"% de melhoria com 95% de confiança estatística."]}),l&&!i&&$e.jsxs("div",{className:"text-xs text-yellow-700 bg-yellow-100 rounded px-2 py-1 mt-2",children:["⚡ ",$e.jsx("strong",{children:"Resultado promissor!"})," Variante ",t," mostra ",a.toFixed(1),"% de melhoria, mas precisa de mais dados para confirmação."]}),o&&$e.jsxs("div",{className:"text-xs text-red-700 bg-red-100 rounded px-2 py-1 mt-2",children:["📉 ",$e.jsx("strong",{children:"Teste perdedor!"})," Variante ",t," apresenta ",Math.abs(a).toFixed(1),"% de queda com significância estatística."]}),!i&&!l&&!o&&a>0&&$e.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 rounded px-2 py-1 mt-2",children:"📊 Resultado positivo mas sem significância estatística. Continue coletando dados."}),!i&&!l&&!o&&a<0&&$e.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 rounded px-2 py-1 mt-2",children:"📊 Resultado negativo mas sem significância estatística. Continue coletando dados."}),!i&&!l&&!o&&0===a&&$e.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 rounded px-2 py-1 mt-2",children:"📊 Sem diferença detectada. Continue coletando dados."})]},t)})})]},e)})})]})},qr=({selectedTable:t,startDate:s,endDate:r})=>{const[a,n]=e.useState([]),[i,l]=e.useState([]),[o,c]=e.useState(!1),[d,u]=e.useState(null),[m,x]=e.useState(""),[p,f]=e.useState(null),g=async()=>{if(t){c(!0),u(null);try{const e=localStorage.getItem("auth-token");if(!e)return void u("Token de autenticação não encontrado");const a=await fetch("https://api.mymetric.app/metrics/experiments",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({start_date:s,end_date:r,table_name:t})});if(500===a.status)return void u("cliente-sem-experimentos");if(!a.ok)throw new Error(`Erro na API: ${a.status}`);const i=await a.json();n(i||[])}catch(e){u(e instanceof Error?e.message:"Erro desconhecido")}finally{c(!1)}}};e.useEffect(()=>{g()},[t,s,r]),e.useEffect(()=>{if(a.length>0){const e=(e=>{const t=e.filter(e=>"mobile"===e.category||"desktop"===e.category),s=new Map;return t.forEach(e=>{const t=e.experiment_id;s.has(t)||s.set(t,{experiment_id:e.experiment_id,experiment_name:e.experiment_name,category:"mixed",variants:{},total_sessions:0,total_users:0,total_transactions:0,total_revenue:0,overall_conversion_rate:0,overall_revenue_per_session:0,mobile_data:null,desktop_data:null});const r=s.get(t),a=""===e.experiment_variant?"controle":e.experiment_variant,n=`${e.category}_${a}`;r.variants[n]||(r.variants[n]={sessions:0,users:0,users_percentage:0,transactions:0,revenue:0,conversion_rate:0,revenue_per_session:0,sessions_per_user:0,avg_order_value:0,category:e.category,variant:a,add_to_cart:0,begin_checkout:0,add_shipping_info:0,add_payment_info:0,add_to_cart_rate:0,begin_checkout_rate:0,add_shipping_info_rate:0,add_payment_info_rate:0}),r.variants[n].sessions+=e.sessions,r.variants[n].users+=e.users||0,r.variants[n].transactions+=e.transactions,r.variants[n].revenue+=e.revenue,r.variants[n].add_to_cart+=e.add_to_cart||0,r.variants[n].begin_checkout+=e.begin_checkout||0,r.variants[n].add_shipping_info+=e.add_shipping_info||0,r.variants[n].add_payment_info+=e.add_payment_info||0,r.total_sessions+=e.sessions,r.total_users+=e.users||0,r.total_transactions+=e.transactions,r.total_revenue+=e.revenue,"mobile"===e.category?(r.mobile_data||(r.mobile_data={sessions:0,transactions:0,revenue:0}),r.mobile_data.sessions+=e.sessions,r.mobile_data.transactions+=e.transactions,r.mobile_data.revenue+=e.revenue):"desktop"===e.category&&(r.desktop_data||(r.desktop_data={sessions:0,transactions:0,revenue:0}),r.desktop_data.sessions+=e.sessions,r.desktop_data.transactions+=e.transactions,r.desktop_data.revenue+=e.revenue)}),s.forEach(e=>{const t=Object.entries(e.variants).filter(([e])=>e.startsWith("mobile_")).reduce((e,[,t])=>e+t.users,0),s=Object.entries(e.variants).filter(([e])=>e.startsWith("desktop_")).reduce((e,[,t])=>e+t.users,0);Object.values(e.variants).forEach(e=>{e.conversion_rate=e.sessions>0?e.transactions/e.sessions*100:0,e.revenue_per_session=e.sessions>0?e.revenue/e.sessions:0,e.sessions_per_user=e.users>0?e.sessions/e.users:0,e.avg_order_value=e.transactions>0?e.revenue/e.transactions:0,e.add_to_cart_rate=e.sessions>0?e.add_to_cart/e.sessions*100:0,e.begin_checkout_rate=e.sessions>0?e.begin_checkout/e.sessions*100:0,e.add_shipping_info_rate=e.sessions>0?e.add_shipping_info/e.sessions*100:0,e.add_payment_info_rate=e.sessions>0?e.add_payment_info/e.sessions*100:0;const r="mobile"===e.category?t:s;e.users_percentage=r>0?e.users/r*100:0}),e.overall_conversion_rate=e.total_sessions>0?e.total_transactions/e.total_sessions*100:0,e.overall_revenue_per_session=e.total_sessions>0?e.total_revenue/e.total_sessions:0}),Array.from(s.values())})(a);l(e)}},[a]);const b=i.filter(e=>e.total_sessions>=50),y=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),w=e=>new Intl.NumberFormat("pt-BR").format(e),j=e=>`${e.toFixed(2)}%`,N=(e,t,s)=>{if(!e||!t||0===e[s])return null;return(t[s]-e[s])/e[s]*100},_=(e,t)=>{if(!e||!t)return null;const s=e.transactions,r=t.transactions;if(0===e.sessions||0===t.sessions)return null;if(0===s&&0===r)return null;const a=s/e.sessions,n=r/t.sessions,i=(s+r)/(e.sessions+t.sessions),l=i*(1-i),o=Math.sqrt(l*(1/e.sessions+1/t.sessions)),c=Math.abs((n-a)/o),d=2*(1-C(c)),u=2*Math.asin(Math.sqrt(n))-2*Math.asin(Math.sqrt(a));let m="Baixa";d<=.001?m="99.9%":d<=.01?m="99%":d<=.05?m="95%":d<=.1&&(m="90%");return{pValue:d,isSignificant:d<=.05,confidence:m,zScore:c,effectSize:u,power:S(e.sessions,t.sessions,u)}},C=e=>{const t=1/(1+.5*Math.abs(e)),s=t*Math.exp(-e*e-1.26551223+1.00002368*t+.37409196*t*t+.09678418*t*t*t-.18628806*t*t*t*t+.27886807*t*t*t*t*t-1.13520398*t*t*t*t*t*t+1.48851587*t*t*t*t*t*t*t-.82215223*t*t*t*t*t*t*t*t+.17087277*t*t*t*t*t*t*t*t*t);return e>=0?1-s:s},S=(e,t,s)=>{const r=e*t/(e+t),a=s*Math.sqrt(r/2)-1.96;return C(a)};return o?$e.jsx("div",{className:"flex items-center justify-center py-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx(I,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando experimentos..."})]})}):d?"cliente-sem-experimentos"===d?$e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center",children:[$e.jsxs("div",{className:"text-blue-600 mb-4",children:[$e.jsx(h,{className:"w-12 h-12 mx-auto mb-2"}),$e.jsx("h3",{className:"text-lg font-semibold",children:"Nenhum Experimento Ativo"})]}),$e.jsxs("p",{className:"text-blue-700 mb-4",children:["Este cliente não possui testes A/B ativos no período selecionado (",s," a ",r,")."]}),$e.jsx("p",{className:"text-blue-600 text-sm",children:"Os experimentos podem estar em outras datas ou o cliente pode não ter configurado testes A/B ainda."})]}):$e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[$e.jsxs("div",{className:"text-red-600 mb-4",children:[$e.jsx(h,{className:"w-12 h-12 mx-auto mb-2"}),$e.jsx("h3",{className:"text-lg font-semibold",children:"Erro ao carregar dados"})]}),$e.jsx("p",{className:"text-red-700 mb-4",children:d}),$e.jsx("button",{onClick:g,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Tentar novamente"})]}):$e.jsxs("div",{className:"space-y-6",children:[i.length>b.length&&$e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:[$e.jsx("span",{className:"font-medium",children:"Filtro ativo:"})," Ocultando ",i.length-b.length," experimento(s) com menos de 50 sessões totais."]}),$e.jsx("div",{className:"flex justify-end mb-4",children:$e.jsxs("button",{onClick:()=>{if(0===b.length)return;const e=[["ID do Experimento","Nome do Experimento","Categoria","Variante","Sessões","Usuários","% Tráfego (Usuários)","Sessões/Usuário","Transações","Receita","Taxa de Conversão","Receita por Sessão","Ticket Médio","Add to Cart","Taxa Add to Cart","Begin Checkout","Taxa Begin Checkout","Add Shipping Info","Taxa Add Shipping Info","Add Payment Info","Taxa Add Payment Info"].join(","),...b.flatMap(e=>Object.entries(e.variants).map(([t,s])=>[e.experiment_id,`"${e.experiment_name}"`,e.category,"controle"===t?"Controle":`Variante ${t}`,s.sessions,s.users,s.users_percentage.toFixed(2),s.sessions_per_user.toFixed(2),s.transactions,s.revenue,s.conversion_rate.toFixed(2),s.revenue_per_session.toFixed(2),s.avg_order_value.toFixed(2),s.add_to_cart,s.add_to_cart_rate.toFixed(2),s.begin_checkout,s.begin_checkout_rate.toFixed(2),s.add_shipping_info,s.add_shipping_info_rate.toFixed(2),s.add_payment_info,s.add_payment_info_rate.toFixed(2)].join(",")))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),n=URL.createObjectURL(t);a.setAttribute("href",n),a.setAttribute("download",`experimentos_ab_agregados_${s}_${r}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},disabled:0===b.length,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm",children:[$e.jsx(D,{className:"w-4 h-4"}),"Exportar CSV"]})}),a.length>0&&$e.jsx(Gr,{data:a,selectedExperimentId:m,onExperimentSelect:x}),$e.jsxs("div",{className:"space-y-8",children:[b.map(e=>$e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:$e.jsx("div",{className:"flex items-center justify-between",children:$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.experiment_name}),$e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[$e.jsxs("span",{children:[$e.jsx("strong",{children:"ID:"})," ",e.experiment_id]}),$e.jsxs("span",{className:"flex items-center gap-2",children:[$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx(Y,{className:"w-4 h-4"}),$e.jsx("strong",{children:"Desktop:"})," ",e.desktop_data?w(e.desktop_data.sessions):"0"," sessões"]}),$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx(q,{className:"w-4 h-4"}),$e.jsx("strong",{children:"Mobile:"})," ",e.mobile_data?w(e.mobile_data.sessions):"0"," sessões"]})]}),$e.jsxs("span",{children:[$e.jsx("strong",{children:"Total Sessões:"})," ",w(e.total_sessions)]}),$e.jsxs("span",{children:[$e.jsx("strong",{children:"Total Usuários:"})," ",w(e.total_users)]}),$e.jsxs("span",{children:[$e.jsx("strong",{children:"Total Receita:"})," ",y(e.total_revenue)]})]})]})})}),$e.jsxs("div",{className:"m-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-gray-200 rounded-lg",children:[$e.jsx("div",{className:"px-6 py-3 border-b border-blue-200",children:$e.jsx("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:"📊 Resumo por Dispositivo"})}),$e.jsxs("div",{className:"px-6 py-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200 shadow-sm",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(Y,{className:"w-5 h-5 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h4",{className:"font-semibold text-gray-900",children:"Desktop"}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Análise para computadores"})]})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"text-2xl font-bold mb-1",children:(()=>{const t=e.variants.desktop_controle,s=e.variants.desktop_1||e.variants.desktop_2;if(!t||!s)return"N/A";const r=N(t,s,"revenue_per_session");return null===r?"N/A":$e.jsxs("span",{className:r>0?"text-green-600":"text-red-600",children:[r>0?"+":"",r.toFixed(1),"%"]})})()}),$e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Lift"}),$e.jsx("div",{className:"text-xs text-gray-600",children:"Receita/Sessão"})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"text-2xl font-bold mb-1",children:(()=>{const t=e.variants.desktop_controle,s=e.variants.desktop_1||e.variants.desktop_2;if(!t||!s)return"N/A";const r=_(t,s);return r?$e.jsx("span",{className:r.isSignificant?"text-green-600":"text-yellow-600",children:r.isSignificant?"✓":"⚠️"}):"N/A"})()}),$e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Significância"}),$e.jsx("div",{className:"text-xs text-gray-600",children:"p < 0.05"})]})]})]}),$e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200 shadow-sm",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:$e.jsx(q,{className:"w-5 h-5 text-green-600"})}),$e.jsxs("div",{children:[$e.jsx("h4",{className:"font-semibold text-gray-900",children:"Mobile"}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Análise para dispositivos móveis"})]})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"text-2xl font-bold mb-1",children:(()=>{const t=e.variants.mobile_controle,s=e.variants.mobile_1||e.variants.mobile_2;if(!t||!s)return"N/A";const r=N(t,s,"revenue_per_session");return null===r?"N/A":$e.jsxs("span",{className:r>0?"text-green-600":"text-red-600",children:[r>0?"+":"",r.toFixed(1),"%"]})})()}),$e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Lift"}),$e.jsx("div",{className:"text-xs text-gray-600",children:"Receita/Sessão"})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"text-2xl font-bold mb-1",children:(()=>{const t=e.variants.mobile_controle,s=e.variants.mobile_1||e.variants.mobile_2;if(!t||!s)return"N/A";const r=_(t,s);return r?$e.jsx("span",{className:r.isSignificant?"text-green-600":"text-yellow-600",children:r.isSignificant?"✓":"⚠️"}):"N/A"})()}),$e.jsx("div",{className:"text-sm font-medium text-gray-800",children:"Significância"}),$e.jsx("div",{className:"text-xs text-gray-600",children:"p < 0.05"})]})]})]}),(()=>{const t=e.variants.desktop_controle,a=e.variants.desktop_1||e.variants.desktop_2,n=e.variants.mobile_controle,i=e.variants.mobile_1||e.variants.mobile_2;let l=0,o=0,c=!1,d=!1;if(t&&a){const e=_(t,a);if((null==e?void 0:e.isSignificant)&&a.revenue_per_session>t.revenue_per_session){l=(a.revenue_per_session-t.revenue_per_session)*((t.sessions+a.sessions)/Math.max(1,(new Date(r).getTime()-new Date(s).getTime())/864e5+1))*365,c=!0}}if(n&&i){const e=_(n,i);if((null==e?void 0:e.isSignificant)&&i.revenue_per_session>n.revenue_per_session){o=(i.revenue_per_session-n.revenue_per_session)*((n.sessions+i.sessions)/Math.max(1,(new Date(r).getTime()-new Date(s).getTime())/864e5+1))*365,d=!0}}const u=l+o;return c||d?$e.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-green-300 shadow-sm col-span-full",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-100 to-emerald-100 rounded-lg",children:$e.jsx(R,{className:"w-5 h-5 text-green-600"})}),$e.jsxs("div",{children:[$e.jsx("h4",{className:"font-semibold text-gray-900",children:"💰 Projeção de Receita Adicional Anual"}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Ganho potencial ao implementar a variante vencedora"})]})]}),$e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[$e.jsxs("div",{className:"text-center mb-4",children:[$e.jsxs("div",{className:"text-3xl font-bold text-green-700 mb-2",children:["+",y(u)]}),$e.jsx("div",{className:"text-sm text-green-600",children:"por ano em receita adicional estimada (total)"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[c&&$e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[$e.jsx(Y,{className:"w-4 h-4 text-blue-600"}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Desktop"})]}),$e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["+",y(l)]}),$e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[(l/u*100).toFixed(1),"% do total"]})]}),d&&$e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[$e.jsx(q,{className:"w-4 h-4 text-green-600"}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mobile"})]}),$e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",y(o)]}),$e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[(o/u*100).toFixed(1),"% do total"]})]})]}),$e.jsx("div",{className:"pt-3 border-t border-green-200",children:$e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsx("span",{children:"📊 Base de cálculo:"}),$e.jsx("span",{className:"font-medium",children:"Lift de receita/sessão × volume anual"})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsx("span",{children:"📅 Período analisado:"}),$e.jsxs("span",{className:"font-medium",children:[new Date(s).toLocaleDateString("pt-BR")," a ",new Date(r).toLocaleDateString("pt-BR")]})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsx("span",{children:"✅ Significância:"}),$e.jsx("span",{className:"font-medium text-green-600",children:"Estatisticamente comprovado (p < 0.05)"})]})]})})]}),$e.jsxs("div",{className:"mt-3 text-xs text-gray-500 bg-blue-50 rounded px-3 py-2",children:["💡 ",$e.jsx("strong",{children:"Nota:"})," Esta é uma projeção conservadora baseada no desempenho atual. Resultados reais podem variar devido a sazonalidade e mudanças no comportamento do usuário."]})]}):null})()]})]}),$e.jsxs("div",{className:"m-6 border border-gray-200 rounded-lg shadow-sm",children:[$e.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[$e.jsx("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:"📈 Detalhamento por Variante e Dispositivo"}),$e.jsxs("button",{onClick:()=>f(e.experiment_id),className:"flex items-center gap-2 px-3 py-1 text-xs font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-200 rounded transition-colors",children:[$e.jsx(K,{className:"w-4 h-4"}),"Tela Cheia"]})]}),$e.jsx("div",{className:"px-6 py-3 bg-purple-50 border-b border-purple-200",children:$e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-800",children:[$e.jsx("span",{className:"font-semibold",children:"Eventos do Funil:"}),$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-block w-2 h-2 bg-purple-400 rounded-full"}),"Carrinho = Add to Cart"]}),$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-block w-2 h-2 bg-purple-400 rounded-full"}),"Checkout = Begin Checkout"]}),$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-block w-2 h-2 bg-purple-400 rounded-full"}),"Envio = Add Shipping Info"]}),$e.jsxs("span",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-block w-2 h-2 bg-purple-400 rounded-full"}),"Pagamento = Add Payment Info"]})]})}),$e.jsx("div",{className:"overflow-auto",children:$e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Variante"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuários"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões/Usuário"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transações"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taxa Conv."}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rec./Sessão"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket Médio"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50 border-l-2 border-purple-200",children:"Carrinho"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50",children:"Checkout"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50",children:"Envio"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50 border-r-2 border-purple-200",children:"Pagamento"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lift"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Signif."})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(e.variants).map(([t,s])=>{const[r,a]=t.split("_"),n="controle"===a,i="mobile"===r,l=i?"mobile_controle":"desktop_controle",o=e.variants[l],c=!n&&o?N(o,s,"revenue_per_session"):null,d=!n&&o?N(o,s,"add_to_cart_rate"):null,u=!n&&o?N(o,s,"begin_checkout_rate"):null,m=!n&&o?N(o,s,"add_shipping_info_rate"):null,h=!n&&o?N(o,s,"add_payment_info_rate"):null;return $e.jsxs("tr",{className:`${n?"bg-blue-50":"hover:bg-gray-50"} ${i?"border-l-4 border-l-blue-200":"border-l-4 border-l-green-200"}`,children:[$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium "+(i?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[i?$e.jsx(q,{className:"w-3 h-3"}):$e.jsx(Y,{className:"w-3 h-3"}),r]}),$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium "+(n?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:n?"Ctrl":`V${a}`})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:w(s.sessions)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{children:[$e.jsx("div",{className:"font-medium",children:w(s.users)}),$e.jsxs("div",{className:"text-xs text-gray-500",children:[j(s.users_percentage)," do tráfego"]})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:s.sessions_per_user.toFixed(2)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:w(s.transactions)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:y(s.revenue)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:j(s.conversion_rate)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:y(s.revenue_per_session)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:y(s.avg_order_value)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50 border-l-2 border-purple-200",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_to_cart)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_to_cart_rate)}),!n&&null!==d&&$e.jsxs("div",{className:"text-xs font-medium "+(d>0?"text-green-600":"text-red-600"),children:[d>0?"↑":"↓",Math.abs(d).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.begin_checkout)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.begin_checkout_rate)}),!n&&null!==u&&$e.jsxs("div",{className:"text-xs font-medium "+(u>0?"text-green-600":"text-red-600"),children:[u>0?"↑":"↓",Math.abs(u).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_shipping_info)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_shipping_info_rate)}),!n&&null!==m&&$e.jsxs("div",{className:"text-xs font-medium "+(m>0?"text-green-600":"text-red-600"),children:[m>0?"↑":"↓",Math.abs(m).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50 border-r-2 border-purple-200",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_payment_info)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_payment_info_rate)}),!n&&null!==h&&$e.jsxs("div",{className:"text-xs font-medium "+(h>0?"text-green-600":"text-red-600"),children:[h>0?"↑":"↓",Math.abs(h).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:n||null===c?$e.jsx("span",{className:"text-sm text-gray-400",children:"-"}):$e.jsxs("div",{className:"flex items-center gap-1",children:[c>0?$e.jsx(v,{className:"w-4 h-4 text-green-600"}):$e.jsx(M,{className:"w-4 h-4 text-red-600"}),$e.jsxs("span",{className:"text-sm font-medium "+(c>0?"text-green-600":"text-red-600"),children:[c>0?"+":"",c.toFixed(1),"%"]})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:!n&&o?(()=>{const e=_(o,s);return e?$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium "+(e.isSignificant?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.isSignificant?"✓":"⚠️"}),$e.jsxs("div",{className:"text-xs",children:[$e.jsx("div",{className:"font-medium "+(e.isSignificant?"text-green-700":"text-yellow-700"),children:e.confidence}),$e.jsxs("div",{className:"text-gray-500 text-xs",children:["p=",e.pValue.toFixed(3)]})]})]}):$e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})():$e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})]},t)})})]})})]})]},e.experiment_id)),0===b.length&&$e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[$e.jsx(X,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum experimento encontrado"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de experimentos para o período e filtros selecionados."})]})]}),p&&(()=>{const e=b.find(e=>e.experiment_id===p);return e?$e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:$e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full h-full max-w-[98vw] max-h-[98vh] flex flex-col",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.experiment_name}),$e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ID: ",e.experiment_id]})]}),$e.jsx("button",{onClick:()=>f(null),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors",children:$e.jsx(k,{className:"w-6 h-6"})})]}),$e.jsx("div",{className:"flex-1 overflow-auto p-6",children:$e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Variante"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuários"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões/Usuário"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transações"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taxa Conv."}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rec./Sessão"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket Médio"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50 border-l-2 border-purple-200",children:"Carrinho"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50",children:"Checkout"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50",children:"Envio"}),$e.jsx("th",{className:"px-3 py-3 text-center text-xs font-medium text-purple-700 uppercase tracking-wider bg-purple-50 border-r-2 border-purple-200",children:"Pagamento"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lift"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Signif."})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(e.variants).map(([t,s])=>{const[r,a]=t.split("_"),n="controle"===a,i="mobile"===r,l=i?"mobile_controle":"desktop_controle",o=e.variants[l],c=!n&&o?N(o,s,"revenue_per_session"):null,d=!n&&o?N(o,s,"add_to_cart_rate"):null,u=!n&&o?N(o,s,"begin_checkout_rate"):null,m=!n&&o?N(o,s,"add_shipping_info_rate"):null,h=!n&&o?N(o,s,"add_payment_info_rate"):null;return $e.jsxs("tr",{className:`${n?"bg-blue-50":"hover:bg-gray-50"} ${i?"border-l-4 border-l-blue-200":"border-l-4 border-l-green-200"}`,children:[$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium "+(i?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[i?$e.jsx(q,{className:"w-3 h-3"}):$e.jsx(Y,{className:"w-3 h-3"}),r]}),$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium "+(n?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:n?"Ctrl":`V${a}`})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:w(s.sessions)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{children:[$e.jsx("div",{className:"font-medium",children:w(s.users)}),$e.jsxs("div",{className:"text-xs text-gray-500",children:[j(s.users_percentage)," do tráfego"]})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:s.sessions_per_user.toFixed(2)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:w(s.transactions)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:y(s.revenue)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:j(s.conversion_rate)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:y(s.revenue_per_session)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900",children:y(s.avg_order_value)}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50 border-l-2 border-purple-200",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_to_cart)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_to_cart_rate)}),!n&&null!==d&&$e.jsxs("div",{className:"text-xs font-medium "+(d>0?"text-green-600":"text-red-600"),children:[d>0?"↑":"↓",Math.abs(d).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.begin_checkout)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.begin_checkout_rate)}),!n&&null!==u&&$e.jsxs("div",{className:"text-xs font-medium "+(u>0?"text-green-600":"text-red-600"),children:[u>0?"↑":"↓",Math.abs(u).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_shipping_info)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_shipping_info_rate)}),!n&&null!==m&&$e.jsxs("div",{className:"text-xs font-medium "+(m>0?"text-green-600":"text-red-600"),children:[m>0?"↑":"↓",Math.abs(m).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-gray-900 bg-purple-50 border-r-2 border-purple-200",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"font-medium",children:w(s.add_payment_info)}),$e.jsx("div",{className:"text-xs text-gray-600",children:j(s.add_payment_info_rate)}),!n&&null!==h&&$e.jsxs("div",{className:"text-xs font-medium "+(h>0?"text-green-600":"text-red-600"),children:[h>0?"↑":"↓",Math.abs(h).toFixed(1),"%"]}),n&&$e.jsx("div",{className:"text-xs text-gray-400",children:"controle"})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:n||null===c?$e.jsx("span",{className:"text-sm text-gray-400",children:"-"}):$e.jsxs("div",{className:"flex items-center gap-1",children:[c>0?$e.jsx(v,{className:"w-4 h-4 text-green-600"}):$e.jsx(M,{className:"w-4 h-4 text-red-600"}),$e.jsxs("span",{className:"text-sm font-medium "+(c>0?"text-green-600":"text-red-600"),children:[c>0?"+":"",c.toFixed(1),"%"]})]})}),$e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:!n&&o?(()=>{const e=_(o,s);return e?$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium "+(e.isSignificant?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.isSignificant?"✓":"⚠️"}),$e.jsxs("div",{className:"text-xs",children:[$e.jsx("div",{className:"font-medium "+(e.isSignificant?"text-green-700":"text-yellow-700"),children:e.confidence}),$e.jsxs("div",{className:"text-gray-500 text-xs",children:["p=",e.pValue.toFixed(3)]})]})]}):$e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})():$e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})]},t)})})]})})]})}):null})()]})},Yr=({selectedTable:t})=>{const[s,r]=e.useState([]),[a,n]=e.useState(!0),[i,l]=e.useState(""),[o,c]=e.useState("purchases_week_4"),[d,u]=e.useState("desc"),[m,h]=e.useState("all"),[p,f]=e.useState(100),[g,b]=e.useState(0),[y,N]=e.useState(!1),[_,k]=e.useState(!1),[C,S]=e.useState(new Set),T=e.useCallback(async(e=0)=>{try{const s=localStorage.getItem("auth-token");if(!s||!t)return;if(!is(t))return;const a=(await ls.getProductTrend(s,{table_name:t,limit:p,offset:e,order_by:o})).data||[];r(e=>{const t=new Set(e.map(e=>e.item_id)),s=a.filter(e=>!t.has(e.item_id));return[...e,...s]}),b(e=>e+a.length),a.length===p?(N(!0),setTimeout(()=>{T(e+p)},500)):N(!1)}catch(s){N(!1)}},[t,p,o]);e.useEffect(()=>{(async()=>{n(!0),r([]),b(0),N(!1);try{const e=localStorage.getItem("auth-token");if(!e||!t)return void n(!1);if(!is(t))return void n(!1);const s=(await ls.getProductTrend(e,{table_name:t,limit:p,offset:0,order_by:o})).data||[],a=s.filter((e,t,s)=>t===s.findIndex(t=>t.item_id===e.item_id));r(a),b(a.length),s.length===p?(N(!0),setTimeout(()=>{T(p)},500)):N(!1)}catch(e){N(!1)}finally{n(!1)}})()},[t,p,o,T]);const A=s.filter(e=>{const t=e.item_name.toLowerCase().includes(i.toLowerCase())||e.item_id.includes(i),s="all"===m||"up"===m&&e.trend_consistency.includes("Growth")||"down"===m&&e.trend_consistency.includes("Decline")||"stable"===m&&e.trend_consistency.includes("Stable");return t&&s}),E=e=>{o===e?u("asc"===d?"desc":"asc"):(c(e),u("desc"))},R=e=>new Intl.NumberFormat("pt-BR").format(e),P=e=>`${e>0?"+":""}${e.toFixed(1)}%`,L=(e,t)=>null==e||null==t?null:0===t?e>0?-100:0:-(e-t)/t*100,O=(e,t)=>null==e||null==t?null:0===t?e>0?100:0:(e-t)/t*100,I=(e,t)=>null==e||null==t?null:0===t?e>0?100:0:(e-t)/t*100,D=e=>e.includes("Growth")?"text-green-600 bg-green-50 border-green-200":e.includes("Decline")?"text-red-600 bg-red-50 border-red-200":"text-gray-600 bg-gray-50 border-gray-200",F=s.length,B=s.filter(e=>e.trend_consistency.includes("Growth")).length,$=s.filter(e=>e.trend_consistency.includes("Decline")).length;return a&&0===s.length?$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando dados de produtos..."}),$e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Carregando automaticamente em lotes de ",p," produtos"]})]}):$e.jsxs("div",{className:""+(_?"fixed inset-0 z-50 bg-white overflow-auto p-6":"space-y-6"),children:[$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:$e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[$e.jsxs("div",{children:[$e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[$e.jsx(x,{className:"w-8 h-8 text-blue-600"}),"Análise de Tendência de Produtos"]}),$e.jsx("p",{className:"text-gray-600 mt-2",children:"Acompanhe o desempenho e tendências dos produtos nas últimas 4 semanas"})]}),$e.jsxs("div",{className:"flex items-center gap-4",children:[y&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[$e.jsx(j,{className:"w-4 h-4 animate-spin"}),$e.jsx("span",{children:"Carregando automaticamente..."}),$e.jsxs("span",{className:"text-gray-500",children:["(",g," produtos)"]})]}),!y&&g>0&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[$e.jsx(x,{className:"w-4 h-4"}),$e.jsx("span",{children:"Carregamento concluído"}),$e.jsxs("span",{className:"text-gray-500",children:["(",g," produtos)"]})]})]})]})}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Produtos"}),$e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:R(F)})]}),$e.jsx(x,{className:"w-8 h-8 text-blue-600"})]})}),$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Crescimento"}),$e.jsx("p",{className:"text-2xl font-bold text-green-600",children:R(B)})]}),$e.jsx(v,{className:"w-8 h-8 text-green-600"})]})}),$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Declínio"}),$e.jsx("p",{className:"text-2xl font-bold text-red-600",children:R($)})]}),$e.jsx(M,{className:"w-8 h-8 text-red-600"})]})})]}),$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:$e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[$e.jsx("div",{className:"flex-1",children:$e.jsxs("div",{className:"relative",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Buscar por nome ou ID do produto...",value:i,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),$e.jsx("div",{className:"lg:w-48",children:$e.jsxs("select",{value:m,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[$e.jsx("option",{value:"all",children:"Todas as Tendências"}),$e.jsx("option",{value:"up",children:"Em Crescimento"}),$e.jsx("option",{value:"down",children:"Em Declínio"}),$e.jsx("option",{value:"stable",children:"Estáveis"})]})}),$e.jsx("div",{className:"lg:w-32",children:$e.jsxs("select",{value:p,onChange:e=>f(Number(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[$e.jsx("option",{value:50,children:"50 itens"}),$e.jsx("option",{value:100,children:"100 itens"}),$e.jsx("option",{value:200,children:"200 itens"})]})}),$e.jsx("div",{className:"lg:w-auto",children:$e.jsx("button",{onClick:()=>k(!_),className:"w-full px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 "+(_?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:_?$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V4.5M9 9H4.5M9 9L3.5 3.5M15 9V4.5M15 9h4.5M15 9l5.5-5.5M9 15v4.5M9 15H4.5M9 15l-5.5 5.5M15 15v4.5M15 15h4.5M15 15l5.5 5.5"})}),"Tela Normal"]}):$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),"Tela Cheia"]})})})]})}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),$e.jsx("th",{className:"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>E("purchases_week_1"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["W1","purchases_week_1"===o&&("asc"===d?$e.jsx(J,{className:"w-3 h-3"}):$e.jsx(Z,{className:"w-3 h-3"}))]})}),$e.jsx("th",{className:"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>E("purchases_week_2"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["W2","purchases_week_2"===o&&("asc"===d?$e.jsx(J,{className:"w-3 h-3"}):$e.jsx(Z,{className:"w-3 h-3"}))]})}),$e.jsx("th",{className:"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>E("purchases_week_3"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["W3","purchases_week_3"===o&&("asc"===d?$e.jsx(J,{className:"w-3 h-3"}):$e.jsx(Z,{className:"w-3 h-3"}))]})}),$e.jsx("th",{className:"px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>E("purchases_week_4"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["W4","purchases_week_4"===o&&("asc"===d?$e.jsx(J,{className:"w-3 h-3"}):$e.jsx(Z,{className:"w-3 h-3"}))]})}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"W1→W2"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"W2→W3"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"W3→W4"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Consistência"}),$e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),$e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[0===A.length?$e.jsx("tr",{children:$e.jsxs("td",{colSpan:11,className:"px-6 py-12 text-center text-gray-500",children:[$e.jsx(x,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),$e.jsx("p",{className:"text-lg font-medium",children:"Nenhum produto encontrado"}),$e.jsx("p",{className:"text-sm",children:"Tente ajustar os filtros ou a busca"})]})}):A.map(e=>{const s=C.has(e.item_id);return $e.jsxs($e.Fragment,{children:[$e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>{return t=e.item_id,void S(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t},children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{children:[$e.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.item_name}),$e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.item_id]})]})}),$e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-xs text-gray-900 text-center",children:R(e.purchases_week_1)}),$e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-xs text-gray-900 text-center",children:R(e.purchases_week_2)}),$e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-xs text-gray-900 text-center",children:R(e.purchases_week_3)}),$e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-xs font-medium text-gray-900 text-center",children:R(e.purchases_week_4)}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.percent_change_w1_w2>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w1_w2<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"text-xs font-medium "+(e.percent_change_w1_w2>0?"text-green-600":e.percent_change_w1_w2<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w1_w2)})]})}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.percent_change_w2_w3>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w2_w3<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"text-xs font-medium "+(e.percent_change_w2_w3>0?"text-green-600":e.percent_change_w2_w3<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w2_w3)})]})}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.percent_change_w3_w4>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w3_w4<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"text-xs font-medium "+(e.percent_change_w3_w4>0?"text-green-600":e.percent_change_w3_w4<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w3_w4)})]})}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsx("span",{className:"text-xs font-medium",children:e.trend_status})}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[(r=e.trend_consistency,r.includes("Growth")?$e.jsx(v,{className:"w-4 h-4 text-green-600"}):r.includes("Decline")?$e.jsx(M,{className:"w-4 h-4 text-red-600"}):$e.jsx(te,{className:"w-4 h-4 text-gray-600"})),$e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full border ${D(e.trend_consistency)}`,children:e.trend_consistency.replace("🔴","").replace("🟢","").replace("⚪","").trim()})]})}),$e.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:$e.jsx("div",{className:"px-3 py-1 text-xs font-medium text-blue-600 bg-blue-50 rounded-lg flex items-center gap-1",children:s?$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Ocultar"]}):$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Expandir"]})})})]},e.item_id),s&&$e.jsx("tr",{className:"bg-gray-50 border-t border-gray-200",children:$e.jsx("td",{colSpan:11,className:"px-6 py-4",children:$e.jsxs("div",{className:"space-y-4",children:[$e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[$e.jsx(v,{className:"w-4 h-4"}),"Análise Correlacional - Últimas 4 Semanas"]}),$e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:$e.jsxs("table",{className:"w-full text-xs",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Métrica"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W1"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W2"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W3"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W4"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W1→W2"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W2→W3"}),$e.jsx("th",{className:"px-2 py-2 text-center font-medium text-gray-700",children:"W3→W4"})]})}),$e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[$e.jsxs("tr",{className:"hover:bg-blue-50",children:[$e.jsx("td",{className:"px-3 py-2 font-medium text-blue-700",children:"Vendas"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:R(e.purchases_week_1)}),$e.jsx("td",{className:"px-2 py-2 text-center",children:R(e.purchases_week_2)}),$e.jsx("td",{className:"px-2 py-2 text-center",children:R(e.purchases_week_3)}),$e.jsx("td",{className:"px-2 py-2 text-center font-medium",children:R(e.purchases_week_4)}),$e.jsx("td",{className:"px-2 py-2 text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.percent_change_w1_w2>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w1_w2<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(e.percent_change_w1_w2>0?"text-green-600":e.percent_change_w1_w2<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w1_w2)})]})}),$e.jsx("td",{className:"px-2 py-2 text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.percent_change_w2_w3>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w2_w3<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(e.percent_change_w2_w3>0?"text-green-600":e.percent_change_w2_w3<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w2_w3)})]})}),$e.jsx("td",{className:"px-2 py-2 text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.percent_change_w3_w4>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):e.percent_change_w3_w4<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(e.percent_change_w3_w4>0?"text-green-600":e.percent_change_w3_w4<0?"text-red-600":"text-gray-600"),children:P(e.percent_change_w3_w4)})]})})]}),(null!==e.benchmark_week_1||null!==e.benchmark_week_2||null!==e.benchmark_week_3||null!==e.benchmark_week_4)&&$e.jsxs("tr",{className:"hover:bg-green-50",children:[$e.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:"Benchmark (%) - Google Merchant Center"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.benchmark_week_1&&void 0!==e.benchmark_week_1?`${(100*e.benchmark_week_1).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.benchmark_week_2&&void 0!==e.benchmark_week_2?`${(100*e.benchmark_week_2).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.benchmark_week_3&&void 0!==e.benchmark_week_3?`${(100*e.benchmark_week_3).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center font-medium",children:null!==e.benchmark_week_4&&void 0!==e.benchmark_week_4?`${(100*e.benchmark_week_4).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=L(e.benchmark_week_2,e.benchmark_week_1);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=L(e.benchmark_week_3,e.benchmark_week_2);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=L(e.benchmark_week_4,e.benchmark_week_3);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()})]}),(null!==e.clicks_week_1||null!==e.clicks_week_2||null!==e.clicks_week_3||null!==e.clicks_week_4)&&$e.jsxs("tr",{className:"hover:bg-purple-50",children:[$e.jsx("td",{className:"px-3 py-2 font-medium text-purple-700",children:"Cliques - Google Merchant Center"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.clicks_week_1&&void 0!==e.clicks_week_1?R(e.clicks_week_1):"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.clicks_week_2&&void 0!==e.clicks_week_2?R(e.clicks_week_2):"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.clicks_week_3&&void 0!==e.clicks_week_3?R(e.clicks_week_3):"-"}),$e.jsx("td",{className:"px-2 py-2 text-center font-medium",children:null!==e.clicks_week_4&&void 0!==e.clicks_week_4?R(e.clicks_week_4):"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=O(e.clicks_week_2,e.clicks_week_1);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=O(e.clicks_week_3,e.clicks_week_2);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=O(e.clicks_week_4,e.clicks_week_3);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()})]}),"havaianas"===t&&(null!==e.size_score_week_1||null!==e.size_score_week_2||null!==e.size_score_week_3||null!==e.size_score_week_4)&&$e.jsxs("tr",{className:"hover:bg-blue-50",children:[$e.jsx("td",{className:"px-3 py-2 font-medium text-blue-700",children:"Score de Grade (%)"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.size_score_week_1&&void 0!==e.size_score_week_1?`${(100*e.size_score_week_1).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.size_score_week_2&&void 0!==e.size_score_week_2?`${(100*e.size_score_week_2).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:null!==e.size_score_week_3&&void 0!==e.size_score_week_3?`${(100*e.size_score_week_3).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center font-medium",children:null!==e.size_score_week_4&&void 0!==e.size_score_week_4?`${(100*e.size_score_week_4).toFixed(1)}%`:"-"}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=I(e.size_score_week_2,e.size_score_week_1);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=I(e.size_score_week_3,e.size_score_week_2);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()}),$e.jsx("td",{className:"px-2 py-2 text-center",children:(()=>{const t=I(e.size_score_week_4,e.size_score_week_3);return null!==t?$e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t>0?$e.jsx(Q,{className:"w-3 h-3 text-green-600"}):t<0?$e.jsx(ee,{className:"w-3 h-3 text-red-600"}):$e.jsx(te,{className:"w-3 h-3 text-gray-600"}),$e.jsx("span",{className:"font-medium "+(t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"),children:P(t)})]}):$e.jsx("span",{className:"text-gray-400",children:"-"})})()})]})]})]})}),"havaianas"===t&&e.size_score_trend_status&&$e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200",children:[$e.jsx("h5",{className:"font-medium text-purple-900 mb-2",children:"Score de Grade"}),$e.jsx("p",{className:"text-purple-700",children:e.size_score_trend_status})]})]})})})]});var r}),y&&$e.jsx("tr",{children:$e.jsx("td",{colSpan:11,className:"px-6 py-6 text-center bg-blue-50",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[$e.jsx(j,{className:"w-5 h-5 animate-spin text-blue-600"}),$e.jsx("span",{className:"text-blue-600 font-medium",children:"Carregando mais produtos automaticamente..."}),$e.jsxs("span",{className:"text-sm text-gray-500",children:["(",g," carregados até agora)"]})]})})})]})]})}),$e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:$e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm text-gray-600",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[$e.jsxs("span",{children:["Total carregado: ",g," produtos"]}),$e.jsxs("span",{children:["Mostrando ",A.length," produtos filtrados"]}),i&&$e.jsxs("span",{className:"text-blue-600",children:['Filtrado por: "',i,'"']})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[y&&$e.jsxs("span",{className:"text-blue-600 flex items-center gap-1",children:[$e.jsx(j,{className:"w-3 h-3 animate-spin"}),"Carregando..."]}),!y&&g>0&&$e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[$e.jsx(x,{className:"w-3 h-3"}),"Carregamento completo"]})]})]})})]})]})};
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var Kr={version:"0.18.5"},Xr=1252,Jr=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Zr=function(e){-1!=Jr.indexOf(e)&&(Xr=e)};var Qr=function(e){Zr(e)};function ea(){Qr(1200),Zr(1252)}var ta,sa=function(e){return String.fromCharCode(e)},ra=function(e){return String.fromCharCode(e)},aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function na(e){for(var t="",s=0,r=0,a=0,n=0,i=0,l=0,o=0,c=0;c<e.length;)n=(s=e.charCodeAt(c++))>>2,i=(3&s)<<4|(r=e.charCodeAt(c++))>>4,l=(15&r)<<2|(a=e.charCodeAt(c++))>>6,o=63&a,isNaN(r)?l=o=64:isNaN(a)&&(o=64),t+=aa.charAt(n)+aa.charAt(i)+aa.charAt(l)+aa.charAt(o);return t}function ia(e){var t="",s=0,r=0,a=0,n=0,i=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<e.length;)s=aa.indexOf(e.charAt(o++))<<2|(n=aa.indexOf(e.charAt(o++)))>>4,t+=String.fromCharCode(s),r=(15&n)<<4|(i=aa.indexOf(e.charAt(o++)))>>2,64!==i&&(t+=String.fromCharCode(r)),a=(3&i)<<6|(l=aa.indexOf(e.charAt(o++))),64!==l&&(t+=String.fromCharCode(a));return t}var la=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),oa=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ca(e){return la?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function da(e){return la?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var ua=function(e){return la?oa(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function ma(e){if("undefined"==typeof ArrayBuffer)return ua(e);for(var t=new ArrayBuffer(e.length),s=new Uint8Array(t),r=0;r!=e.length;++r)s[r]=255&e.charCodeAt(r);return t}function ha(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],s=0;s<e.length;++s)t[s]=String.fromCharCode(e[s]);return t.join("")}var xa=la?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:oa(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,s=0;for(t=0;t<e.length;++t)s+=e[t].length;var r=new Uint8Array(s),a=0;for(t=0,s=0;t<e.length;s+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],s);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),s)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var pa=/\u0000/g,fa=/[\u0001-\u0006]/g;function ga(e){for(var t="",s=e.length-1;s>=0;)t+=e.charAt(s--);return t}function ba(e,t){var s=""+e;return s.length>=t?s:En("0",t-s.length)+s}function va(e,t){var s=""+e;return s.length>=t?s:En(" ",t-s.length)+s}function ya(e,t){var s=""+e;return s.length>=t?s:s+En(" ",t-s.length)}var wa=Math.pow(2,32);function ja(e,t){return e>wa||e<-wa?function(e,t){var s=""+Math.round(e);return s.length>=t?s:En("0",t-s.length)+s}(e,t):function(e,t){var s=""+e;return s.length>=t?s:En("0",t-s.length)+s}(Math.round(e),t)}function Na(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var _a=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ka=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ca={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Sa={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ta={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Aa(e,t,s){for(var r=e<0?-1:1,a=e*r,n=0,i=1,l=0,o=1,c=0,d=0,u=Math.floor(a);c<t&&(l=(u=Math.floor(a))*i+n,d=u*c+o,!(a-u<5e-8));)a=1/(a-u),n=i,i=l,o=c,c=d;if(d>t&&(c>t?(d=o,l=n):(d=c,l=i)),!s)return[0,r*l,d];var m=Math.floor(r*l/d);return[m,r*l-m*d,d]}function Ea(e,t,s){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),n=0,i=[],l={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(r+=1462),l.u>.9999&&(l.u=0,86400==++a&&(l.T=a=0,++r,++l.D)),60===r)i=s?[1317,10,29]:[1900,2,29],n=3;else if(0===r)i=s?[1317,8,29]:[1900,1,0],n=6;else{r>60&&--r;var o=new Date(1900,0,1);o.setDate(o.getDate()+r-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],n=o.getDay(),r<60&&(n=(n+6)%7),s&&(n=function(e,t){t[0]-=581;var s=e.getDay();e<60&&(s=(s+6)%7);return s}(o,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=n,l}var Ra=new Date(1899,11,31,0,0,0),Pa=Ra.getTime(),Ma=new Date(1900,2,1,0,0,0);function La(e,t){var s=e.getTime();return t?s-=1262304e5:e>=Ma&&(s+=864e5),(s-(Pa+6e4*(e.getTimezoneOffset()-Ra.getTimezoneOffset())))/864e5}function Oa(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ia(e){var t,s=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=s>=-4&&s<=-1?e.toPrecision(10+s):Math.abs(s)<=9?function(e){var t=e<0?12:11,s=Oa(e.toFixed(12));return s.length<=t||(s=e.toPrecision(10)).length<=t?s:e.toExponential(5)}(e):10===s?e.toFixed(10).substr(0,12):function(e){var t=Oa(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Oa(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Da(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Ia(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return an(14,La(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Fa(e,t,s,r){var a,n="",i=0,l=0,o=s.y,c=0;switch(e){case 98:o=s.y+543;case 121:switch(t.length){case 1:case 2:a=o%100,c=2;break;default:a=o%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=s.m,c=t.length;break;case 3:return ka[s.m-1][1];case 5:return ka[s.m-1][0];default:return ka[s.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=s.d,c=t.length;break;case 3:return _a[s.q][0];default:return _a[s.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(s.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=s.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=s.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==s.u||"s"!=t&&"ss"!=t?(l=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(l*(s.S+s.u)))>=60*l&&(i=0),"s"===t?0===i?"0":""+i/l:(n=ba(i,2+r),"ss"===t?n.substr(0,2):"."+n.substr(2,t.length-1))):ba(s.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*s.D+s.H;break;case"[m]":case"[mm]":a=60*(24*s.D+s.H)+s.M;break;case"[s]":case"[ss]":a=60*(60*(24*s.D+s.H)+s.M)+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=o,c=1}return c>0?ba(a,c):""}function Ba(e){if(e.length<=3)return e;for(var t=e.length%3,s=e.substr(0,t);t!=e.length;t+=3)s+=(s.length>0?",":"")+e.substr(t,3);return s}var $a=/%/g;function za(e,t){var s,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+za(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%a;if(n<0&&(n+=a),-1===(s=(t/Math.pow(10,n)).toPrecision(r+1+(a+n)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===s.indexOf(".")?s=s.charAt(0)+"."+s.substr(1)+"E+"+(i-s.length+n):s+="E+"+(i-n);"0."===s.substr(0,2);)s=(s=s.charAt(0)+s.substr(2,a)+"."+s.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,s,r){return t+s+r.substr(0,(a+n)%a)+"."+r.substr(n)+"E"})}else s=t.toExponential(r);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var Va=/# (\?+)( ?)\/( ?)(\d+)/;var Ua=/^#*0*\.([0#]+)/,Wa=/\).*[0#]/,Ha=/\(###\) ###\\?-####/;function Ga(e){for(var t,s="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(t)}return s}function qa(e,t){var s=Math.pow(10,t);return""+Math.round(e*s)/s}function Ya(e,t){var s=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(s*r)).length?0:Math.round(s*r)}function Ka(e,t,s){if(40===e.charCodeAt(0)&&!t.match(Wa)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Ka("n",r,s):"("+Ka("n",r,-s)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,s){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Za(e,t.substr(0,r),s/Math.pow(10,3*(t.length-r)))}(e,t,s);if(-1!==t.indexOf("%"))return function(e,t,s){var r=t.replace($a,""),a=t.length-r.length;return Za(e,r,s*Math.pow(10,2*a))+En("%",a)}(e,t,s);if(-1!==t.indexOf("E"))return za(t,s);if(36===t.charCodeAt(0))return"$"+Ka(e,t.substr(" "==t.charAt(1)?2:1),s);var a,n,i,l,o=Math.abs(s),c=s<0?"-":"";if(t.match(/^00+$/))return c+ja(o,t.length);if(t.match(/^[#?]+$/))return"0"===(a=ja(s,0))&&(a=""),a.length>t.length?a:Ga(t.substr(0,t.length-a.length))+a;if(n=t.match(Va))return function(e,t,s){var r=parseInt(e[4],10),a=Math.round(t*r),n=Math.floor(a/r),i=a-n*r,l=r;return s+(0===n?"":""+n)+" "+(0===i?En(" ",e[1].length+1+e[4].length):va(i,e[1].length)+e[2]+"/"+e[3]+ba(l,e[4].length))}(n,o,c);if(t.match(/^#+0+$/))return c+ja(o,t.length-t.indexOf("0"));if(n=t.match(Ua))return a=qa(s,n[1].length).replace(/^([^\.]+)$/,"$1."+Ga(n[1])).replace(/\.$/,"."+Ga(n[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+En("0",Ga(n[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+qa(o,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Ba(ja(o,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Ka(e,t,-s):Ba(""+(Math.floor(s)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(s,n[1].length)))+"."+ba(Ya(s,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return Ka(e,t.replace(/^#,#*,/,""),s);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ga(Ka(e,t.replace(/[\\-]/g,""),s)),i=0,ga(ga(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Ha))return"("+(a=Ka(e,"##########",s)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),l=Aa(o,Math.pow(10,i)-1,!1),a=""+c," "==(d=Za("n",n[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+n[2]+"/"+n[3],(d=ya(l[2],i)).length<n[4].length&&(d=Ga(n[4].substr(n[4].length-d.length))+d),a+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((l=Aa(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?va(l[1],i)+n[2]+"/"+n[3]+ya(l[2],i):En(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return a=ja(s,0),t.length<=a.length?a:Ga(t.substr(0,t.length-a.length))+a;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,m=t.length-a.length-u;return Ga(t.substr(0,u)+a+t.substr(t.length-m))}if(n=t.match(/^00,000\.([#0]*0)$/))return i=Ya(s,n[1].length),s<0?"-"+Ka(e,t,-s):Ba(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ba(0,3-e.length):"")+e})+"."+ba(i,n[1].length);switch(t){case"###,##0.00":return Ka(e,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var h=Ba(ja(o,0));return"0"!==h?c+h:"";case"###,###.00":return Ka(e,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return Ka(e,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Xa(e,t){var s,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Xa(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%a;if(n<0&&(n+=a),!(s=(t/Math.pow(10,n)).toPrecision(r+1+(a+n)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===s.indexOf(".")?s=s.charAt(0)+"."+s.substr(1)+"E+"+(i-s.length+n):s+="E+"+(i-n),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,s,r){return t+s+r.substr(0,(a+n)%a)+"."+r.substr(n)+"E"})}else s=t.toExponential(r);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function Ja(e,t,s){if(40===e.charCodeAt(0)&&!t.match(Wa)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Ja("n",r,s):"("+Ja("n",r,-s)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,s){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Za(e,t.substr(0,r),s/Math.pow(10,3*(t.length-r)))}(e,t,s);if(-1!==t.indexOf("%"))return function(e,t,s){var r=t.replace($a,""),a=t.length-r.length;return Za(e,r,s*Math.pow(10,2*a))+En("%",a)}(e,t,s);if(-1!==t.indexOf("E"))return Xa(t,s);if(36===t.charCodeAt(0))return"$"+Ja(e,t.substr(" "==t.charAt(1)?2:1),s);var a,n,i,l,o=Math.abs(s),c=s<0?"-":"";if(t.match(/^00+$/))return c+ba(o,t.length);if(t.match(/^[#?]+$/))return a=""+s,0===s&&(a=""),a.length>t.length?a:Ga(t.substr(0,t.length-a.length))+a;if(n=t.match(Va))return function(e,t,s){return s+(0===t?"":""+t)+En(" ",e[1].length+2+e[4].length)}(n,o,c);if(t.match(/^#+0+$/))return c+ba(o,t.length-t.indexOf("0"));if(n=t.match(Ua))return a=(a=(""+s).replace(/^([^\.]+)$/,"$1."+Ga(n[1])).replace(/\.$/,"."+Ga(n[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+En("0",Ga(n[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+Ba(""+o);if(n=t.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Ja(e,t,-s):Ba(""+s)+"."+En("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Ja(e,t.replace(/^#,#*,/,""),s);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ga(Ja(e,t.replace(/[\\-]/g,""),s)),i=0,ga(ga(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Ha))return"("+(a=Ja(e,"##########",s)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),l=Aa(o,Math.pow(10,i)-1,!1),a=""+c," "==(d=Za("n",n[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+n[2]+"/"+n[3],(d=ya(l[2],i)).length<n[4].length&&(d=Ga(n[4].substr(n[4].length-d.length))+d),a+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((l=Aa(o,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?va(l[1],i)+n[2]+"/"+n[3]+ya(l[2],i):En(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return a=""+s,t.length<=a.length?a:Ga(t.substr(0,t.length-a.length))+a;if(n=t.match(/^([#0]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,m=t.length-a.length-u;return Ga(t.substr(0,u)+a+t.substr(t.length-m))}if(n=t.match(/^00,000\.([#0]*0)$/))return s<0?"-"+Ja(e,t,-s):Ba(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ba(0,3-e.length):"")+e})+"."+ba(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Ba(""+o);return"0"!==h?c+h:"";default:if(t.match(/\.[0#?]*$/))return Ja(e,t.slice(0,t.lastIndexOf(".")),s)+Ga(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Za(e,t,s){return(0|s)===s?Ja(e,t,s):Ka(e,t,s)}var Qa=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function en(e){for(var t=0,s="",r="";t<e.length;)switch(s=e.charAt(t)){case"G":Na(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=s;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Qa))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++t))>-1||"\\"==s&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===s;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var tn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sn(e,t){if(null==t)return!1;var s=parseFloat(t[2]);switch(t[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0}return!1}function rn(e,t){var s=function(e){for(var t=[],s=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:s=!s;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===s)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=s.length,a=s[r-1].indexOf("@");if(r<4&&a>-1&&--r,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if("number"!=typeof t)return[4,4===s.length||a>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=a>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=a>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=a>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"]}var n=t>0?s[0]:t<0?s[1]:s[2];if(-1===s[0].indexOf("[")&&-1===s[1].indexOf("["))return[r,n];if(null!=s[0].match(/\[[=<>]/)||null!=s[1].match(/\[[=<>]/)){var i=s[0].match(tn),l=s[1].match(tn);return sn(t,i)?[r,s[0]]:sn(t,l)?[r,s[1]]:[r,s[null!=i&&null!=l?2:1]]}return[r,n]}function an(e,t,s){null==s&&(s={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&s.dateNF?s.dateNF:e;break;case"number":null==(r=14==e&&s.dateNF?s.dateNF:(null!=s.table?s.table:Ca)[e])&&(r=s.table&&s.table[Sa[e]]||Ca[Sa[e]]),null==r&&(r=Ta[e]||"General")}if(Na(r,0))return Da(t,s);t instanceof Date&&(t=La(t,s.date1904));var a=rn(r,t);if(Na(a[1]))return Da(t,s);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,s,r){for(var a,n,i,l=[],o="",c=0,d="",u="t",m="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Na(e,c))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";34!==(i=e.charCodeAt(++c))&&c<e.length;)o+=String.fromCharCode(i);l[l.length]={t:"t",v:o},++c;break;case"\\":var h=e.charAt(++c),x="("===h||")"===h?h:"t";l[l.length]={t:x,v:h},++c;break;case"_":l[l.length]={t:"t",v:" "},c+=2;break;case"@":l[l.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Ea(t,s,"2"===e.charAt(c+1))))return"";l[l.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Ea(t,s)))return"";for(o=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)o+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=m),l[l.length]={t:d,v:o},u=d;break;case"A":case"a":case"上":var p={t:d,v:d};if(null==a&&(a=Ea(t,s)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(p.v=a.H>=12?"P":"A"),p.t="T",m="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"PM":"AM"),p.t="T",c+=5,m="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"下午":"上午"),p.t="T",c+=5,m="h"):(p.t="t",++c),null==a&&"T"===p.t)return"";l[l.length]=p,u=d;break;case"[":for(o=d;"]"!==e.charAt(c++)&&c<e.length;)o+=e.charAt(c);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(Qa)){if(null==a&&null==(a=Ea(t,s)))return"";l[l.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",en(e)||(l[l.length]={t:"t",v:o}));break;case".":if(null!=a){for(o=d;++c<e.length&&"0"===(d=e.charAt(c));)o+=d;l[l.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)o+=d;l[l.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++c)===d;)o+=d;l[l.length]={t:d,v:o},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":l[l.length]={t:1===r?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);l[l.length]={t:"D",v:o};break;case" ":l[l.length]={t:d,v:d},++c;break;case"$":l[l.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"t",v:d},++c}var f,g=0,b=0;for(c=l.length-1,u="t";c>=0;--c)switch(l[c].t){case"h":case"H":l[c].t=m,u="h",g<1&&(g=1);break;case"s":(f=l[c].v.match(/\.0+$/))&&(b=Math.max(b,f[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":u=l[c].t;break;case"m":"s"===u&&(l[c].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&l[c].v.match(/[Hh]/)&&(g=1),g<2&&l[c].v.match(/[Mm]/)&&(g=2),g<3&&l[c].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var v,y="";for(c=0;c<l.length;++c)switch(l[c].t){case"t":case"T":case" ":case"D":break;case"X":l[c].v="",l[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[c].v=Fa(l[c].t.charCodeAt(0),l[c].v,a,b),l[c].t="t";break;case"n":case"?":for(v=c+1;null!=l[v]&&("?"===(d=l[v].t)||"D"===d||(" "===d||"t"===d)&&null!=l[v+1]&&("?"===l[v+1].t||"t"===l[v+1].t&&"/"===l[v+1].v)||"("===l[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===l[v].v||" "===l[v].v&&null!=l[v+1]&&"?"==l[v+1].t));)l[c].v+=l[v].v,l[v]={v:"",t:";"},++v;y+=l[c].v,c=v-1;break;case"G":l[c].t="t",l[c].v=Da(t,s)}var w,j,N="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,j=Za("n",y,w)):(j=Za("n",y,w=t<0&&r>1?-t:t),w<0&&l[0]&&"t"==l[0].t&&(j=j.substr(1),l[0].v="-"+l[0].v)),v=j.length-1;var _=l.length;for(c=0;c<l.length;++c)if(null!=l[c]&&"t"!=l[c].t&&l[c].v.indexOf(".")>-1){_=c;break}var k=l.length;if(_===l.length&&-1===j.indexOf("E")){for(c=l.length-1;c>=0;--c)null!=l[c]&&-1!=="n?".indexOf(l[c].t)&&(v>=l[c].v.length-1?(v-=l[c].v.length,l[c].v=j.substr(v+1,l[c].v.length)):v<0?l[c].v="":(l[c].v=j.substr(0,v+1),v=-1),l[c].t="t",k=c);v>=0&&k<l.length&&(l[k].v=j.substr(0,v+1)+l[k].v)}else if(_!==l.length&&-1===j.indexOf("E")){for(v=j.indexOf(".")-1,c=_;c>=0;--c)if(null!=l[c]&&-1!=="n?".indexOf(l[c].t)){for(n=l[c].v.indexOf(".")>-1&&c===_?l[c].v.indexOf(".")-1:l[c].v.length-1,N=l[c].v.substr(n+1);n>=0;--n)v>=0&&("0"===l[c].v.charAt(n)||"#"===l[c].v.charAt(n))&&(N=j.charAt(v--)+N);l[c].v=N,l[c].t="t",k=c}for(v>=0&&k<l.length&&(l[k].v=j.substr(0,v+1)+l[k].v),v=j.indexOf(".")+1,c=_;c<l.length;++c)if(null!=l[c]&&(-1!=="n?(".indexOf(l[c].t)||c===_)){for(n=l[c].v.indexOf(".")>-1&&c===_?l[c].v.indexOf(".")+1:0,N=l[c].v.substr(0,n);n<l[c].v.length;++n)v<j.length&&(N+=j.charAt(v++));l[c].v=N,l[c].t="t",k=c}}}for(c=0;c<l.length;++c)null!=l[c]&&"n?".indexOf(l[c].t)>-1&&(w=r>1&&t<0&&c>0&&"-"===l[c-1].v?-t:t,l[c].v=Za(l[c].t,l[c].v,w),l[c].t="t");var C="";for(c=0;c!==l.length;++c)null!=l[c]&&(C+=l[c].v);return C}(a[1],t,s,a[0])}function nn(e,t){if("number"!=typeof t){t=+t||-1;for(var s=0;s<392;++s)if(null!=Ca[s]){if(Ca[s]==e){t=s;break}}else t<0&&(t=s);t<0&&(t=391)}return Ca[t]=e,t}function ln(e){for(var t=0;392!=t;++t)void 0!==e[t]&&nn(e[t],t)}function on(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',Ca=e}var cn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var dn=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),s=0;256!=s;++s)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=s)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[s]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();var s=function(e){var t=0,s=0,r=0,a="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(s=e[r],t=256+r;t<4096;t+=256)s=a[t]=s>>>8^e[255&s];var n=[];for(r=1;16!=r;++r)n[r-1]="undefined"!=typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return n}(t),r=s[0],a=s[1],n=s[2],i=s[3],l=s[4],o=s[5],c=s[6],d=s[7],u=s[8],m=s[9],h=s[10],x=s[11],p=s[12],f=s[13],g=s[14];return e.table=t,e.bstr=function(e,s){for(var r=-1^s,a=0,n=e.length;a<n;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,s){for(var b=-1^s,v=e.length-15,y=0;y<v;)b=g[e[y++]^255&b]^f[e[y++]^b>>8&255]^p[e[y++]^b>>16&255]^x[e[y++]^b>>>24]^h[e[y++]]^m[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^o[e[y++]]^l[e[y++]]^i[e[y++]]^n[e[y++]]^a[e[y++]]^r[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,s){for(var r=-1^s,a=0,n=e.length,i=0,l=0;a<n;)(i=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^i)]:i<2048?r=(r=r>>>8^t[255&(r^(192|i>>6&31))])>>>8^t[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),l=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|i>>8&7))])>>>8^t[255&(r^(128|i>>2&63))])>>>8^t[255&(r^(128|l>>6&15|(3&i)<<4))])>>>8^t[255&(r^(128|63&l))]):r=(r=(r=r>>>8^t[255&(r^(224|i>>12&15))])>>>8^t[255&(r^(128|i>>6&63))])>>>8^t[255&(r^(128|63&i))];return~r},e}(),un=function(){var e,t={};function s(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:s(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"==typeof t&&(t=new Date(t));var s=t.getHours();s=(s=s<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,s);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function n(e){sl(e,0);for(var t={},s=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),n=e.l+a,i={};if(21589===r)1&(s=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&s&&(i.atime=e.read_shift(4)),4&s&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=n,t[r]=i}return t}function i(){return e||(e={})}function l(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=j(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var s=t&&t.root||"",r=(la&&Buffer.isBuffer(e)?e.toString("binary"):j(e)).split("\r\n"),a=0,n="";for(a=0;a<r.length;++a)if(n=r[a],/^Content-Location:/i.test(n)&&(n=n.slice(n.indexOf("file")),s||(s=n.slice(0,n.lastIndexOf("/")+1)),n.slice(0,s.length)!=s))for(;s.length>0&&(s=(s=s.slice(0,s.length-1)).slice(0,s.lastIndexOf("/")+1),n.slice(0,s.length)!=s););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var l="--"+(i[1]||""),o=[],c=[],d={FileIndex:o,FullPaths:c};m(d);var u,h=0;for(a=0;a<r.length;++a){var x=r[a];x!==l&&x!==l+"--"||(h++&&ce(d,r.slice(u,a),s),u=a)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var s,r,a,n,i,l,h=512,x=[],p=e.slice(0,512);sl(p,0);var f=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(s=f[0]){case 3:h=512;break;case 4:h=4096;break;case 0:if(0==f[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+s)}512!==h&&sl(p=e.slice(0,h),28);var v=e.slice(0,h);!function(e,t){var s=9;switch(e.l+=2,s=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+s);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+s);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+s)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,s);var y=p.read_shift(4,"i");if(3===s&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,n=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),r=p.read_shift(4,"i"),l=p.read_shift(4,"i"),a=p.read_shift(4,"i");for(var w=-1,N=0;N<109&&!((w=p.read_shift(4,"i"))<0);++N)x[N]=w;var _=function(e,t){for(var s=Math.ceil(e.length/t)-1,r=[],a=1;a<s;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[s-1]=e.slice(s*t),r}(e,h);c(l,a,_,h,x);var k=function(e,t,s,r){var a=e.length,n=[],i=[],l=[],o=[],c=r-1,d=0,u=0,m=0,h=0;for(d=0;d<a;++d)if(l=[],(m=d+t)>=a&&(m-=a),!i[m]){o=[];var x=[];for(u=m;u>=0;){x[u]=!0,i[u]=!0,l[l.length]=u,o.push(e[u]);var p=s[Math.floor(4*u/r)];if(r<4+(h=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+r);if(!e[p])break;if(x[u=Yi(e[p],h)])break}n[m]={nodes:l,data:_i([o])}}return n}(_,n,x,h);k[n].name="!Directory",r>0&&i!==g&&(k[i].name="!MiniFAT"),k[x[0]].name="!FAT",k.fat_addrs=x,k.ssz=h;var C=[],S=[],T=[];!function(e,t,s,r,a,n,i,l){for(var c,m=0,h=r.length?2:0,x=t[e].data,p=0,f=0;p<x.length;p+=128){var b=x.slice(p,p+128);sl(b,64),f=b.read_shift(2),c=Ci(b,0,f-h),r.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=u(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=g,v.name=""),5===v.type?(m=v.start,a>0&&m!==g&&(t[m].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(s,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:m!==g&&v.start!==g&&t[m]&&(v.content=o(v,t[m].data,(t[l]||{}).data))),v.content&&sl(v.content,0),n[c]=v,i.push(v)}}(n,k,_,C,r,{},S,i),function(e,t,s){for(var r=0,a=0,n=0,i=0,l=0,o=s.length,c=[],d=[];r<o;++r)c[r]=d[r]=r,t[r]=s[r];for(;l<d.length;++l)a=e[r=d[l]].L,n=e[r].R,i=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==n&&c[n]!==n&&(c[r]=c[n])),-1!==i&&(c[i]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],d.lastIndexOf(a)<l&&d.push(a)),-1!==n&&r!=c[r]&&(c[n]=c[r],d.lastIndexOf(n)<l&&d.push(n));for(r=1;r<o;++r)c[r]===r&&(-1!==n&&c[n]!==n?c[r]=c[n]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<o;++r)if(0!==e[r].type){if((l=r)!=c[l])do{l=c[l],t[r]=t[l]+"/"+t[r]}while(0!==l&&-1!==c[l]&&l!=c[l]);c[r]=-1}for(t[0]+="/",r=1;r<o;++r)2!==e[r].type&&(t[r]+="/")}(S,T,C),C.shift();var A={FileIndex:S,FullPaths:T};return t&&t.raw&&(A.raw={header:v,sectors:_}),A}function o(e,t,s){for(var r=e.start,a=e.size,n=[],i=r;s&&a>0&&i>=0;)n.push(t.slice(i*f,i*f+f)),a-=f,i=Yi(s,4*i);return 0===n.length?al(0):xa(n).slice(0,e.size)}function c(e,t,s,r,a){var n=g;if(e===g){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=s[e],l=(r>>>2)-1;if(!i)return;for(var o=0;o<l&&(n=Yi(i,4*o))!==g;++o)a.push(n);c(Yi(i,r-4),t-1,s,r,a)}}function d(e,t,s,r,a){var n=[],i=[];a||(a=[]);var l=r-1,o=0,c=0;for(o=t;o>=0;){a[o]=!0,n[n.length]=o,i.push(e[o]);var d=s[Math.floor(4*o/r)];if(r<4+(c=4*o&l))throw new Error("FAT boundary crossed: "+o+" 4 "+r);if(!e[d])break;o=Yi(e[d],c)}return{nodes:n,data:_i([i])}}function u(e,t){return new Date(1e3*(qi(e,t+4)/1e7*Math.pow(2,32)+qi(e,t)/1e7-11644473600))}function m(e,t){var s=t||{},r=s.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),s.CLSID&&(e.FileIndex[0].clsid=s.CLSID),function(e){var t="Sh33tJ5";if(un.find(e,"/"+t))return;var s=al(4);s[0]=55,s[1]=s[3]=50,s[2]=54,e.FileIndex.push({name:t,type:2,content:s,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),h(e)}(e)}function h(e,t){m(e);for(var a=!1,n=!1,i=e.FullPaths.length-1;i>=0;--i){var l=e.FileIndex[i];switch(l.type){case 0:n?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(l.R*l.L*l.C)&&(a=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(a=!0);break;default:a=!0}}if(a||t){var o=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var h=s(u[i][0]);(n=d[h])||(u.push([h,{name:r(h).replace("/",""),type:1,clsid:y,ct:o,mt:o,content:null}]),d[h]=!0)}for(u.sort(function(e,t){return function(e,t){for(var s=e.split("/"),r=t.split("/"),a=0,n=0,i=Math.min(s.length,r.length);a<i;++a){if(n=s[a].length-r[a].length)return n;if(s[a]!=r[a])return s[a]<r[a]?-1:1}return s.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var x=e.FileIndex[i],p=e.FullPaths[i];if(x.name=r(p).replace("/",""),x.L=x.R=x.C=-(x.color=1),x.size=x.content?x.content.length:0,x.start=0,x.clsid=x.clsid||y,0===i)x.C=u.length>1?1:-1,x.size=0,x.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&s(e.FullPaths[c])!=p;++c);for(x.C=c>=u.length?-1:c,c=i+1;c<u.length&&s(e.FullPaths[c])!=s(p);++c);x.R=c>=u.length?-1:c,x.type=1}else s(e.FullPaths[i+1]||"")==s(p)&&(x.R=i+1),x.type=2}}}function x(e,t){var s=t||{};if("mad"==s.fileType)return function(e,t){for(var s=t||{},r=s.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],n=e.FullPaths[0],i=n,l=e.FileIndex[0],o=1;o<e.FullPaths.length;++o)if(i=e.FullPaths[o].slice(n.length),(l=e.FileIndex[o]).size&&l.content&&"Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=l.content,d=la&&Buffer.isBuffer(c)?c.toString("binary"):j(c),u=0,m=Math.min(1024,d.length),h=0,x=0;x<=m;++x)(h=d.charCodeAt(x))>=32&&h<128&&++u;var p=u>=4*m/5;a.push(r),a.push("Content-Location: "+(s.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),a.push("Content-Type: "+ie(l,i)),a.push(""),a.push(p?oe(d):le(d))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,s);if(h(e),"zip"===s.fileType)return function(e,t){var s=t||{},r=[],n=[],i=al(1),l=s.compression?8:0,o=0,c=0,d=0,u=0,m=0,h=e.FullPaths[0],x=h,p=e.FileIndex[0],f=[],g=0;for(c=1;c<e.FullPaths.length;++c)if(x=e.FullPaths[c].slice(h.length),(p=e.FileIndex[c]).size&&p.content&&"Sh33tJ5"!=x){var b=u,v=al(x.length);for(d=0;d<x.length;++d)v.write_shift(1,127&x.charCodeAt(d));v=v.slice(0,v.l),f[m]=dn.buf(p.content,0);var y=p.content;8==l&&(y=N(y)),(i=al(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),p.mt?a(i,p.mt):i.write_shift(4,0),i.write_shift(-4,f[m]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),u+=i.length,r.push(i),u+=v.length,r.push(v),u+=y.length,r.push(y),(i=al(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,o),i.write_shift(2,l),i.write_shift(4,0),i.write_shift(-4,f[m]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),g+=i.l,n.push(i),g+=v.length,n.push(v),++m}return i=al(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,m),i.write_shift(2,m),i.write_shift(4,g),i.write_shift(4,u),i.write_shift(2,0),xa([xa(r),xa(n),i])}(e,s);var r=function(e){for(var t=0,s=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var n=a.content.length;n>0&&(n<4096?t+=n+63>>6:s+=n+511>>9)}}for(var i=e.FullPaths.length+3>>2,l=t+127>>7,o=(t+7>>3)+s+i+l,c=o+127>>7,d=c<=109?0:Math.ceil((c-109)/127);o+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,l,i,s,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),n=al(r[7]<<9),i=0,l=0;for(i=0;i<8;++i)n.write_shift(1,v[i]);for(i=0;i<8;++i)n.write_shift(2,0);for(n.write_shift(2,62),n.write_shift(2,3),n.write_shift(2,65534),n.write_shift(2,9),n.write_shift(2,6),i=0;i<3;++i)n.write_shift(2,0);for(n.write_shift(4,0),n.write_shift(4,r[2]),n.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),n.write_shift(4,0),n.write_shift(4,4096),n.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:g),n.write_shift(4,r[3]),n.write_shift(-4,r[1]?r[0]-1:g),n.write_shift(4,r[1]),i=0;i<109;++i)n.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(l=0;l<r[1];++l){for(;i<236+127*l;++i)n.write_shift(-4,i<r[2]?r[1]+i:-1);n.write_shift(-4,l===r[1]-1?g:l+1)}var o=function(e){for(l+=e;i<l-1;++i)n.write_shift(-4,i+1);e&&(++i,n.write_shift(-4,g))};for(l=i=0,l+=r[1];i<l;++i)n.write_shift(-4,w.DIFSECT);for(l+=r[2];i<l;++i)n.write_shift(-4,w.FATSECT);o(r[3]),o(r[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=l,o(d+511>>9)));for(o(r[6]+7>>3);511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(l=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=l,o(d+63>>6)));for(;511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var m=e.FullPaths[i];if(m&&0!==m.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:g);var x=0===i&&s.root||u.name;if(d=2*(x.length+1),n.write_shift(64,x,"utf16le"),n.write_shift(2,d),n.write_shift(1,u.type),n.write_shift(1,u.color),n.write_shift(-4,u.L),n.write_shift(-4,u.R),n.write_shift(-4,u.C),u.clsid)n.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)n.write_shift(4,0);n.write_shift(4,u.state||0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,u.start),n.write_shift(4,u.size),n.write_shift(4,0)}else{for(c=0;c<17;++c)n.write_shift(4,0);for(c=0;c<3;++c)n.write_shift(4,-1);for(c=0;c<12;++c)n.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(n.l=u.start+1<<9,la&&Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;511&c;++c)n.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(la&&Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;63&c;++c)n.write_shift(1,0)}if(la)n.l=n.length;else for(;n.l<n.length;)n.write_shift(1,0);return n}t.version="1.2.1";var p,f=64,g=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:g,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function j(e){for(var t=new Array(e.length),s=0;s<e.length;++s)t[s]=String.fromCharCode(e[s]);return t.join("")}function N(e){return p?p.deflateRawSync(e):Y(e)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function S(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var T="undefined"!=typeof Uint8Array,A=T?new Uint8Array(256):[],E=0;E<256;++E)A[E]=S(E);function R(e,t){var s=A[255&e];return t<=8?s>>>8-t:(s=s<<8|A[e>>8&255],t<=16?s>>>16-t:(s=s<<8|A[e>>16&255])>>>24-t)}function P(e,t){var s=7&t,r=t>>>3;return(e[r]|(s<=6?0:e[r+1]<<8))>>>s&3}function M(e,t){var s=7&t,r=t>>>3;return(e[r]|(s<=5?0:e[r+1]<<8))>>>s&7}function L(e,t){var s=7&t,r=t>>>3;return(e[r]|(s<=3?0:e[r+1]<<8))>>>s&31}function O(e,t){var s=7&t,r=t>>>3;return(e[r]|(s<=1?0:e[r+1]<<8))>>>s&127}function I(e,t,s){var r=7&t,a=t>>>3,n=(1<<s)-1,i=e[a]>>>r;return s<8-r?i&n:(i|=e[a+1]<<8-r,s<16-r?i&n:(i|=e[a+2]<<16-r,s<24-r?i&n:(i|=e[a+3]<<24-r)&n))}function D(e,t,s){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&s)<<r:(e[a]|=s<<r&255,e[a+1]=(7&s)>>8-r),t+3}function F(e,t,s){return s=(1&s)<<(7&t),e[t>>>3]|=s,t+1}function B(e,t,s){var r=t>>>3;return s<<=7&t,e[r]|=255&s,s>>>=8,e[r+1]=s,t+8}function $(e,t,s){var r=t>>>3;return s<<=7&t,e[r]|=255&s,s>>>=8,e[r+1]=255&s,e[r+2]=s>>>8,t+16}function z(e,t){var s=e.length,r=2*s>t?2*s:t+5,a=0;if(s>=t)return e;if(la){var n=da(r);if(e.copy)e.copy(n);else for(;a<e.length;++a)n[a]=e[a];return n}if(T){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;a<s;++a)i[a]=e[a];return i}return e.length=r,e}function V(e){for(var t=new Array(e),s=0;s<e;++s)t[s]=0;return t}function U(e,t,s){var r=1,a=0,n=0,i=0,l=0,o=e.length,c=T?new Uint16Array(32):V(32);for(n=0;n<32;++n)c[n]=0;for(n=o;n<s;++n)e[n]=0;o=e.length;var d=T?new Uint16Array(o):V(o);for(n=0;n<o;++n)c[a=e[n]]++,r<a&&(r=a),d[n]=0;for(c[0]=0,n=1;n<=r;++n)c[n+16]=l=l+c[n-1]<<1;for(n=0;n<o;++n)0!=(l=e[n])&&(d[n]=c[l+16]++);var u=0;for(n=0;n<o;++n)if(0!=(u=e[n]))for(l=R(d[n],r)>>r-u,i=(1<<r+4-u)-1;i>=0;--i)t[l|i<<u]=15&u|n<<4;return r}var W=T?new Uint16Array(512):V(512),H=T?new Uint16Array(32):V(32);if(!T){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)H[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);U(e,H,32);var s=[];for(t=0;t<=143;t++)s.push(8);for(;t<=255;t++)s.push(9);for(;t<=279;t++)s.push(7);for(;t<=287;t++)s.push(8);U(s,W,288)}();var q=function(){for(var e=T?new Uint8Array(32768):[],t=0,s=0;t<C.length-1;++t)for(;s<C[t+1];++s)e[s]=t;for(;s<32768;++s)e[s]=29;var r=T?new Uint8Array(259):[];for(t=0,s=0;t<k.length-1;++t)for(;s<k[t+1];++s)r[s]=t;return function(t,s){return t.length<8?function(e,t){for(var s=0;s<e.length;){var r=Math.min(65535,e.length-s),a=s+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[s++]}return t.l}(t,s):function(t,s){for(var a=0,n=0,i=T?new Uint16Array(32768):[];n<t.length;){var l=Math.min(65535,t.length-n);if(l<10){for(7&(a=D(s,a,+!(n+l!=t.length)))&&(a+=8-(7&a)),s.l=a/8|0,s.write_shift(2,l),s.write_shift(2,65535&~l);l-- >0;)s[s.l++]=t[n++];a=8*s.l}else{a=D(s,a,+!(n+l!=t.length)+2);for(var o=0;l-- >0;){var c=t[n],d=-1,u=0;if((d=i[o=32767&(o<<5^c)])&&((d|=-32768&n)>n&&(d-=32768),d<n))for(;t[d+u]==t[n+u]&&u<250;)++u;if(u>2){(c=r[u])<=22?a=B(s,a,A[c+1]>>1)-1:(B(s,a,3),B(s,a+=5,A[c-23]>>5),a+=3);var m=c<8?0:c-4>>2;m>0&&($(s,a,u-k[c]),a+=m),c=e[n-d],a=B(s,a,A[c]>>3),a-=3;var h=c<4?0:c-2>>1;h>0&&($(s,a,n-d-C[c]),a+=h);for(var x=0;x<u;++x)i[o]=32767&n,o=32767&(o<<5^t[n]),++n;l-=u-1}else c<=143?c+=48:a=F(s,a,1),a=B(s,a,A[c]),i[o]=32767&n,++n}a=B(s,a,0)-1}}return s.l=(a+7)/8|0,s.l}(t,s)}}();function Y(e){var t=al(50+Math.floor(1.1*e.length)),s=q(e,t);return t.slice(0,s)}var K=T?new Uint16Array(32768):V(32768),X=T?new Uint16Array(32768):V(32768),J=T?new Uint16Array(128):V(128),Z=1,Q=1;function ee(e,t){var s=L(e,t)+257,r=L(e,t+=5)+1,a=function(e,t){var s=7&t,r=t>>>3;return(e[r]|(s<=4?0:e[r+1]<<8))>>>s&15}(e,t+=5)+4;t+=4;for(var n=0,i=T?new Uint8Array(19):V(19),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=1,c=T?new Uint8Array(8):V(8),d=T?new Uint8Array(8):V(8),u=i.length,m=0;m<a;++m)i[_[m]]=n=M(e,t),o<n&&(o=n),c[n]++,t+=3;var h=0;for(c[0]=0,m=1;m<=o;++m)d[m]=h=h+c[m-1]<<1;for(m=0;m<u;++m)0!=(h=i[m])&&(l[m]=d[h]++);var x=0;for(m=0;m<u;++m)if(0!=(x=i[m])){h=A[l[m]]>>8-x;for(var p=(1<<7-x)-1;p>=0;--p)J[h|p<<x]=7&x|m<<3}var f=[];for(o=1;f.length<s+r;)switch(t+=7&(h=J[O(e,t)]),h>>>=3){case 16:for(n=3+P(e,t),t+=2,h=f[f.length-1];n-- >0;)f.push(h);break;case 17:for(n=3+M(e,t),t+=3;n-- >0;)f.push(0);break;case 18:for(n=11+O(e,t),t+=7;n-- >0;)f.push(0);break;default:f.push(h),o<h&&(o=h)}var g=f.slice(0,s),b=f.slice(s);for(m=s;m<286;++m)g[m]=0;for(m=r;m<30;++m)b[m]=0;return Z=U(g,K,286),Q=U(b,X,30),t}function te(e,t){var s=function(e,t){if(3==e[0]&&!(3&e[1]))return[ca(t),2];for(var s=0,r=0,a=da(t||1<<18),n=0,i=a.length>>>0,l=0,o=0;!(1&r);)if(r=M(e,s),s+=3,r>>>1!=0)for(r>>1==1?(l=9,o=5):(s=ee(e,s),l=Z,o=Q);;){!t&&i<n+32767&&(i=(a=z(a,n+32767)).length);var c=I(e,s,l),d=r>>>1==1?W[c]:K[c];if(s+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var m=n+k[d];u>0&&(m+=I(e,s,u),s+=u),c=I(e,s,o),s+=15&(d=r>>>1==1?H[c]:X[c]);var h=(d>>>=4)<4?0:d-2>>1,x=C[d];for(h>0&&(x+=I(e,s,h),s+=h),!t&&i<m&&(i=(a=z(a,m+100)).length);n<m;)a[n]=a[n-x],++n}else a[n++]=d}else{7&s&&(s+=8-(7&s));var p=e[s>>>3]|e[(s>>>3)+1]<<8;if(s+=32,p>0)for(!t&&i<n+p&&(i=(a=z(a,n+p)).length);p-- >0;)a[n++]=e[s>>>3],s+=8}return t?[a,s+7>>>3]:[a.slice(0,n),s+7>>>3]}(e.slice(e.l||0),t);return e.l+=s[1],s[0]}function se(e,t){if(!e)throw new Error(t)}function re(e,t){var s=e;sl(s,0);var r={FileIndex:[],FullPaths:[]};m(r,{root:t.root});for(var a=s.length-4;(80!=s[a]||75!=s[a+1]||5!=s[a+2]||6!=s[a+3])&&a>=0;)--a;s.l=a+4,s.l+=4;var i=s.read_shift(2);s.l+=6;var l=s.read_shift(4);for(s.l=l,a=0;a<i;++a){s.l+=20;var o=s.read_shift(4),c=s.read_shift(4),d=s.read_shift(2),u=s.read_shift(2),h=s.read_shift(2);s.l+=8;var x=s.read_shift(4),p=n(s.slice(s.l+d,s.l+d+u));s.l+=d+u+h;var f=s.l;s.l=x+4,ae(s,o,c,r,p),s.l=f}return r}function ae(e,t,s,r,a){e.l+=2;var i=e.read_shift(2),l=e.read_shift(2),o=function(e){var t=65535&e.read_shift(2),s=65535&e.read_shift(2),r=new Date,a=31&s,n=15&(s>>>=5);s>>>=4,r.setMilliseconds(0),r.setFullYear(s+1980),r.setMonth(n-1),r.setDate(a);var i=31&t,l=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(l),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),m=e.read_shift(2),h="",x=0;x<u;++x)h+=String.fromCharCode(e[e.l++]);if(m){var f=n(e.slice(e.l,e.l+m));(f[21589]||{}).mt&&(o=f[21589].mt),((a||{})[21589]||{}).mt&&(o=a[21589].mt)}e.l+=m;var g=e.slice(e.l,e.l+c);switch(l){case 8:g=function(e,t){if(!p)return te(e,t);var s=new(0,p.InflateRaw),r=s._processChunk(e.slice(e.l),s._finishFlushFlag);return e.l+=s.bytesRead,r}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&se(b,"Bad compressed size: "+t+" != "+c),d!=s&&se(b,"Bad uncompressed size: "+s+" != "+d),de(r,h,g,{unsafe:!0,mt:o})}var ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var s=e.name||"",r=s.match(/\.([^\.]+)$/);return r&&ne[r[1]]||t&&(r=(s=t).match(/[\.\\]([^\.\\])+$/))&&ne[r[1]]?ne[r[1]]:"application/octet-stream"}function le(e){for(var t=na(e),s=[],r=0;r<t.length;r+=76)s.push(t.slice(r,r+76));return s.join("\r\n")+"\r\n"}function oe(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var s=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var n=r[a];if(0!=n.length)for(var i=0;i<n.length;){var l=76,o=n.slice(i,i+l);"="==o.charAt(l-1)?l--:"="==o.charAt(l-2)?l-=2:"="==o.charAt(l-3)&&(l-=3),o=n.slice(i,i+l),(i+=l)<n.length&&(o+="="),s.push(o)}else s.push("")}return s.join("\r\n")}function ce(e,t,s){for(var r,a="",n="",i="",l=0;l<10;++l){var o=t[l];if(!o||o.match(/^\s*$/))break;var c=o.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":n=c[2].trim()}}switch(++l,n.toLowerCase()){case"base64":r=ua(ia(t.slice(l).join("")));break;case"quoted-printable":r=function(e){for(var t=[],s=0;s<e.length;++s){for(var r=e[s];s<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++s];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return ua(t.join("\r\n"))}(t.slice(l));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+n)}var d=de(e,a.slice(s.length),r,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,s,a){var n=a&&a.unsafe;n||m(e);var i=!n&&un.find(e,t);if(!i){var l=e.FullPaths[0];t.slice(0,l.length)==l?l=t:("/"!=l.slice(-1)&&(l+="/"),l=(l+t).replace("//","/")),i={name:r(t),type:2},e.FileIndex.push(i),e.FullPaths.push(l),n||un.utils.cfb_gc(e)}return i.content=s,i.size=s?s.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var s=e.FullPaths.map(function(e){return e.toUpperCase()}),r=s.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=s[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var n=t.toUpperCase(),i=!0===a?s.indexOf(n):r.indexOf(n);if(-1!==i)return e.FileIndex[i];var l=!n.match(fa);for(n=n.replace(pa,""),l&&(n=n.replace(fa,"!")),i=0;i<s.length;++i){if((l?s[i].replace(fa,"!"):s[i]).replace(pa,"")==n)return e.FileIndex[i];if((l?r[i].replace(fa,"!"):r[i]).replace(pa,"")==n)return e.FileIndex[i]}return null},t.read=function(t,s){var r=s&&s.type;switch(r||la&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,s){return i(),l(e.readFileSync(t),s)}(t,s);case"base64":return l(ua(ia(t)),s);case"binary":return l(ua(t),s)}return l(t,s)},t.parse=l,t.write=function(t,s){var r=x(t,s);switch(s&&s.type||"buffer"){case"file":return i(),e.writeFileSync(s.filename,r),r;case"binary":return"string"==typeof r?r:j(r);case"base64":return na("string"==typeof r?r:j(r));case"buffer":if(la)return Buffer.isBuffer(r)?r:oa(r);case"array":return"string"==typeof r?ua(r):r}return r},t.writeFile=function(t,s,r){i();var a=x(t,r);e.writeFileSync(s,a)},t.utils={cfb_new:function(e){var t={};return m(t,e),t},cfb_add:de,cfb_del:function(e,t){m(e);var s=un.find(e,t);if(s)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==s)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,s){m(e);var a=un.find(e,t);if(a)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==a)return e.FileIndex[n].name=r(s),e.FullPaths[n]=s,!0;return!1},cfb_gc:function(e){h(e,!0)},ReadShift:Xi,CheckField:tl,prep_blob:sl,bconcat:xa,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(s){}},_deflateRaw:Y,_inflateRaw:te,consts:w},t}();function mn(e){return"string"==typeof e?ma(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function hn(e,t,s){if("undefined"!=typeof Deno){if(s&&"string"==typeof t)switch(s){case"utf8":t=new TextEncoder(s).encode(t);break;case"binary":t=ma(t);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(e,t)}var r="utf8"==s?Kn(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!=typeof Blob){var a=new Blob([mn(r)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!=typeof saveAs)return saveAs(a,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(a);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ha(t)),l.write(t),l.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function xn(e){for(var t=Object.keys(e),s=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&s.push(t[r]);return s}function pn(e,t){for(var s=[],r=xn(e),a=0;a!==r.length;++a)null==s[e[r[a]][t]]&&(s[e[r[a]][t]]=r[a]);return s}function fn(e){for(var t=[],s=xn(e),r=0;r!==s.length;++r)t[e[s[r]]]=s[r];return t}function gn(e){for(var t=[],s=xn(e),r=0;r!==s.length;++r)t[e[s[r]]]=parseInt(s[r],10);return t}var bn=new Date(1899,11,30,0,0,0);function vn(e,t){return(e.getTime()-(bn.getTime()+6e4*(e.getTimezoneOffset()-bn.getTimezoneOffset())))/864e5}var yn=new Date,wn=bn.getTime()+6e4*(yn.getTimezoneOffset()-bn.getTimezoneOffset()),jn=yn.getTimezoneOffset();function Nn(e){var t=new Date;return t.setTime(24*e*60*60*1e3+wn),t.getTimezoneOffset()!==jn&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-jn)),t}var _n=new Date("2017-02-19T19:06:09.000Z"),kn=isNaN(_n.getFullYear())?new Date("2/19/17"):_n,Cn=2017==kn.getFullYear();function Sn(e,t){var s=new Date(e);if(Cn)return t>0?s.setTime(s.getTime()+60*s.getTimezoneOffset()*1e3):t<0&&s.setTime(s.getTime()-60*s.getTimezoneOffset()*1e3),s;if(e instanceof Date)return e;if(1917==kn.getFullYear()&&!isNaN(s.getFullYear())){var r=s.getFullYear();return e.indexOf(""+r)>-1||s.setFullYear(s.getFullYear()+100),s}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function Tn(e,t){if(la&&Buffer.isBuffer(e))return e.toString("binary");if("undefined"!=typeof TextDecoder)try{var s={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return s[e]||e})}catch(n){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function An(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=An(e[s]));return t}function En(e,t){for(var s="";s.length<t;)s+=e;return s}function Rn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var s=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return s=-s,t}),isNaN(t=Number(r))?t:t/s):t/s}var Pn=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mn(e){var t=new Date(e),s=new Date(NaN),r=t.getYear(),a=t.getMonth(),n=t.getDate();if(isNaN(n))return s;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Pn.indexOf(i))return s}else if(i.match(/[a-z]/))return s;return r<0||r>8099?s:(a>0||n>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?s:t}function Ln(e,t,s){if(e.FullPaths){var r;if("string"==typeof s)return r=la?oa(s):function(e){for(var t=[],s=0,r=e.length+250,a=ca(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)a[s++]=i;else if(i<2048)a[s++]=192|i>>6&31,a[s++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var l=1023&e.charCodeAt(++n);a[s++]=240|i>>8&7,a[s++]=128|i>>2&63,a[s++]=128|l>>6&15|(3&i)<<4,a[s++]=128|63&l}else a[s++]=224|i>>12&15,a[s++]=128|i>>6&63,a[s++]=128|63&i;s>r&&(t.push(a.slice(0,s)),s=0,a=ca(65535),r=65530)}return t.push(a.slice(0,s)),xa(t)}(s),un.utils.cfb_add(e,t,r);un.utils.cfb_add(e,t,s)}else e.file(t,s)}function On(){return un.utils.cfb_new()}var In='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Dn=fn({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Fn=/[&<>'"]/g,Bn=/[\u0000-\u0008\u000b-\u001f]/g;function $n(e){return(e+"").replace(Fn,function(e){return Dn[e]}).replace(Bn,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zn(e){return $n(e).replace(/ /g,"_x0020_")}var Vn=/[\u0000-\u001f]/g;function Un(e){return(e+"").replace(Fn,function(e){return Dn[e]}).replace(/\n/g,"<br/>").replace(Vn,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Wn(e){for(var t="",s=0,r=0,a=0,n=0,i=0,l=0;s<e.length;)(r=e.charCodeAt(s++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(s++),r>191&&r<224?(i=(31&r)<<6,i|=63&a,t+=String.fromCharCode(i)):(n=e.charCodeAt(s++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&n):(l=((7&r)<<18|(63&a)<<12|(63&n)<<6|63&(i=e.charCodeAt(s++)))-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(1023&l)))));return t}function Hn(e){var t,s,r,a=ca(2*e.length),n=1,i=0,l=0;for(s=0;s<e.length;s+=n)n=1,(r=e.charCodeAt(s))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(s+1)),n=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(s+1))+(63&e.charCodeAt(s+2)),n=3):(n=4,t=262144*(7&r)+4096*(63&e.charCodeAt(s+1))+64*(63&e.charCodeAt(s+2))+(63&e.charCodeAt(s+3)),l=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==l&&(a[i++]=255&l,a[i++]=l>>>8,l=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function Gn(e){return oa(e,"binary").toString("utf8")}var qn="foo bar bazâð£",Yn=la&&(Gn(qn)==Wn(qn)&&Gn||Hn(qn)==Wn(qn)&&Hn)||Wn,Kn=la?function(e){return oa(e,"utf8").toString("binary")}:function(e){for(var t=[],s=0,r=0,a=0;s<e.length;)switch(r=e.charCodeAt(s++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(s++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Xn=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)s=s.replace(e[r][0],e[r][1]);return s}}(),Jn=/(^\s|\s$|\n)/;function Zn(e,t){return"<"+e+(t.match(Jn)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Qn(e){return xn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ei(e,t,s){return"<"+e+(null!=s?Qn(s):"")+(null!=t?(t.match(Jn)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ti(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(s){if(t)throw s}return""}var si="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",ri="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",ai="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",ni="http://schemas.openxmlformats.org/package/2006/content-types",ii="http://schemas.openxmlformats.org/package/2006/relationships",li="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",oi="http://purl.org/dc/elements/1.1/",ci="http://purl.org/dc/terms/",di="http://purl.org/dc/dcmitype/",ui="http://schemas.openxmlformats.org/officeDocument/2006/relationships",mi="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",hi="http://www.w3.org/2001/XMLSchema-instance",xi="http://www.w3.org/2001/XMLSchema",pi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fi="urn:schemas-microsoft-com:office:office",gi="urn:schemas-microsoft-com:office:excel",bi="urn:schemas-microsoft-com:office:spreadsheet",vi="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",yi="http://macVmlSchemaUri",wi="urn:schemas-microsoft-com:vml",ji="http://www.w3.org/TR/REC-html40";var Ni=function(e){for(var t=[],s=0;s<e[0].length;++s)if(e[0][s])for(var r=0,a=e[0][s].length;r<a;r+=10240)t.push.apply(t,e[0][s].slice(r,r+10240));return t},_i=la?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:oa(e)})):Ni(e)}:Ni,ki=function(e,t,s){for(var r=[],a=t;a<s;a+=2)r.push(String.fromCharCode(Hi(e,a)));return r.join("").replace(pa,"")},Ci=la?function(e,t,s){return Buffer.isBuffer(e)?e.toString("utf16le",t,s).replace(pa,""):ki(e,t,s)}:ki,Si=function(e,t,s){for(var r=[],a=t;a<t+s;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},Ti=la?function(e,t,s){return Buffer.isBuffer(e)?e.toString("hex",t,t+s):Si(e,t,s)}:Si,Ai=function(e,t,s){for(var r=[],a=t;a<s;a++)r.push(String.fromCharCode(Wi(e,a)));return r.join("")},Ei=la?function(e,t,s){return Buffer.isBuffer(e)?e.toString("utf8",t,s):Ai(e,t,s)}:Ai,Ri=function(e,t){var s=qi(e,t);return s>0?Ei(e,t+4,t+4+s-1):""},Pi=Ri,Mi=function(e,t){var s=qi(e,t);return s>0?Ei(e,t+4,t+4+s-1):""},Li=Mi,Oi=function(e,t){var s=2*qi(e,t);return s>0?Ei(e,t+4,t+4+s-1):""},Ii=Oi,Di=function(e,t){var s=qi(e,t);return s>0?Ci(e,t+4,t+4+s):""},Fi=Di,Bi=function(e,t){var s=qi(e,t);return s>0?Ei(e,t+4,t+4+s):""},$i=Bi,zi=function(e,t){return function(e,t){for(var s=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],n=5;n>=0;--n)a=256*a+e[t+n];return 2047==r?0==a?s*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),s*Math.pow(2,r-52)*a)}(e,t)},Vi=zi,Ui=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};la&&(Pi=function(e,t){if(!Buffer.isBuffer(e))return Ri(e,t);var s=e.readUInt32LE(t);return s>0?e.toString("utf8",t+4,t+4+s-1):""},Li=function(e,t){if(!Buffer.isBuffer(e))return Mi(e,t);var s=e.readUInt32LE(t);return s>0?e.toString("utf8",t+4,t+4+s-1):""},Ii=function(e,t){if(!Buffer.isBuffer(e))return Oi(e,t);var s=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+s-1)},Fi=function(e,t){if(!Buffer.isBuffer(e))return Di(e,t);var s=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+s)},$i=function(e,t){if(!Buffer.isBuffer(e))return Bi(e,t);var s=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+s)},Vi=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):zi(e,t)},Ui=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var Wi=function(e,t){return e[t]},Hi=function(e,t){return 256*e[t+1]+e[t]},Gi=function(e,t){var s=256*e[t+1]+e[t];return s<32768?s:-1*(65535-s+1)},qi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Yi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ki=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xi(e,t){var s,r,a,n,i,l,o="",c=[];switch(t){case"dbcs":if(l=this.l,la&&Buffer.isBuffer(this))o=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)o+=String.fromCharCode(Hi(this,l)),l+=2;e*=2;break;case"utf8":o=Ei(this,this.l,this.l+e);break;case"utf16le":e*=2,o=Ci(this,this.l,this.l+e);break;case"wstr":return Xi.call(this,e,"dbcs");case"lpstr-ansi":o=Pi(this,this.l),e=4+qi(this,this.l);break;case"lpstr-cp":o=Li(this,this.l),e=4+qi(this,this.l);break;case"lpwstr":o=Ii(this,this.l),e=4+2*qi(this,this.l);break;case"lpp4":e=4+qi(this,this.l),o=Fi(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+qi(this,this.l),o=$i(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,o="";0!==(a=Wi(this,this.l+e++));)c.push(sa(a));o=c.join("");break;case"_wstr":for(e=0,o="";0!==(a=Hi(this,this.l+e));)c.push(sa(a)),e+=2;e+=2,o=c.join("");break;case"dbcs-cont":for(o="",l=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return a=Wi(this,l),this.l=l+1,n=Xi.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(sa(Hi(this,l))),l+=2}o=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(o="",l=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return a=Wi(this,l),this.l=l+1,n=Xi.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(sa(Wi(this,l))),l+=1}o=c.join("");break;default:switch(e){case 1:return s=Wi(this,this.l),this.l++,s;case 2:return s=("i"===t?Gi:Hi)(this,this.l),this.l+=2,s;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(r=qi(this,this.l),this.l+=4,r):(s=(e>0?Yi:Ki)(this,this.l),this.l+=4,s);case 8:case-8:if("f"===t)return r=8==e?Vi(this,this.l):Vi([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:o=Ti(this,this.l,e)}}return this.l+=e,o}var Ji=function(e,t,s){e[s]=255&t,e[s+1]=t>>>8&255,e[s+2]=t>>>16&255,e[s+3]=t>>>24&255},Zi=function(e,t,s){e[s]=255&t,e[s+1]=t>>8&255,e[s+2]=t>>16&255,e[s+3]=t>>24&255},Qi=function(e,t,s){e[s]=255&t,e[s+1]=t>>>8&255};function el(e,t,s){var r=0,a=0;if("dbcs"===s){for(a=0;a!=t.length;++a)Qi(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===s){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===s){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===s){var n=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=255&i,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Ji(this,t,this.l);break;case 8:if(r=8,"f"===s){!function(e,t,s){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,n=0,i=r?-t:t;isFinite(i)?0==i?a=n=0:(a=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?a=-1022:(n-=Math.pow(2,52),a+=1023)):(a=2047,n=isNaN(t)?26985:0);for(var l=0;l<=5;++l,n/=256)e[s+l]=255&n;e[s+6]=(15&a)<<4|15&n,e[s+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Zi(this,t,this.l)}}return this.l+=r,this}function tl(e,t){var s=Ti(this,this.l,e.length>>1);if(s!==e)throw new Error(t+"Expected "+e+" saw "+s);this.l+=e.length>>1}function sl(e,t){e.l=t,e.read_shift=Xi,e.chk=tl,e.write_shift=el}function rl(e,t){e.l+=t}function al(e){var t=ca(e);return sl(t,0),t}function nl(){var e=[],t=la?256:2048,s=function(e){var t=al(e);return sl(t,0),t},r=s(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},n=function(e){return r&&e<r.length-r.l?r:(a(),r=s(Math.max(e+1,t)))};return{next:n,push:function(e){a(),null==(r=e).l&&(r.l=r.length),n(t)},end:function(){return a(),xa(e)},_bufs:e}}function il(e,t,s,r){var a,n=+t;if(!isNaN(n)){r||(r=mu[n].p||(s||[]).length||0),a=1+(n>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var i=e.next(a);n<=127?i.write_shift(1,n):(i.write_shift(1,128+(127&n)),i.write_shift(1,n>>7));for(var l=0;4!=l;++l){if(!(r>=128)){i.write_shift(1,r);break}i.write_shift(1,128+(127&r)),r>>=7}r>0&&Ui(s)&&e.push(s)}}function ll(e,t,s){var r=An(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!s||s.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ol(e,t,s){var r=An(e);return r.s=ll(r.s,t.s,s),r.e=ll(r.e,t.s,s),r}function cl(e,t){if(e.cRel&&e.c<0)for(e=An(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=An(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var s=fl(e);return e.cRel||null==e.cRel||(s=s.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(s=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(s)),s}function dl(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?cl(e.s,t.biff)+":"+cl(e.e,t.biff):(e.s.rRel?"":"$")+ml(e.s.r)+":"+(e.e.rRel?"":"$")+ml(e.e.r):(e.s.cRel?"":"$")+xl(e.s.c)+":"+(e.e.cRel?"":"$")+xl(e.e.c)}function ul(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function ml(e){return""+(e+1)}function hl(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),s=0,r=0;r!==t.length;++r)s=26*s+t.charCodeAt(r)-64;return s-1}function xl(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pl(e){for(var t=0,s=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(s=26*s+(a-64))}return{c:s-1,r:t-1}}function fl(e){for(var t=e.c+1,s="";t;t=(t-1)/26|0)s=String.fromCharCode((t-1)%26+65)+s;return s+(e.r+1)}function gl(e){var t=e.indexOf(":");return-1==t?{s:pl(e),e:pl(e)}:{s:pl(e.slice(0,t)),e:pl(e.slice(t+1))}}function bl(e,t){return void 0===t||"number"==typeof t?bl(e.s,e.e):("string"!=typeof e&&(e=fl(e)),"string"!=typeof t&&(t=fl(t)),e==t?e:e+":"+t)}function vl(e){var t={s:{c:0,r:0},e:{c:0,r:0}},s=0,r=0,a=0,n=e.length;for(s=0;r<n&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)s=26*s+a;for(t.s.c=--s,s=0;r<n&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)s=10*s+a;if(t.s.r=--s,r===n||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,s=0;r!=n&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)s=26*s+a;for(t.e.c=--s,s=0;r!=n&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)s=10*s+a;return t.e.r=--s,t}function yl(e,t){var s="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=an(e.z,s?vn(t):t)}catch(r){}try{return e.w=an((e.XF||{}).numFmtId||(s?14:0),s?vn(t):t)}catch(r){return""+t}}function wl(e,t,s){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&s&&s.dateNF&&(e.z=s.dateNF),"e"==e.t?so[e.v]||e.v:yl(e,null==t?e.v:t))}function jl(e,t){var s=t&&t.sheet?t.sheet:"Sheet1",r={};return r[s]=e,{SheetNames:[s],Sheets:r}}function Nl(e,t,s){var r=s||{},a=e?Array.isArray(e):r.dense,n=e||(a?[]:{}),i=0,l=0;if(n&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var o="string"==typeof r.origin?pl(r.origin):r.origin;i=o.r,l=o.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=vl(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[u].length;++m)if(void 0!==t[u][m]){var h={v:t[u][m]},x=i+u,p=l+m;if(c.s.r>x&&(c.s.r=x),c.s.c>p&&(c.s.c=p),c.e.r<x&&(c.e.r=x),c.e.c<p&&(c.e.c=p),!t[u][m]||"object"!=typeof t[u][m]||Array.isArray(t[u][m])||t[u][m]instanceof Date)if(Array.isArray(h.v)&&(h.f=t[u][m][1],h.v=h.v[0]),null===h.v)if(h.f)h.t="n";else if(r.nullError)h.t="e",h.v=0;else{if(!r.sheetStubs)continue;h.t="z"}else"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.z=r.dateNF||Ca[14],r.cellDates?(h.t="d",h.w=an(h.z,vn(h.v))):(h.t="n",h.v=vn(h.v),h.w=an(h.z,h.v))):h.t="s";else h=t[u][m];if(a)n[x]||(n[x]=[]),n[x][p]&&n[x][p].z&&(h.z=n[x][p].z),n[x][p]=h;else{var f=fl({c:p,r:x});n[f]&&n[f].z&&(h.z=n[f].z),n[f]=h}}}return c.s.c<1e7&&(n["!ref"]=bl(c)),n}function _l(e,t){return Nl(null,e,t)}function kl(e,t){return t||(t=al(4)),t.write_shift(4,e),t}function Cl(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Sl(e,t){var s=!1;return null==t&&(s=!0,t=al(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),s?t.slice(0,t.l):t}function Tl(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Al(e,t){var s=e.l,r=e.read_shift(1),a=Cl(e),n=[],i={t:a,h:a};if(1&r){for(var l=e.read_shift(4),o=0;o!=l;++o)n.push(Tl(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=s+t,i}var El=Al;function Rl(e,t){var s=!1;return null==t&&(s=!0,t=al(23+4*e.t.length)),t.write_shift(1,1),Sl(e.t,t),t.write_shift(4,1),function(e,t){t||(t=al(4)),t.write_shift(2,0),t.write_shift(2,0)}(0,t),s?t.slice(0,t.l):t}function Pl(e){var t=e.read_shift(4),s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:s}}function Ml(e,t){return null==t&&(t=al(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ll(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ol(e,t){return null==t&&(t=al(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Il=Cl,Dl=Sl;function Fl(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Bl(e,t){var s=!1;return null==t&&(s=!0,t=al(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),s?t.slice(0,t.l):t}var $l=Cl,zl=Fl,Vl=Bl;function Ul(e){var t=e.slice(e.l,e.l+4),s=1&t[0],r=2&t[0];e.l+=4;var a=0===r?Vi([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Yi(t,0)>>2;return s?a/100:a}function Wl(e,t){null==t&&(t=al(4));var s=0,r=0,a=100*e;if(e==(0|e)&&e>=-536870912&&e<1<<29?r=1:a==(0|a)&&a>=-536870912&&a<1<<29&&(r=1,s=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((s?a:e)<<2)+(s+2))}function Hl(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Gl=Hl,ql=function(e,t){return t||(t=al(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Yl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Kl(e,t){return(t||al(8)).write_shift(8,e,"f")}function Xl(e,t){if(t||(t=al(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var s=e.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),t.write_shift(2,s),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var Jl=80,Zl={1:{n:"CodePage",t:2},2:{n:"Category",t:Jl},3:{n:"PresentationFormat",t:Jl},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Jl},15:{n:"Company",t:Jl},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Jl},27:{n:"ContentStatus",t:Jl},28:{n:"Language",t:Jl},29:{n:"Version",t:Jl},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Ql={1:{n:"CodePage",t:2},2:{n:"Title",t:Jl},3:{n:"Subject",t:Jl},4:{n:"Author",t:Jl},5:{n:"Keywords",t:Jl},6:{n:"Comments",t:Jl},7:{n:"Template",t:Jl},8:{n:"LastAuthor",t:Jl},9:{n:"RevNumber",t:Jl},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Jl},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function eo(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var to=An(eo([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),so={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ro={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ao={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function no(e,t){var s,r=function(e){for(var t=[],s=xn(e),r=0;r!==s.length;++r)null==t[e[s[r]]]&&(t[e[s[r]]]=[]),t[e[s[r]]].push(s[r]);return t}(ro),a=[];a[a.length]=In,a[a.length]=ei("Types",null,{xmlns:ni,"xmlns:xsd":xi,"xmlns:xsi":hi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return ei("Default",null,{Extension:e[0],ContentType:e[1]})}));var n=function(r){e[r]&&e[r].length>0&&(s=e[r][0],a[a.length]=ei("Override",null,{PartName:("/"==s[0]?"":"/")+s,ContentType:ao[r][t.bookType]||ao[r].xlsx}))},i=function(s){(e[s]||[]).forEach(function(e){a[a.length]=ei("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ao[s][t.bookType]||ao[s].xlsx})})},l=function(t){(e[t]||[]).forEach(function(e){a[a.length]=ei("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return n("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var io={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function oo(e){var t=[In,ei("Relationships",null,{xmlns:ii})];return xn(e["!id"]).forEach(function(s){t[t.length]=ei("Relationship",null,e["!id"][s])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function co(e,t,s,r,a,n){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=s,[io.HLINK,io.XPATH,io.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function uo(e,t,s){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function mo(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function ho(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kr.version+"</meta:generator></office:meta></office:document-meta>"}var xo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function po(e,t,s,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=$n(t),r[r.length]=s?ei(e,t,s):Zn(e,t))}function fo(e,t){var s=t||{},r=[In,ei("cp:coreProperties",null,{"xmlns:cp":si,"xmlns:dc":oi,"xmlns:dcterms":ci,"xmlns:dcmitype":di,"xmlns:xsi":hi})],a={};if(!e&&!s.Props)return r.join("");e&&(null!=e.CreatedDate&&po("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:ti(e.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&po("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:ti(e.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var n=0;n!=xo.length;++n){var i=xo[n],l=s.Props&&null!=s.Props[i[1]]?s.Props[i[1]]:e?e[i[1]]:null;!0===l?l="1":!1===l?l="0":"number"==typeof l&&(l=String(l)),null!=l&&po(i[0],l,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var go=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bo=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vo(e){var t=[],s=ei;return e||(e={}),e.Application="SheetJS",t[t.length]=In,t[t.length]=ei("Properties",null,{xmlns:ai,"xmlns:vt":mi}),go.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=$n(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=s(r[0],a))}}),t[t.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=s("TitlesOfParts",s("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+$n(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function yo(e){var t=[In,ei("Properties",null,{xmlns:ri,"xmlns:vt":mi})];if(!e)return t.join("");var s=1;return xn(e).forEach(function(r){++s,t[t.length]=ei("property",function(e){switch(typeof e){case"string":var t=ei("vt:lpwstr",$n(e));return t.replace(/&quot;/g,"_x0022_");case"number":return ei((0|e)==e?"vt:i4":"vt:r8",$n(String(e)));case"boolean":return ei("vt:bool",e?"true":"false")}if(e instanceof Date)return ei("vt:filetime",ti(e));throw new Error("Unable to serialize "+e)}(e[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:$n(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wo={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jo(e,t){var s=al(4),r=al(4);switch(s.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=al(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,s=t%Math.pow(2,32),r=(t-s)/Math.pow(2,32);r*=1e7;var a=(s*=1e7)/Math.pow(2,32)|0;a>0&&(s%=Math.pow(2,32),r+=a);var n=al(8);return n.write_shift(4,s),n.write_shift(4,r),n}(t);break;case 31:case 80:for((r=al(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xa([s,r])}var No=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function _o(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function ko(e,t,s){var r=al(8),a=[],n=[],i=8,l=0,o=al(8),c=al(8);if(o.write_shift(4,2),o.write_shift(4,1200),c.write_shift(4,1),n.push(o),a.push(c),i+=8+o.length,!t){(c=al(8)).write_shift(4,0),a.unshift(c);var d=[al(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var u=e[l][0];for((o=al(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,l+2),o.write_shift(4,u.length+1),o.write_shift(0,u,"dbcs");o.l!=o.length;)o.write_shift(1,0);d.push(o)}o=xa(d),n.unshift(o),i+=8+o.length}for(l=0;l<e.length;++l)if((!t||t[e[l][0]])&&!(No.indexOf(e[l][0])>-1||bo.indexOf(e[l][0])>-1)&&null!=e[l][1]){var m=e[l][1],h=0;if(t){var x=s[h=+t[e[l][0]]];if("version"==x.p&&"string"==typeof m){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}o=jo(x.t,m)}else{var f=_o(m);-1==f&&(f=31,m=String(m)),o=jo(f,m)}n.push(o),(c=al(8)).write_shift(4,t?h:2+l),a.push(c),i+=8+o.length}var g=8*(n.length+1);for(l=0;l<n.length;++l)a[l].write_shift(4,g),g+=n[l].length;return r.write_shift(4,i),r.write_shift(4,n.length),xa([r].concat(a).concat(n))}function Co(e,t,s,r,a,n){var i=al(a?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,un.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var o=ko(e,s,r);if(l.push(o),a){var c=ko(a,null,null);i.write_shift(16,n,"hex"),i.write_shift(4,68+o.length),l.push(c)}return xa(l)}function So(e,t){return t||(t=al(2)),t.write_shift(2,+!!e),t}function To(e){return e.read_shift(2,"u")}function Ao(e,t){return t||(t=al(2)),t.write_shift(2,e),t}function Eo(e,t,s){return s||(s=al(2)),s.write_shift(1,"e"==t?+e:+!!e),s.write_shift(1,"e"==t?1:0),s}function Ro(e,t,s){var r=e.read_shift(s&&s.biff>=12?2:1),a="sbcs-cont";(s&&s.biff,s&&8!=s.biff)?12==s.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");return s.biff>=2&&s.biff<=5&&(a="cpstr"),r?e.read_shift(r,a):""}function Po(e){var t=e.t||"",s=al(3);s.write_shift(2,t.length),s.write_shift(1,1);var r=al(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),xa([s,r])}function Mo(e,t,s){return s||(s=al(3+2*e.length)),s.write_shift(2,e.length),s.write_shift(1,1),s.write_shift(31,e,"utf16le"),s}function Lo(e,t){t||(t=al(6+2*e.length)),t.write_shift(4,1+e.length);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function Oo(e){var t=al(512),s=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),n=a>-1?31:23;switch(r.charAt(0)){case"#":n=28;break;case".":n&=-3}t.write_shift(4,2),t.write_shift(4,n);var i=[8,6815827,6619237,4849780,83];for(s=0;s<i.length;++s)t.write_shift(4,i[s]);if(28==n)Lo(r=r.slice(1),t);else if(2&n){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<i.length;++s)t.write_shift(1,parseInt(i[s],16));var l=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(l.length+1)),s=0;s<l.length;++s)t.write_shift(2,l.charCodeAt(s));t.write_shift(2,0),8&n&&Lo(a>-1?r.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<i.length;++s)t.write_shift(1,parseInt(i[s],16));for(var o=0;"../"==r.slice(3*o,3*o+3)||"..\\"==r.slice(3*o,3*o+3);)++o;for(t.write_shift(2,o),t.write_shift(4,r.length-3*o+1),s=0;s<r.length-3*o;++s)t.write_shift(1,255&r.charCodeAt(s+3*o));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),s=0;s<6;++s)t.write_shift(4,0)}return t.slice(0,t.l)}function Io(e,t,s,r){return r||(r=al(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,s||0),r}function Do(e,t,s){var r=s.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Fo(e){var t=e.read_shift(2),s=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:s}}}function Bo(e,t){return t||(t=al(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function $o(e,t,s){var r=1536,a=16;switch(s.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var n=al(a);return n.write_shift(2,r),n.write_shift(2,t),a>4&&n.write_shift(2,29282),a>6&&n.write_shift(2,1997),a>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function zo(e,t){var s=!t||t.biff>=8?2:1,r=al(8+s*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(s*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function Vo(e,t,s,r){var a=s&&5==s.biff;r||(r=al(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var n=r.length>r.l?r.slice(0,r.l):r;return null==n.l&&(n.l=n.length),n}function Uo(e,t,s,r){var a=s&&5==s.biff;r||(r=al(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&a&&(n|=1024),r.write_shift(4,n),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function Wo(e){var t=al(24),s=pl(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return xa([t,Oo(e[1])])}function Ho(e){var t=e[1].Tooltip,s=al(10+2*(t.length+1));s.write_shift(2,2048);var r=pl(e[0]);s.write_shift(2,r.r),s.write_shift(2,r.r),s.write_shift(2,r.c),s.write_shift(2,r.c);for(var a=0;a<t.length;++a)s.write_shift(2,t.charCodeAt(a));return s.write_shift(2,0),s}var Go=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=fn({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(t,s){var r=s||{};r.dateNF||(r.dateNF="yyyymmdd");var a=_l(function(t,s){var r=[],a=ca(1);switch(s.type){case"base64":a=ua(ia(t));break;case"binary":a=ua(t);break;case"buffer":case"array":a=t}sl(a,0);var n=a.read_shift(1),i=!!(136&n),l=!1,o=!1;switch(n){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:l=!0,i=!0;break;case 140:o=!0;break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}var c=0,d=521;2==n&&(c=a.read_shift(2)),a.l+=3,2!=n&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=n&&(d=a.read_shift(2));var u=a.read_shift(2),m=s.codepage||1252;2!=n&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(m=e[a[a.l]]),a.l+=1,a.l+=2),o&&(a.l+=36);for(var h=[],x={},p=Math.min(a.length,2==n?521:d-10-(l?264:0)),f=o?32:11;a.l<p&&13!=a[a.l];)switch((x={}).name=ta.utils.decode(m,a.slice(a.l,a.l+f)).replace(/[\u0000\r\n].*$/g,""),a.l+=f,x.type=String.fromCharCode(a.read_shift(1)),2==n||o||(x.offset=a.read_shift(4)),x.len=a.read_shift(1),2==n&&(x.offset=a.read_shift(2)),x.dec=a.read_shift(1),x.name.length&&h.push(x),2!=n&&(a.l+=o?13:14),x.type){case"B":(!l||8!=x.len)&&s.WTF;break;case"G":case"P":s.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(13!==a[a.l]&&(a.l=d-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=d;var g=0,b=0;for(r[0]=[],b=0;b!=h.length;++b)r[0][b]=h[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++g]=[],b=0,b=0;b!=h.length;++b){var v=a.slice(a.l,a.l+h[b].len);a.l+=h[b].len,sl(v,0);var y=ta.utils.decode(m,v);switch(h[b].type){case"C":y.trim().length&&(r[g][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?r[g][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):r[g][b]=y;break;case"F":r[g][b]=parseFloat(y.trim());break;case"+":case"I":r[g][b]=o?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":r[g][b]=!0;break;case"N":case"F":r[g][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));r[g][b]="##MEMO##"+(o?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(r[g][b]=+y||0);break;case"@":r[g][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":r[g][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":r[g][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[g][b]=-v.read_shift(-8,"f");break;case"B":if(l&&8==h[b].len){r[g][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=h[b].len;break;case"0":if("_NullFlags"===h[b].name)break;default:throw new Error("DBF Unsupported data type "+h[b].type)}}else a.l+=u;if(2!=n&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return s&&s.sheetRows&&(r=r.slice(0,s.sheetRows)),s.DBF=h,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return jl(s(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:s,from_sheet:function(e,s){var a=s||{};if(+a.codepage>=0&&Qr(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var n=nl(),i=sm(e,{header:1,raw:!0,cellDates:!0}),l=i[0],o=i.slice(1),c=e["!cols"]||[],d=0,u=0,m=0,h=1;for(d=0;d<l.length;++d)if(((c[d]||{}).DBF||{}).name)l[d]=c[d].DBF.name,++m;else if(null!=l[d]){if(++m,"number"==typeof l[d]&&(l[d]=l[d].toString(10)),"string"!=typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+typeof l[d]+"|");if(l.indexOf(l[d])!==d)for(u=0;u<1024;++u)if(-1==l.indexOf(l[d]+"_"+u)){l[d]+="_"+u;break}}var x=vl(e["!ref"]),p=[],f=[],g=[];for(d=0;d<=x.e.c-x.s.c;++d){var b="",v="",y=0,w=[];for(u=0;u<o.length;++u)null!=o[u][d]&&w.push(o[u][d]);if(0!=w.length&&null!=l[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",g[d]=c[d].DBF.dec,y=c[d].DBF.len),f[d]="C"==b||"N"==v?y:r[b]||0,h+=f[d],p[d]=b}else p[d]="?"}var j=n.next(32);for(j.write_shift(4,318902576),j.write_shift(4,o.length),j.write_shift(2,296+32*m),j.write_shift(2,h),d=0;d<4;++d)j.write_shift(4,0);for(j.write_shift(4,(+t[Xr]||3)<<8),d=0,u=0;d<l.length;++d)if(null!=l[d]){var N=n.next(32),_=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,_,"sbcs"),N.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),N.write_shift(4,u),N.write_shift(1,f[d]||r[p[d]]||0),N.write_shift(1,g[d]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),u+=f[d]||r[p[d]]||0}var k=n.next(264);for(k.write_shift(4,13),d=0;d<65;++d)k.write_shift(4,0);for(d=0;d<o.length;++d){var C=n.next(h);for(C.write_shift(1,0),u=0;u<l.length;++u)if(null!=l[u])switch(p[u]){case"L":C.write_shift(1,null==o[d][u]?63:o[d][u]?84:70);break;case"B":C.write_shift(8,o[d][u]||0,"f");break;case"N":var S="0";for("number"==typeof o[d][u]&&(S=o[d][u].toFixed(g[u]||0)),m=0;m<f[u]-S.length;++m)C.write_shift(1,32);C.write_shift(1,S,"sbcs");break;case"D":o[d][u]?(C.write_shift(4,("0000"+o[d][u].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(o[d][u].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+o[d][u].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var T=String(null!=o[d][u]?o[d][u]:"").slice(0,f[u]);for(C.write_shift(1,T,"sbcs"),m=0;m<f[u]-T.length;++m)C.write_shift(1,32)}}return n.next(1).write_shift(1,26),n.end()}}}(),qo=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+xn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(t,s){var r=e[s];return"number"==typeof r?ra(r):r},r=function(e,t,s){var r=t.charCodeAt(0)-32<<4|s.charCodeAt(0)-48;return 59==r?e:ra(r)};function a(e,a){var n,i=e.split(/[\n\r]+/),l=-1,o=-1,c=0,d=0,u=[],m=[],h=null,x={},p=[],f=[],g=[],b=0;for(+a.codepage>=0&&Qr(+a.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,s),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),j=w[0];if(y.length>0)switch(j){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&m.push(y.slice(3).replace(/;;/g,";"));break;case"C":var N=!1,_=!1,k=!1,C=!1,S=-1,T=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":o=parseInt(w[d].slice(1))-1,_=!0;break;case"Y":for(l=parseInt(w[d].slice(1))-1,_||(o=0),n=u.length;n<=l;++n)u[n]=[];break;case"K":'"'===(v=w[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(Rn(v))?isNaN(Mn(v).getDate())||(v=Sn(v)):(v=Rn(v),null!==h&&en(h)&&(v=Nn(v))),N=!0;break;case"E":C=!0;var A=Dc(w[d].slice(1),{r:l,c:o});u[l][o]=[u[l][o],A];break;case"S":k=!0,u[l][o]=[u[l][o],"S5S"];break;case"R":S=parseInt(w[d].slice(1))-1;break;case"C":T=parseInt(w[d].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}if(N&&(u[l][o]&&2==u[l][o].length?u[l][o][0]=v:u[l][o]=v,h=null),k){if(C)throw new Error("SYLK shared formula cannot have own formula");var E=S>-1&&u[S][T];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");u[l][o][1]=$c(E[1],{r:l-S,c:o-T})}break;case"F":var R=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":o=parseInt(w[d].slice(1))-1,++R;break;case"Y":for(l=parseInt(w[d].slice(1))-1,n=u.length;n<=l;++n)u[n]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":h=m[parseInt(w[d].slice(1))];break;case"W":for(g=w[d].slice(1).split(" "),n=parseInt(g[0],10);n<=parseInt(g[1],10);++n)b=parseInt(g[2],10),f[n-1]=0===b?{hidden:!0}:{wch:b},cc(f[n-1]);break;case"C":f[o=parseInt(w[d].slice(1))-1]||(f[o]={});break;case"R":p[l=parseInt(w[d].slice(1))-1]||(p[l]={}),b>0?(p[l].hpt=b,p[l].hpx=mc(b)):0===b&&(p[l].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}R<1&&(h=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(x["!rows"]=p),f.length>0&&(x["!cols"]=f),a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),[u,x]}function n(e,t){var s=function(e,t){switch(t.type){case"base64":return a(ia(e),t);case"binary":return a(e,t);case"buffer":return a(la&&Buffer.isBuffer(e)?e.toString("binary"):ha(e),t);case"array":return a(Tn(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=s[0],n=s[1],i=_l(r,t);return xn(n).forEach(function(e){i[e]=n[e]}),i}function i(e,t,s,r){var a="C;Y"+(s+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Bc(e.f,{r:s,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return jl(n(e,t),t)},to_sheet:n,from_sheet:function(e,t){var s,r,a=["ID;PWXL;N;E"],n=[],l=vl(e["!ref"]),o=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var s="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?s+="0":("number"!=typeof e.width||e.wpx||(e.wpx=ic(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=lc(e.wpx)),"number"==typeof e.wch&&(s+=Math.round(e.wch)))," "!=s.charAt(s.length-1)&&r.push(s)})),e["!rows"]&&function(e,t){t.forEach(function(t,s){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*uc(t.hpx)+";"),r.length>2&&e.push(r+"R"+(s+1))})}(a,e["!rows"]),a.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" "));for(var d=l.s.r;d<=l.e.r;++d)for(var u=l.s.c;u<=l.e.c;++u){var m=fl({r:d,c:u});(s=o?(e[d]||[])[u]:e[m])&&(null!=s.v||s.f&&!s.F)&&n.push(i(s,0,d,u))}return a.join(c)+c+n.join(c)+c+"E"+c}}}(),Yo=function(){function e(e,t){for(var s=e.split("\n"),r=-1,a=-1,n=0,i=[];n!==s.length;++n)if("BOT"!==s[n].trim()){if(!(r<0)){for(var l=s[n].trim().split(","),o=l[0],c=l[1],d=s[++n]||"";1&(d.match(/["]/g)||[]).length&&n<s.length-1;)d+="\n"+s[++n];switch(d=d.trim(),+o){case-1:if("BOT"===d){i[++r]=[],a=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[r][a]=!0:"FALSE"===d?i[r][a]=!1:isNaN(Rn(c))?isNaN(Mn(c).getDate())?i[r][a]=c:i[r][a]=Sn(c):i[r][a]=Rn(c),++a;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[r][a++]=""!==d?d:null}if("EOD"===d)break}}else i[++r]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,s){return _l(function(t,s){switch(s.type){case"base64":return e(ia(t),s);case"binary":return e(t,s);case"buffer":return e(la&&Buffer.isBuffer(t)?t.toString("binary"):ha(t),s);case"array":return e(Tn(t),s)}throw new Error("Unrecognized type "+s.type)}(t,s),s)}return{to_workbook:function(e,s){return jl(t(e,s),s)},to_sheet:t,from_sheet:function(){var e=function(e,t,s,r,a){e.push(t),e.push(s+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,s,r){e.push(t+","+s),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(s){var r,a=[],n=vl(s["!ref"]),i=Array.isArray(s);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,n.e.r-n.s.r+1,""),e(a,"TUPLES",0,n.e.c-n.s.c+1,""),e(a,"DATA",0,0,"");for(var l=n.s.r;l<=n.e.r;++l){t(a,-1,0,"BOT");for(var o=n.s.c;o<=n.e.c;++o){var c=fl({r:l,c:o});if(r=i?(s[l]||[])[o]:s[c])switch(r.t){case"n":var d=r.w;d||null==r.v||(d=r.v),null==d?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,d,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=an(r.z||Ca[14],vn(Sn(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Ko=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(t,s){return _l(function(t,s){for(var r=t.split("\n"),a=-1,n=-1,i=0,l=[];i!==r.length;++i){var o=r[i].trim().split(":");if("cell"===o[0]){var c=pl(o[1]);if(l.length<=c.r)for(a=l.length;a<=c.r;++a)l[a]||(l[a]=[]);switch(a=c.r,n=c.c,o[2]){case"t":l[a][n]=e(o[3]);break;case"v":l[a][n]=+o[3];break;case"vtf":var d=o[o.length-1];case"vtc":"nl"===o[3]?l[a][n]=!!+o[4]:l[a][n]=+o[4],"vtf"==o[2]&&(l[a][n]=[l[a][n],d])}}}return s&&s.sheetRows&&(l=l.slice(0,s.sheetRows)),l}(t,s),s)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",n=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function l(e){if(!e||!e["!ref"])return"";for(var s,r=[],a=[],n="",i=gl(e["!ref"]),l=Array.isArray(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c)if(n=fl({r:o,c:c}),(s=l?(e[o]||[])[c]:e[n])&&null!=s.v&&"z"!==s.t){switch(a=["cell",n,"t"],s.t){case"s":case"str":a.push(t(s.v));break;case"n":s.f?(a[2]="vtf",a[3]="n",a[4]=s.v,a[5]=t(s.f)):(a[2]="v",a[3]=s.v);break;case"b":a[2]="vt"+(s.f?"f":"c"),a[3]="nl",a[4]=s.v?"1":"0",a[5]=t(s.f||(s.v?"TRUE":"FALSE"));break;case"d":var d=vn(Sn(s.v));a[2]="vtc",a[3]="nd",a[4]=""+d,a[5]=s.w||an(s.z||Ca[14],d);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return jl(s(e,t),t)},to_sheet:s,from_sheet:function(e){return[r,a,n,a,l(e),i].join("\n")}}}(),Xo=function(){function e(e,t,s,r,a){a.raw?t[s][r]=e:""===e||("TRUE"===e?t[s][r]=!0:"FALSE"===e?t[s][r]=!1:isNaN(Rn(e))?isNaN(Mn(e).getDate())?t[s][r]=e:t[s][r]=Sn(e):t[s][r]=Rn(e))}var t={44:",",9:"\t",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?a=!a:!a&&i in t&&(r[i]=(r[i]||0)+1);for(n in i=[],r)Object.prototype.hasOwnProperty.call(r,n)&&i.push([r[n],n]);if(!i.length)for(n in r=s)Object.prototype.hasOwnProperty.call(r,n)&&i.push([r[n],n]);return i.sort(function(e,t){return e[0]-t[0]||s[e[1]]-s[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var s=t||{},a="",n=s.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=s&&s.FS?s.FS:r(e.slice(0,1024));var l=0,o=0,c=0,d=0,u=0,m=a.charCodeAt(0),h=!1,x=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var f,g,b=null!=s.dateNF?(f=s.dateNF,g=(g="number"==typeof f?Ca[f]:f).replace(cn,"(\\d+)"),new RegExp("^"+g+"$")):null;function v(){var t=e.slice(d,u),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(s.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Rn(t)))if(!isNaN(Mn(t).getDate())||b&&t.match(b)){r.z=s.dateNF||Ca[14];var a=0;b&&t.match(b)&&(t=function(e,t,s){var r=-1,a=-1,n=-1,i=-1,l=-1,o=-1;(t.match(cn)||[]).forEach(function(e,t){var c=parseInt(s[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":n=c;break;case"h":i=c;break;case"s":o=c;break;case"m":i>=0?l=c:a=c}}),o>=0&&-1==l&&a>=0&&(l=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return-1==i&&-1==l&&-1==o?c:-1==r&&-1==a&&-1==n?d:c+"T"+d}(0,s.dateNF,t.match(b)||[]),a=1),s.cellDates?(r.t="d",r.v=Sn(t,a)):(r.t="n",r.v=vn(Sn(t,a))),!1!==s.cellText&&(r.w=an(r.z,r.v instanceof Date?vn(r.v):r.v)),s.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==s.cellText&&(r.w=t),r.v=c;if("z"==r.t||(s.dense?(n[l]||(n[l]=[]),n[l][o]=r):n[fl({c:o,r:l})]=r),d=u+1,p=e.charCodeAt(d),i.e.c<o&&(i.e.c=o),i.e.r<l&&(i.e.r=l),x==m)++o;else if(o=0,++l,s.sheetRows&&s.sheetRows<=l)return!0}e:for(;u<e.length;++u)switch(x=e.charCodeAt(u)){case 34:34===p&&(h=!h);break;case m:case 10:case 13:if(!h&&v())break e}return u-d>0&&v(),n["!ref"]=bl(i),n}function n(t,s){return s&&s.PRN?s.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,s):_l(function(t,s){var r=s||{},a=[];if(!t||0===t.length)return a;for(var n=t.split(/[\r\n]/),i=n.length-1;i>=0&&0===n[i].length;)--i;for(var l=10,o=0,c=0;c<=i;++c)-1==(o=n[c].indexOf(" "))?o=n[c].length:o++,l=Math.max(l,o);for(c=0;c<=i;++c){a[c]=[];var d=0;for(e(n[c].slice(0,l).trim(),a,c,d,r),d=1;d<=(n[c].length-l)/10+1;++d)e(n[c].slice(l+10*(d-1),l+10*d).trim(),a,c,d,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,s),s):a(t,s)}function i(e,t){var s="",r="string"==t.type?[0,0,0,0]:function(e,t){var s="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":s=ia(e.slice(0,12));break;case"binary":s=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}(e,t);switch(t.type){case"base64":s=ia(e);break;case"binary":case"string":s=e;break;case"buffer":65001==t.codepage?s=e.toString("utf8"):(t.codepage,s=la&&Buffer.isBuffer(e)?e.toString("binary"):ha(e));break;case"array":s=Tn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?s=Yn(s.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?s=Yn(s):t.type,"socialcalc:version:"==s.slice(0,19)?Ko.to_sheet("string"==t.type?s:Yn(s),t):n(s,t)}return{to_workbook:function(e,t){return jl(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,s=[],r=vl(e["!ref"]),a=Array.isArray(e),n=r.s.r;n<=r.e.r;++n){for(var i=[],l=r.s.c;l<=r.e.c;++l){var o=fl({r:n,c:l});if((t=a?(e[n]||[])[l]:e[o])&&null!=t.v){for(var c=(t.w||(wl(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===l?" ":""))}else i.push("          ")}s.push(i.join(""))}return s.join("\n")}}}(),Jo=function(){function e(e,t,s){if(e){sl(e,e.l||0);for(var r=s.Enum||g;e.l<e.length;){var a=e.read_shift(2),n=r[a]||r[65535],i=e.read_shift(2),l=e.l+i,o=n.f&&n.f(e,i,s);if(e.l=l,t(o,n,a))return}}}function t(t,s){if(!t)return t;var r=s||{},a=r.dense?[]:{},n="Sheet1",i="",l=0,o={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},m=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=g,e(t,function(e,t,s){switch(s){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==s&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Ca[14],r.cellDates&&(e[1].t="d",e[1].v=Nn(e[1].v))),r.qpro&&e[3]>l&&(a["!ref"]=bl(u),o[n]=a,c.push(n),a=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n=i||"Sheet"+(l+1),i="");var d=r.dense?(a[e[0].r]||[])[e[0].c]:a[fl(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[fl(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=b,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,s){switch(s){case 204:n=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(a["!ref"]=bl(u),o[n]=a,c.push(n),a=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n="Sheet"+(l+1)),m>0&&e[0].r>=m)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[fl(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(n=e[1])}},r)}if(a["!ref"]=bl(u),o[i||n]=a,c.push(i||n),!d.length)return{SheetNames:c,Sheets:o};for(var h={},x=[],p=0;p<d.length;++p)o[c[p]]?(x.push(d[p]||c[p]),h[d[p]]=o[d[p]]||o[c[p]]):(x.push(d[p]),h[d[p]]={"!ref":"A1"});return{SheetNames:x,Sheets:h}}function s(e,t,s){var r=[{c:0,r:0},{t:"n",v:0},0,0];return s.qpro&&20768!=s.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,n=s(e,0,r);if(n[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return n[1].v=e.read_shift(i,"utf8"),n}return r.qpro&&e.l++,n[1].v=e.read_shift(a-e.l,"cstr"),n}function a(e,t,s){var r=al(7+s.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var n=s.charCodeAt(a);r.write_shift(1,n>=128?95:n)}return r.write_shift(1,0),r}function n(e,t,s){var r=al(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,s,"i"),r}function i(e,t,s){var r=al(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,s,"f"),r}function l(e,t,s){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(s?xl(t):ml(t))}var o={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,s,r){var a=al(6+r.length);a.write_shift(2,e),a.write_shift(1,s),a.write_shift(1,t),a.write_shift(1,39);for(var n=0;n<r.length;++n){var i=r.charCodeAt(n);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function m(e,t){var s=d(e),r=e.read_shift(4),a=e.read_shift(4),n=e.read_shift(2);if(65535==n)return 0===r&&3221225472===a?(s[1].t="e",s[1].v=15):0===r&&3489660928===a?(s[1].t="e",s[1].v=42):s[1].v=0,s;var i=32768&n;return n=(32767&n)-16446,s[1].v=(1-2*i)*(a*Math.pow(2,n+32)+r*Math.pow(2,n)),s}function h(e,t,s,r){var a=al(14);if(a.write_shift(2,e),a.write_shift(1,s),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var n,i=0,l=0,o=0;return r<0&&(i=1,r=-r),l=0|Math.log2(r),2147483648&(o=(r/=Math.pow(2,l-31))>>>0)||(++l,o=(r/=2)>>>0),r-=o,o|=2147483648,o>>>=0,n=(r*=Math.pow(2,32))>>>0,a.write_shift(4,n),a.write_shift(4,o),l+=16383+(i?32768:0),a.write_shift(2,l),a}function x(e,t){var s=d(e),r=e.read_shift(8,"f");return s[1].v=r,s}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function f(e,t){var s=al(5+e.length);s.write_shift(2,14e3),s.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);s[s.l++]=a>127?95:a}return s[s.l++]=0,s}var g={0:{n:"BOF",f:To},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,s){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&s.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&s.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&s.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=s(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=s(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,n=s(e,0,r);if(n[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){sl(e,0);var s=[],r=0,a="",n="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:s.push(e.read_shift(8,"f"));break;case 1:n=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),s.push(n+a);break;case 2:var m=l(t[0].c,e.read_shift(2),!0),h=l(t[0].r,e.read_shift(2),!1);n=l(t[0].c,e.read_shift(2),!0),a=l(t[0].r,e.read_shift(2),!1),s.push(m+h+":"+n+a);break;case 3:if(e.l<e.length)return;break;case 4:s.push("("+s.pop()+")");break;case 5:s.push(e.read_shift(2));break;case 6:for(var x="";u=e[e.l++];)x+=String.fromCharCode(u);s.push('"'+x.replace(/"/g,'""')+'"');break;case 8:s.push("-"+s.pop());break;case 23:s.push("+"+s.pop());break;case 22:s.push("NOT("+s.pop()+")");break;case 20:case 21:d=s.pop(),i=s.pop(),s.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=s.pop(),i=s.pop(),s.push(i+c[u]+d);else{if(!o[u])return;if(69==(r=o[u][1])&&(r=e[e.l++]),r>s.length)return;var p=s.slice(-r);s.length-=r,s.push(o[u][0]+"("+p.join(",")+")")}}}1==s.length&&(t[1].f=""+s[0])}(e.slice(e.l,e.l+i),n),e.l+=i}return n}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var s=e[e.l++];s>t-1&&(s=t-1);for(var r="";r.length<s;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var s=d(e);return s[1].t="s",s[1].v=e.read_shift(t-4,"cstr"),s}},23:{n:"NUMBER17",f:m},24:{n:"NUMBER18",f:function(e,t){var s=d(e);s[1].v=e.read_shift(2);var r=s[1].v>>1;if(1&s[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return s[1].v=r,s}},25:{n:"FORMULA19",f:function(e,t){var s=m(e);return e.l+=t-14,s}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var s={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(s[a]=[0,""],s[a][0]=e.read_shift(2);e[e.l];)s[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return s}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var s=d(e),r=e.read_shift(4);return s[1].v=r>>6,s}},38:{n:"??"},39:{n:"NUMBER27",f:x},40:{n:"FORMULA28",f:function(e,t){var s=x(e);return e.l+=t-10,s}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,s){if(s.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var s=t||{};if(+s.codepage>=0&&Qr(+s.codepage),"string"==s.type)throw new Error("Cannot write WK1 to JS string");var r,l,o=nl(),c=vl(e["!ref"]),d=Array.isArray(e),u=[];hu(o,0,(r=1030,(l=al(2)).write_shift(2,r),l)),hu(o,6,function(e){var t=al(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(c));for(var m=Math.min(c.e.r,8191),h=c.s.r;h<=m;++h)for(var x=ml(h),p=c.s.c;p<=c.e.c;++p){h===c.s.r&&(u[p]=xl(p));var f=u[p]+x,g=d?(e[h]||[])[p]:e[f];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?hu(o,13,n(h,p,g.v)):hu(o,14,i(h,p,g.v));else hu(o,15,a(h,p,wl(g).slice(0,239)))}return hu(o,1),o.end()},book_to_wk3:function(e,t){var s=t||{};if(+s.codepage>=0&&Qr(+s.codepage),"string"==s.type)throw new Error("Cannot write WK3 to JS string");var r=nl();hu(r,0,function(e){var t=al(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var s=0,r=0,a=0,n=0;n<e.SheetNames.length;++n){var i=e.SheetNames[n],l=e.Sheets[i];if(l&&l["!ref"]){++a;var o=gl(l["!ref"]);s<o.e.r&&(s=o.e.r),r<o.e.c&&(r=o.e.c)}}s>8191&&(s=8191);return t.write_shift(2,s),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,n=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&hu(r,27,f(e.SheetNames[a],n++));var i=0;for(a=0;a<e.SheetNames.length;++a){var l=e.Sheets[e.SheetNames[a]];if(l&&l["!ref"]){for(var o=vl(l["!ref"]),c=Array.isArray(l),d=[],m=Math.min(o.e.r,8191),x=o.s.r;x<=m;++x)for(var p=ml(x),g=o.s.c;g<=o.e.c;++g){x===o.s.r&&(d[g]=xl(g));var b=d[g]+p,v=c?(l[x]||[])[g]:l[b];if(v&&"z"!=v.t)if("n"==v.t)hu(r,23,h(x,g,i,v.v));else hu(r,22,u(x,g,i,wl(v).slice(0,239)))}++i}}return hu(r,1),r.end()},to_workbook:function(e,s){switch(s.type){case"base64":return t(ua(ia(e)),s);case"binary":return t(ua(e),s);case"buffer":case"array":return t(e,s)}throw"Unsupported type "+s.type}}}(),Zo=/^\s|\s$|[\t\n\r]/;function Qo(e,t){if(!t.bookSST)return"";var s=[In];s[s.length]=ei("sst",null,{xmlns:pi[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],n="<si>";a.r?n+=a.r:(n+="<t",a.t||(a.t=""),a.t.match(Zo)&&(n+=' xml:space="preserve"'),n+=">"+$n(a.t)+"</t>"),n+="</si>",s[s.length]=n}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}var ec=function(e,t){var s=!1;return null==t&&(s=!0,t=al(15+4*e.t.length)),t.write_shift(1,0),Sl(e.t,t),s?t.slice(0,t.l):t};function tc(e){var t=nl();il(t,159,function(e,t){return t||(t=al(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var s=0;s<e.length;++s)il(t,19,ec(e[s]));return il(t,160),t.end()}function sc(e){var t,s,r=0,a=function(e){for(var t=[],s=e.split(""),r=0;r<s.length;++r)t[r]=s[r].charCodeAt(0);return t}(e),n=a.length+1;for((t=ca(n))[0]=a.length,s=1;s!=n;++s)t[s]=a[s-1];for(s=n-1;s>=0;--s)r=((16384&r?1:0)|r<<1&32767)^t[s];return 52811^r}var rc=function(){function e(e,s){switch(s.type){case"base64":return t(ia(e),s);case"binary":return t(e,s);case"buffer":return t(la&&Buffer.isBuffer(e)?e.toString("binary"):ha(e),s);case"array":return t(Tn(e),s)}throw new Error("Unrecognized type "+s.type)}function t(e,t){var s=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(s)&&(s[t]=[]);for(var r,n=/\\\w+\b/g,i=0,l=-1;r=n.exec(e);){if("\\cell"===r[0]){var o=e.slice(i,n.lastIndex-r[0].length);if(" "==o[0]&&(o=o.slice(1)),++l,o.length){var c={v:o,t:"s"};Array.isArray(s)?s[t][l]=c:s[fl({r:t,c:l})]=c}}i=n.lastIndex}l>a.e.c&&(a.e.c=l)}),s["!ref"]=bl(a),s}return{to_workbook:function(t,s){return jl(e(t,s),s)},to_sheet:e,from_sheet:function(e){for(var t,s=["{\\rtf1\\ansi"],r=vl(e["!ref"]),a=Array.isArray(e),n=r.s.r;n<=r.e.r;++n){s.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)s.push("\\cellx"+(i+1));for(s.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var l=fl({r:n,c:i});(t=a?(e[n]||[])[i]:e[l])&&(null!=t.v||t.f&&!t.F)&&(s.push(" "+(t.w||(wl(t),t.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}}}();function ac(e){for(var t=0,s=1;3!=t;++t)s=256*s+(e[t]>255?255:e[t]<0?0:e[t]);return s.toString(16).toUpperCase().slice(1)}var nc=6;function ic(e){return Math.floor((e+Math.round(128/nc)/256)*nc)}function lc(e){return Math.floor((e-5)/nc*100+.5)/100}function oc(e){return Math.round((e*nc+5)/nc*256)/256}function cc(e){e.width?(e.wpx=ic(e.width),e.wch=lc(e.wpx),e.MDW=nc):e.wpx?(e.wch=lc(e.wpx),e.width=oc(e.wch),e.MDW=nc):"number"==typeof e.wch&&(e.width=oc(e.wch),e.wpx=ic(e.width),e.MDW=nc),e.customWidth&&delete e.customWidth}var dc=96;function uc(e){return 96*e/dc}function mc(e){return e*dc/96}function hc(e,t){var s,r=[In,ei("styleSheet",null,{xmlns:pi[0],"xmlns:vt":mi})];return e.SSF&&null!=(s=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var r=s[0];r<=s[1];++r)null!=e[r]&&(t[t.length]=ei("numFmt",null,{numFmtId:r,formatCode:$n(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=ei("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=function(e){var t=[];return t[t.length]=ei("cellXfs",null),e.forEach(function(e){t[t.length]=ei("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=ei("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function xc(e,t,s){s||(s=al(6+4*t.length)),s.write_shift(2,e),Sl(t,s);var r=s.length>s.l?s.slice(0,s.l):s;return null==s.l&&(s.l=s.length),r}function pc(e,t){t||(t=al(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=al(2));var s=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,s),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var s=0;"superscript"==e.vertAlign?s=1:"subscript"==e.vertAlign&&(s=2),t.write_shift(2,s),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Xl(e.color,t);return t.write_shift(1,2),Sl(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fc,gc=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bc=rl;function vc(e,t){t||(t=al(84)),fc||(fc=fn(gc));var s=fc[e.patternType];null==s&&(s=40),t.write_shift(4,s);var r=0;if(40!=s)for(Xl({auto:1},t),Xl({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function yc(e,t,s){s||(s=al(16)),s.write_shift(2,t||0),s.write_shift(2,e.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);return s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function wc(e,t){return t||(t=al(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var jc=rl;function Nc(e){var t;il(e,613,kl(1)),il(e,46,(t||(t=al(51)),t.write_shift(1,0),wc(0,t),wc(0,t),wc(0,t),wc(0,t),wc(0,t),t.length>t.l?t.slice(0,t.l):t)),il(e,614)}function _c(e){var t,s;il(e,619,kl(1)),il(e,48,(t={xfId:0,name:"Normal"},s||(s=al(52)),s.write_shift(4,t.xfId),s.write_shift(2,1),s.write_shift(1,0),s.write_shift(1,0),Bl(t.name||"",s),s.length>s.l?s.slice(0,s.l):s)),il(e,620)}function kc(e){il(e,508,function(e,t,s){var r=al(2052);return r.write_shift(4,e),Bl(t,r),Bl(s,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),il(e,509)}function Cc(e,t){var s=nl();return il(s,278),function(e,t){if(t){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++s}),0!=s&&(il(e,615,kl(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var r=s[0];r<=s[1];++r)null!=t[r]&&il(e,44,xc(r,t[r]))}),il(e,616))}}(s,e.SSF),function(e){il(e,611,kl(1)),il(e,43,pc({sz:12,color:{theme:1},name:"Calibri",family:2})),il(e,612)}(s),function(e){il(e,603,kl(2)),il(e,45,vc({patternType:"none"})),il(e,45,vc({patternType:"gray125"})),il(e,604)}(s),Nc(s),function(e){il(e,626,kl(1)),il(e,47,yc({numFmtId:0},65535)),il(e,627)}(s),function(e,t){il(e,617,kl(t.length)),t.forEach(function(t){il(e,47,yc(t,0))}),il(e,618)}(s,t.cellXfs),_c(s),function(e){il(e,505,kl(0)),il(e,506)}(s),kc(s),il(s,279),s.end()}function Sc(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var s=[In];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',s[s.length]='<a:font script="Hang" typeface="맑은 고딕"/>',s[s.length]='<a:font script="Hans" typeface="宋体"/>',s[s.length]='<a:font script="Hant" typeface="新細明體"/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',s[s.length]='<a:font script="Hang" typeface="맑은 고딕"/>',s[s.length]='<a:font script="Hans" typeface="宋体"/>',s[s.length]='<a:font script="Hant" typeface="新細明體"/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function Tc(){var e,t,s=nl();return il(s,332),il(s,334,kl(1)),il(s,335,((t=al(12+2*(e={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,e.flags),t.write_shift(4,e.version),Sl(e.name,t),t.slice(0,t.l))),il(s,336),il(s,339,function(e,t){var s=al(8+2*t.length);return s.write_shift(4,e),Sl(t,s),s.slice(0,s.l)}(1,"XLDAPR")),il(s,52),il(s,35,kl(514)),il(s,4096,kl(0)),il(s,4097,Ao(1)),il(s,36),il(s,53),il(s,340),il(s,337,function(e){var t=al(8);return t.write_shift(4,e),t.write_shift(4,1),t}(1)),il(s,51,function(e){var t=al(4+8*e.length);t.write_shift(4,e.length);for(var s=0;s<e.length;++s)t.write_shift(4,e[s][0]),t.write_shift(4,e[s][1]);return t}([[1,0]])),il(s,338),il(s,333),s.end()}function Ac(){var e=[In];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Ec=1024;function Rc(e,t){for(var s=[21600,21600],r=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),a=[ei("xml",null,{"xmlns:v":wi,"xmlns:o":fi,"xmlns:x":gi,"xmlns:mv":yi}).replace(/\/>/,">"),ei("o:shapelayout",ei("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ei("v:shapetype",[ei("v:stroke",null,{joinstyle:"miter"}),ei("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:r})];Ec<1e3*e;)Ec+=1e3;return t.forEach(function(e){var t=pl(e[0]),s={color2:"#BEFF82",type:"gradient"};"gradient"==s.type&&(s.angle="-180");var r="gradient"==s.type?ei("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n=ei("v:fill",r,s);++Ec,a=a.concat(["<v:shape"+Qn({id:"_x0000_s"+Ec,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,ei("v:shadow",null,{on:"t",obscured:"t"}),ei("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Zn("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Zn("x:AutoFill","False"),Zn("x:Row",String(t.r)),Zn("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Pc(e){var t=[In,ei("comments",null,{xmlns:pi[0]})],s=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=$n(e.a);-1==s.indexOf(r)&&(s.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==s.indexOf("tc="+e.ID)&&(s.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==s.length&&(s.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=s.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=s.indexOf($n(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(Zn("t",$n(a[0]||"")));else{for(var n="Comment:\n    "+a[0]+"\n",i=1;i<a.length;++i)n+="Reply:\n    "+a[i]+"\n";t.push(Zn("t",$n(n)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Mc(e,t,s){var r=[In,ei("ThreadedComments",null,{xmlns:li}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(n,i){if(n.T){n.a&&-1==t.indexOf(n.a)&&t.push(n.a);var l={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};0==i?a=l.id:l.parentId=a,n.ID=l.id,n.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(n.a)).slice(-12)+"}"),r.push(ei("threadedComment",Zn("text",n.t||""),l))}else delete n.ID})}),r.push("</ThreadedComments>"),r.join("")}var Lc=Cl;function Oc(e){var t=nl(),s=[];return il(t,628),il(t,630),e.forEach(function(e){e[1].forEach(function(e){s.indexOf(e.a)>-1||(s.push(e.a.slice(0,54)),il(t,632,function(e){return Sl(e.slice(0,54))}(e.a)))})}),il(t,631),il(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=s.indexOf(r.a);var a={s:pl(e[0]),e:pl(e[0])};il(t,635,function(e,t){return null==t&&(t=al(36)),t.write_shift(4,e[1].iauthor),ql(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&il(t,637,Rl(r)),il(t,636),delete r.iauthor})}),il(t,634),il(t,629),t.end()}var Ic=["xlsb","xlsm","xlam","biff8","xla"],Dc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function s(e,s,r,a){var n=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==a.length?n=!0:"["==a.charAt(0)&&(n=!0,a=a.slice(1,-1));var l=r.length>0?0|parseInt(r,10):0,o=a.length>0?0|parseInt(a,10):0;return n?o+=t.c:--o,i?l+=t.r:--l,s+(n?"":"$")+xl(o)+(i?"":"$")+ml(l)}return function(r,a){return t=a,r.replace(e,s)}}(),Fc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Bc=function(){return function(e,t){return e.replace(Fc,function(e,s,r,a,n,i){var l=hl(a)-(r?0:t.c),o=ul(i)-(n?0:t.r);return s+"R"+(0==o?"":n?o+1:"["+o+"]")+"C"+(0==l?"":r?l+1:"["+l+"]")})}}();function $c(e,t){return e.replace(Fc,function(e,s,r,a,n,i){return s+("$"==r?r+a:xl(hl(a)+t.c))+("$"==n?n+i:ml(ul(i)+t.r))})}function zc(e){e.l+=1}function Vc(e,t){var s=e.read_shift(2);return[16383&s,s>>14&1,s>>15&1]}function Uc(e,t,s){var r=2;if(s){if(s.biff>=2&&s.biff<=5)return Wc(e);12==s.biff&&(r=4)}var a=e.read_shift(r),n=e.read_shift(r),i=Vc(e),l=Vc(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function Wc(e){var t=Vc(e),s=Vc(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:s[0],c:a,cRel:s[1],rRel:s[2]}}}function Hc(e,t,s){if(s&&s.biff>=2&&s.biff<=5)return function(e){var t=Vc(e),s=e.read_shift(1);return{r:t[0],c:s,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(s&&12==s.biff?4:2),a=Vc(e);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function Gc(e){var t=e.read_shift(2),s=e.read_shift(2);return{r:t,c:255&s,fQuoted:!!(16384&s),cRel:s>>15,rRel:s>>15}}function qc(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Yc(e){return[e.read_shift(1),e.read_shift(1)]}function Kc(e,t){var s=[e.read_shift(1)];if(12==t)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2}switch(s[0]){case 4:s[1]=function(e,t){return 1===e.read_shift(t)}(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:s[1]=so[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:s[1]=Yl(e);break;case 2:s[1]=function(e,t,s){if(s.biff>5)return function(e,t,s){var r=e.read_shift(s&&2==s.biff?1:2);return 0===r?(e.l++,""):function(e,t,s){if(s){if(s.biff>=2&&s.biff<=5)return e.read_shift(t,"cpstr");if(s.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}(e,r,s)}(e,0,s);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,s.biff<=4||!e.lens?"cpstr":"sbcs-cont")}(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function Xc(e,t,s){for(var r=e.read_shift(12==s.biff?4:2),a=[],n=0;n!=r;++n)a.push((12==s.biff?Gl:Fo)(e));return a}function Jc(e,t,s){var r=0,a=0;12==s.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),s.biff>=2&&s.biff<8&&(--r,0==--a&&(a=256));for(var n=0,i=[];n!=r&&(i[n]=[]);++n)for(var l=0;l!=a;++l)i[n][l]=Kc(e,s.biff);return i}function Zc(e,t,s){return e.l+=2,[Gc(e)]}function Qc(e){return e.l+=6,[]}function ed(e){return e.l+=2,[To(e),1&e.read_shift(2)]}var td=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var sd={1:{n:"PtgExp",f:function(e,t,s){return e.l++,s&&12==s.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(s&&2==s.biff?1:2)]}},2:{n:"PtgTbl",f:rl},3:{n:"PtgAdd",f:zc},4:{n:"PtgSub",f:zc},5:{n:"PtgMul",f:zc},6:{n:"PtgDiv",f:zc},7:{n:"PtgPower",f:zc},8:{n:"PtgConcat",f:zc},9:{n:"PtgLt",f:zc},10:{n:"PtgLe",f:zc},11:{n:"PtgEq",f:zc},12:{n:"PtgGe",f:zc},13:{n:"PtgGt",f:zc},14:{n:"PtgNe",f:zc},15:{n:"PtgIsect",f:zc},16:{n:"PtgUnion",f:zc},17:{n:"PtgRange",f:zc},18:{n:"PtgUplus",f:zc},19:{n:"PtgUminus",f:zc},20:{n:"PtgPercent",f:zc},21:{n:"PtgParen",f:zc},22:{n:"PtgMissArg",f:zc},23:{n:"PtgStr",f:function(e,t,s){return e.l++,Ro(e,0,s)}},26:{n:"PtgSheet",f:function(e,t,s){return e.l+=5,e.l+=2,e.l+=2==s.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,s){return e.l+=2==s.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,so[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Yl(e)}},32:{n:"PtgArray",f:function(e,t,s){var r=(96&e[e.l++])>>5;return e.l+=2==s.biff?6:12==s.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,s){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(s&&s.biff<=3?1:2);return[vd[a],bd[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,s){var r=e[e.l++],a=e.read_shift(1),n=s&&s.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===n[0]?bd:gd)[n[1]]]}},35:{n:"PtgName",f:function(e,t,s){var r=e.read_shift(1)>>>5&3,a=!s||s.biff>=8?4:2,n=e.read_shift(a);switch(s.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,n]}},36:{n:"PtgRef",f:function(e,t,s){var r=(96&e[e.l])>>5;return e.l+=1,[r,Hc(e,0,s)]}},37:{n:"PtgArea",f:function(e,t,s){return[(96&e[e.l++])>>5,Uc(e,s.biff>=2&&s.biff,s)]}},38:{n:"PtgMemArea",f:function(e,t,s){var r=e.read_shift(1)>>>5&3;return e.l+=s&&2==s.biff?3:4,[r,e.read_shift(s&&2==s.biff?1:2)]}},39:{n:"PtgMemErr",f:rl},40:{n:"PtgMemNoMem",f:rl},41:{n:"PtgMemFunc",f:function(e,t,s){return[e.read_shift(1)>>>5&3,e.read_shift(s&&2==s.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,s){var r=e.read_shift(1)>>>5&3;return e.l+=4,s.biff<8&&e.l--,12==s.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,s){var r=(96&e[e.l++])>>5;return e.l+=s&&s.biff>8?12:s.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,s){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,s){var r=s&&s.biff?s.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),s=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&s>=128&&(s-=256),{r:t,c:s,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),n=e.read_shift(2),i=(16384&n)>>14,l=(32768&n)>>15;if(n&=16383,1==l)for(;a>524287;)a-=1048576;if(1==i)for(;n>8191;)n-=16384;return{r:a,c:n,cRel:i,rRel:l}}(e,0,s);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,s){var r=(96&e[e.l++])>>5,a=function(e,t,s){if(s.biff<8)return Wc(e);var r=e.read_shift(12==s.biff?4:2),a=e.read_shift(12==s.biff?4:2),n=Vc(e),i=Vc(e);return{s:{r:r,c:n[0],cRel:n[1],rRel:n[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,s);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,s){return 5==s.biff?function(e){var t=e.read_shift(1)>>>5&3,s=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,s,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,s){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return s&&5==s.biff&&(e.l+=12),[r,a,Hc(e,0,s)]}},59:{n:"PtgArea3d",f:function(e,t,s){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(s)switch(s.biff){case 5:e.l+=12;break;case 12:0}return[r,a,Uc(e,0,s)]}},60:{n:"PtgRefErr3d",f:function(e,t,s){var r=(96&e[e.l++])>>5,a=e.read_shift(2),n=4;if(s)switch(s.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,s){var r=(96&e[e.l++])>>5,a=e.read_shift(2),n=8;if(s)switch(s.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[r,a]}},255:{}},rd={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ad={1:{n:"PtgElfLel",f:ed},2:{n:"PtgElfRw",f:Zc},3:{n:"PtgElfCol",f:Zc},6:{n:"PtgElfRwV",f:Zc},7:{n:"PtgElfColV",f:Zc},10:{n:"PtgElfRadical",f:Zc},11:{n:"PtgElfRadicalS",f:Qc},13:{n:"PtgElfColS",f:Qc},15:{n:"PtgElfColSV",f:Qc},16:{n:"PtgElfRadicalLel",f:ed},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),s=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),n=e.read_shift(2);return{ixti:t,coltype:3&s,rt:td[s>>2&31],idx:r,c:a,C:n}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},nd={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,s){var r=255&e[e.l+1]?1:0;return e.l+=s&&2==s.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,s){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(s&&2==s.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,s){e.l+=2;for(var r=e.read_shift(s&&2==s.biff?1:2),a=[],n=0;n<=r;++n)a.push(e.read_shift(s&&2==s.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,s){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(s&&2==s.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,s){e.l+=s&&2==s.biff?3:4}},32:{n:"PtgAttrBaxcel",f:qc},33:{n:"PtgAttrBaxcel",f:qc},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Yc(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Yc(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function id(e){for(var t=[],s=0;s<e.length;++s){for(var r=e[s],a=[],n=0;n<r.length;++n){var i=r[n];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var ld={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function od(e,t,s){if(!e)return"SH33TJSERR0";if(s.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(s.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(s.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=s.SID?e.SheetNames[s.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function cd(e,t,s){var r=od(e,t,s);return"#REF"==r?r:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,s)}function dd(e,t,s,r,a){var n,i,l,o,c=a&&a.biff||8,d={s:{c:0,r:0}},u=[],m=0,h=0,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,f="",g=0,b=e[0].length;g<b;++g){var v=e[0][g];switch(v[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(n=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:f=En(" ",e[0][p][1][1]);break;case 1:f=En("\r",e[0][p][1][1]);break;default:if(f="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=f,p=-1}u.push(i+ld[v[0]]+n);break;case"PtgIsect":n=u.pop(),i=u.pop(),u.push(i+" "+n);break;case"PtgUnion":n=u.pop(),i=u.pop(),u.push(i+","+n);break;case"PtgRange":n=u.pop(),i=u.pop(),u.push(i+":"+n);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":l=ll(v[1][1],d,a),u.push(cl(l,c));break;case"PtgRefN":l=s?ll(v[1][1],s,a):v[1][1],u.push(cl(l,c));break;case"PtgRef3d":m=v[1][1],l=ll(v[1][2],d,a),x=cd(r,m,a),u.push(x+"!"+cl(l,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var j=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=j.shift()),u.push(w+"("+j.join(",")+")");break;case"PtgBool":u.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(v[1]);break;case"PtgNum":u.push(String(v[1]));break;case"PtgStr":u.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":o=ol(v[1][1],s?{s:s}:d,a),u.push(dl(o,a));break;case"PtgArea":o=ol(v[1][1],d,a),u.push(dl(o,a));break;case"PtgArea3d":m=v[1][1],o=v[1][2],x=cd(r,m,a),u.push(x+"!"+dl(o,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":h=v[1][2];var N=(r.names||[])[h-1]||(r[0]||[])[h],_=N?N.Name:"SH33TJSNAME"+String(h);_&&"_xlfn."==_.slice(0,6)&&!a.xlfn&&(_=_.slice(6)),u.push(_);break;case"PtgNameX":var k,C=v[1][1];if(h=v[1][2],!(a.biff<=5)){var S="";if(14849==((r[C]||[])[0]||[])[0]||(1025==((r[C]||[])[0]||[])[0]?r[C][h]&&r[C][h].itab>0&&(S=r.SheetNames[r[C][h].itab-1]+"!"):S=r.SheetNames[h-1]+"!"),r[C]&&r[C][h])S+=r[C][h].Name;else if(r[0]&&r[0][h])S+=r[0][h].Name;else{var T=(od(r,C,a)||"").split(";;");T[h-1]?S=T[h-1]:S+="SH33TJSERRX"}u.push(S);break}C<0&&(C=-C),r[C]&&(k=r[C][h]),k||(k={Name:"SH33TJSERRY"}),u.push(k.Name);break;case"PtgParen":var A="(",E=")";if(p>=0){switch(f="",e[0][p][1][0]){case 2:A=En(" ",e[0][p][1][1])+A;break;case 3:A=En("\r",e[0][p][1][1])+A;break;case 4:E=En(" ",e[0][p][1][1])+E;break;case 5:E=En("\r",e[0][p][1][1])+E;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(A+u.pop()+E);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":l={c:v[1][1],r:v[1][0]};var R={c:s.c,r:s.r};if(r.sharedf[fl(l)]){var P=r.sharedf[fl(l)];u.push(dd(P,d,R,r,a))}else{var M=!1;for(n=0;n!=r.arrayf.length;++n)if(i=r.arrayf[n],!(l.c<i[0].s.c||l.c>i[0].e.c||l.r<i[0].s.r||l.r>i[0].e.r)){u.push(dd(i[1],d,R,r,a)),M=!0;break}M||u.push(v[1])}break;case"PtgArray":u.push("{"+id(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=a.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var L=!0;switch((v=e[0][p])[1][0]){case 4:L=!1;case 0:f=En(" ",v[1][1]);break;case 5:L=!1;case 1:f=En("\r",v[1][1]);break;default:if(f="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}u.push((L?f:"")+u.pop()+(L?"":f)),p=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function ud(e,t,s,r,a){var n=Io(t,s,a),i=function(e){if(null==e){var t=al(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Kl("number"==typeof e?e:0)}(e.v),l=al(6);l.write_shift(2,33),l.write_shift(4,0);for(var o=al(e.bf.length),c=0;c<e.bf.length;++c)o[c]=e.bf[c];return xa([n,i,l,o])}function md(e,t,s){var r=e.read_shift(4),a=function(e,t,s){for(var r,a,n=e.l+t,i=[];n!=e.l;)t=n-e.l,a=e[e.l],r=sd[a]||sd[rd[a]],24!==a&&25!==a||(r=(24===a?ad:nd)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,t,s)]):rl(e,t);return i}(e,r,s),n=e.read_shift(4),i=n>0?function(e,t,s,r){if(r.biff<8)return rl(e,t);for(var a=e.l+t,n=[],i=0;i!==s.length;++i)switch(s[i][0]){case"PtgArray":s[i][1]=Jc(e,0,r),n.push(s[i][1]);break;case"PtgMemArea":s[i][2]=Xc(e,s[i][1],r),n.push(s[i][2]);break;case"PtgExp":r&&12==r.biff&&(s[i][1][1]=e.read_shift(4),n.push(s[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[i][0]}return 0!==(t=a-e.l)&&n.push(rl(e,t)),n}(e,n,a,s):null;return[a,i]}var hd=md,xd=md,pd=md,fd=md,gd={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},bd={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vd={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yd(e){return("of:="+e.replace(Fc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function wd(e){return e.replace(/\./,"!")}var jd="undefined"!=typeof Map;function Nd(e,t,s){var r=0,a=e.length;if(s){if(jd?s.has(t):Object.prototype.hasOwnProperty.call(s,t))for(var n=jd?s.get(t):s[t];r<n.length;++r)if(e[n[r]].t===t)return e.Count++,n[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,s&&(jd?(s.has(t)||s.set(t,[]),s.get(t).push(a)):(Object.prototype.hasOwnProperty.call(s,t)||(s[t]=[]),s[t].push(a))),a}function _d(e,t){var s={min:e+1,max:e+1},r=-1;return t.MDW&&(nc=t.MDW),null!=t.width?s.customWidth=1:null!=t.wpx?r=lc(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(s.width=oc(r),s.customWidth=1):null!=t.width&&(s.width=t.width),t.hidden&&(s.hidden=!0),null!=t.level&&(s.outlineLevel=s.level=t.level),s}function kd(e,t){if(e){var s=[.7,.7,.75,.75,.3,.3];null==e.left&&(e.left=s[0]),null==e.right&&(e.right=s[1]),null==e.top&&(e.top=s[2]),null==e.bottom&&(e.bottom=s[3]),null==e.header&&(e.header=s[4]),null==e.footer&&(e.footer=s[5])}}function Cd(e,t,s){var r=s.revssf[null!=t.z?t.z:"General"],a=60,n=e.length;if(null==r&&s.ssf)for(;a<392;++a)if(null==s.ssf[a]){nn(t.z,a),s.ssf[a]=t.z,s.revssf[t.z]=r=a;break}for(a=0;a!=n;++a)if(e[a].numFmtId===r)return a;return e[n]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function Sd(e,t,s){if(e&&e["!ref"]){var r=vl(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+s+"): "+e["!ref"])}}var Td=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Ad=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ed(e,t,s,r){if(e.c&&s["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var a="",n=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=so[e.v];break;case"d":r&&r.cellDates?a=Sn(e.v,-1).toISOString():((e=An(e)).t="n",a=""+(e.v=vn(Sn(e.v)))),void 0===e.z&&(e.z=Ca[14]);break;default:a=e.v}var l=Zn("v",$n(a)),o={r:t},c=Cd(r.cellXfs,e,r);switch(0!==c&&(o.s=c),e.t){case"n":case"z":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){l=Zn("v",""+Nd(r.Strings,e.v,r.revStrings)),o.t="s";break}o.t="str"}if(e.t!=n&&(e.t=n,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ei("f",$n(e.f),d)+(null!=e.v?l:"")}return e.l&&s["!links"].push([t,e.l]),e.D&&(o.cm=1),ei("c",l,o)}function Rd(e,t,s,r){var a,n=[In,ei("worksheet",null,{xmlns:pi[0],"xmlns:r":ui})],i=s.SheetNames[e],l="",o=s.Sheets[i];null==o&&(o={});var c=o["!ref"]||"A1",d=vl(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=bl(d)}r||(r={}),o["!comments"]=[];var u=[];!function(e,t,s,r,a){var n=!1,i={},l=null;if("xlsx"!==r.bookType&&t.vbaraw){var o=t.SheetNames[s];try{t.Workbook&&(o=t.Workbook.Sheets[s].CodeName||o)}catch(d){}n=!0,i.codeName=Kn($n(o))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+ei("outlinePr",null,c)}(n||l)&&(a[a.length]=ei("sheetPr",l,i))}(o,s,e,t,n),n[n.length]=ei("dimension",null,{ref:c}),n[n.length]=function(e,t,s,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ei("sheetViews",ei("sheetView",null,a),{})}(0,0,0,s),t.sheetFormat&&(n[n.length]=ei("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&o["!cols"].length>0&&(n[n.length]=function(e,t){for(var s,r=["<cols>"],a=0;a!=t.length;++a)(s=t[a])&&(r[r.length]=ei("col",null,_d(a,s)));return r[r.length]="</cols>",r.join("")}(0,o["!cols"])),n[a=n.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&(l=function(e,t){var s,r,a=[],n=[],i=vl(e["!ref"]),l="",o="",c=[],d=0,u=0,m=e["!rows"],h=Array.isArray(e),x={r:o},p=-1;for(u=i.s.c;u<=i.e.c;++u)c[u]=xl(u);for(d=i.s.r;d<=i.e.r;++d){for(n=[],o=ml(d),u=i.s.c;u<=i.e.c;++u){s=c[u]+o;var f=h?(e[d]||[])[u]:e[s];void 0!==f&&null!=(l=Ed(f,s,e,t))&&n.push(l)}(n.length>0||m&&m[d])&&(x={r:o},m&&m[d]&&((r=m[d]).hidden&&(x.hidden=1),p=-1,r.hpx?p=uc(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(x.ht=p,x.customHeight=1),r.level&&(x.outlineLevel=r.level)),a[a.length]=ei("row",n.join(""),x))}if(m)for(;d<m.length;++d)m&&m[d]&&(x={r:d+1},(r=m[d]).hidden&&(x.hidden=1),p=-1,r.hpx?p=uc(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(x.ht=p,x.customHeight=1),r.level&&(x.outlineLevel=r.level),a[a.length]=ei("row","",x));return a.join("")}(o,t),l.length>0&&(n[n.length]=l)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),o["!protect"]&&(n[n.length]=function(e){var t={sheet:1};return Td.forEach(function(s){null!=e[s]&&e[s]&&(t[s]="1")}),Ad.forEach(function(s){null==e[s]||e[s]||(t[s]="0")}),e.password&&(t.password=sc(e.password).toString(16).toUpperCase()),ei("sheetProtection",null,t)}(o["!protect"])),null!=o["!autofilter"]&&(n[n.length]=function(e,t,s,r){var a="string"==typeof e.ref?e.ref:bl(e.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var n=s.Workbook.Names,i=gl(a);i.s.r==i.e.r&&(i.e.r=gl(t["!ref"]).e.r,a=bl(i));for(var l=0;l<n.length;++l){var o=n[l];if("_xlnm._FilterDatabase"==o.Name&&o.Sheet==r){o.Ref="'"+s.SheetNames[r]+"'!"+a;break}}return l==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+s.SheetNames[r]+"'!"+a}),ei("autoFilter",null,{ref:a})}(o["!autofilter"],o,s,e)),null!=o["!merges"]&&o["!merges"].length>0&&(n[n.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',s=0;s!=e.length;++s)t+='<mergeCell ref="'+bl(e[s])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var m,h,x=-1,p=-1;return o["!links"].length>0&&(n[n.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(m={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=co(r,-1,$n(e[1].Target).replace(/#.*$/,""),io.HLINK),m["r:id"]="rId"+p),(x=e[1].Target.indexOf("#"))>-1&&(m.location=$n(e[1].Target.slice(x+1))),e[1].Tooltip&&(m.tooltip=$n(e[1].Tooltip)),n[n.length]=ei("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(n[n.length]=(kd(h=o["!margins"]),ei("pageMargins",null,h))),t&&!t.ignoreEC&&null!=t.ignoreEC||(n[n.length]=Zn("ignoredErrors",ei("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=co(r,-1,"../drawings/drawing"+(e+1)+".xml",io.DRAW),n[n.length]=ei("drawing",null,{"r:id":"rId"+p}),o["!drawing"]=u),o["!comments"].length>0&&(p=co(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",io.VML),n[n.length]=ei("legacyDrawing",null,{"r:id":"rId"+p}),o["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Pd(e,t,s,r){var a=function(e,t,s){var r=al(145),a=(s["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var n=320;a.hpx?n=20*uc(a.hpx):a.hpt&&(n=20*a.hpt),r.write_shift(2,n),r.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),r.write_shift(1,i),r.write_shift(1,0);var l=0,o=r.l;r.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,m=-1,h=d<<10;h<d+1<<10;++h)c.c=h,(Array.isArray(s)?(s[c.r]||[])[c.c]:s[fl(c)])&&(u<0&&(u=h),m=h);u<0||(++l,r.write_shift(4,u),r.write_shift(4,m))}var x=r.l;return r.l=o,r.write_shift(4,l),r.l=x,r.length>r.l?r.slice(0,r.l):r}(r,s,t);(a.length>17||(t["!rows"]||[])[r])&&il(e,0,a)}var Md=Gl,Ld=ql;var Od=Gl,Id=ql;var Dd=["left","right","top","bottom","header","footer"];function Fd(e,t,s,r,a,n,i){if(void 0===t.v)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":(t=An(t)).z=t.z||Ca[14],t.v=vn(Sn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v}var o={r:s,c:r};switch(o.s=Cd(a.cellXfs,t,a),t.l&&n["!links"].push([fl(o),t.l]),t.c&&n["!comments"].push([fl(o),t.c]),t.t){case"s":case"str":return a.bookSST?(l=Nd(a.Strings,t.v,a.revStrings),o.t="s",o.v=l,i?il(e,18,function(e,t,s){return null==s&&(s=al(8)),Ol(t,s),s.write_shift(4,t.v),s}(0,o)):il(e,7,function(e,t,s){return null==s&&(s=al(12)),Ml(t,s),s.write_shift(4,t.v),s}(0,o))):(o.t="str",i?il(e,17,function(e,t,s){return null==s&&(s=al(8+4*e.v.length)),Ol(t,s),Sl(e.v,s),s.length>s.l?s.slice(0,s.l):s}(t,o)):il(e,6,function(e,t,s){return null==s&&(s=al(12+4*e.v.length)),Ml(t,s),Sl(e.v,s),s.length>s.l?s.slice(0,s.l):s}(t,o))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?il(e,13,function(e,t,s){return null==s&&(s=al(8)),Ol(t,s),Wl(e.v,s),s}(t,o)):il(e,2,function(e,t,s){return null==s&&(s=al(12)),Ml(t,s),Wl(e.v,s),s}(t,o)):i?il(e,16,function(e,t,s){return null==s&&(s=al(12)),Ol(t,s),Kl(e.v,s),s}(t,o)):il(e,5,function(e,t,s){return null==s&&(s=al(16)),Ml(t,s),Kl(e.v,s),s}(t,o)),!0;case"b":return o.t="b",i?il(e,15,function(e,t,s){return null==s&&(s=al(5)),Ol(t,s),s.write_shift(1,e.v?1:0),s}(t,o)):il(e,4,function(e,t,s){return null==s&&(s=al(9)),Ml(t,s),s.write_shift(1,e.v?1:0),s}(t,o)),!0;case"e":return o.t="e",i?il(e,14,function(e,t,s){return null==s&&(s=al(8)),Ol(t,s),s.write_shift(1,e.v),s.write_shift(2,0),s.write_shift(1,0),s}(t,o)):il(e,3,function(e,t,s){return null==s&&(s=al(9)),Ml(t,s),s.write_shift(1,e.v),s}(t,o)),!0}return i?il(e,12,function(e,t,s){return null==s&&(s=al(4)),Ol(t,s)}(0,o)):il(e,1,function(e,t,s){return null==s&&(s=al(8)),Ml(t,s)}(0,o)),!0}function Bd(e,t){var s,r;t&&t["!merges"]&&(il(e,177,(s=t["!merges"].length,null==r&&(r=al(4)),r.write_shift(4,s),r)),t["!merges"].forEach(function(t){il(e,176,Id(t))}),il(e,178))}function $d(e,t){t&&t["!cols"]&&(il(e,390),t["!cols"].forEach(function(t,s){t&&il(e,60,function(e,t,s){null==s&&(s=al(18));var r=_d(e,t);s.write_shift(-4,e),s.write_shift(-4,e),s.write_shift(4,256*(r.width||10)),s.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),s.write_shift(2,a),s}(s,t))}),il(e,391))}function zd(e,t){var s,r;t&&t["!ref"]&&(il(e,648),il(e,649,(s=vl(t["!ref"]),(r=al(24)).write_shift(4,4),r.write_shift(4,1),ql(s,r),r)),il(e,650))}function Vd(e,t,s){t["!links"].forEach(function(t){if(t[1].Target){var r=co(s,-1,t[1].Target.replace(/#.*$/,""),io.HLINK);il(e,494,function(e,t){var s=al(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ql({s:pl(e[0]),e:pl(e[0])},s),Vl("rId"+t,s);var r=e[1].Target.indexOf("#");return Sl((-1==r?"":e[1].Target.slice(r+1))||"",s),Sl(e[1].Tooltip||"",s),Sl("",s),s.slice(0,s.l)}(t,r))}}),delete t["!links"]}function Ud(e,t,s){il(e,133),il(e,137,function(e,t,s){null==s&&(s=al(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),s.write_shift(2,r),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}(0,s)),il(e,138),il(e,134)}function Wd(e,t){var s,r;t["!protect"]&&il(e,535,(s=t["!protect"],null==r&&(r=al(66)),r.write_shift(2,s.password?sc(s.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==s[e[0]]||s[e[0]]?0:1):r.write_shift(4,null!=s[e[0]]&&s[e[0]]?0:1)}),r))}function Hd(e,t,s,r){var a=nl(),n=s.SheetNames[e],i=s.Sheets[n]||{},l=n;try{s&&s.Workbook&&(l=s.Workbook.Sheets[e].CodeName||l)}catch(u){}var o,c,d=vl(i["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],il(a,129),(s.vbaraw||i["!outline"])&&il(a,147,function(e,t,s){null==s&&(s=al(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),s.write_shift(1,r);for(var a=1;a<3;++a)s.write_shift(1,0);return Xl({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),Dl(e,s),s.slice(0,s.l)}(l,i["!outline"])),il(a,148,Ld(d)),Ud(a,0,s.Workbook),$d(a,i),function(e,t,s,r){var a,n=vl(t["!ref"]||"A1"),i="",l=[];il(e,145);var o=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=c;++d){i=ml(d),Pd(e,t,n,d);var u=!1;if(d<=n.e.r)for(var m=n.s.c;m<=n.e.c;++m){d===n.s.r&&(l[m]=xl(m)),a=l[m]+i;var h=o?(t[d]||[])[m]:t[a];u=!!h&&Fd(e,h,d,m,r,t,u)}}il(e,146)}(a,i,0,t),Wd(a,i),function(e,t,s,r){if(t["!autofilter"]){var a=t["!autofilter"],n="string"==typeof a.ref?a.ref:bl(a.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var i=s.Workbook.Names,l=gl(n);l.s.r==l.e.r&&(l.e.r=gl(t["!ref"]).e.r,n=bl(l));for(var o=0;o<i.length;++o){var c=i[o];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+s.SheetNames[r]+"'!"+n;break}}o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+s.SheetNames[r]+"'!"+n}),il(e,161,ql(vl(n))),il(e,162)}}(a,i,s,e),Bd(a,i),Vd(a,i,r),i["!margins"]&&il(a,476,(o=i["!margins"],null==c&&(c=al(48)),kd(o),Dd.forEach(function(e){Kl(o[e],c)}),c)),t&&!t.ignoreEC&&null!=t.ignoreEC||zd(a,i),function(e,t,s,r){if(t["!comments"].length>0){var a=co(r,-1,"../drawings/vmlDrawing"+(s+1)+".vml",io.VML);il(e,551,Vl("rId"+a)),t["!legacy"]=a}}(a,i,e,r),il(a,130),a.end()}var Gd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var qd="][*?/\\".split("");function Yd(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");return qd.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),!0}function Kd(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,s,r,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,s=a,r=!!e.vbaraw,t.forEach(function(e,a){Yd(e);for(var n=0;n<a;++n)if(e==t[n])throw new Error("Duplicate Sheet Name: "+e);if(r){var i=s&&s[a]&&s[a].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}});for(var n=0;n<e.SheetNames.length;++n)Sd(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function Xd(e){var t=[In];t[t.length]=ei("workbook",null,{xmlns:pi[0],"xmlns:r":ui});var s=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gd.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ei("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],n=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&a[n]&&a[n].Hidden;++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var i={name:$n(e.SheetNames[n].slice(0,31))};if(i.sheetId=""+(n+1),i["r:id"]="rId"+(n+1),a[n])switch(a[n].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=ei("sheet",null,i)}return t[t.length]="</sheets>",s&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var s={name:e.Name};e.Comment&&(s.comment=e.Comment),null!=e.Sheet&&(s.localSheetId=""+e.Sheet),e.Hidden&&(s.hidden="1"),e.Ref&&(t[t.length]=ei("definedName",$n(e.Ref),s))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Jd(e,t){return t||(t=al(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vl(e.strRelID,t),Sl(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Zd(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var s,r,a=t.Workbook.Sheets,n=0,i=-1,l=-1;n<a.length;++n)!a[n]||!a[n].Hidden&&-1==i?i=n:1==a[n].Hidden&&-1==l&&(l=n);if(!(l>i))il(e,135),il(e,158,(s=i,r||(r=al(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,s),r.write_shift(4,s),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),il(e,136)}}function Qd(e,t){var s=nl();return il(s,131),il(s,128,function(e,t){t||(t=al(127));for(var s=0;4!=s;++s)t.write_shift(4,0);return Sl("SheetJS",t),Sl(Kr.version,t),Sl(Kr.version,t),Sl("7262",t),t.length>t.l?t.slice(0,t.l):t}()),il(s,153,function(e,t){t||(t=al(72));var s=0;return e&&e.filterPrivacy&&(s|=8),t.write_shift(4,s),t.write_shift(4,0),Dl(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Zd(s,e),function(e,t){il(e,143);for(var s=0;s!=t.SheetNames.length;++s)il(e,156,Jd({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[s]&&t.Workbook.Sheets[s].Hidden||0,iTabID:s+1,strRelID:"rId"+(s+1),name:t.SheetNames[s]}));il(e,144)}(s,e),il(s,132),s.end()}function eu(e,t,s,r,a){return(".bin"===t.slice(-4)?Hd:Rd)(e,s,r,a)}function tu(e,t,s){return(".bin"===t.slice(-4)?Oc:Pc)(e)}function su(e,t){var s=[];return e.Props&&s.push(function(e,t){var s=[];return xn(wo).map(function(e){for(var t=0;t<xo.length;++t)if(xo[t][1]==e)return xo[t];for(t=0;t<go.length;++t)if(go[t][1]==e)return go[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),s.push(Zn(wo[r[1]]||r[1],a))}}),ei("DocumentProperties",s.join(""),{xmlns:fi})}(e.Props,t)),e.Custprops&&s.push(function(e,t){var s=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&xn(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<xo.length;++r)if(t==xo[r][1])return;for(r=0;r<go.length;++r)if(t==go[r][1])return;for(r=0;r<s.length;++r)if(t==s[r])return;var n=e[t],i="string";"number"==typeof n?(i="float",n=String(n)):!0===n||!1===n?(i="boolean",n=n?"1":"0"):n=String(n),a.push(ei(zn(t),n,{"dt:dt":i}))}}),t&&xn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&(!e||!Object.prototype.hasOwnProperty.call(e,s))){var r=t[s],n="string";"number"==typeof r?(n="float",r=String(r)):!0===r||!1===r?(n="boolean",r=r?"1":"0"):r instanceof Date?(n="dateTime.tz",r=r.toISOString()):r=String(r),a.push(ei(zn(s),r,{"dt:dt":n}))}}),"<"+r+' xmlns="'+fi+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),s.join("")}function ru(e){return ei("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Bc(e.Ref,{r:0,c:0})})}function au(e,t,s,r,a,n,i){if(!e||null==e.v&&null==e.f)return"";var l={};if(e.f&&(l["ss:Formula"]="="+$n(Bc(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var o=pl(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(o.r==i.r?"":"["+(o.r-i.r)+"]")+"C"+(o.c==i.c?"":"["+(o.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=$n(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=$n(e.l.Tooltip))),s["!merges"])for(var c=s["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(l["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(l["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",m="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":u="Number",m=String(e.v);break;case"b":u="Boolean",m=e.v?"1":"0";break;case"e":u="Error",m=so[e.v];break;case"d":u="DateTime",m=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Ca[14]);break;case"s":u="String",m=((e.v||"")+"").replace(Fn,function(e){return Dn[e]}).replace(Vn,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var h=Cd(r.cellXfs,e,r);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=i.c+1;var x=null!=e.v?m:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=ei("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return ei("Comment",t,{"ss:Author":e.a})}).join("")),ei("Cell",p,l)}function nu(e,t){var s='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=mc(t.hpt)),t.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(s+=' ss:Hidden="1"')),s+">"}function iu(e,t,s){var r=[],a=s.SheetNames[e],n=s.Sheets[a],i=n?function(e,t,s,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,n=[],i=0;i<a.length;++i){var l=a[i];l.Sheet==s&&(l.Name.match(/^_xlfn\./)||n.push(ru(l)))}return n.join("")}(n,0,e,s):"";return i.length>0&&r.push("<Names>"+i+"</Names>"),i=n?function(e,t){if(!e["!ref"])return"";var s=vl(e["!ref"]),r=e["!merges"]||[],a=0,n=[];e["!cols"]&&e["!cols"].forEach(function(e,t){cc(e);var s=!!e.width,r=_d(t,e),a={"ss:Index":t+1};s&&(a["ss:Width"]=ic(r.width)),e.hidden&&(a["ss:Hidden"]="1"),n.push(ei("Column",null,a))});for(var i=Array.isArray(e),l=s.s.r;l<=s.e.r;++l){for(var o=[nu(l,(e["!rows"]||[])[l])],c=s.s.c;c<=s.e.c;++c){var d=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c||r[a].s.r>l||r[a].e.c<c||r[a].e.r<l)){r[a].s.c==c&&r[a].s.r==l||(d=!0);break}if(!d){var u={r:l,c:c},m=fl(u),h=i?(e[l]||[])[c]:e[m];o.push(au(h,m,e,t,0,0,u))}}o.push("</Row>"),o.length>2&&n.push(o.join(""))}return n.join("")}(n,t):"",i.length>0&&r.push("<Table>"+i+"</Table>"),r.push(function(e,t,s,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ei("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ei("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ei("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[s])if(r.Workbook.Sheets[s].Hidden)a.push(ei("Visible",1==r.Workbook.Sheets[s].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<s&&(!r.Workbook.Sheets[n]||r.Workbook.Sheets[n].Hidden);++n);n==s&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Zn("ProtectContents","True")),e["!protect"].objects&&a.push(Zn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Zn("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(Zn("EnableSelection","UnlockedCells")):a.push(Zn("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":ei("WorksheetOptions",a.join(""),{xmlns:gi})}(n,0,e,s)),r.join("")}function lu(e,t){t||(t={}),e.SSF||(e.SSF=An(Ca)),e.SSF&&(on(),ln(e.SSF),t.revssf=gn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Cd(t.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(su(e,t)),s.push(""),s.push(""),s.push("");for(var r=0;r<e.SheetNames.length;++r)s.push(ei("Worksheet",iu(r,t,e),{"ss:Name":$n(e.SheetNames[r])}));return s[2]=function(e,t){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(ei("NumberFormat",null,{"ss:Format":$n(Ca[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};s.push(ei("Style",r.join(""),a))}),ei("Styles",s.join(""))}(0,t),s[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,s=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||s.push(ru(a)))}return ei("Names",s.join(""))}(e),In+ei("Workbook",s.join(""),{xmlns:bi,"xmlns:o":fi,"xmlns:x":gi,"xmlns:ss":bi,"xmlns:dt":vi,"xmlns:html":ji})}var ou="e0859ff2f94f6810ab9108002b27b3d9",cu="02d5cdd59c2e1b10939708002b2cf9ae",du="05d5cdd59c2e1b10939708002b2cf9ae";function uu(e,t){var s=t||{},r=un.utils.cfb_new({root:"R"}),a="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":a="/Workbook",s.biff=8;break;case"biff5":a="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return un.utils.cfb_add(r,a,ju(e,s)),8==s.biff&&(e.Props||e.Custprops)&&function(e,t){var s,r=[],a=[],n=[],i=0,l=pn(Zl,"n"),o=pn(Ql,"n");if(e.Props)for(s=xn(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=xn(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<n.length;++i)No.indexOf(n[i][0])>-1||bo.indexOf(n[i][0])>-1||null!=n[i][1]&&c.push(n[i]);a.length&&un.utils.cfb_add(t,"/SummaryInformation",Co(a,ou,o,Ql)),(r.length||c.length)&&un.utils.cfb_add(t,"/DocumentSummaryInformation",Co(r,cu,l,Zl,c.length?c:null,du))}(e,r),8==s.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(s,r){if(0!=r){var a=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&un.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,un.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var mu={0:{f:function(e,t){var s={},r=e.l+t;s.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=r,7&n&&(s.level=7&n),16&n&&(s.hidden=!0),32&n&&(s.hpt=a/20),s}},1:{f:function(e){return[Pl(e)]}},2:{f:function(e){return[Pl(e),Ul(e),"n"]}},3:{f:function(e){return[Pl(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Pl(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Pl(e),Yl(e),"n"]}},6:{f:function(e){return[Pl(e),Cl(e),"str"]}},7:{f:function(e){return[Pl(e),e.read_shift(4),"s"]}},8:{f:function(e,t,s){var r=e.l+t,a=Pl(e);a.r=s["!row"];var n=[a,Cl(e),"str"];if(s.cellFormula){e.l+=2;var i=xd(e,r-e.l,s);n[3]=dd(i,0,a,s.supbooks,s)}else e.l=r;return n}},9:{f:function(e,t,s){var r=e.l+t,a=Pl(e);a.r=s["!row"];var n=[a,Yl(e),"n"];if(s.cellFormula){e.l+=2;var i=xd(e,r-e.l,s);n[3]=dd(i,0,a,s.supbooks,s)}else e.l=r;return n}},10:{f:function(e,t,s){var r=e.l+t,a=Pl(e);a.r=s["!row"];var n=[a,e.read_shift(1),"b"];if(s.cellFormula){e.l+=2;var i=xd(e,r-e.l,s);n[3]=dd(i,0,a,s.supbooks,s)}else e.l=r;return n}},11:{f:function(e,t,s){var r=e.l+t,a=Pl(e);a.r=s["!row"];var n=[a,e.read_shift(1),"e"];if(s.cellFormula){e.l+=2;var i=xd(e,r-e.l,s);n[3]=dd(i,0,a,s.supbooks,s)}else e.l=r;return n}},12:{f:function(e){return[Ll(e)]}},13:{f:function(e){return[Ll(e),Ul(e),"n"]}},14:{f:function(e){return[Ll(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Ll(e),e.read_shift(1),"b"]}},16:{f:function(e){return[Ll(e),Yl(e),"n"]}},17:{f:function(e){return[Ll(e),Cl(e),"str"]}},18:{f:function(e){return[Ll(e),e.read_shift(4),"s"]}},19:{f:Al},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,s){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),n=$l(e),i=pd(e,0,s),l=Fl(e);e.l=r;var o={Name:n,Ptg:i};return a<268435455&&(o.Sheet=a),l&&(o.Comment=l),o}},40:{},42:{},43:{f:function(e,t,s){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var n=e.read_shift(1);0!=n&&(r.underline=n);var i=e.read_shift(1);i>0&&(r.family=i);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=function(e){var t={},s=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),n=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=r;var o=to[r];o&&(t.rgb=ac(o));break;case 2:t.rgb=ac([n,i,l]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Cl(e),r}},44:{f:function(e,t){return[e.read_shift(2),Cl(e)]}},45:{f:bc},46:{f:jc},47:{f:function(e,t){var s=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=s,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],s=e.read_shift(4);s-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:function(e,t,s){if(!s.cellStyles)return rl(e,t);var r=s&&s.biff>=12?4:2,a=e.read_shift(r),n=e.read_shift(r),i=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:n,w:i,ixfe:l,flags:o};return(s.biff>=5||!s.biff)&&(c.level=o>>8&7),c}},62:{f:function(e){return[Pl(e),Al(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var s={};s.r=e.read_shift(4),s.c=e.read_shift(4),t.r=fl(s);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rl,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var s={},r=e[e.l];return++e.l,s.above=!(64&r),s.left=!(128&r),e.l+=18,s.name=Il(e),s}},148:{f:Md,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var s={},r=e.read_shift(4);s.defaultThemeVersion=e.read_shift(4);var a=t>8?Cl(e):"";return a.length>0&&(s.CodeName=a),s.autoCompressPictures=!!(65536&r),s.backupFile=!!(64&r),s.checkCompatibility=!!(4096&r),s.date1904=!!(1&r),s.filterPrivacy=!!(8&r),s.hidePivotFieldList=!!(1024&r),s.promptedSolutions=!!(16&r),s.publishItems=!!(2048&r),s.refreshAllConnections=!!(262144&r),s.saveExternalLinkValues=!!(128&r),s.showBorderUnselectedTables=!!(4&r),s.showInkAnnotation=!!(32&r),s.showObjects=["all","placeholders","none"][r>>13&3],s.showPivotChartFilter=!!(32768&r),s.updateLinks=["userSet","never","always"][r>>8&3],s}},154:{},155:{},156:{f:function(e,t){var s={};return s.Hidden=e.read_shift(4),s.iTabID=e.read_shift(4),s.strRelID=zl(e),s.name=Cl(e),s}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Od},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Cl(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:function(e,t,s){if(s.biff<8)return function(e,t,s){3==e[e.l+1]&&e[e.l]++;var r=Ro(e,0,s);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,s);for(var r=[],a=e.l+t,n=e.read_shift(s.biff>8?4:2);0!==n--;)r.push(Do(e,s.biff,s));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,s){var r=e.l+t,a=Hl(e),n=e.read_shift(1),i=[a];if(i[2]=n,s.cellFormula){var l=hd(e,r-e.l,s);i[1]=l}else e.l=r;return i}},427:{f:function(e,t,s){var r=e.l+t,a=[Gl(e)];if(s.cellFormula){var n=fd(e,r-e.l,s);a[1]=n,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Dd.forEach(function(s){t[s]=Yl(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var s=e.l+t,r=Gl(e),a=Fl(e),n=Cl(e),i=Cl(e),l=Cl(e);e.l=s;var o={rfx:r,relId:a,loc:n,display:l};return i&&(o.Tooltip=i),o}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Lc},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var s=Gl(e);return t.rfx=s.s,t.ref=fl(s.s),e.l+=16,t}},636:{T:-1},637:{f:El},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Cl(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function hu(e,t,s,r){var a=t;if(!isNaN(a)){var n=r||(s||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,n),n>0&&Ui(s)&&e.push(s)}}function xu(e,t,s){return e||(e=al(7)),e.write_shift(2,t),e.write_shift(2,s),e.write_shift(2,0),e.write_shift(1,0),e}function pu(e,t,s,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?vn(Sn(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?hu(e,2,(n=s,i=r,l=a,o=al(9),xu(o,n,i),o.write_shift(2,l),o)):hu(e,3,function(e,t,s){var r=al(15);return xu(r,e,t),r.write_shift(8,s,"f"),r}(s,r,a)));case"b":case"e":return void hu(e,5,function(e,t,s,r){var a=al(9);return xu(a,e,t),Eo(s,r||"b",a),a}(s,r,t.v,t.t));case"s":case"str":return void hu(e,4,function(e,t,s){var r=al(8+2*s.length);return xu(r,e,t),r.write_shift(1,s.length),r.write_shift(s.length,s,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(s,r,(t.v||"").slice(0,255)))}var n,i,l,o;hu(e,1,xu(null,s,r))}function fu(e,t){for(var s=t||{},r=nl(),a=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==s.sheet&&(a=n);if(0==a&&s.sheet&&e.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return hu(r,4==s.biff?1033:3==s.biff?521:9,$o(0,16,s)),function(e,t,s,r){var a,n=Array.isArray(t),i=vl(t["!ref"]||"A1"),l="",o=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=bl(i)}for(var c=i.s.r;c<=i.e.r;++c){l=ml(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(o[d]=xl(d)),a=o[d]+l;var u=n?(t[c]||[])[d]:t[a];u&&pu(e,u,c,d)}}}(r,e.Sheets[e.SheetNames[a]],0,s),hu(r,10),r.end()}function gu(e,t,s){hu(e,49,function(e,t){var s=e.name||"Arial",r=t&&5==t.biff,a=al(r?15+s.length:16+2*s.length);return a.write_shift(2,20*e.sz),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,s.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*s.length,s,r?"sbcs":"utf16le"),a}({sz:12,name:"Arial"},s))}function bu(e,t){if(t){var s=0;t.forEach(function(t,r){++s<=256&&t&&hu(e,125,function(e,t){var s=al(12);s.write_shift(2,t),s.write_shift(2,t),s.write_shift(2,256*e.width),s.write_shift(2,0);var r=0;return e.hidden&&(r|=1),s.write_shift(1,r),r=e.level||0,s.write_shift(1,r),s.write_shift(2,0),s}(_d(r,t),r))})}}function vu(e,t,s,r,a){var n=16+Cd(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)hu(e,6,ud(t,s,r,0,n));else switch(t.t){case"d":case"n":hu(e,515,function(e,t,s,r){var a=al(14);return Io(e,t,r,a),Kl(s,a),a}(s,r,"d"==t.t?vn(Sn(t.v)):t.v,n));break;case"b":case"e":hu(e,517,function(e,t,s,r,a,n){var i=al(8);return Io(e,t,r,i),Eo(s,n,i),i}(s,r,t.v,n,0,t.t));break;case"s":case"str":if(a.bookSST)hu(e,253,function(e,t,s,r){var a=al(10);return Io(e,t,r,a),a.write_shift(4,s),a}(s,r,Nd(a.Strings,t.v,a.revStrings),n));else hu(e,516,function(e,t,s,r,a){var n=!a||8==a.biff,i=al(+n+8+(1+n)*s.length);return Io(e,t,r,i),i.write_shift(2,s.length),n&&i.write_shift(1,1),i.write_shift((1+n)*s.length,s,n?"utf16le":"sbcs"),i}(s,r,(t.v||"").slice(0,255),n,a));break;default:hu(e,513,Io(s,r,n))}else hu(e,513,Io(s,r,n))}function yu(e,t,s){var r,a,n=nl(),i=s.SheetNames[e],l=s.Sheets[i]||{},o=(s||{}).Workbook||{},c=(o.Sheets||[])[e]||{},d=Array.isArray(l),u=8==t.biff,m="",h=[],x=vl(l["!ref"]||"A1"),p=u?65536:16384;if(x.e.c>255||x.e.r>=p){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,p-1)}hu(n,2057,$o(0,16,t)),hu(n,13,Ao(1)),hu(n,12,Ao(100)),hu(n,15,So(!0)),hu(n,17,So(!1)),hu(n,16,Kl(.001)),hu(n,95,So(!0)),hu(n,42,So(!1)),hu(n,43,So(!1)),hu(n,130,Ao(1)),hu(n,128,((a=al(8)).write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a)),hu(n,131,So(!1)),hu(n,132,So(!1)),u&&bu(n,l["!cols"]),hu(n,512,function(e,t){var s=8!=t.biff&&t.biff?2:4,r=al(2*s+6);return r.write_shift(s,e.s.r),r.write_shift(s,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(x,t)),u&&(l["!links"]=[]);for(var f=x.s.r;f<=x.e.r;++f){m=ml(f);for(var g=x.s.c;g<=x.e.c;++g){f===x.s.r&&(h[g]=xl(g)),r=h[g]+m;var b=d?(l[f]||[])[g]:l[r];b&&(vu(n,b,f,g,t),u&&b.l&&l["!links"].push([r,b.l]))}}var v=c.CodeName||c.name||i;return u&&hu(n,574,function(e){var t=al(18),s=1718;return e&&e.RTL&&(s|=64),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(l["!merges"]||[]).length&&hu(n,229,function(e){var t=al(2+8*e.length);t.write_shift(2,e.length);for(var s=0;s<e.length;++s)Bo(e[s],t);return t}(l["!merges"])),u&&function(e,t){for(var s=0;s<t["!links"].length;++s){var r=t["!links"][s];hu(e,440,Wo(r)),r[1].Tooltip&&hu(e,2048,Ho(r))}delete t["!links"]}(n,l),hu(n,442,Mo(v)),u&&function(e,t){var s=al(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),hu(e,2151,s),(s=al(39)).write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),Bo(vl(t["!ref"]||"A1"),s),s.write_shift(4,4),hu(e,2152,s)}(n,l),hu(n,10),n.end()}function wu(e,t,s){var r,a=nl(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=8==s.biff,c=5==s.biff;(hu(a,2057,$o(0,5,s)),"xla"==s.bookType&&hu(a,135),hu(a,225,o?Ao(1200):null),hu(a,193,function(e,t){t||(t=al(e));for(var s=0;s<e;++s)t.write_shift(1,0);return t}(2)),c&&hu(a,191),c&&hu(a,192),hu(a,226),hu(a,92,function(e,t){var s=!t||8==t.biff,r=al(s?112:54);for(r.write_shift(8==t.biff?2:1,7),s&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(s?0:536870912));r.l<r.length;)r.write_shift(1,s?0:32);return r}(0,s)),hu(a,66,Ao(o?1200:1252)),o&&hu(a,353,Ao(0)),o&&hu(a,448),hu(a,317,function(e){for(var t=al(2*e),s=0;s<e;++s)t.write_shift(2,s+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&hu(a,211),o&&e.vbaraw)&&hu(a,442,Mo(l.CodeName||"ThisWorkbook"));hu(a,156,Ao(17)),hu(a,25,So(!1)),hu(a,18,So(!1)),hu(a,19,Ao(0)),o&&hu(a,431,So(!1)),o&&hu(a,444,Ao(0)),hu(a,61,((r=al(18)).write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r)),hu(a,64,So(!1)),hu(a,141,Ao(0)),hu(a,34,So("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&function(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}(e.Workbook.WBProps.date1904)?"true":"false"}(e))),hu(a,14,So(!0)),o&&hu(a,439,So(!1)),hu(a,218,Ao(0)),gu(a,0,s),function(e,t,s){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&hu(e,1054,Vo(a,t[a],s))})}(a,e.SSF,s),function(e,t){for(var s=0;s<16;++s)hu(e,224,Uo({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){hu(e,224,Uo(s,0,t))})}(a,s),o&&hu(a,352,So(!1));var d=a.end(),u=nl();o&&hu(u,140,function(e){return e||(e=al(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),o&&s.Strings&&function(e,t,s){var r=(s||[]).length||0;if(r<=8224)return hu(e,t,s,r);var a=t;if(!isNaN(a)){for(var n=s.parts||[],i=0,l=0,o=0;o+(n[i]||8224)<=8224;)o+=n[i]||8224,i++;var c=e.next(4);for(c.write_shift(2,a),c.write_shift(2,o),e.push(s.slice(l,l+o)),l+=o;l<r;){for((c=e.next(4)).write_shift(2,60),o=0;o+(n[i]||8224)<=8224;)o+=n[i]||8224,i++;c.write_shift(2,o),e.push(s.slice(l,l+o)),l+=o}}}(u,252,function(e){var t=al(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var s=[],r=0;r<e.length;++r)s[r]=Po(e[r]);var a=xa([t].concat(s));return a.parts=[t.length].concat(s.map(function(e){return e.length})),a}(s.Strings)),hu(u,10);var m=u.end(),h=nl(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var f=d.length+x+m.length;for(p=0;p<e.SheetNames.length;++p){hu(h,133,zo({pos:f,hs:(i[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},s)),f+=t[p].length}var g=h.end();if(x!=g.length)throw new Error("BS8 "+x+" != "+g.length);var b=[];return d.length&&b.push(d),g.length&&b.push(g),m.length&&b.push(m),xa(b)}function ju(e,t){for(var s=0;s<=e.SheetNames.length;++s){var r=e.Sheets[e.SheetNames[s]];if(r&&r["!ref"])gl(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var s=t||{},r=[];e&&!e.SSF&&(e.SSF=An(Ca)),e&&e.SSF&&(on(),ln(e.SSF),s.revssf=gn(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,Yu(s),s.cellXfs=[],Cd(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=yu(a,s,e);return r.unshift(wu(e,r,s)),xa(r)}(e,t);case 4:case 3:case 2:return fu(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Nu(e,t,s,r){for(var a=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,o=0,c=0;c<a.length;++c)if(!(a[c].s.r>s||a[c].s.c>i||a[c].e.r<s||a[c].e.c<i)){if(a[c].s.r<s||a[c].s.c<i){l=-1;break}l=a[c].e.r-a[c].s.r+1,o=a[c].e.c-a[c].s.c+1;break}if(!(l<0)){var d=fl({r:s,c:i}),u=r.dense?(e[s]||[])[i]:e[d],m=u&&null!=u.v&&(u.h||Un(u.w||(wl(u),u.w)||""))||"",h={};l>1&&(h.rowspan=l),o>1&&(h.colspan=o),r.editable?m='<span contenteditable="true">'+m+"</span>":u&&(h["data-t"]=u&&u.t||"z",null!=u.v&&(h["data-v"]=u.v),null!=u.z&&(h["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(m='<a href="'+u.l.Target+'">'+m+"</a>")),h.id=(r.id||"sjs")+"-"+d,n.push(ei("td",m,h))}}return"<tr>"+n.join("")+"</tr>"}function _u(e,t){var s=t||{},r=null!=s.header?s.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a=null!=s.footer?s.footer:"</body></html>",n=[r],i=gl(e["!ref"]);s.dense=Array.isArray(e),n.push(function(e,t,s){return[].join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}(0,0,s));for(var l=i.s.r;l<=i.e.r;++l)n.push(Nu(e,i,l,s));return n.push("</table>"+a),n.join("")}function ku(e,t,s){var r=s||{},a=0,n=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var i="string"==typeof r.origin?pl(r.origin):r.origin;a=i.r,n=i.c}var l=t.getElementsByTagName("tr"),o=Math.min(r.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:a,c:n}};if(e["!ref"]){var d=gl(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==a&&(c.e.r=a=d.e.r+1)}var u=[],m=0,h=e["!rows"]||(e["!rows"]=[]),x=0,p=0,f=0,g=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<o;++x){var y=l[x];if(Su(y)){if(r.display)continue;h[p]={hidden:!0}}var w=y.children;for(f=g=0;f<w.length;++f){var j=w[f];if(!r.display||!Su(j)){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):Xn(j.innerHTML),_=j.getAttribute("data-z")||j.getAttribute("z");for(m=0;m<u.length;++m){var k=u[m];k.s.c==g+n&&k.s.r<p+a&&p+a<=k.e.r&&(g=k.e.c+1-n,m=-1)}v=+j.getAttribute("colspan")||1,((b=+j.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+a,c:g+n},e:{r:p+a+(b||1)-1,c:g+n+(v||1)-1}});var C={t:"s",v:N},S=j.getAttribute("data-t")||j.getAttribute("t")||"";null!=N&&(0==N.length?C.t=S||"z":r.raw||0==N.trim().length||"s"==S||("TRUE"===N?C={t:"b",v:!0}:"FALSE"===N?C={t:"b",v:!1}:isNaN(Rn(N))?isNaN(Mn(N).getDate())||(C={t:"d",v:Sn(N)},r.cellDates||(C={t:"n",v:vn(C.v)}),C.z=r.dateNF||Ca[14]):C={t:"n",v:Rn(N)})),void 0===C.z&&null!=_&&(C.z=_);var T="",A=j.getElementsByTagName("A");if(A&&A.length)for(var E=0;E<A.length&&(!A[E].hasAttribute("href")||"#"==(T=A[E].getAttribute("href")).charAt(0));++E);T&&"#"!=T.charAt(0)&&(C.l={Target:T}),r.dense?(e[p+a]||(e[p+a]=[]),e[p+a][g+n]=C):e[fl({c:g+n,r:p+a})]=C,c.e.c<g+n&&(c.e.c=g+n),g+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=bl(c),p>=o&&(e["!fullref"]=bl((c.e.r=l.length-x+p-1+a,c))),e}function Cu(e,t){return ku((t||{}).dense?[]:{},e,t)}function Su(e){var t="",s=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return s&&(t=s(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var Tu=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Qn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return In+t}}(),Au=function(){var e=function(e){return $n(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",s=function(s,r,a){var n=[];n.push('      <table:table table:name="'+$n(r.SheetNames[a])+'" table:style-name="ta1">\n');var i=0,l=0,o=gl(s["!ref"]||"A1"),c=s["!merges"]||[],d=0,u=Array.isArray(s);if(s["!cols"])for(l=0;l<=o.e.c;++l)n.push("        <table:table-column"+(s["!cols"][l]?' table:style-name="co'+s["!cols"][l].ods+'"':"")+"></table:table-column>\n");var m="",h=s["!rows"]||[];for(i=0;i<o.s.r;++i)m=h[i]?' table:style-name="ro'+h[i].ods+'"':"",n.push("        <table:table-row"+m+"></table:table-row>\n");for(;i<=o.e.r;++i){for(m=h[i]?' table:style-name="ro'+h[i].ods+'"':"",n.push("        <table:table-row"+m+">\n"),l=0;l<o.s.c;++l)n.push(t);for(;l<=o.e.c;++l){var x=!1,p={},f="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>l||c[d].s.r>i||c[d].e.c<l||c[d].e.r<i)){c[d].s.c==l&&c[d].s.r==i||(x=!0),p["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,p["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(x)n.push("          <table:covered-table-cell/>\n");else{var g=fl({r:i,c:l}),b=u?(s[i]||[])[l]:s[g];if(b&&b.f&&(p["table:formula"]=$n(yd(b.f)),b.F&&b.F.slice(0,g.length)==g)){var v=gl(b.F);p["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,p["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1}if(b){switch(b.t){case"b":f=b.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=b.v?"true":"false";break;case"n":f=b.w||String(b.v||0),p["office:value-type"]="float",p["office:value"]=b.v||0;break;case"s":case"str":f=null==b.v?"":b.v,p["office:value-type"]="string";break;case"d":f=b.w||Sn(b.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Sn(b.v).toISOString(),p["table:style-name"]="ce1";break;default:n.push(t);continue}var y=e(f);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+wd(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=ei("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}n.push("          "+ei("table:table-cell",ei("text:p",y,{}),p)+"\n")}else n.push(t)}}n.push("        </table:table-row>\n")}return n.push("      </table:table>\n"),n.join("")};return function(e,t){var r=[In],a=Qn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),n=Qn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+n+">\n"),r.push(ho().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var s=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;cc(a),a.ods=s;var n=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+s+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+n+'"/>\n'),e.push("  </style:style>\n"),++s}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var s=0;s<t["!rows"].length;++s)if(t["!rows"][s]){t["!rows"][s].ods=r;var a=t["!rows"][s].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)r.push(s(e.Sheets[e.SheetNames[i]],e,i));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function Eu(e,t){if("fods"==t.bookType)return Au(e,t);var s=On(),r="",a=[],n=[];return Ln(s,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ln(s,r="content.xml",Au(e,t)),a.push([r,"text/xml"]),n.push([r,"ContentFile"]),Ln(s,r="styles.xml",Tu(e,t)),a.push([r,"text/xml"]),n.push([r,"StylesFile"]),Ln(s,r="meta.xml",In+ho()),a.push([r,"text/xml"]),n.push([r,"MetadataFile"]),Ln(s,r="manifest.rdf",function(e){var t=[In];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var s=0;s!=e.length;++s)t.push(uo(e[s][0],e[s][1])),t.push(mo("",e[s][0]));return t.push(uo("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),a.push([r,"application/rdf+xml"]),Ln(s,r="META-INF/manifest.xml",function(e){var t=[In];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var s=0;s<e.length;++s)t.push('  <manifest:file-entry manifest:full-path="'+e[s][0]+'" manifest:media-type="'+e[s][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),s}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ru(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pu(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):ua(Kn(e))}function Mu(e){var t=e.reduce(function(e,t){return e+t.length},0),s=new Uint8Array(t),r=0;return e.forEach(function(e){s.set(e,r),r+=e.length}),s}function Lu(e,t){var s=t?t[0]:0,r=127&e[s];e:if(e[s++]>=128){if(r|=(127&e[s])<<7,e[s++]<128)break e;if(r|=(127&e[s])<<14,e[s++]<128)break e;if(r|=(127&e[s])<<21,e[s++]<128)break e;if(r+=(127&e[s])*Math.pow(2,28),++s,e[s++]<128)break e;if(r+=(127&e[s])*Math.pow(2,35),++s,e[s++]<128)break e;if(r+=(127&e[s])*Math.pow(2,42),++s,e[s++]<128)break e}return t&&(t[0]=s),r}function Ou(e){var t=new Uint8Array(7);t[0]=127&e;var s=1;e:if(e>127){if(t[s-1]|=128,t[s]=e>>7&127,++s,e<=16383)break e;if(t[s-1]|=128,t[s]=e>>14&127,++s,e<=2097151)break e;if(t[s-1]|=128,t[s]=e>>21&127,++s,e<=268435455)break e;if(t[s-1]|=128,t[s]=e/256>>>21&127,++s,e<=34359738367)break e;if(t[s-1]|=128,t[s]=e/65536>>>21&127,++s,e<=4398046511103)break e;t[s-1]|=128,t[s]=e/16777216>>>21&127,++s}return t.slice(0,s)}function Iu(e){var t=0,s=127&e[t];e:if(e[t++]>=128){if(s|=(127&e[t])<<7,e[t++]<128)break e;if(s|=(127&e[t])<<14,e[t++]<128)break e;if(s|=(127&e[t])<<21,e[t++]<128)break e;s|=(127&e[t])<<28}return s}function Du(e){for(var t=[],s=[0];s[0]<e.length;){var r,a=s[0],n=Lu(e,s),i=7&n,l=0;if(0==(n=Math.floor(n/8)))break;switch(i){case 0:for(var o=s[0];e[s[0]++]>=128;);r=e.slice(o,s[0]);break;case 5:l=4,r=e.slice(s[0],s[0]+l),s[0]+=l;break;case 1:l=8,r=e.slice(s[0],s[0]+l),s[0]+=l;break;case 2:l=Lu(e,s),r=e.slice(s[0],s[0]+l),s[0]+=l;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var c={data:r,type:i};null==t[n]?t[n]=[c]:t[n].push(c)}return t}function Fu(e){var t=[];return e.forEach(function(e,s){e.forEach(function(e){e.data&&(t.push(Ou(8*s+e.type)),2==e.type&&t.push(Ou(e.data.length)),t.push(e.data))})}),Mu(t)}function Bu(e){for(var t,s=[],r=[0];r[0]<e.length;){var a=Lu(e,r),n=Du(e.slice(r[0],r[0]+a));r[0]+=a;var i={id:Iu(n[1][0].data),messages:[]};n[2].forEach(function(t){var s=Du(t.data),a=Iu(s[3][0].data);i.messages.push({meta:s,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=n[3])?void 0:t[0])&&(i.merge=Iu(n[3][0].data)>>>0>0),s.push(i)}return s}function $u(e){var t=[];return e.forEach(function(e){var s=[];s[1]=[{data:Ou(e.id),type:0}],s[2]=[],null!=e.merge&&(s[3]=[{data:Ou(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:Ou(e.data.length)}],s[2].push({data:Fu(e.meta),type:2})});var a=Fu(s);t.push(Ou(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),Mu(t)}function zu(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var s=[0],r=Lu(t,s),a=[];s[0]<t.length;){var n=3&t[s[0]];if(0!=n){var i=0,l=0;if(1==n?(l=4+(t[s[0]]>>2&7),i=(224&t[s[0]++])<<3,i|=t[s[0]++]):(l=1+(t[s[0]++]>>2),2==n?(i=t[s[0]]|t[s[0]+1]<<8,s[0]+=2):(i=(t[s[0]]|t[s[0]+1]<<8|t[s[0]+2]<<16|t[s[0]+3]<<24)>>>0,s[0]+=4)),a=[Mu(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(l>=i)for(a.push(a[0].slice(-i)),l-=i;l>=a[a.length-1].length;)a.push(a[a.length-1]),l-=a[a.length-1].length;a.push(a[0].slice(-i,-i+l))}else{var o=t[s[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[s[0]],c>1&&(o|=t[s[0]+1]<<8),c>2&&(o|=t[s[0]+2]<<16),c>3&&(o|=t[s[0]+3]<<24),o>>>=0,o++,s[0]+=c}a.push(t.slice(s[0],s[0]+o)),s[0]+=o}}var d=Mu(a);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Vu(e){for(var t=[],s=0;s<e.length;){var r=e[s++],a=e[s]|e[s+1]<<8|e[s+2]<<16;s+=3,t.push(zu(r,e.slice(s,s+a))),s+=a}if(s!==e.length)throw new Error("data is not a valid framed stream!");return Mu(t)}function Uu(e){for(var t=[],s=0;s<e.length;){var r=Math.min(e.length-s,268435455),a=new Uint8Array(4);t.push(a);var n=Ou(r),i=n.length;t.push(n),r<=60?(i++,t.push(new Uint8Array([r-1<<2]))):r<=256?(i+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(i+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(i+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(i+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(s,s+r)),i+=r,a[0]=0,a[1]=255&i,a[2]=i>>8&255,a[3]=i>>16&255,s+=r}return Mu(t)}function Wu(e,t){var s=new Uint8Array(32),r=Ru(s),a=12,n=0;switch(s[0]=5,e.t){case"n":s[1]=2,function(e,t,s){var r=Math.floor(0==s?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,a=s/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var n=0;a>=1;++n,a/=256)e[t+n]=255&a;e[t+15]|=s>=0?0:128}(s,a,e.v),n|=1,a+=16;break;case"b":s[1]=6,r.setFloat64(a,e.v?1:0,!0),n|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));s[1]=3,r.setUint32(a,t.indexOf(e.v),!0),n|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,n,!0),s.slice(0,a)}function Hu(e,t){var s=new Uint8Array(32),r=Ru(s),a=12,n=0;switch(s[0]=3,e.t){case"n":s[2]=2,r.setFloat64(a,e.v,!0),n|=32,a+=8;break;case"b":s[2]=6,r.setFloat64(a,e.v?1:0,!0),n|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));s[2]=3,r.setUint32(a,t.indexOf(e.v),!0),n|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,n,!0),s.slice(0,a)}function Gu(e){return Lu(Du(e)[1][0].data)}function qu(e,t,s){var r,a,n,i;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(n=e[8])?void 0:n[0])?void 0:i.data)&&Iu(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var l=0,o=Ru(e[7][0].data),c=0,d=[],u=Ru(e[4][0].data),m=0,h=[],x=0;x<t.length;++x)if(null!=t[x]){var p,f;switch(o.setUint16(2*x,c,!0),u.setUint16(2*x,m,!0),typeof t[x]){case"string":p=Wu({t:"s",v:t[x]},s),f=Hu({t:"s",v:t[x]},s);break;case"number":p=Wu({t:"n",v:t[x]},s),f=Hu({t:"n",v:t[x]},s);break;case"boolean":p=Wu({t:"b",v:t[x]},s),f=Hu({t:"b",v:t[x]},s);break;default:throw new Error("Unsupported value "+t[x])}d.push(p),c+=p.length,h.push(f),m+=f.length,++l}else o.setUint16(2*x,65535,!0),u.setUint16(2*x,65535);for(e[2][0].data=Ou(l);x<e[7][0].data.length/2;++x)o.setUint16(2*x,65535,!0),u.setUint16(2*x,65535,!0);return e[6][0].data=Mu(d),e[3][0].data=Mu(h),l}function Yu(e){var t;(t=[["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]],function(e){for(var s=0;s!=t.length;++s){var r=t[s];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}})(e)}function Ku(e,t){return"ods"==t.bookType?Eu(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=e.Sheets[e.SheetNames[0]];e.SheetNames.length;var r=gl(s["!ref"]);r.s.r=r.s.c=0,r.e.c>9&&(r.e.c=9),r.e.r>49&&(r.e.r=49);var a=sm(s,{range:r,header:1}),n=["~Sh33tJ5~"];a.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&n.push(e)})});var i={},l=[],o=un.read(t.numbers,{type:"base64"});o.FileIndex.map(function(e,t){return[e,o.FullPaths[t]]}).forEach(function(e){var t=e[0],s=e[1];2==t.type&&t.name.match(/\.iwa/)&&Bu(Vu(t.content)).forEach(function(e){l.push(e.id),i[e.id]={deps:[],location:s,type:Iu(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var c=l.filter(function(e){return e>1}).map(function(e){return[e,Ou(e)]});o.FileIndex.map(function(e,t){return[e,o.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Bu(Vu(t.content)).forEach(function(e){e.messages.forEach(function(t){c.forEach(function(t){e.messages.some(function(e){return 11006!=Iu(e.meta[1][0].data)&&function(e,t){e:for(var s=0;s<=e.length-t.length;++s){for(var r=0;r<t.length;++r)if(e[s+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&i[t[0]].deps.push(e.id)})})})});for(var d,u=un.find(o,i[1].location),m=Bu(Vu(u.content)),h=0;h<m.length;++h){var x=m[h];1==x.id&&(d=x)}var p=Gu(Du(d.messages[0].data)[1][0].data);for(m=Bu(Vu((u=un.find(o,i[p].location)).content)),h=0;h<m.length;++h)(x=m[h]).id==p&&(d=x);for(p=Gu(Du(d.messages[0].data)[2][0].data),m=Bu(Vu((u=un.find(o,i[p].location)).content)),h=0;h<m.length;++h)(x=m[h]).id==p&&(d=x);for(p=Gu(Du(d.messages[0].data)[2][0].data),m=Bu(Vu((u=un.find(o,i[p].location)).content)),h=0;h<m.length;++h)(x=m[h]).id==p&&(d=x);var f=Du(d.messages[0].data);f[6][0].data=Ou(r.e.r+1),f[7][0].data=Ou(r.e.c+1);for(var g=Gu(f[46][0].data),b=un.find(o,i[g].location),v=Bu(Vu(b.content)),y=0;y<v.length&&v[y].id!=g;++y);if(v[y].id!=g)throw"Bad ColumnRowUIDMapArchive";var w=Du(v[y].messages[0].data);w[1]=[],w[2]=[],w[3]=[];for(var j=0;j<=r.e.c;++j){var N=[];N[1]=N[2]=[{type:0,data:Ou(j+420690)}],w[1].push({type:2,data:Fu(N)}),w[2].push({type:0,data:Ou(j)}),w[3].push({type:0,data:Ou(j)})}w[4]=[],w[5]=[],w[6]=[];for(var _=0;_<=r.e.r;++_)(N=[])[1]=N[2]=[{type:0,data:Ou(_+726270)}],w[4].push({type:2,data:Fu(N)}),w[5].push({type:0,data:Ou(_)}),w[6].push({type:0,data:Ou(_)});v[y].messages[0].data=Fu(w),b.content=Uu($u(v)),b.size=b.content.length,delete f[46];var k=Du(f[4][0].data);k[7][0].data=Ou(r.e.r+1);var C=Gu(Du(k[1][0].data)[2][0].data);if((v=Bu(Vu((b=un.find(o,i[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var S=Du(v[0].messages[0].data);for(_=0;_<a.length;++_){var T=Du(S[2][0].data);T[1][0].data=Ou(_),T[4][0].data=Ou(a[_].length),S[2][_]={type:S[2][0].type,data:Fu(T)}}v[0].messages[0].data=Fu(S),b.content=Uu($u(v)),b.size=b.content.length;var A=Gu(k[2][0].data);if((v=Bu(Vu((b=un.find(o,i[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";for(S=Du(v[0].messages[0].data),j=0;j<=r.e.c;++j)(T=Du(S[2][0].data))[1][0].data=Ou(j),T[4][0].data=Ou(r.e.r+1),S[2][j]={type:S[2][0].type,data:Fu(T)};v[0].messages[0].data=Fu(S),b.content=Uu($u(v)),b.size=b.content.length;var E=Gu(k[4][0].data);!function(){for(var e,t=un.find(o,i[E].location),s=Bu(Vu(t.content)),r=0;r<s.length;++r){var a=s[r];a.id==E&&(e=a)}var l=Du(e.messages[0].data);l[3]=[];var c=[];n.forEach(function(e,t){c[1]=[{type:0,data:Ou(t)}],c[2]=[{type:0,data:Ou(1)}],c[3]=[{type:2,data:Pu(e)}],l[3].push({type:2,data:Fu(c)})}),e.messages[0].data=Fu(l);var d=Uu($u(s));t.content=d,t.size=t.content.length}();var R=Du(k[3][0].data),P=R[1][0];delete R[2];var M=Du(P.data),L=Gu(M[2][0].data);!function(){for(var e,t=un.find(o,i[L].location),s=Bu(Vu(t.content)),l=0;l<s.length;++l){var c=s[l];c.id==L&&(e=c)}var d=Du(e.messages[0].data);delete d[6],delete R[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var m=0,h=0;h<=r.e.r;++h){var x=Du(u);m+=qu(x,a[h],n),x[1][0].data=Ou(h),d[5].push({data:Fu(x),type:2})}d[1]=[{type:0,data:Ou(r.e.c+1)}],d[2]=[{type:0,data:Ou(r.e.r+1)}],d[3]=[{type:0,data:Ou(m)}],d[4]=[{type:0,data:Ou(r.e.r+1)}],e.messages[0].data=Fu(d);var p=Uu($u(s));t.content=p,t.size=t.content.length}(),P.data=Fu(M),k[3][0].data=Fu(R),f[4][0].data=Fu(k),d.messages[0].data=Fu(f);var O=Uu($u(m));return u.content=O,u.size=u.content.length,o}(e,t):"xlsb"==t.bookType?function(e,t){Ec=1024,e&&!e.SSF&&(e.SSF=An(Ca));e&&e.SSF&&(on(),ln(e.SSF),t.revssf=gn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var s="xlsb"==t.bookType?"bin":"xml",r=Ic.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Yu(t=t||{});var n=On(),i="",l=0;t.cellXfs=[],Cd(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Ln(n,i="docProps/core.xml",fo(e.Props,t)),a.coreprops.push(i),co(t.rels,2,i,io.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var o=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ln(n,i,vo(e.Props)),a.extprops.push(i),co(t.rels,3,i,io.EXT_PROPS),e.Custprops!==e.Props&&xn(e.Custprops||{}).length>0&&(Ln(n,i="docProps/custom.xml",yo(e.Custprops)),a.custprops.push(i),co(t.rels,4,i,io.CUST_PROPS));for(l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},u=e.Sheets[e.SheetNames[l-1]];(u||{})["!type"];if(Ln(n,i="xl/worksheets/sheet"+l+"."+s,eu(l-1,i,t,e,d)),a.sheets.push(i),co(t.wbrels,-1,"worksheets/sheet"+l+"."+s,io.WS[0]),u){var m=u["!comments"],h=!1,x="";m&&m.length>0&&(Ln(n,x="xl/comments"+l+"."+s,tu(m,x)),a.comments.push(x),co(d,-1,"../comments"+l+"."+s,io.CMNT),h=!0),u["!legacy"]&&h&&Ln(n,"xl/drawings/vmlDrawing"+l+".vml",Rc(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&Ln(n,lo(i),oo(d))}null!=t.Strings&&t.Strings.length>0&&(Ln(n,i="xl/sharedStrings."+s,function(e,t,s){return(".bin"===t.slice(-4)?tc:Qo)(e,s)}(t.Strings,i,t)),a.strs.push(i),co(t.wbrels,-1,"sharedStrings."+s,io.SST));Ln(n,i="xl/workbook."+s,function(e,t){return(".bin"===t.slice(-4)?Qd:Xd)(e)}(e,i)),a.workbooks.push(i),co(t.rels,1,i,io.WB),Ln(n,i="xl/theme/theme1.xml",Sc(e.Themes,t)),a.themes.push(i),co(t.wbrels,-1,"theme/theme1.xml",io.THEME),Ln(n,i="xl/styles."+s,function(e,t,s){return(".bin"===t.slice(-4)?Cc:hc)(e,s)}(e,i,t)),a.styles.push(i),co(t.wbrels,-1,"styles."+s,io.STY),e.vbaraw&&r&&(Ln(n,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),co(t.wbrels,-1,"vbaProject.bin",io.VBA));return Ln(n,i="xl/metadata."+s,function(e){return(".bin"===e.slice(-4)?Tc:Ac)()}(i)),a.metadata.push(i),co(t.wbrels,-1,"metadata."+s,io.XLMETA),Ln(n,"[Content_Types].xml",no(a,t)),Ln(n,"_rels/.rels",oo(t.rels)),Ln(n,"xl/_rels/workbook."+s+".rels",oo(t.wbrels)),delete t.revssf,delete t.ssf,n}(e,t):function(e,t){Ec=1024,e&&!e.SSF&&(e.SSF=An(Ca));e&&e.SSF&&(on(),ln(e.SSF),t.revssf=gn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var s="xml",r=Ic.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Yu(t=t||{});var n=On(),i="",l=0;t.cellXfs=[],Cd(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Ln(n,i="docProps/core.xml",fo(e.Props,t)),a.coreprops.push(i),co(t.rels,2,i,io.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var o=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ln(n,i,vo(e.Props)),a.extprops.push(i),co(t.rels,3,i,io.EXT_PROPS),e.Custprops!==e.Props&&xn(e.Custprops||{}).length>0&&(Ln(n,i="docProps/custom.xml",yo(e.Custprops)),a.custprops.push(i),co(t.rels,4,i,io.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},m=e.Sheets[e.SheetNames[l-1]];(m||{})["!type"];if(Ln(n,i="xl/worksheets/sheet"+l+"."+s,Rd(l-1,t,e,u)),a.sheets.push(i),co(t.wbrels,-1,"worksheets/sheet"+l+"."+s,io.WS[0]),m){var h=m["!comments"],x=!1,p="";if(h&&h.length>0){var f=!1;h.forEach(function(e){e[1].forEach(function(e){1==e.T&&(f=!0)})}),f&&(Ln(n,p="xl/threadedComments/threadedComment"+l+"."+s,Mc(h,d,t)),a.threadedcomments.push(p),co(u,-1,"../threadedComments/threadedComment"+l+"."+s,io.TCMNT)),Ln(n,p="xl/comments"+l+"."+s,Pc(h)),a.comments.push(p),co(u,-1,"../comments"+l+"."+s,io.CMNT),x=!0}m["!legacy"]&&x&&Ln(n,"xl/drawings/vmlDrawing"+l+".vml",Rc(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}u["!id"].rId1&&Ln(n,lo(i),oo(u))}null!=t.Strings&&t.Strings.length>0&&(Ln(n,i="xl/sharedStrings."+s,Qo(t.Strings,t)),a.strs.push(i),co(t.wbrels,-1,"sharedStrings."+s,io.SST));Ln(n,i="xl/workbook."+s,Xd(e)),a.workbooks.push(i),co(t.rels,1,i,io.WB),Ln(n,i="xl/theme/theme1.xml",Sc(e.Themes,t)),a.themes.push(i),co(t.wbrels,-1,"theme/theme1.xml",io.THEME),Ln(n,i="xl/styles."+s,hc(e,t)),a.styles.push(i),co(t.wbrels,-1,"styles."+s,io.STY),e.vbaraw&&r&&(Ln(n,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),co(t.wbrels,-1,"vbaProject.bin",io.VBA));Ln(n,i="xl/metadata."+s,Ac()),a.metadata.push(i),co(t.wbrels,-1,"metadata."+s,io.XLMETA),d.length>1&&(Ln(n,i="xl/persons/person.xml",function(e){var t=[In,ei("personList",null,{xmlns:li,"xmlns:x":pi[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,s){t.push(ei("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),a.people.push(i),co(t.wbrels,-1,"persons/person.xml",io.PEOPLE));return Ln(n,"[Content_Types].xml",no(a,t)),Ln(n,"_rels/.rels",oo(t.rels)),Ln(n,"xl/_rels/workbook."+s+".rels",oo(t.wbrels)),delete t.revssf,delete t.ssf,n}(e,t)}function Xu(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return hn(t.file,un.write(e,{type:la?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return un.write(e,t)}function Ju(e,t){var s=An(t||{});return function(e,t){var s={},r=la?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";t.compression&&(s.compression="DEFLATE");if(t.password)s.type=r;else switch(t.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":s.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?un.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!t.compression}):e.generate(s);if("undefined"!=typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(ma(a))}return t.password&&"undefined"!=typeof encrypt_agile?Xu(encrypt_agile(a,t.password),t):"file"===t.type?hn(t.file,a):"string"==t.type?Yn(a):a}(Ku(e,s),s)}function Zu(e,t,s){s||(s="");var r=s+e;switch(t.type){case"base64":return na(Kn(r));case"binary":return Kn(r);case"string":return e;case"file":return hn(t.file,r,"utf8");case"buffer":return la?oa(r,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(r):Zu(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Qu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var s="",r=0;r<e.length;++r)s+=String.fromCharCode(e[r]);return"base64"==t.type?na(s):"string"==t.type?Yn(s):s;case"file":return hn(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function em(e,t){ea(),Kd(e);var s=An(t||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),"array"==s.type){s.type="binary";var r=em(e,s);return s.type="array",ma(r)}var a=0;if(s.sheet&&(a="number"==typeof s.sheet?s.sheet:e.SheetNames.indexOf(s.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return Zu(lu(e,s),s);case"slk":case"sylk":return Zu(qo.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"htm":case"html":return Zu(_u(e.Sheets[e.SheetNames[a]],s),s);case"txt":return function(e,t){switch(t.type){case"base64":return na(e);case"binary":case"string":return e;case"file":return hn(t.file,e,"binary");case"buffer":return la?oa(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(im(e.Sheets[e.SheetNames[a]],s),s);case"csv":return Zu(nm(e.Sheets[e.SheetNames[a]],s),s,"\ufeff");case"dif":return Zu(Yo.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"dbf":return Qu(Go.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"prn":return Zu(Xo.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"rtf":return Zu(rc.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"eth":return Zu(Ko.from_sheet(e.Sheets[e.SheetNames[a]],s),s);case"fods":return Zu(Eu(e,s),s);case"wk1":return Qu(Jo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],s),s);case"wk3":return Qu(Jo.book_to_wk3(e,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),Qu(ju(e,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),function(e,t){var s=t||{};return Xu(uu(e,s),s)}(e,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ju(e,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function tm(e,t,s,r,a,n,i,l){var o=ml(s),c=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,m=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:s,enumerable:!1})}catch(f){m.__rowNum__=s}else m.__rowNum__=s;if(!i||e[s])for(var h=t.s.c;h<=t.e.c;++h){var x=i?e[s][h]:e[r[h]+o];if(void 0!==x&&void 0!==x.t){var p=x.v;switch(x.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(null!=n[h]){if(null==p)if("e"==x.t&&null===p)m[n[h]]=null;else if(void 0!==c)m[n[h]]=c;else{if(!d||null!==p)continue;m[n[h]]=null}else m[n[h]]=d&&("n"!==x.t||"n"===x.t&&!1!==l.rawNumbers)?p:wl(x,p,l);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=n[h]&&(m[n[h]]=c)}}return{row:m,isempty:u}}function sm(e,t){if(null==e||null==e["!ref"])return[];var s={t:"n",v:0},r=0,a=1,n=[],i=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof d){case"string":o=vl(d);break;case"number":(o=vl(e["!ref"])).s.r=d;break;default:o=d}r>0&&(a=0);var u=ml(o.s.r),m=[],h=[],x=0,p=0,f=Array.isArray(e),g=o.s.r,b=0,v={};f&&!e[g]&&(e[g]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=o.s.c;b<=o.e.c;++b)if(!(y[b]||{}).hidden)switch(m[b]=xl(b),s=f?e[g][b]:e[m[b]+u],r){case 1:n[b]=b-o.s.c;break;case 2:n[b]=m[b];break;case 3:n[b]=c.header[b-o.s.c];break;default:if(null==s&&(s={w:"__EMPTY",t:"s"}),l=i=wl(s,null,c),p=v[i]||0){do{l=i+"_"+p++}while(v[l]);v[i]=p,v[l]=1}else v[i]=1;n[b]=l}for(g=o.s.r+a;g<=o.e.r;++g)if(!(w[g]||{}).hidden){var j=tm(e,o,g,m,r,n,f,c);(!1===j.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(h[x++]=j.row)}return h.length=x,h}var rm=/"/g;function am(e,t,s,r,a,n,i,l){for(var o=!0,c=[],d="",u=ml(s),m=t.s.c;m<=t.e.c;++m)if(r[m]){var h=l.dense?(e[s]||[])[m]:e[r[m]+u];if(null==h)d="";else if(null!=h.v){o=!1,d=""+(l.rawNumbers&&"n"==h.t?h.v:wl(h,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===a||p===n||34===p||l.forceQuotes){d='"'+d.replace(rm,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==h.f||h.F?d="":(o=!1,(d="="+h.f).indexOf(",")>=0&&(d='"'+d.replace(rm,'""')+'"'));c.push(d)}return!1===l.blankrows&&o?null:c.join(i)}function nm(e,t){var s=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=vl(e["!ref"]),n=void 0!==r.FS?r.FS:",",i=n.charCodeAt(0),l=void 0!==r.RS?r.RS:"\n",o=l.charCodeAt(0),c=new RegExp(("|"==n?"\\|":n)+"+$"),d="",u=[];r.dense=Array.isArray(e);for(var m=r.skipHidden&&e["!cols"]||[],h=r.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(m[x]||{}).hidden||(u[x]=xl(x));for(var p=0,f=a.s.r;f<=a.e.r;++f)(h[f]||{}).hidden||null!=(d=am(e,a,f,u,i,o,n,r))&&(r.strip&&(d=d.replace(c,"")),(d||!1!==r.blankrows)&&s.push((p++?l:"")+d));return delete r.dense,s.join("")}function im(e,t){return t||(t={}),t.FS="\t",t.RS="\n",nm(e,t)}function lm(e,t,s){var r,a=s||{},n=+!a.skipHeader,i=e||{},l=0,o=0;if(i&&null!=a.origin)if("number"==typeof a.origin)l=a.origin;else{var c="string"==typeof a.origin?pl(a.origin):a.origin;l=c.r,o=c.c}var d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var u=vl(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==l&&(l=u.e.r+1,d.e.r=l+t.length-1+n)}else-1==l&&(l=0,d.e.r=t.length-1+n);var m=a.header||[],h=0;t.forEach(function(e,t){xn(e).forEach(function(s){-1==(h=m.indexOf(s))&&(m[h=m.length]=s);var c=e[s],d="z",u="",x=fl({c:o+h,r:l+t+n});r=om(i,x),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",a.cellDates||(d="n",c=vn(c)),u=a.dateNF||Ca[14]):null===c&&a.nullError&&(d="e",c=0),r?(r.t=d,r.v=c,delete r.w,delete r.R,u&&(r.z=u)):i[x]=r={t:d,v:c},u&&(r.z=u)):i[x]=c})}),d.e.c=Math.max(d.e.c,o+m.length-1);var x=ml(l);if(n)for(h=0;h<m.length;++h)i[xl(h+o)+x]={t:"s",v:m[h]};return i["!ref"]=bl(d),i}function om(e,t,s){if("string"==typeof t){if(Array.isArray(e)){var r=pl(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return om(e,fl("number"!=typeof t?t:{r:t,c:s||0}))}function cm(e,t,s){return t?(e.l={Target:t},s&&(e.l.Tooltip=s)):delete e.l,e}var dm={encode_col:xl,encode_row:ml,encode_cell:fl,encode_range:bl,decode_col:hl,decode_row:ul,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:pl,decode_range:gl,format_cell:wl,sheet_add_aoa:Nl,sheet_add_json:lm,sheet_add_dom:ku,aoa_to_sheet:_l,json_to_sheet:function(e,t){return lm(null,e,t)},table_to_sheet:Cu,table_to_book:function(e,t){return jl(Cu(e,t),t)},sheet_to_csv:nm,sheet_to_txt:im,sheet_to_json:sm,sheet_to_html:_u,sheet_to_formulae:function(e){var t,s="",r="";if(null==e||null==e["!ref"])return[];var a,n=vl(e["!ref"]),i="",l=[],o=[],c=Array.isArray(e);for(a=n.s.c;a<=n.e.c;++a)l[a]=xl(a);for(var d=n.s.r;d<=n.e.r;++d)for(i=ml(d),a=n.s.c;a<=n.e.c;++a)if(s=l[a]+i,r="",void 0!==(t=c?(e[d]||[])[a]:e[s])){if(null!=t.F){if(s=t.F,!t.f)continue;r=t.f,-1==s.indexOf(":")&&(s=s+":"+s)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}o[o.length]=s+"="+r}return o},sheet_to_row_object_array:sm,sheet_get_cell:om,book_new:function(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function(e,t,s,r){var a=1;if(!s)for(;a<=65535&&-1!=e.SheetNames.indexOf(s="Sheet"+a);++a,s=void 0);if(!s||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(s)>=0){var n=s.match(/(^.*?)(\d+)$/);a=n&&+n[2]||0;var i=n&&n[1]||s;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(s=i+a);++a);}if(Yd(s),e.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return e.SheetNames.push(s),e.Sheets[s]=t,s},book_set_sheet_visibility:function(e,t,s){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var s=e.SheetNames.indexOf(t);if(s>-1)return s;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}e.Workbook.Sheets[r].Hidden=s},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:cm,cell_set_internal_link:function(e,t,s){return cm(e,"#"+t,s)},cell_add_comment:function(e,t,s){e.c||(e.c=[]),e.c.push({t:t,a:s||"SheetJS"})},sheet_set_array_formula:function(e,t,s,r){for(var a="string"!=typeof t?t:vl(t),n="string"==typeof t?t:bl(t),i=a.s.r;i<=a.e.r;++i)for(var l=a.s.c;l<=a.e.c;++l){var o=om(e,i,l);o.t="n",o.F=n,delete o.v,i==a.s.r&&l==a.s.c&&(o.f=s,r&&(o.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const um=[{key:"cost",label:"Investimento",color:"#dc2626",icon:R,yAxisId:"right"},{key:"impressions",label:"Impressões",color:"#3b82f6",icon:o,yAxisId:"left"},{key:"clicks",label:"Cliques",color:"#8b5cf6",icon:se,yAxisId:"left"},{key:"leads",label:"Leads",color:"#f59e0b",icon:E,yAxisId:"left"},{key:"transactions",label:"Transações",color:"#ef4444",icon:f,yAxisId:"left"},{key:"revenue",label:"Receita",color:"#10b981",icon:R,yAxisId:"right"},{key:"transactions_first",label:"1ª Compra",color:"#06b6d4",icon:E,yAxisId:"left"},{key:"revenue_first",label:"Receita 1ª",color:"#059669",icon:R,yAxisId:"right"},{key:"ctr",label:"CTR (%)",color:"#7c3aed",icon:h,yAxisId:"left"},{key:"cpc",label:"CPC",color:"#d97706",icon:R,yAxisId:"right"},{key:"cpv",label:"CPV",color:"#dc2626",icon:R,yAxisId:"right"},{key:"cpa",label:"CPA",color:"#0891b2",icon:R,yAxisId:"right"},{key:"roas",label:"ROAS",color:"#16a34a",icon:v,yAxisId:"left"},{key:"roas_first",label:"ROAS 1ª",color:"#0d9488",icon:v,yAxisId:"left"}],mm=({data:t,title:s})=>{const[r,a]=e.useState(["cost","revenue"]),[n,i]=e.useState(!1),[l,o]=e.useState(""),c=({active:e,payload:t,label:s})=>e&&t&&t.length?$e.jsxs("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-lg",children:[$e.jsx("p",{className:"font-semibold text-gray-900 mb-2",children:fs(s).toLocaleDateString("pt-BR")}),t.map((e,t)=>{const s=um.find(t=>t.key===e.dataKey);if(!s)return null;const r=e.value,a=s.key.includes("cost")||s.key.includes("cpc")||s.key.includes("cpv")||s.key.includes("cpa")||s.key.includes("revenue")?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r):s.key.includes("ctr")||s.key.includes("roas")?`${r.toFixed(2)}${s.key.includes("ctr")?"%":"x"}`:new Intl.NumberFormat("pt-BR").format(r);return $e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),$e.jsxs("span",{className:"text-gray-600",children:[s.label,":"]}),$e.jsx("span",{className:"font-medium text-gray-900",children:a})]},t)})]}):null,d=um.filter(e=>r.includes(e.key));return $e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s}),$e.jsx("div",{className:"relative",children:$e.jsxs("button",{onClick:()=>i(!n),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(n?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),$e.jsx("span",{children:"Métricas"}),$e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+(n?"bg-white/20 text-white":"bg-blue-100 text-blue-600"),children:r.length}),$e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]}),n&&$e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[$e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>{i(!1),o("")}}),$e.jsx("div",{className:"absolute top-20 right-6 w-96 max-w-[calc(100vw-3rem)]",children:$e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden animate-in slide-in-from-top-2 duration-300",children:[$e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Selecionar Métricas"}),$e.jsx("p",{className:"text-blue-100 text-sm",children:"Escolha quais métricas exibir no gráfico"})]})]}),$e.jsx("button",{onClick:()=>{i(!1),o("")},className:"w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("input",{type:"text",placeholder:"Buscar métricas...",value:l,onChange:e=>o(e.target.value),className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),l&&$e.jsx("button",{onClick:()=>o(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:$e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[l&&(um.some(e=>e.label.toLowerCase().includes(l.toLowerCase())||e.key.toLowerCase().includes(l.toLowerCase()))?null:$e.jsxs("div",{className:"text-center py-8",children:[$e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:$e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma métrica encontrada"}),$e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'Tente buscar por termos como "receita", "cliques", "roas", etc.'}),$e.jsx("button",{onClick:()=>o(""),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:"Limpar busca"})]})),$e.jsx("div",{children:$e.jsx("div",{className:"space-y-2",children:um.filter(e=>!l||e.label.toLowerCase().includes(l.toLowerCase())||e.key.toLowerCase().includes(l.toLowerCase())).map(e=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:r.includes(e.key),onChange:()=>{return t=e.key,void a(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),$e.jsx(e.icon,{className:"w-4 h-4 text-gray-600"}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.label})]},e.key))})})]})}),$e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:$e.jsxs("div",{className:"flex justify-between items-center",children:[$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("button",{onClick:()=>a(um.map(e=>e.key)),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors flex items-center gap-2",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Todas"]}),$e.jsxs("button",{onClick:()=>a(["cost","revenue"]),className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-2",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Básicas"]})]}),$e.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," de ",um.length," selecionadas"]})]})})]})})]}),$e.jsx("div",{className:"h-96",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:t,children:[$e.jsx(je,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),$e.jsx(Ne,{dataKey:"date",stroke:"#666",fontSize:12,tickFormatter:e=>fs(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),$e.jsx(_e,{yAxisId:"left",stroke:"#666",fontSize:12,tickFormatter:e=>new Intl.NumberFormat("pt-BR",{notation:"compact"}).format(e)}),$e.jsx(_e,{yAxisId:"right",orientation:"right",stroke:"#666",fontSize:12,tickFormatter:e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",notation:"compact"}).format(e)}),$e.jsx(ke,{content:$e.jsx(c,{})}),d.map(e=>$e.jsx(Ce,{type:"monotone",dataKey:e.key,stroke:e.color,strokeWidth:2,dot:{fill:e.color,strokeWidth:2,r:4},activeDot:{r:6,stroke:e.color,strokeWidth:2},yAxisId:e.yAxisId},e.key))]})})}),$e.jsx("div",{className:"mt-4 flex flex-wrap gap-4",children:d.map(e=>$e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),$e.jsx("span",{className:"text-gray-600",children:e.label})]},e.key))})]})},hm=({selectedTable:t,startDate:s,endDate:r,token:a})=>{const[n,i]=e.useState([]),[l,c]=e.useState(!0),[d,u]=e.useState("cost"),[m,x]=e.useState("desc"),[p,g]=e.useState(""),[j,N]=e.useState(""),[_,k]=e.useState(""),[S,T]=e.useState(!1),[P,M]=e.useState("origin_stack"),[L,O]=e.useState(!1),[I,D]=e.useState(!1),[F,B]=e.useState(!1),[$,z]=e.useState(null),[V,W]=e.useState(null),[H,G]=e.useState(null),[q,Y]=e.useState(!0),[K,X]=e.useState(!1),[J,Z]=e.useState(!1),[Q,ee]=e.useState(!1),[te,ne]=e.useState({}),[ie,le]=e.useState(!1),[oe,ce]=e.useState(!1),[de,ue]=e.useState("overview"),[me,he]=e.useState([]),[xe,pe]=e.useState(!1),[fe,ge]=e.useState("campaign"),[be,ve]=e.useState(null),[we,je]=e.useState(null),[Ne,_e]=e.useState((()=>{const e=localStorage.getItem("paidMediaCreativeVisibleColumns");if(e)try{return JSON.parse(e)}catch{return{platform:!0,campaign_name:!0,cost:!0,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!0,transactions_first:!1,transactions_delta:!0,new_customers_percentage:!0,revenue:!0,revenue_first:!1,cpv:!1,cpa:!1,cpa_delta:!0,roas:!0,roas_first:!1}}return{platform:!0,campaign_name:!0,cost:!0,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!0,transactions_first:!1,transactions_delta:!0,new_customers_percentage:!0,revenue:!0,revenue_first:!1,cpv:!1,cpa:!1,cpa_delta:!0,roas:!0,roas_first:!1}})()),[Ce,Se]=e.useState(!1);e.useEffect(()=>{localStorage.setItem("paidMediaCreativeVisibleColumns",JSON.stringify(Ne))},[Ne]);const[Re,Pe]=e.useState((()=>{const e=localStorage.getItem("paidMediaVisibleColumns");if(e)try{return JSON.parse(e)}catch{return{platform:!0,campaign_name:!0,cost:!0,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!0,transactions_first:!1,transactions_delta:!0,new_customers_percentage:!0,revenue:!0,revenue_first:!1,roas:!0,roas_first:!1,cpv:!1,cpa:!1,cpa_delta:!0}}return{platform:!0,campaign_name:!0,cost:!0,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!0,transactions_first:!1,transactions_delta:!0,new_customers_percentage:!0,revenue:!0,revenue_first:!1,roas:!0,roas_first:!1,cpv:!1,cpa:!1,cpa_delta:!0}})()),[Me,Le]=e.useState(!1);e.useEffect(()=>{localStorage.setItem("paidMediaVisibleColumns",JSON.stringify(Re))},[Re]);Ur((()=>{try{if(l)return"🔄 Carregando... - Mídia Paga";if(ie)return"🔄 Atualizando... - Mídia Paga";if(Be&&Be.length>0){const e=Be.reduce((e,t)=>e+t.cost,0),t=Be.reduce((e,t)=>e+t.revenue,0),a=e>0?(t/e).toFixed(1):"0.0",n=fs(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),i=fs(r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),l=$?` | Filtrado: ${$}`:"";return`✅ ${Be.length} campanhas | R$ ${e.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0})} | ROAS ${a}x | ${n} - ${i}${l} - Mídia Paga`}return"Mídia Paga - Dashboard"}catch(e){return"Mídia Paga - Dashboard"}})());const Oe=()=>"campaign"===fe?"Campanhas":"adgroup"===fe?"Grupos de Anúncio":"Criativos",Ie=()=>"campaign"===fe?"adgroup":"adgroup"===fe?"creative":null,De=()=>null!==Ie();e.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("auth-token");if(!e)return void c(!1);if(!is(t))return void c(!1);c(!0);const a=await ls.getAdsCampaigns(e,{start_date:s,end_date:r,table_name:t,last_cache:q,force_refresh:!1});i(a.data||[]),W(a.cache_info||null),G(a.summary||null),Z(!1)}catch(e){i([])}finally{c(!1)}})()},[t,P,s,r]),e.useEffect(()=>{"creatives"===de&&(async(e=!1)=>{if(is(t)){pe(!0);try{const n={start_date:s,end_date:r,table_name:t,last_cache:q&&!e,force_refresh:e},i=await ls.getAdsCreatives(a,n),l=(i.data||[]).map(e=>({platform:e.platform,campaign_name:e.campaign_name,ad_group_name:e.adset_name||e.ad_group_name||"N/A",creative_name:e.ad_name||e.creative_name||"N/A",date:e.date,cost:e.cost,impressions:e.impressions,clicks:e.clicks,leads:e.leads,transactions:e.transactions,revenue:e.revenue,transactions_first:e.transactions_first,revenue_first:e.revenue_first,transactions_origin_stack:e.transactions_origin_stack,revenue_origin_stack:e.revenue_origin_stack,transactions_first_origin_stack:e.transactions_first_origin_stack,revenue_first_origin_stack:e.revenue_first_origin_stack}));he(l),W(i.cache_info||null)}catch(n){he([]),W(null)}finally{pe(!1)}}})()},[de,t,s,r,a]);const Fe=()=>{if(!V)return!1;const e=new Date(V.cached_at+"Z");return((new Date).getTime()-e.getTime())/36e5>4},Be=n.filter(e=>{const t=!$||e.campaign_name===$,s="overview"!==de||!p||e.platform===p,r=!j||(e.campaign_name.toLowerCase().includes(j.toLowerCase())||e.platform.toLowerCase().includes(j.toLowerCase()));return t&&s&&r});new Set(n.map(e=>e.platform));const ze=Be.length>0?Be.reduce((e,t)=>{const s=`${t.platform}-${t.campaign_name}`;return e[s]||(e[s]={platform:t.platform,campaign_name:t.campaign_name,cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0,transactions_origin_stack:0,revenue_origin_stack:0,transactions_first_origin_stack:0,revenue_first_origin_stack:0,records:[]}),e[s].cost+=t.cost,e[s].impressions+=t.impressions,e[s].clicks+=t.clicks,e[s].leads+=t.leads,"origin_stack"===P?(e[s].transactions+=t.transactions_origin_stack,e[s].revenue+=t.revenue_origin_stack,e[s].transactions_first+=t.transactions_first_origin_stack,e[s].revenue_first+=t.revenue_first_origin_stack):(e[s].transactions+=t.transactions,e[s].revenue+=t.revenue,e[s].transactions_first+=t.transactions_first,e[s].revenue_first+=t.revenue_first),e[s].transactions_origin_stack+=t.transactions_origin_stack,e[s].revenue_origin_stack+=t.revenue_origin_stack,e[s].transactions_first_origin_stack+=t.transactions_first_origin_stack,e[s].revenue_first_origin_stack+=t.revenue_first_origin_stack,e[s].fsm_transactions+=t.fsm_transactions||0,e[s].records.push(t),e},{}):{},Ve=Object.values(ze),Ue=(We=Ve,[...We].sort((e,t)=>{let s,r;switch(d){case"campaign_name":s=e.campaign_name,r=t.campaign_name;break;case"platform":s=e.platform,r=t.platform;break;case"cost":default:s=e.cost,r=t.cost;break;case"impressions":s=e.impressions,r=t.impressions;break;case"clicks":s=e.clicks,r=t.clicks;break;case"ctr":s=e.impressions>0?e.clicks/e.impressions*100:0,r=t.impressions>0?t.clicks/t.impressions*100:0;break;case"cpc":s=e.clicks>0?e.cost/e.clicks:0,r=t.clicks>0?t.cost/t.clicks:0;break;case"leads":s=e.leads,r=t.leads;break;case"transactions":s=e.transactions,r=t.transactions;break;case"transactions_first":s=e.transactions_first,r=t.transactions_first;break;case"transactions_delta":const a=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.revenue,0):e.revenue,n=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):e.revenue_origin_stack,i=e.cost>0?a/e.cost:0,l=e.cost>0?n/e.cost:0;s=i>0?(l-i)/i*100:0;const o=t.records&&t.records.length>0?t.records.reduce((e,t)=>e+t.revenue,0):t.revenue,c=t.records&&t.records.length>0?t.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):t.revenue_origin_stack,d=t.cost>0?o/t.cost:0,u=t.cost>0?c/t.cost:0;r=d>0?(u-d)/d*100:0;break;case"new_customers_percentage":const m="origin_stack"===P&&e.transactions_origin_stack||e.transactions,h="origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first;s=m>0?h/m*100:0;const x="origin_stack"===P&&t.transactions_origin_stack||t.transactions,p="origin_stack"===P&&t.transactions_first_origin_stack||t.transactions_first;r=x>0?p/x*100:0;break;case"revenue":s=e.revenue,r=t.revenue;break;case"revenue_first":s=e.revenue_first,r=t.revenue_first;break;case"roas":s=e.cost>0?e.revenue/e.cost:0,r=t.cost>0?t.revenue/t.cost:0;break;case"roas_first":s=e.cost>0?e.revenue_first/e.cost:0,r=t.cost>0?t.revenue_first/t.cost:0;break;case"cpv":s=e.transactions>0?e.cost/e.transactions:0,r=t.transactions>0?t.cost/t.transactions:0;break;case"cpa":s=e.transactions_first>0?e.cost/e.transactions_first:0,r=t.transactions_first>0?t.cost/t.transactions_first:0;break;case"cpa_delta":const f=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.transactions_first,0):e.transactions_first,g=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):e.transactions_first_origin_stack,b=f>0?e.cost/f:0,v=g>0?e.cost/g:0;s=b>0?(b-v)/b*100:0;const y=t.records&&t.records.length>0?t.records.reduce((e,t)=>e+t.transactions_first,0):t.transactions_first,w=t.records&&t.records.length>0?t.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):t.transactions_first_origin_stack,j=y>0?t.cost/y:0,N=w>0?t.cost/w:0;r=j>0?(j-N)/j*100:0}return"string"==typeof s&&(s=s.toLowerCase(),r=r.toLowerCase()),s<r?"asc"===m?-1:1:s>r?"asc"===m?1:-1:0}));var We;const He=S?Ue:Ue.slice(0,10),Ge=Ue.length>10,qe=(()=>{let e=me.filter(e=>{const t="creatives"!==de||!p||e.platform===p,s=!j||e.campaign_name.toLowerCase().includes(j.toLowerCase())||e.ad_group_name.toLowerCase().includes(j.toLowerCase())||e.creative_name.toLowerCase().includes(j.toLowerCase());let r=!0;be&&(r=r&&e.campaign_name===be),we&&(r=r&&e.ad_group_name===we);return t&&s&&r});if("adgroup"===fe&&be&&me.filter(e=>e.campaign_name===be),0===e.length&&be&&me.filter(e=>e.campaign_name===be),"campaign"===fe){return e.reduce((e,t)=>{const s=t.campaign_name;return e[s]||(e[s]={platform:t.platform,campaign_name:t.campaign_name,cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0,transactions_origin_stack:0,revenue_origin_stack:0,transactions_first_origin_stack:0,revenue_first_origin_stack:0,fsm_transactions:0}),e[s].cost+=t.cost,e[s].impressions+=t.impressions,e[s].clicks+=t.clicks,e[s].leads+=t.leads,e[s].transactions+=t.transactions,e[s].revenue+=t.revenue,e[s].transactions_first+=t.transactions_first,e[s].revenue_first+=t.revenue_first,e[s].transactions_origin_stack+=t.transactions_origin_stack,e[s].revenue_origin_stack+=t.revenue_origin_stack,e[s].transactions_first_origin_stack+=t.transactions_first_origin_stack,e[s].revenue_first_origin_stack+=t.revenue_first_origin_stack,e[s].fsm_transactions+=t.fsm_transactions||0,e},{})}if("adgroup"===fe){return e.reduce((e,t)=>{const s=t.ad_group_name;return e[s]||(e[s]={platform:t.platform,campaign_name:t.campaign_name,ad_group_name:t.ad_group_name,cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0,transactions_origin_stack:0,revenue_origin_stack:0,transactions_first_origin_stack:0,revenue_first_origin_stack:0,fsm_transactions:0}),e[s].cost+=t.cost,e[s].impressions+=t.impressions,e[s].clicks+=t.clicks,e[s].leads+=t.leads,e[s].transactions+=t.transactions,e[s].revenue+=t.revenue,e[s].transactions_first+=t.transactions_first,e[s].revenue_first+=t.revenue_first,e[s].transactions_origin_stack+=t.transactions_origin_stack,e[s].revenue_origin_stack+=t.revenue_origin_stack,e[s].transactions_first_origin_stack+=t.transactions_first_origin_stack,e[s].revenue_first_origin_stack+=t.revenue_first_origin_stack,e[s].fsm_transactions+=t.fsm_transactions||0,e},{})}return e.reduce((e,t)=>{const s=t.creative_name;return e[s]||(e[s]={platform:t.platform,campaign_name:t.campaign_name,ad_group_name:t.ad_group_name,creative_name:t.creative_name,cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0,transactions_origin_stack:0,revenue_origin_stack:0,transactions_first_origin_stack:0,revenue_first_origin_stack:0,fsm_transactions:0}),e[s].cost+=t.cost,e[s].impressions+=t.impressions,e[s].clicks+=t.clicks,e[s].leads+=t.leads,e[s].transactions+=t.transactions,e[s].revenue+=t.revenue,e[s].transactions_first+=t.transactions_first,e[s].revenue_first+=t.revenue_first,e[s].transactions_origin_stack+=t.transactions_origin_stack,e[s].revenue_origin_stack+=t.revenue_origin_stack,e[s].transactions_first_origin_stack+=t.transactions_first_origin_stack,e[s].revenue_first_origin_stack+=t.revenue_first_origin_stack,e[s].fsm_transactions+=t.fsm_transactions||0,e},{})})(),Ye=Object.values(qe).sort((e,t)=>{const s=e[d]||0,r=t[d]||0;return"asc"===m?s-r:r-s}),Ke=Ve.length>0?Ve.reduce((e,t)=>({cost:e.cost+t.cost,impressions:e.impressions+t.impressions,clicks:e.clicks+t.clicks,leads:e.leads+t.leads,transactions:e.transactions+("origin_stack"===P&&t.transactions_origin_stack||t.transactions),revenue:e.revenue+("origin_stack"===P&&t.revenue_origin_stack||t.revenue),transactions_first:e.transactions_first+("origin_stack"===P&&t.transactions_first_origin_stack||t.transactions_first),revenue_first:e.revenue_first+("origin_stack"===P&&t.revenue_first_origin_stack||t.revenue_first)}),{cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0}):{cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0},Xe=Ye.length>0?Ye.reduce((e,t)=>({cost:e.cost+t.cost,impressions:e.impressions+t.impressions,clicks:e.clicks+t.clicks,leads:e.leads+t.leads,transactions:e.transactions+("origin_stack"===P&&t.transactions_origin_stack||t.transactions),revenue:e.revenue+("origin_stack"===P&&t.revenue_origin_stack||t.revenue),transactions_first:e.transactions_first+("origin_stack"===P&&t.transactions_first_origin_stack||t.transactions_first),revenue_first:e.revenue_first+("origin_stack"===P&&t.revenue_first_origin_stack||t.revenue_first),transactions_origin_stack:e.transactions_origin_stack+(t.transactions_origin_stack||0),revenue_origin_stack:e.revenue_origin_stack+(t.revenue_origin_stack||0),transactions_first_origin_stack:e.transactions_first_origin_stack+(t.transactions_first_origin_stack||0),revenue_first_origin_stack:e.revenue_first_origin_stack+(t.revenue_first_origin_stack||0)}),{cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0,transactions_origin_stack:0,revenue_origin_stack:0,transactions_first_origin_stack:0,revenue_first_origin_stack:0,fsm_transactions:0}):{cost:0,impressions:0,clicks:0,leads:0,transactions:0,revenue:0,transactions_first:0,revenue_first:0},Je=Ye.length>0?Ye.reduce((e,t)=>({transactions:e.transactions+(t.transactions_origin_stack||0),revenue:e.revenue+(t.revenue_origin_stack||0),transactions_first:e.transactions_first+(t.transactions_first_origin_stack||0),revenue_first:e.revenue_first+(t.revenue_first_origin_stack||0)}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0}):{transactions:0,revenue:0,transactions_first:0,revenue_first:0},Ze=Ye.length>0?Ye.reduce((e,t)=>({transactions:e.transactions+t.transactions,revenue:e.revenue+t.revenue,transactions_first:e.transactions_first+t.transactions_first,revenue_first:e.revenue_first+t.revenue_first}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0}):{transactions:0,revenue:0,transactions_first:0,revenue_first:0},Qe=Ke.impressions>0?Ke.clicks/Ke.impressions*100:0,et=Ke.clicks>0?Ke.cost/Ke.clicks:0,tt=Ke.transactions>0?Ke.cost/Ke.transactions:0,st=Ke.transactions_first>0?Ke.cost/Ke.transactions_first:0,rt=Ke.leads>0?Ke.cost/Ke.leads:0,at=Ke.impressions>0?Ke.cost/Ke.impressions*1e3:0,nt=Ke.cost>0?Ke.revenue/Ke.cost:0,it=Ke.cost>0?Ke.revenue_first/Ke.cost:0,lt=[...new Set(Be.map(e=>e.platform))],ot=lt.length>0?lt.map(e=>{const t=Ve.filter(t=>t.platform===e);return{name:e,cost:t.reduce((e,t)=>e+t.cost,0),impressions:t.reduce((e,t)=>e+t.impressions,0),clicks:t.reduce((e,t)=>e+t.clicks,0),revenue:t.reduce((e,t)=>e+t.revenue,0)}}).filter(e=>e.cost>0):[],ct=["#64748b","#94a3b8","#cbd5e1","#e2e8f0","#f1f5f9"],dt=e=>{const t=e.toLowerCase();return t.includes("google")||t.includes("ads")&&!t.includes("meta")?"#10b981":t.includes("meta")||t.includes("facebook")||t.includes("instagram")||"meta_ads"===t?"#3b82f6":ct[0]},ut=n.length>0?{last_non_direct:n.reduce((e,t)=>({transactions:e.transactions+t.transactions,revenue:e.revenue+t.revenue,transactions_first:e.transactions_first+t.transactions_first,revenue_first:e.revenue_first+t.revenue_first}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0}),origin_stack:n.reduce((e,t)=>({transactions:e.transactions+t.transactions_origin_stack,revenue:e.revenue+t.revenue_origin_stack,transactions_first:e.transactions_first+t.transactions_first_origin_stack,revenue_first:e.revenue_first+t.revenue_first_origin_stack}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0})}:{last_non_direct:{transactions:0,revenue:0,transactions_first:0,revenue_first:0},origin_stack:{transactions:0,revenue:0,transactions_first:0,revenue_first:0}},mt=n.length>0?{google:{last_non_direct:n.filter(e=>{var t,s,r;return(null==(t=e.platform)?void 0:t.toLowerCase().includes("google"))||(null==(s=e.platform)?void 0:s.toLowerCase().includes("ads"))&&!(null==(r=e.platform)?void 0:r.toLowerCase().includes("meta"))}).reduce((e,t)=>({transactions:e.transactions+t.transactions,revenue:e.revenue+t.revenue,transactions_first:e.transactions_first+t.transactions_first,revenue_first:e.revenue_first+t.revenue_first,cost:e.cost+t.cost}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0}),origin_stack:n.filter(e=>{var t,s,r;return(null==(t=e.platform)?void 0:t.toLowerCase().includes("google"))||(null==(s=e.platform)?void 0:s.toLowerCase().includes("ads"))&&!(null==(r=e.platform)?void 0:r.toLowerCase().includes("meta"))}).reduce((e,t)=>({transactions:e.transactions+t.transactions_origin_stack,revenue:e.revenue+t.revenue_origin_stack,transactions_first:e.transactions_first+t.transactions_first_origin_stack,revenue_first:e.revenue_first+t.revenue_first_origin_stack,cost:e.cost+t.cost}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0})},meta:{last_non_direct:n.filter(e=>{var t,s,r;return(null==(t=e.platform)?void 0:t.toLowerCase().includes("meta"))||(null==(s=e.platform)?void 0:s.toLowerCase().includes("facebook"))||(null==(r=e.platform)?void 0:r.toLowerCase().includes("instagram"))}).reduce((e,t)=>({transactions:e.transactions+t.transactions,revenue:e.revenue+t.revenue,transactions_first:e.transactions_first+t.transactions_first,revenue_first:e.revenue_first+t.revenue_first,cost:e.cost+t.cost}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0}),origin_stack:n.filter(e=>{var t,s,r;return(null==(t=e.platform)?void 0:t.toLowerCase().includes("meta"))||(null==(s=e.platform)?void 0:s.toLowerCase().includes("facebook"))||(null==(r=e.platform)?void 0:r.toLowerCase().includes("instagram"))}).reduce((e,t)=>({transactions:e.transactions+t.transactions_origin_stack,revenue:e.revenue+t.revenue_origin_stack,transactions_first:e.transactions_first+t.transactions_first_origin_stack,revenue_first:e.revenue_first+t.revenue_first_origin_stack,cost:e.cost+t.cost}),{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0})}}:{google:{last_non_direct:{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0},origin_stack:{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0}},meta:{last_non_direct:{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0},origin_stack:{transactions:0,revenue:0,transactions_first:0,revenue_first:0,cost:0}}},ht={cpv:ut.last_non_direct.transactions>0?Ke.cost/ut.last_non_direct.transactions:0,roas:Ke.cost>0?ut.last_non_direct.revenue/Ke.cost:0,cpa:ut.last_non_direct.transactions_first>0?Ke.cost/ut.last_non_direct.transactions_first:0,roasFirst:Ke.cost>0?ut.last_non_direct.revenue_first/Ke.cost:0},xt={cpv:ut.origin_stack.transactions>0?Ke.cost/ut.origin_stack.transactions:0,roas:Ke.cost>0?ut.origin_stack.revenue/Ke.cost:0,cpa:ut.origin_stack.transactions_first>0?Ke.cost/ut.origin_stack.transactions_first:0,roasFirst:Ke.cost>0?ut.origin_stack.revenue_first/Ke.cost:0},pt={lastNonDirect:{cpv:mt.google.last_non_direct.transactions>0?mt.google.last_non_direct.cost/mt.google.last_non_direct.transactions:0,roas:mt.google.last_non_direct.cost>0?mt.google.last_non_direct.revenue/mt.google.last_non_direct.cost:0,cpa:mt.google.last_non_direct.transactions_first>0?mt.google.last_non_direct.cost/mt.google.last_non_direct.transactions_first:0,roasFirst:mt.google.last_non_direct.cost>0?mt.google.last_non_direct.revenue_first/mt.google.last_non_direct.cost:0},originStack:{cpv:mt.google.origin_stack.transactions>0?mt.google.origin_stack.cost/mt.google.origin_stack.transactions:0,roas:mt.google.origin_stack.cost>0?mt.google.origin_stack.revenue/mt.google.origin_stack.cost:0,cpa:mt.google.origin_stack.transactions_first>0?mt.google.origin_stack.cost/mt.google.origin_stack.transactions_first:0,roasFirst:mt.google.origin_stack.cost>0?mt.google.origin_stack.revenue_first/mt.google.origin_stack.cost:0}},ft={lastNonDirect:{cpv:mt.meta.last_non_direct.transactions>0?mt.meta.last_non_direct.cost/mt.meta.last_non_direct.transactions:0,roas:mt.meta.last_non_direct.cost>0?mt.meta.last_non_direct.revenue/mt.meta.last_non_direct.cost:0,cpa:mt.meta.last_non_direct.transactions_first>0?mt.meta.last_non_direct.cost/mt.meta.last_non_direct.transactions_first:0,roasFirst:mt.meta.last_non_direct.cost>0?mt.meta.last_non_direct.revenue_first/mt.meta.last_non_direct.cost:0},originStack:{cpv:mt.meta.origin_stack.transactions>0?mt.meta.origin_stack.cost/mt.meta.origin_stack.transactions:0,roas:mt.meta.origin_stack.cost>0?mt.meta.origin_stack.revenue/mt.meta.origin_stack.cost:0,cpa:mt.meta.origin_stack.transactions_first>0?mt.meta.origin_stack.cost/mt.meta.origin_stack.transactions_first:0,roasFirst:mt.meta.origin_stack.cost>0?mt.meta.origin_stack.revenue_first/mt.meta.origin_stack.cost:0}},gt=e=>{d===e?x("asc"===m?"desc":"asc"):(u(e),x("desc"))},bt=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),vt=Xe.impressions>0?Xe.clicks/Xe.impressions*100:0,yt=Xe.clicks>0?Xe.cost/Xe.clicks:0,wt=Xe.transactions>0?Xe.cost/Xe.transactions:0,jt=Xe.leads>0?Xe.cost/Xe.leads:0,Nt=e=>new Intl.NumberFormat("pt-BR").format(e),_t=Be.length>0?Be.reduce((e,t)=>{const s=e.find(e=>e.date===t.date);if(s)s.cost+=t.cost,s.impressions+=t.impressions,s.clicks+=t.clicks,s.leads+=t.leads,"origin_stack"===P?(s.transactions+=t.transactions_origin_stack,s.revenue+=t.revenue_origin_stack,s.transactions_first+=t.transactions_first_origin_stack,s.revenue_first+=t.revenue_first_origin_stack):(s.transactions+=t.transactions,s.revenue+=t.revenue,s.transactions_first+=t.transactions_first,s.revenue_first+=t.revenue_first);else{const s={date:t.date,cost:t.cost,impressions:t.impressions,clicks:t.clicks,leads:t.leads,transactions:"origin_stack"===P?t.transactions_origin_stack:t.transactions,revenue:"origin_stack"===P?t.revenue_origin_stack:t.revenue,transactions_first:"origin_stack"===P?t.transactions_first_origin_stack:t.transactions_first,revenue_first:"origin_stack"===P?t.revenue_first_origin_stack:t.revenue_first,ctr:0,cpc:0,cpv:0,cpa:0,roas:0,roas_first:0};e.push(s)}return e},[]).map(e=>({...e,ctr:e.impressions>0?e.clicks/e.impressions*100:0,cpc:e.clicks>0?e.cost/e.clicks:0,cpv:e.transactions>0?e.cost/e.transactions:0,cpa:e.transactions_first>0?e.cost/e.transactions_first:0,roas:e.cost>0?e.revenue/e.cost:0,roas_first:e.cost>0?e.revenue_first/e.cost:0})).sort((e,t)=>{return s=e.date,r=t.date,s<r?-1:s>r?1:0;var s,r}):[],kt=me.length>0?me.reduce((e,t)=>{const s=e.find(e=>e.date===t.date);return s?(s.cost+=t.cost,s.impressions+=t.impressions,s.clicks+=t.clicks,s.leads+=t.leads,s.transactions+=t.transactions,s.revenue+=t.revenue,s.transactions_first+=t.transactions_first,s.revenue_first+=t.revenue_first):e.push({date:t.date,cost:t.cost,impressions:t.impressions,clicks:t.clicks,leads:t.leads,transactions:t.transactions,revenue:t.revenue,transactions_first:t.transactions_first,revenue_first:t.revenue_first,ctr:0,cpc:0,cpv:0,cpa:0,roas:0,roas_first:0}),e},[]).map(e=>({...e,ctr:e.impressions>0?e.clicks/e.impressions*100:0,cpc:e.clicks>0?e.cost/e.clicks:0,cpv:e.transactions>0?e.cost/e.transactions:0,cpa:e.transactions_first>0?e.cost/e.transactions_first:0,roas:e.cost>0?e.revenue/e.cost:0,roas_first:e.cost>0?e.revenue_first/e.cost:0})).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[];return _t.reduce((e,t)=>e+t.revenue,0),_t.reduce((e,t)=>e+t.revenue_first,0),l?$e.jsx("div",{className:"flex items-center justify-center py-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Aguarde, seus dados serão carregados"})]})}):0!==n.length||l?0===Be.length&&n.length>0?$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum resultado encontrado"}),$e.jsxs("p",{className:"text-gray-600 mb-4",children:["Nenhuma campanha corresponde aos filtros aplicados.",$&&$e.jsxs("span",{className:"block mt-2 text-sm text-blue-600",children:["Filtro ativo: ",$e.jsx("strong",{children:$})]})]}),$e.jsx("button",{onClick:()=>{z(null),g(""),N("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Limpar Filtros"})]}):$e.jsxs("div",{className:""+(oe?"fixed inset-0 z-50 bg-white overflow-auto":"space-y-6"),children:[$e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),$e.jsx("span",{className:"text-sm font-medium text-blue-800",children:K?"Atualizando em background...":q?J?"Dados Atualizados (sem cache)":"Dados do Cache":"Dados Atualizados"}),V&&q&&$e.jsxs("span",{className:"text-xs "+(Fe()?"text-orange-600":"text-blue-600"),children:["de ",new Date(V.cached_at+"Z").toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).replace(",",""),Fe()&&$e.jsx("span",{className:"ml-1 text-orange-500",children:"(desatualizado)"})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[(!V||Fe()||K)&&$e.jsx("button",{onClick:async()=>{X(!0);try{let e=localStorage.getItem("auth-token");if(!e)return;if(!is(t))return;await new Promise(e=>setTimeout(e,1e3)),e=localStorage.getItem("auth-token");const a=await ls.getAdsCampaigns(e||"",{start_date:s,end_date:r,table_name:t,force_refresh:!0});i(a.data||[]),W(a.cache_info||null),G(a.summary||null),Z(!1),ee(!1)}catch(e){if(e instanceof Error&&(/5\d{2}/.test(e.message)||e.status&&e.status>=500&&e.status<600||e.isNetworkError||e.message.includes("Failed to fetch")||e.message.includes("Network error"))){ee(!0);try{const e=localStorage.getItem("auth-token"),s=await ls.getAdsCampaigns(e||"",{table_name:t,last_cache:!0});i(s.data||[]),W(s.cache_info||null),G(s.summary||null),Z(!1)}catch(a){}}}finally{X(!1)}},disabled:K,className:"flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-colors "+(K?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:K?$e.jsxs($e.Fragment,{children:[$e.jsx("div",{className:"w-3 h-3 border border-gray-400 border-t-transparent rounded-full animate-spin"}),"Atualizando..."]}):$e.jsxs($e.Fragment,{children:[$e.jsx(v,{className:"w-3 h-3"}),"Atualizar Dados"]})}),ie&&$e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 text-xs font-medium text-orange-600 bg-orange-50 rounded-md border border-orange-200",children:[$e.jsx("div",{className:"w-3 h-3 border border-orange-600 border-t-transparent rounded-full animate-spin"}),"Atualizando em background..."]})]})]})}),$e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Modelo de Atribuição"}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(h,{className:"w-4 h-4 text-gray-500"}),$e.jsxs("select",{value:P,onChange:e=>M(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white min-w-[200px]",children:[$e.jsx("option",{value:"origin_stack",children:"Origin Stack (Padrão)"}),$e.jsx("option",{value:"last_non_direct",children:"Last Non-Direct (Alternativo)"})]})]})]}),$e.jsxs("div",{className:"text-sm text-gray-600",children:[$e.jsx("span",{className:"font-medium",children:"origin_stack"===P?"Origin Stack":"Last Non-Direct Session"}),$e.jsxs("span",{className:"ml-2 text-gray-400",children:["• ","origin_stack"===P?"Atribui conversões ao primeiro toque da jornada":"Atribui conversões ao último toque não direto"]})]})]})}),$e.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:$e.jsx("div",{className:"border-b border-gray-200",children:$e.jsxs("nav",{className:"-mb-px flex space-x-8 px-6",children:[$e.jsxs("button",{onClick:()=>ue("overview"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("overview"===de?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[$e.jsx(y,{className:"h-4 w-4"}),$e.jsx("span",{children:"Visão Geral"})]}),$e.jsxs("button",{onClick:()=>ue("creatives"),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+("creatives"===de?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[$e.jsx(U,{className:"h-4 w-4"}),$e.jsx("span",{children:"Criativos"})]})]})})}),"overview"===de&&$e.jsxs("div",{className:"space-y-6",children:[$e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtrar por Plataforma"}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsx("button",{onClick:()=>g(""),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(""===p?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:"Todas"}),$e.jsxs("button",{onClick:()=>g("google_ads"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 "+("google_ads"===p?"bg-green-600 text-white shadow-md":"bg-green-50 text-green-700 hover:bg-green-100 border border-green-200"),children:[$e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Google Ads"]}),$e.jsxs("button",{onClick:()=>g("meta_ads"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 "+("meta_ads"===p?"bg-blue-600 text-white shadow-md":"bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200"),children:[$e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),"Meta Ads"]})]})]}),p&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[$e.jsx("span",{children:"Filtro ativo:"}),$e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("google_ads"===p?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:"google_ads"===p?"Google Ads":"Meta Ads"}),$e.jsx("button",{onClick:()=>g(""),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Limpar filtro",children:$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}),$e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-blue-50 rounded-2xl p-6 border border-slate-200",children:[$e.jsxs("div",{className:"text-center mb-4",children:[$e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"🎯 Funil de Performance"}),$e.jsx("p",{className:"text-xs text-gray-600",children:"Do investimento ao resultado"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Investimento Total"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Ke.cost)})]}),$e.jsx("div",{className:"p-2 bg-red-50 rounded-lg",children:$e.jsx(R,{className:"w-5 h-5 text-red-600"})})]})}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Impressões"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Ke.impressions)})]}),$e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:$e.jsx(o,{className:"w-5 h-5 text-blue-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPM: ",bt(at)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Cliques"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Ke.clicks)})]}),$e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:$e.jsx(se,{className:"w-5 h-5 text-green-600"})})]}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CTR: ",Qe.toFixed(1),"%"]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPC: ",bt(et)]})]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Leads"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Ke.leads)})]}),$e.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:$e.jsx(E,{className:"w-5 h-5 text-orange-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPL: ",bt(rt)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Transações"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Ke.transactions)})]}),$e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:$e.jsx(f,{className:"w-5 h-5 text-purple-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPV: ",bt(tt)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"1ª Compra"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Ke.transactions_first)})]}),$e.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg",children:$e.jsx(E,{className:"w-5 h-5 text-indigo-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPA 1ª: ",bt(st)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Receita Total"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Ke.revenue)})]}),$e.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg",children:$e.jsx(R,{className:"w-5 h-5 text-emerald-600"})})]}),$e.jsxs("span",{className:"text-xs px-2 py-1 rounded "+(nt>=3?"bg-green-100 text-green-700":nt>=2?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:["ROAS: ",nt.toFixed(2),"x"]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Receita 1ª Compra"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Ke.revenue_first)})]}),$e.jsx("div",{className:"p-2 bg-teal-50 rounded-lg",children:$e.jsx(v,{className:"w-5 h-5 text-teal-600"})})]}),$e.jsxs("span",{className:"text-xs px-2 py-1 rounded "+(it>=3?"bg-green-100 text-green-700":it>=2?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:["ROAS 1ª: ",it.toFixed(2),"x"]})]})]})]}),ot.length>1&&$e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📊 Distribuição por Plataforma"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"Investimento"}),$e.jsx(ye,{width:"100%",height:200,children:$e.jsxs(Te,{children:[$e.jsx(Ae,{data:ot.map(e=>({name:e.name,value:e.cost})),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"value",children:ot.map((e,t)=>$e.jsx(Ee,{fill:dt(e.name)},`cell-${t}`))}),$e.jsx(ke,{formatter:e=>bt(Number(e))})]})}),$e.jsx("div",{className:"mt-2 space-y-1",children:ot.map((e,t)=>$e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:dt(e.name)}}),$e.jsx("span",{className:"text-gray-600",children:e.name})]},e.name))})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"Impressões"}),$e.jsx(ye,{width:"100%",height:200,children:$e.jsxs(Te,{children:[$e.jsx(Ae,{data:ot.map(e=>({name:e.name,value:e.impressions})),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"value",children:ot.map((e,t)=>$e.jsx(Ee,{fill:dt(e.name)},`cell-${t}`))}),$e.jsx(ke,{formatter:e=>Nt(Number(e))})]})}),$e.jsx("div",{className:"mt-2 space-y-1",children:ot.map((e,t)=>$e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:dt(e.name)}}),$e.jsx("span",{className:"text-gray-600",children:e.name})]},e.name))})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"Cliques"}),$e.jsx(ye,{width:"100%",height:200,children:$e.jsxs(Te,{children:[$e.jsx(Ae,{data:ot.map(e=>({name:e.name,value:e.clicks})),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"value",children:ot.map((e,t)=>$e.jsx(Ee,{fill:dt(e.name)},`cell-${t}`))}),$e.jsx(ke,{formatter:e=>Nt(Number(e))})]})}),$e.jsx("div",{className:"mt-2 space-y-1",children:ot.map((e,t)=>$e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:dt(e.name)}}),$e.jsx("span",{className:"text-gray-600",children:e.name})]},e.name))})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"Receita"}),$e.jsx(ye,{width:"100%",height:200,children:$e.jsxs(Te,{children:[$e.jsx(Ae,{data:ot.map(e=>({name:e.name,value:e.revenue})),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"value",children:ot.map((e,t)=>$e.jsx(Ee,{fill:dt(e.name)},`cell-${t}`))}),$e.jsx(ke,{formatter:e=>bt(Number(e))})]})}),$e.jsx("div",{className:"mt-2 space-y-1",children:ot.map((e,t)=>$e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:dt(e.name)}}),$e.jsx("span",{className:"text-gray-600",children:e.name})]},e.name))})]})]})]}),"overview"===de&&_t.length>0&&$e.jsx(mm,{data:_t,title:"📈 Timeline de Performance - Mídia Paga"}),"creatives"===de&&kt&&kt.length>0&&$e.jsx(mm,{data:kt,title:"📈 Timeline de Performance - Criativos"}),$e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-gray-50 -m-6 p-6 rounded-lg transition-colors",onClick:()=>O(!L),children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"⚖️ Comparativo: Modelos de Atribuição"}),$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsxs("div",{className:"flex items-center gap-2",onClick:e=>e.stopPropagation(),children:[$e.jsx("label",{className:"text-sm text-gray-600",children:"Por plataforma:"}),$e.jsx("button",{onClick:()=>B(!F),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(F?"bg-blue-600":"bg-gray-200"),children:$e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(F?"translate-x-6":"translate-x-1")})})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-sm text-gray-500",children:L?"Minimizar":"Expandir"}),L?$e.jsx(A,{className:"w-5 h-5 text-gray-500"}):$e.jsx(C,{className:"w-5 h-5 text-gray-500"})]})]})]}),L&&$e.jsxs("div",{className:"mb-6",children:[$e.jsxs("button",{onClick:()=>D(!I),className:"w-full flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200 hover:from-blue-100 hover:to-purple-100 transition-colors",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),$e.jsxs("span",{className:"text-sm font-medium text-gray-800",children:[I?"Ocultar":"Ver"," Explicação dos Modelos de Atribuição"]})]}),$e.jsx("svg",{className:"w-4 h-4 text-blue-600 transition-transform duration-200 "+(I?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),I&&$e.jsxs("div",{className:"mt-4 p-6 bg-white rounded-lg border border-gray-200 shadow-sm",children:[$e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[$e.jsxs("div",{className:"space-y-4",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("span",{className:"w-8 h-8 bg-gray-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"L"}),$e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Last Non-Direct Session (LNDS)"})]}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Atribui 100% do crédito da conversão à última sessão não-direta antes da compra. Este modelo é ideal para entender qual foi o último canal que influenciou a decisão de compra."}),$e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[$e.jsx("h5",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Como funciona:"}),$e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[$e.jsx("li",{children:"• Identifica a última sessão antes da conversão"}),$e.jsx("li",{children:"• Ignora sessões diretas (digitação de URL)"}),$e.jsx("li",{children:"• Atribui todo o crédito a essa sessão"})]})]}),$e.jsxs("div",{className:"text-xs text-gray-500",children:[$e.jsx("strong",{children:"Melhor para:"})," Entender o último toque antes da conversão"]})]})]}),$e.jsxs("div",{className:"space-y-4",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("span",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"O"}),$e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Origin Stack"})]}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Sistema de atribuição baseado em prioridades que segue uma ordem específica na jornada do usuário. O crédito é atribuído ao primeiro evento que ocorrer na sequência."}),$e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[$e.jsx("h5",{className:"text-xs font-semibold text-blue-700 mb-2",children:"Ordem de Prioridade:"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"1"}),$e.jsx("span",{className:"text-xs text-gray-700",children:"Captura de Lead"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"2"}),$e.jsx("span",{className:"text-xs text-gray-700",children:"First Session de Mídia Paga"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:"3"}),$e.jsx("span",{className:"text-xs text-gray-700",children:"Last Session de Mídia Paga"})]})]}),$e.jsx("div",{className:"mt-2 text-xs text-blue-600 font-medium",children:"⚡ O que vier primeiro na jornada recebe o crédito"})]}),$e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[$e.jsx("h5",{className:"text-xs font-semibold text-yellow-700 mb-2",children:"Exemplos Práticos:"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:[$e.jsx("strong",{children:"Cenário 1:"})," Meta Ads (lead) → Google Ads → Conversão"]}),$e.jsxs("p",{className:"text-xs text-gray-600",children:[$e.jsx("strong",{children:"Resultado:"})," Crédito vai para Meta Ads (gerou o lead)"]})]}),$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:[$e.jsx("strong",{children:"Cenário 2:"})," Google Ads → Meta Ads (lead) → Conversão"]}),$e.jsxs("p",{className:"text-xs text-gray-600",children:[$e.jsx("strong",{children:"Resultado:"})," Crédito vai para Meta Ads (gerou o lead)"]})]}),$e.jsxs("div",{children:[$e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:[$e.jsx("strong",{children:"Cenário 3:"})," Google Ads → Facebook Ads → Conversão (sem lead)"]}),$e.jsxs("p",{className:"text-xs text-gray-600",children:[$e.jsx("strong",{children:"Resultado:"})," Crédito vai para Google Ads (1ª sessão de mídia paga)"]})]})]})]}),$e.jsxs("div",{className:"text-xs text-gray-500",children:[$e.jsx("strong",{children:"Melhor para:"})," Entender o ponto de origem na jornada de conversão"]})]})]})]}),$e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:$e.jsxs("div",{className:"flex items-start gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0",children:"💡"}),$e.jsxs("div",{className:"flex-1",children:[$e.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Dica para Melhorar o Origin Stack"}),$e.jsx("p",{className:"text-xs text-green-700 mb-3",children:"Para maximizar a eficácia do modelo Origin Stack, invista em estratégias de captura de leads:"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"1"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Popups com Cupons de Desconto"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"2"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Formulários de Newsletter"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"3"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Quiz Interativos"})]})]}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"4"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"E-books e Materiais Gratuitos"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"5"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Webinars e Lives"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"w-4 h-4 bg-green-400 text-white rounded-full flex items-center justify-center text-xs",children:"6"}),$e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Testes e Avaliações"})]})]})]}),$e.jsxs("div",{className:"mt-3 p-2 bg-green-100 rounded text-xs text-green-800",children:[$e.jsx("strong",{children:"💡 Resultado:"})," Mais leads capturados = mais crédito atribuído ao Origin Stack = melhor performance nas métricas"]})]})]})})]})]}),!L&&$e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[$e.jsxs("div",{className:"text-center mb-4",children:[$e.jsxs("h5",{className:"text-sm font-semibold text-gray-700 mb-1 flex items-center justify-center gap-2",children:[$e.jsx("span",{className:"text-lg",children:"📊"}),"Comparativo de Modelos de Atribuição"]}),$e.jsx("p",{className:"text-xs text-gray-600",children:"Origin Stack vs Last Non-Direct Session"})]}),$e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 text-center",children:[$e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-100 to-green-200 rounded-lg flex items-center justify-center mx-auto mb-2",children:$e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold "+(ut.origin_stack.transactions>ut.last_non_direct.transactions?"text-green-600":"text-red-600"),children:(()=>{const e=ut.last_non_direct.transactions,t=ut.origin_stack.transactions,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]}),$e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 text-center",children:[$e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-lg flex items-center justify-center mx-auto mb-2",children:$e.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold "+(ut.origin_stack.revenue>ut.last_non_direct.revenue?"text-green-600":"text-red-600"),children:(()=>{const e=ut.last_non_direct.revenue,t=ut.origin_stack.revenue,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]}),$e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 text-center",children:[$e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg flex items-center justify-center mx-auto mb-2",children:$e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"CPV"}),$e.jsx("p",{className:"text-lg font-bold "+(xt.cpv<ht.cpv?"text-green-600":"text-red-600"),children:(()=>{const e=ht.cpv,t=xt.cpv,s=e>0?(e-t)/e*100:0;return s>0?`-${s.toFixed(1)}%`:`+${Math.abs(s).toFixed(1)}%`})()})]}),$e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 text-center",children:[$e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-100 to-purple-200 rounded-lg flex items-center justify-center mx-auto mb-2",children:$e.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"ROAS"}),$e.jsx("p",{className:"text-lg font-bold "+(xt.roas>ht.roas?"text-green-600":"text-red-600"),children:(()=>{const e=ht.roas,t=xt.roas,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]})]})]}),L&&$e.jsxs("div",{className:"mt-6",children:[$e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[$e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"📊 Last Non-Direct Session"}),$e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("last_non_direct"===P?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"),children:"last_non_direct"===P?"Ativo":"Inativo"})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(ut.last_non_direct.transactions)}),$e.jsxs("p",{className:"text-xs text-green-600",children:["CPV: ",bt(ht.cpv)]})]}),$e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(ut.last_non_direct.revenue)}),$e.jsxs("p",{className:"text-xs "+(ht.roas>=3?"text-green-600":ht.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",ht.roas.toFixed(2),"x"]})]}),$e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"1ª Compra"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(ut.last_non_direct.transactions_first)}),$e.jsxs("p",{className:"text-xs text-blue-600",children:["CPA: ",bt(ht.cpa)]})]}),$e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita 1ª"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(ut.last_non_direct.revenue_first)}),$e.jsxs("p",{className:"text-xs "+(ht.roasFirst>=3?"text-green-600":ht.roasFirst>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",ht.roasFirst.toFixed(2),"x"]})]})]})]}),$e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"🎯 Origin Stack"}),$e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("origin_stack"===P?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"),children:"origin_stack"===P?"Ativo":"Inativo"})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(ut.origin_stack.transactions)}),$e.jsxs("p",{className:"text-xs text-green-600",children:["CPV: ",bt(xt.cpv)]})]}),$e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(ut.origin_stack.revenue)}),$e.jsxs("p",{className:"text-xs "+(xt.roas>=3?"text-green-600":xt.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",xt.roas.toFixed(2),"x"]})]}),$e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"1ª Compra"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(ut.origin_stack.transactions_first)}),$e.jsxs("p",{className:"text-xs text-blue-600",children:["CPA: ",bt(xt.cpa)]})]}),$e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[$e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Receita 1ª"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(ut.origin_stack.revenue_first)}),$e.jsxs("p",{className:"text-xs "+(xt.roasFirst>=3?"text-green-600":xt.roasFirst>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",xt.roasFirst.toFixed(2),"x"]})]})]})]})]}),$e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-md",children:[$e.jsxs("div",{className:"text-center mb-4",children:[$e.jsxs("h5",{className:"text-lg font-bold text-gray-800 mb-1 flex items-center justify-center gap-2",children:[$e.jsx("span",{className:"text-xl",children:"📈"}),"Análise Comparativa"]}),$e.jsx("p",{className:"text-xs text-gray-600",children:"Percentual de ganho do Origin Stack sobre o modelo padrão"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-green-300",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-100 to-green-200 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300",children:$e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),$e.jsx("h6",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Ganho Transações"}),$e.jsx("p",{className:"text-2xl font-bold mb-2 "+(ut.origin_stack.transactions>ut.last_non_direct.transactions?"text-green-600":"text-red-600"),children:(()=>{const e=ut.last_non_direct.transactions,t=ut.origin_stack.transactions,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()}),$e.jsxs("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[Nt(ut.origin_stack.transactions-ut.last_non_direct.transactions)," transações"]})]})}),$e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-emerald-300",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300",children:$e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),$e.jsx("h6",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Ganho Receita"}),$e.jsx("p",{className:"text-2xl font-bold mb-2 "+(ut.origin_stack.revenue>ut.last_non_direct.revenue?"text-green-600":"text-red-600"),children:(()=>{const e=ut.last_non_direct.revenue,t=ut.origin_stack.revenue,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()}),$e.jsx("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:bt(ut.origin_stack.revenue-ut.last_non_direct.revenue)})]})}),$e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-blue-300",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300",children:$e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),$e.jsx("h6",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Melhoria CPV"}),$e.jsx("p",{className:"text-2xl font-bold mb-2 "+(xt.cpv<ht.cpv?"text-green-600":"text-red-600"),children:(()=>{const e=ht.cpv,t=xt.cpv,s=e>0?(e-t)/e*100:0;return s>0?`-${s.toFixed(1)}%`:`+${Math.abs(s).toFixed(1)}%`})()}),$e.jsx("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:xt.cpv<ht.cpv?"Origin Stack":"Last Non-Direct"})]})}),$e.jsx("div",{className:"group bg-white/80 backdrop-blur-sm border border-gray-200/50 rounded-xl p-4 shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-purple-300",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-100 to-purple-200 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:scale-110 transition-transform duration-300",children:$e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),$e.jsx("h6",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Melhoria ROAS"}),$e.jsx("p",{className:"text-2xl font-bold mb-2 "+(xt.roas>ht.roas?"text-green-600":"text-red-600"),children:(()=>{const e=ht.roas,t=xt.roas,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()}),$e.jsx("p",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:xt.roas>ht.roas?"Origin Stack":"Last Non-Direct"})]})})]})]})]}),L&&F&&$e.jsxs("div",{className:"mt-8",children:[$e.jsxs("div",{className:"mb-6",children:[$e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[$e.jsx("span",{className:"text-xl",children:"🏢"}),"Comparativo por Plataforma: Google vs Meta"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Análise detalhada dos modelos de atribuição separados por plataforma"})]}),$e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[$e.jsxs("div",{className:"border border-green-200 rounded-lg p-6 bg-gradient-to-br from-green-50 to-emerald-50",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("h5",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[$e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Google Ads"]}),$e.jsxs("div",{className:"text-sm text-gray-600",children:["Investimento: ",bt(mt.google.last_non_direct.cost)]})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-green-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Last Non-Direct"}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(mt.google.last_non_direct.transactions)}),$e.jsxs("p",{className:"text-xs text-green-600",children:["CPV: ",bt(pt.lastNonDirect.cpv)]})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(mt.google.last_non_direct.revenue)}),$e.jsxs("p",{className:"text-xs "+(pt.lastNonDirect.roas>=3?"text-green-600":pt.lastNonDirect.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",pt.lastNonDirect.roas.toFixed(2),"x"]})]})]})]}),$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-green-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Origin Stack"}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(mt.google.origin_stack.transactions)}),$e.jsxs("p",{className:"text-xs text-green-600",children:["CPV: ",bt(pt.originStack.cpv)]})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(mt.google.origin_stack.revenue)}),$e.jsxs("p",{className:"text-xs "+(pt.originStack.roas>=3?"text-green-600":pt.originStack.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",pt.originStack.roas.toFixed(2),"x"]})]})]})]})]}),$e.jsxs("div",{className:"bg-white/60 rounded-lg p-4 border border-green-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3 text-center",children:"Ganho Origin Stack vs Last Non-Direct"}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold "+(mt.google.origin_stack.transactions>mt.google.last_non_direct.transactions?"text-green-600":"text-red-600"),children:(()=>{const e=mt.google.last_non_direct.transactions,t=mt.google.origin_stack.transactions,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold "+(mt.google.origin_stack.revenue>mt.google.last_non_direct.revenue?"text-green-600":"text-red-600"),children:(()=>{const e=mt.google.last_non_direct.revenue,t=mt.google.origin_stack.revenue,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]})]})]})]}),$e.jsxs("div",{className:"border border-blue-200 rounded-lg p-6 bg-gradient-to-br from-blue-50 to-indigo-50",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("h5",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[$e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),"Meta Ads"]}),$e.jsxs("div",{className:"text-sm text-gray-600",children:["Investimento: ",bt(mt.meta.last_non_direct.cost)]})]}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-blue-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Last Non-Direct"}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(mt.meta.last_non_direct.transactions)}),$e.jsxs("p",{className:"text-xs text-blue-600",children:["CPV: ",bt(ft.lastNonDirect.cpv)]})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(mt.meta.last_non_direct.revenue)}),$e.jsxs("p",{className:"text-xs "+(ft.lastNonDirect.roas>=3?"text-green-600":ft.lastNonDirect.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",ft.lastNonDirect.roas.toFixed(2),"x"]})]})]})]}),$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-blue-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Origin Stack"}),$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Nt(mt.meta.origin_stack.transactions)}),$e.jsxs("p",{className:"text-xs text-blue-600",children:["CPV: ",bt(ft.originStack.cpv)]})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold text-gray-900",children:bt(mt.meta.origin_stack.revenue)}),$e.jsxs("p",{className:"text-xs "+(ft.originStack.roas>=3?"text-green-600":ft.originStack.roas>=2?"text-yellow-600":"text-red-600"),children:["ROAS: ",ft.originStack.roas.toFixed(2),"x"]})]})]})]})]}),$e.jsxs("div",{className:"bg-white/60 rounded-lg p-4 border border-blue-200",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-3 text-center",children:"Ganho Origin Stack vs Last Non-Direct"}),$e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Transações"}),$e.jsx("p",{className:"text-lg font-bold "+(mt.meta.origin_stack.transactions>mt.meta.last_non_direct.transactions?"text-green-600":"text-red-600"),children:(()=>{const e=mt.meta.last_non_direct.transactions,t=mt.meta.origin_stack.transactions,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-xs text-gray-600",children:"Receita"}),$e.jsx("p",{className:"text-lg font-bold "+(mt.meta.origin_stack.revenue>mt.meta.last_non_direct.revenue?"text-green-600":"text-red-600"),children:(()=>{const e=mt.meta.last_non_direct.revenue,t=mt.meta.origin_stack.revenue,s=e>0?(t-e)/e*100:0;return s>0?`+${s.toFixed(1)}%`:`${s.toFixed(1)}%`})()})]})]})]})]})]}),$e.jsxs("div",{className:"mt-6 p-6 bg-gradient-to-br from-slate-50 via-gray-50 to-blue-50 rounded-xl border border-gray-200 shadow-md",children:[$e.jsxs("h5",{className:"text-lg font-bold text-gray-800 mb-4 text-center flex items-center justify-center gap-2",children:[$e.jsx("span",{className:"text-xl",children:"📊"}),"Resumo Comparativo: Google vs Meta"]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-gray-200 text-center",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Investimento Total"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Google"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:bt(mt.google.last_non_direct.cost)})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Meta"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:bt(mt.meta.last_non_direct.cost)})]})]})]}),$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-gray-200 text-center",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Transações (Origin Stack)"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Google"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:Nt(mt.google.origin_stack.transactions)})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Meta"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:Nt(mt.meta.origin_stack.transactions)})]})]})]}),$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-gray-200 text-center",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Receita (Origin Stack)"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Google"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:bt(mt.google.origin_stack.revenue)})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Meta"]}),$e.jsx("span",{className:"text-sm font-bold text-gray-900",children:bt(mt.meta.origin_stack.revenue)})]})]})]}),$e.jsxs("div",{className:"bg-white/80 rounded-lg p-4 border border-gray-200 text-center",children:[$e.jsx("h6",{className:"text-sm font-semibold text-gray-700 mb-2",children:"ROAS (Origin Stack)"}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Google"]}),$e.jsxs("span",{className:"text-sm font-bold "+(pt.originStack.roas>=3?"text-green-600":pt.originStack.roas>=2?"text-yellow-600":"text-red-600"),children:[pt.originStack.roas.toFixed(2),"x"]})]}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Meta"]}),$e.jsxs("span",{className:"text-sm font-bold "+(ft.originStack.roas>=3?"text-green-600":ft.originStack.roas>=2?"text-yellow-600":"text-red-600"),children:[ft.originStack.roas.toFixed(2),"x"]})]})]})]})]})]})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden "+(oe?"fixed inset-0 z-50 m-0 rounded-none":""),children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex flex-col gap-4",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Campanhas de Mídia Paga"}),$e.jsxs("p",{className:"text-sm text-gray-500",children:["Dados consolidados por campanha",$e.jsxs("span",{className:"ml-2 text-xs font-medium text-blue-600",children:["• ","origin_stack"===P?"Origin Stack":"Last Non-Direct Session"]}),Ue.length>0&&$e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["• ",Ue.length," campanhas"]})]})]}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsx("div",{className:"relative",children:$e.jsxs("button",{onClick:()=>Le(!Me),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(Me?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),$e.jsx("span",{children:"Métricas"}),$e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+(Me?"bg-white/20 text-white":"bg-blue-100 text-blue-600"),children:Object.values(Re).filter(Boolean).length}),$e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(Me?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),$e.jsxs("button",{onClick:()=>{try{const e=Ue.map(e=>({Plataforma:e.platform,Campanha:e.campaign_name,Investimento:e.cost,"Impressões":e.impressions,Cliques:e.clicks,"CTR (%)":e.impressions>0?(e.clicks/e.impressions*100).toFixed(2):"0.00",CPC:e.clicks>0?e.cost/e.clicks:0,Leads:e.leads,"Transações":e.transactions,"Transações 1ª Compra":e.transactions_first,"% Novos Clientes":e.transactions>0?(e.transactions_first/e.transactions*100).toFixed(1):"0.0",Receita:e.revenue,"Receita 1ª Compra":e.revenue_first,ROAS:e.cost>0?(e.revenue/e.cost).toFixed(2):"0.00","ROAS 1ª Compra":e.cost>0?(e.revenue_first/e.cost).toFixed(2):"0.00",CPV:e.transactions>0?e.cost/e.transactions:0,CPA:e.transactions_first>0?e.cost/e.transactions_first:0})),s=dm.book_new(),r=dm.json_to_sheet(e),a=[{wch:15},{wch:40},{wch:15},{wch:15},{wch:12},{wch:10},{wch:12},{wch:10},{wch:12},{wch:18},{wch:15},{wch:15},{wch:18},{wch:10},{wch:15},{wch:12},{wch:12}];r["!cols"]=a,dm.book_append_sheet(s,r,"Campanhas");const n=new Date,i=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`;!function(e,t){var s={type:"file"};s.file=t,function(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(s),em(e,s)}(s,`paid-media-${t}-${i}.xlsx`)}catch(e){alert("Erro ao gerar arquivo Excel. Por favor, tente novamente.")}},className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 bg-green-600 text-white hover:bg-green-700 shadow-sm",title:"Baixar dados em Excel",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),$e.jsx("span",{children:"XLSX"})]}),$e.jsx("button",{onClick:()=>ce(!oe),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(oe?"bg-blue-600 text-white hover:bg-blue-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:oe?$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V4.5M9 9H4.5M9 9L3.5 3.5M15 9V4.5M15 9h4.5M15 9l5.5-5.5M9 15v4.5M9 15H4.5M9 15l-5.5 5.5M15 15v4.5M15 15h4.5M15 15l5.5 5.5"})}),$e.jsx("span",{children:"Tela Normal"})]}):$e.jsxs($e.Fragment,{children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),$e.jsx("span",{children:"Tela Cheia"})]})})]})]}),$e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[$&&$e.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200",children:[$e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),$e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Filtrado por:"}),$e.jsx("span",{className:"text-sm text-blue-800 font-semibold truncate max-w-[200px]",children:$}),$e.jsx("button",{onClick:()=>z(null),className:"text-blue-600 hover:text-blue-800 transition-colors flex-shrink-0",title:"Limpar filtro de campanha",children:$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(b,{className:"w-4 h-4 text-gray-500"}),$e.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white min-w-[140px]",children:[$e.jsx("option",{value:"",children:"Todas as plataformas"}),lt.map(e=>$e.jsx("option",{value:e,children:e},e))]})]}),$e.jsxs("div",{className:"relative flex-1",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500"}),$e.jsx("input",{type:"text",placeholder:"Buscar campanha...",value:j,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white"})]})]})]})}),Me&&$e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[$e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>{Le(!1),N("")}}),$e.jsx("div",{className:"absolute top-20 right-6 w-96 max-w-[calc(100vw-3rem)]",children:$e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden animate-in slide-in-from-top-2 duration-300",children:[$e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Selecionar Métricas"}),$e.jsx("p",{className:"text-blue-100 text-sm",children:"Escolha quais colunas exibir na tabela"})]})]}),$e.jsx("button",{onClick:()=>{Le(!1),N("")},className:"w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("input",{type:"text",placeholder:"Buscar métricas...",value:_,onChange:e=>k(e.target.value),className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),_&&$e.jsx("button",{onClick:()=>k(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:$e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[_&&([{key:"platform",label:"Plataforma",icon:"🏢"},{key:"campaign_name",label:"Campanha",icon:"📢"},{key:"cost",label:"Investimento",icon:"💰"},{key:"impressions",label:"Impressões",icon:"👁️"},{key:"clicks",label:"Cliques",icon:"👆"},{key:"ctr",label:"CTR",icon:"📊"},{key:"cpc",label:"CPC",icon:"💸"},{key:"leads",label:"Leads",icon:"🎯"},{key:"transactions",label:"Transações",icon:"🛒"},{key:"transactions_first",label:"Trans. 1ª Compra",icon:"🆕"},{key:"transactions_delta",label:"Δ ROAS %",icon:"📊"},{key:"new_customers_percentage",label:"% Novos Clientes",icon:"👥"},{key:"revenue",label:"Receita",icon:"💵"},{key:"revenue_first",label:"Receita 1ª Compra",icon:"💎"},{key:"roas",label:"ROAS",icon:"📈"},{key:"roas_first",label:"ROAS 1ª Compra",icon:"🚀"},{key:"cpv",label:"CPV",icon:"💳"},{key:"cpa",label:"CPA",icon:"🎯"},{key:"cpa_delta",label:"Δ CPA %",icon:"📊"}].some(e=>e.label.toLowerCase().includes(_.toLowerCase())||e.key.toLowerCase().includes(_.toLowerCase()))?null:$e.jsxs("div",{className:"text-center py-8",children:[$e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:$e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma métrica encontrada"}),$e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'Tente buscar por termos como "receita", "cliques", "roas", etc.'}),$e.jsx("button",{onClick:()=>k(""),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:"Limpar busca"})]})),(()=>{const e=[{key:"platform",label:"Plataforma",icon:"🏢"},{key:"campaign_name",label:"Campanha",icon:"📢"}].filter(e=>!_||e.label.toLowerCase().includes(_.toLowerCase())||e.key.toLowerCase().includes(_.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Identificação"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Re[e],onChange:t=>Pe(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"cost",label:"Investimento",icon:"💰"},{key:"impressions",label:"Impressões",icon:"👁️"},{key:"clicks",label:"Cliques",icon:"👆"},{key:"ctr",label:"CTR",icon:"📊"},{key:"cpc",label:"CPC",icon:"💸"}].filter(e=>!_||e.label.toLowerCase().includes(_.toLowerCase())||e.key.toLowerCase().includes(_.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Investimento e Alcance"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Re[e],onChange:t=>Pe(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"leads",label:"Leads",icon:"🎯"},{key:"transactions",label:"Transações",icon:"🛒"},{key:"transactions_first",label:"Trans. 1ª Compra",icon:"🆕"},{key:"transactions_delta",label:"Δ ROAS %",icon:"📊"},{key:"revenue",label:"Receita",icon:"💵"},{key:"revenue_first",label:"Receita 1ª Compra",icon:"💎"}].filter(e=>!_||e.label.toLowerCase().includes(_.toLowerCase())||e.key.toLowerCase().includes(_.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Conversões e Receita"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Re[e],onChange:t=>Pe(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"roas",label:"ROAS",icon:"📈"},{key:"roas_first",label:"ROAS 1ª Compra",icon:"🚀"},{key:"cpv",label:"CPV",icon:"💳"},{key:"cpa",label:"CPA",icon:"🎯"},{key:"cpa_delta",label:"Δ CPA %",icon:"📊"}].filter(e=>!_||e.label.toLowerCase().includes(_.toLowerCase())||e.key.toLowerCase().includes(_.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Performance"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Re[e],onChange:t=>Pe(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})()]})}),$e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:$e.jsxs("div",{className:"flex justify-between items-center",children:[$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("button",{onClick:()=>Pe({platform:!0,campaign_name:!0,cost:!0,impressions:!0,clicks:!0,ctr:!0,cpc:!0,leads:!0,transactions:!0,transactions_first:!0,revenue:!0,revenue_first:!0,roas:!0,roas_first:!0,cpv:!0,cpa:!0}),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors flex items-center gap-2",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Todas"]}),$e.jsxs("button",{onClick:()=>Pe({platform:!0,campaign_name:!0,cost:!1,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!1,transactions_first:!1,revenue:!1,revenue_first:!1,roas:!1,roas_first:!1,cpv:!1,cpa:!1}),className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-2",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Básicas"]})]}),$e.jsxs("div",{className:"text-sm text-gray-500",children:[Object.values(Re).filter(Boolean).length," de ",Object.keys(Re).length," selecionadas"]})]})})]})})]}),$e.jsx("div",{className:"overflow-x-auto "+(oe?"h-[calc(100vh-120px)] overflow-y-auto":""),children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-20",children:$e.jsxs("tr",{children:[Re.platform&&$e.jsx(bs,{field:"platform",currentSortField:d,currentSortDirection:m,onSort:gt,className:"sticky left-0 z-10 bg-gray-50",children:"Plataforma"}),Re.campaign_name&&$e.jsx(bs,{field:"campaign_name",currentSortField:d,currentSortDirection:m,onSort:gt,className:(Re.platform?"sticky left-[120px]":"sticky left-0")+" z-10 bg-gray-50",children:"Campanha"}),Re.cost&&$e.jsx(bs,{field:"cost",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Investimento"}),Re.impressions&&$e.jsx(bs,{field:"impressions",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Impressões"}),Re.clicks&&$e.jsx(bs,{field:"clicks",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Cliques"}),Re.ctr&&$e.jsx(bs,{field:"ctr",currentSortField:d,currentSortDirection:m,onSort:gt,children:"CTR"}),Re.cpc&&$e.jsx(bs,{field:"cpc",currentSortField:d,currentSortDirection:m,onSort:gt,children:"CPC"}),Re.leads&&$e.jsx(bs,{field:"leads",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Leads"}),Re.transactions&&$e.jsx(bs,{field:"transactions",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Transações"}),Re.transactions_first&&$e.jsx(bs,{field:"transactions_first",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Trans. 1ª Compra"}),Re.transactions_delta&&$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider relative",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsxs("button",{onClick:()=>gt("transactions_delta"),className:"flex items-center gap-1 hover:text-gray-700 group",children:[$e.jsx("span",{children:"Δ ROAS %"}),$e.jsxs("div",{className:"flex flex-col",children:[$e.jsx("svg",{className:"w-3 h-3 "+("transactions_delta"===d&&"asc"===m?"text-blue-600":"text-gray-400 group-hover:text-gray-600"),fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M5 10l5-5 5 5H5z"})}),$e.jsx("svg",{className:"w-3 h-3 -mt-1 "+("transactions_delta"===d&&"desc"===m?"text-blue-600":"text-gray-400 group-hover:text-gray-600"),fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M15 10l-5 5-5-5h10z"})})]})]}),$e.jsxs("div",{className:"relative group",children:[$e.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-help",fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),$e.jsxs("div",{className:"hidden group-hover:block absolute left-1/2 -translate-x-1/2 top-full mt-2 w-80 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl z-[99999] pointer-events-none border border-gray-700",children:[$e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full w-0 h-0 border-l-[6px] border-r-[6px] border-b-[6px] border-transparent border-b-gray-900"}),$e.jsx("div",{className:"font-semibold mb-1",children:"Delta ROAS entre modelos de atribuição"}),$e.jsxs("div",{className:"space-y-1",children:[$e.jsx("p",{children:"Compara o ROAS entre Last Non-Direct (LND) e Origin Stack (OS):"}),$e.jsx("p",{className:"text-emerald-300",children:"💚 Verde escuro: Muito acima da média (+50%)"}),$e.jsx("p",{className:"text-green-300",children:"🟢 Verde claro: Acima da média"}),$e.jsx("p",{className:"text-orange-300",children:"🟠 Laranja: Abaixo da média"}),$e.jsx("p",{className:"text-red-300",children:"🔴 Vermelho: Muito abaixo da média (-50%)"}),$e.jsx("p",{className:"text-gray-400 mt-1",children:"Fórmula: ((ROAS_OS - ROAS_LND) / ROAS_LND) × 100"})]})]})]})]})}),Re.new_customers_percentage&&$e.jsx(bs,{field:"new_customers_percentage",currentSortField:d,currentSortDirection:m,onSort:gt,children:"% Novos Clientes"}),Re.revenue&&$e.jsx(bs,{field:"revenue",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Receita"}),Re.revenue_first&&$e.jsx(bs,{field:"revenue_first",currentSortField:d,currentSortDirection:m,onSort:gt,children:"Receita 1ª Compra"}),Re.roas&&$e.jsx(bs,{field:"roas",currentSortField:d,currentSortDirection:m,onSort:gt,children:"ROAS"}),Re.roas_first&&$e.jsx(bs,{field:"roas_first",currentSortField:d,currentSortDirection:m,onSort:gt,children:"ROAS 1ª Compra"}),Re.cpv&&$e.jsx(bs,{field:"cpv",currentSortField:d,currentSortDirection:m,onSort:gt,children:"CPV"}),Re.cpa&&$e.jsx(bs,{field:"cpa",currentSortField:d,currentSortDirection:m,onSort:gt,children:"CPA"}),Re.cpa_delta&&$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider relative",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsxs("button",{onClick:()=>gt("cpa_delta"),className:"flex items-center gap-1 hover:text-gray-700 group",children:[$e.jsx("span",{children:"Δ CPA %"}),$e.jsxs("div",{className:"flex flex-col",children:[$e.jsx("svg",{className:"w-3 h-3 "+("cpa_delta"===d&&"asc"===m?"text-blue-600":"text-gray-400 group-hover:text-gray-600"),fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M5 10l5-5 5 5H5z"})}),$e.jsx("svg",{className:"w-3 h-3 -mt-1 "+("cpa_delta"===d&&"desc"===m?"text-blue-600":"text-gray-400 group-hover:text-gray-600"),fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{d:"M15 10l-5 5-5-5h10z"})})]})]}),$e.jsxs("div",{className:"relative group",children:[$e.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-help",fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),$e.jsxs("div",{className:"hidden group-hover:block absolute left-1/2 -translate-x-1/2 top-full mt-2 w-80 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl z-[99999] pointer-events-none border border-gray-700",children:[$e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full w-0 h-0 border-l-[6px] border-r-[6px] border-b-[6px] border-transparent border-b-gray-900"}),$e.jsx("div",{className:"font-semibold mb-1",children:"Delta CPA entre modelos de atribuição"}),$e.jsxs("div",{className:"space-y-1",children:[$e.jsx("p",{children:"Compara o CPA entre Last Non-Direct (LND) e Origin Stack (OS):"}),$e.jsx("p",{className:"text-emerald-300",children:"💚 Verde escuro: Muito acima da média (+50%)"}),$e.jsx("p",{className:"text-green-300",children:"🟢 Verde claro: Acima da média"}),$e.jsx("p",{className:"text-orange-300",children:"🟠 Laranja: Abaixo da média"}),$e.jsx("p",{className:"text-red-300",children:"🔴 Vermelho: Muito abaixo da média (-50%)"}),$e.jsx("p",{className:"text-gray-400 mt-1",children:"Fórmula: ((CPA_LND - CPA_OS) / CPA_LND) × 100"}),$e.jsx("p",{className:"text-xs text-gray-400",children:"Nota: CPA menor é melhor, então valor positivo = OS mais eficiente"})]})]})]})]})})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(()=>{const e=[],t=[];He.forEach(s=>{const r=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+t.revenue,0):s.revenue,a=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):s.revenue_origin_stack,n=s.cost>0?r/s.cost:0,i=s.cost>0?a/s.cost:0;n>0&&e.push((i-n)/n*100);const l=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+t.transactions_first,0):s.transactions_first,o=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):s.transactions_first_origin_stack,c=l>0?s.cost/l:0,d=o>0?s.cost/o:0;c>0&&t.push((c-d)/c*100)});const s=e.length>0?e.reduce((e,t)=>e+t,0)/e.length:0,r=t.length>0?t.reduce((e,t)=>e+t,0)/t.length:0;return He.map((e,t)=>{const a=e.impressions>0?e.clicks/e.impressions*100:0,n=e.clicks>0?e.cost/e.clicks:0,i=e.cost>0?e.revenue/e.cost:0,l=e.cost>0?e.revenue_first/e.cost:0,o=e.transactions>0?e.cost/e.transactions:0,c=e.transactions_first>0?e.cost/e.transactions_first:0,d="origin_stack"===P&&e.transactions_origin_stack||e.transactions,u="origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first,m=d>0?u/d*100:0;return $e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors "+(t%2==0?"bg-white":"bg-gray-50"),children:[Re.platform&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap sticky left-0 z-10 "+(t%2==0?"bg-white":"bg-gray-50"),children:$e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.platform})}),Re.campaign_name&&$e.jsx("td",{className:`px-6 py-4 max-w-xs ${Re.platform?"sticky left-[120px]":"sticky left-0"} z-10 ${t%2==0?"bg-white":"bg-gray-50"}`,children:$e.jsxs("button",{onClick:()=>z(e.campaign_name),className:"text-sm font-medium truncate text-left w-full hover:underline transition-colors "+($===e.campaign_name?"text-blue-600 font-semibold":"text-gray-900 hover:text-blue-600"),title:`Filtrar por: ${e.campaign_name}`,children:[e.campaign_name,$===e.campaign_name&&$e.jsx("span",{className:"ml-1 text-blue-500",children:"✓"})]})}),Re.cost&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-red-600",children:bt(e.cost)}),Re.impressions&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Nt(e.impressions)}),Re.clicks&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Nt(e.clicks)}),Re.ctr&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:[a.toFixed(2),"%"]}),Re.cpc&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:bt(n)}),Re.leads&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:Nt(e.leads)}),Re.transactions&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:Nt(e.transactions)}),Re.transactions_first&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:Nt(e.transactions_first)}),Re.transactions_delta&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(()=>{const t=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.revenue,0):e.revenue,r=e.cost>0?t/e.cost:0,a=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):e.revenue_origin_stack,n=e.cost>0?a/e.cost:0,i=r>0?(n-r)/r*100:null,l=null!==i?i.toFixed(1):"-",o=null!==i&&i>0;let c="",d="",u="font-semibold";null!==i&&i>1.5*s?(c="bg-emerald-100",d="text-emerald-800",u="font-bold"):null!==i&&i>s?(c="bg-green-100",d="text-green-700",u="font-bold"):null!==i&&i<.5*s?(c="bg-red-100",d="text-red-700"):null!==i&&i<s?(c="bg-orange-100",d="text-orange-700"):d=o?"text-green-600":null!==i&&i<0?"text-red-600":"text-gray-600";const m=o?"+":"";return $e.jsx("div",{className:`${c} ${d} ${u} rounded px-2 py-1 inline-block`,children:"-"!==l?`${m}${l}%`:"-"})})()}),Re.new_customers_percentage&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:d>0?`${m.toFixed(1)}%`:"-"}),Re.revenue&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:bt(e.revenue)}),Re.revenue_first&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-emerald-600",children:bt(e.revenue_first)}),Re.roas&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:$e.jsxs("span",{className:""+(i>=3?"text-green-600":i>=2?"text-yellow-600":"text-red-600"),children:[i.toFixed(2),"x"]})}),Re.roas_first&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:$e.jsxs("span",{className:""+(l>=3?"text-green-600":l>=2?"text-yellow-600":"text-red-600"),children:[l.toFixed(2),"x"]})}),Re.cpv&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-600",children:bt(o)}),Re.cpa&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:bt(c)}),Re.cpa_delta&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(()=>{const t=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.transactions_first,0):e.transactions_first,s=t>0?e.cost/t:0,a=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):e.transactions_first_origin_stack,n=a>0?e.cost/a:0,i=s>0?(s-n)/s*100:null,l=null!==i?i.toFixed(1):"-",o=null!==i&&i>0;let c="",d="",u="font-semibold";null!==i&&i>1.5*r?(c="bg-emerald-100",d="text-emerald-800",u="font-bold"):null!==i&&i>r?(c="bg-green-100",d="text-green-700",u="font-bold"):null!==i&&i<.5*r?(c="bg-red-100",d="text-red-700"):null!==i&&i<r?(c="bg-orange-100",d="text-orange-700"):d=o?"text-green-600":null!==i&&i<0?"text-red-600":"text-gray-600";const m=o?"+":"";return $e.jsx("div",{className:`${c} ${d} ${u} rounded px-2 py-1 inline-block`,children:"-"!==l?`${m}${l}%`:"-"})})()})]},t)})})()})]})}),Ge&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>T(!S),className:"flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:S?$e.jsxs($e.Fragment,{children:[$e.jsx("span",{children:"Mostrar menos"}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}):$e.jsxs($e.Fragment,{children:[$e.jsxs("span",{children:["Mostrar todas as ",Ue.length," campanhas"]}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})})]})]}),"creatives"===de&&$e.jsxs("div",{className:"space-y-6",children:[$e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:$e.jsxs("div",{className:"flex items-start",children:[$e.jsx("div",{className:"flex-shrink-0",children:$e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),$e.jsxs("div",{className:"ml-3",children:[$e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Informação Importante"}),$e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:$e.jsxs("p",{children:["Esta aba atualmente exibe apenas dados de ",$e.jsx("strong",{children:"Meta Ads"}),". Os dados de Google Ads serão adicionados em breve."]})})]})]})}),$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-2",children:[$e.jsx("span",{children:"Criativos"}),be&&$e.jsxs($e.Fragment,{children:[$e.jsx("span",{children:"›"}),$e.jsx("span",{children:be})]}),we&&$e.jsxs($e.Fragment,{children:[$e.jsx("span",{children:"›"}),$e.jsx("span",{children:we})]})]}),$e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:Oe()}),$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Análise detalhada por criativo e grupo de anúncio"})]}),$e.jsxs("div",{className:"flex items-center space-x-2",children:[(be||we||"campaign"!==fe)&&$e.jsx("button",{onClick:()=>{"creative"===fe?(ge("adgroup"),je(null)):"adgroup"===fe?(ge("campaign"),je(null)):"campaign"===fe&&(ge("campaign"),ve(null),je(null))},className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:$e.jsx("span",{children:"← Voltar"})}),$e.jsx("button",{onClick:()=>ce(e=>!e),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",title:oe?"Sair da tela cheia":"Tela cheia",children:$e.jsx("span",{children:oe?"Sair Tela Cheia":"Tela Cheia"})})]})]}),xe?$e.jsx("div",{className:"flex items-center justify-center h-64",children:$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===Ye.length?$e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[$e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),$e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nenhum dado de criativos encontrado"}),$e.jsx("p",{className:"text-sm text-center",children:"Não há dados de criativos disponíveis para o período selecionado."})]}):$e.jsxs($e.Fragment,{children:[$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Investimento Total"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Xe.cost)})]}),$e.jsx("div",{className:"p-2 bg-red-50 rounded-lg",children:$e.jsx(R,{className:"w-5 h-5 text-red-600"})})]})}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Impressões"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Xe.impressions)})]}),$e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:$e.jsx(o,{className:"w-5 h-5 text-blue-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPM: ",bt(Xe.impressions>0?Xe.cost/Xe.impressions*1e3:0)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Cliques"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Xe.clicks)})]}),$e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:$e.jsx(se,{className:"w-5 h-5 text-green-600"})})]}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CTR: ",vt.toFixed(1),"%"]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPC: ",bt(yt)]})]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Leads"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Xe.leads)})]}),$e.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:$e.jsx(E,{className:"w-5 h-5 text-orange-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPL: ",bt(jt)]})]})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Transações"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Xe.transactions)})]}),$e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:$e.jsx(f,{className:"w-5 h-5 text-purple-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPV: ",bt(wt)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Receita Total"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Xe.revenue)})]}),$e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:$e.jsx(v,{className:"w-5 h-5 text-green-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["ROAS: ",(Xe.cost>0?Xe.revenue/Xe.cost:0).toFixed(1),"x"]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Transações 1ª"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:Nt(Xe.transactions_first)})]}),$e.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg",children:$e.jsx(re,{className:"w-5 h-5 text-indigo-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["CPA 1ª: ",bt(Xe.transactions_first>0?Xe.cost/Xe.transactions_first:0)]})]}),$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Receita 1ª"}),$e.jsx("p",{className:"text-xl font-bold text-gray-900",children:bt(Xe.revenue_first)})]}),$e.jsx("div",{className:"p-2 bg-yellow-50 rounded-lg",children:$e.jsx(ae,{className:"w-5 h-5 text-yellow-600"})})]}),$e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["ROAS 1ª: ",(Xe.cost>0?Xe.revenue_first/Xe.cost:0).toFixed(1),"x"]})]})]}),$e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[$e.jsx(y,{className:"w-5 h-5 mr-2 text-blue-600"}),"Comparativo de Modelos de Atribuição"]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[$e.jsxs("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("h4",{className:"font-semibold text-blue-900",children:"Origin Stack (Padrão)"}),$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(U,{className:"w-4 h-4 text-blue-600"})})]}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-blue-700",children:"Transações:"}),$e.jsx("span",{className:"font-semibold text-blue-900",children:Nt(Je.transactions)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-blue-700",children:"Receita:"}),$e.jsx("span",{className:"font-semibold text-blue-900",children:bt(Je.revenue)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-blue-700",children:"ROAS:"}),$e.jsxs("span",{className:"font-semibold text-blue-900",children:[(Xe.cost>0?Je.revenue/Xe.cost:0).toFixed(1),"x"]})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-blue-700",children:"Transações 1ª:"}),$e.jsx("span",{className:"font-semibold text-blue-900",children:Nt(Je.transactions_first)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-blue-700",children:"Receita 1ª:"}),$e.jsx("span",{className:"font-semibold text-blue-900",children:bt(Je.revenue_first)})]})]})]}),$e.jsxs("div",{className:"border border-green-200 rounded-lg p-4 bg-green-50",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("h4",{className:"font-semibold text-green-900",children:"Last Non-Direct (Alternativo)"}),$e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:$e.jsx(h,{className:"w-4 h-4 text-green-600"})})]}),$e.jsxs("div",{className:"space-y-2",children:[$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-green-700",children:"Transações:"}),$e.jsx("span",{className:"font-semibold text-green-900",children:Nt(Ze.transactions)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-green-700",children:"Receita:"}),$e.jsx("span",{className:"font-semibold text-green-900",children:bt(Ze.revenue)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-green-700",children:"ROAS:"}),$e.jsxs("span",{className:"font-semibold text-green-900",children:[(Xe.cost>0?Ze.revenue/Xe.cost:0).toFixed(1),"x"]})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-green-700",children:"Transações 1ª:"}),$e.jsx("span",{className:"font-semibold text-green-900",children:Nt(Ze.transactions_first)})]}),$e.jsxs("div",{className:"flex justify-between",children:[$e.jsx("span",{className:"text-sm text-green-700",children:"Receita 1ª:"}),$e.jsx("span",{className:"font-semibold text-green-900",children:bt(Ze.revenue_first)})]})]})]})]}),$e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[$e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Diferenças entre os modelos:"}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-600",children:"Diferença em Transações:"}),$e.jsxs("span",{className:"ml-2 font-semibold "+(Je.transactions>Ze.transactions?"text-green-600":"text-red-600"),children:[Je.transactions>Ze.transactions?"+":"",Nt(Je.transactions-Ze.transactions)]})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-600",children:"Diferença em Receita:"}),$e.jsxs("span",{className:"ml-2 font-semibold "+(Je.revenue>Ze.revenue?"text-green-600":"text-red-600"),children:[Je.revenue>Ze.revenue?"+":"",bt(Je.revenue-Ze.revenue)]})]})]})]})]}),$e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:$e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[$e.jsxs("div",{className:"flex items-center space-x-2",children:[$e.jsx(b,{className:"h-4 w-4 text-gray-500"}),$e.jsxs("select",{value:p,onChange:e=>g(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[$e.jsx("option",{value:"",children:"Todas as plataformas"}),Array.from(new Set(me.map(e=>e.platform))).map(e=>$e.jsx("option",{value:e,children:e},e))]})]}),$e.jsxs("div",{className:"flex items-center space-x-2",children:[$e.jsx(w,{className:"h-4 w-4 text-gray-500"}),$e.jsx("input",{type:"text",placeholder:`Buscar ${Oe().toLowerCase()}...`,value:j,onChange:e=>N(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),$e.jsxs("div",{className:"flex items-center space-x-2",children:[$e.jsx("label",{className:"text-sm text-gray-600",children:"Atribuição:"}),$e.jsxs("select",{value:P,onChange:e=>M(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[$e.jsx("option",{value:"origin_stack",children:"Origin Stack (Padrão)"}),$e.jsx("option",{value:"last_non_direct",children:"Last Non-Direct (Alternativo)"})]})]})]})}),$e.jsx("div",{className:"flex gap-2 mb-4",children:$e.jsx("div",{className:"relative",children:$e.jsxs("button",{onClick:()=>Se(!Ce),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(Ce?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),$e.jsx("span",{children:"Métricas"}),$e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+(Ce?"bg-white/20 text-white":"bg-blue-100 text-blue-600"),children:Object.values(Ne).filter(Boolean).length}),$e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(Ce?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})}),$e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[$e.jsx("div",{className:"p-4 border-b",children:$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[Oe()," (",Ye.length,")"]})}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-20",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plataforma"}),$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"campaign"===fe?"Campanha":"adgroup"===fe?"Grupo de Anúncio":"Criativo"}),Ne.cost&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Investimento"}),Ne.revenue&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"}),Ne.revenue_first&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita 1ª"}),Ne.impressions&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Impressões"}),Ne.clicks&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliques"}),Ne.leads&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leads"}),Ne.transactions&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transações"}),Ne.transactions_first&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transações 1ª"}),Ne.transactions_delta&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider relative",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("span",{children:"Δ ROAS %"}),$e.jsxs("div",{className:"relative group",children:[$e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400 cursor-help",fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),$e.jsxs("div",{className:"hidden group-hover:block absolute left-1/2 -translate-x-1/2 top-full mt-2 w-72 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl z-[99999] pointer-events-none border border-gray-700",children:[$e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full w-0 h-0 border-l-[6px] border-r-[6px] border-b-[6px] border-transparent border-b-gray-900"}),$e.jsx("div",{className:"font-semibold mb-1",children:"Delta ROAS"}),$e.jsxs("div",{className:"space-y-1",children:[$e.jsx("p",{children:"Compara ROAS entre LND e OS:"}),$e.jsx("p",{className:"text-emerald-300",children:"💚 Muito acima (+50%)"}),$e.jsx("p",{className:"text-green-300",children:"🟢 Acima da média"}),$e.jsx("p",{className:"text-orange-300",children:"🟠 Abaixo da média"}),$e.jsx("p",{className:"text-red-300",children:"🔴 Muito abaixo (-50%)"})]})]})]})]})}),Ne.new_customers_percentage&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% Novos Clientes"}),Ne.ctr&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CTR"}),Ne.cpc&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPC"}),Ne.cpv&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPV"}),Ne.cpa&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPA"}),Ne.cpa_delta&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider relative",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("span",{children:"Δ CPA %"}),$e.jsxs("div",{className:"relative group",children:[$e.jsx("svg",{className:"w-3.5 h-3.5 text-gray-400 cursor-help",fill:"currentColor",viewBox:"0 0 20 20",children:$e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),$e.jsxs("div",{className:"hidden group-hover:block absolute left-1/2 -translate-x-1/2 top-full mt-2 w-72 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-xl z-[99999] pointer-events-none border border-gray-700",children:[$e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full w-0 h-0 border-l-[6px] border-r-[6px] border-b-[6px] border-transparent border-b-gray-900"}),$e.jsx("div",{className:"font-semibold mb-1",children:"Delta CPA"}),$e.jsxs("div",{className:"space-y-1",children:[$e.jsx("p",{children:"Compara CPA entre LND e OS:"}),$e.jsx("p",{className:"text-emerald-300",children:"💚 Muito acima (+50%)"}),$e.jsx("p",{className:"text-green-300",children:"🟢 Acima da média"}),$e.jsx("p",{className:"text-orange-300",children:"🟠 Abaixo da média"}),$e.jsx("p",{className:"text-red-300",children:"🔴 Muito abaixo (-50%)"})]})]})]})]})}),Ne.roas&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ROAS"}),De()&&$e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(()=>{const e=[],t=[];Ye.slice(0,20).forEach(s=>{const r=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+t.revenue,0):s.revenue,a=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):s.revenue_origin_stack,n=s.cost>0?r/s.cost:0,i=s.cost>0?a/s.cost:0;n>0&&e.push((i-n)/n*100);const l=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+t.transactions_first,0):s.transactions_first,o=s.records&&s.records.length>0?s.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):s.transactions_first_origin_stack,c=l>0?s.cost/l:0,d=o>0?s.cost/o:0;c>0&&t.push((c-d)/c*100)});const s=e.length>0?e.reduce((e,t)=>e+t,0)/e.length:0,r=t.length>0?t.reduce((e,t)=>e+t,0)/t.length:0;return Ye.slice(0,20).map((e,t)=>{const a="origin_stack"===P&&e.revenue_origin_stack||e.revenue,n=e.cost>0?a/e.cost:0,i="campaign"===fe?e.campaign_name:"adgroup"===fe?e.ad_group_name:e.creative_name,l="origin_stack"===P&&e.transactions_origin_stack||e.transactions,o="origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first,c=l>0?o/l*100:0;return $e.jsxs("tr",{className:"hover:bg-gray-50",children:[$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:$e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.platform})}),$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:$e.jsx("span",{className:"truncate max-w-xs block",title:i,children:i})}),Ne.cost&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:bt(e.cost)}),Ne.revenue&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:bt("origin_stack"===P&&e.revenue_origin_stack||e.revenue)}),Ne.revenue_first&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:bt("origin_stack"===P&&e.revenue_first_origin_stack||e.revenue_first)}),Ne.impressions&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Nt(e.impressions)}),Ne.clicks&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Nt(e.clicks)}),Ne.leads&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Nt(e.leads)}),Ne.transactions&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Nt("origin_stack"===P&&e.transactions_origin_stack||e.transactions)}),Ne.transactions_first&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Nt("origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first)}),Ne.transactions_delta&&$e.jsx("td",{className:"px-4 py-3 text-sm",children:(()=>{const t=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.revenue,0):e.revenue,r=e.cost>0?t/e.cost:0,a=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.revenue_origin_stack||0),0):e.revenue_origin_stack,n=e.cost>0?a/e.cost:0,i=r>0?(n-r)/r*100:null,l=null!==i?i.toFixed(1):"-",o=null!==i&&i>0;let c="",d="",u="font-semibold";null!==i&&i>1.5*s?(c="bg-emerald-100",d="text-emerald-800",u="font-bold"):null!==i&&i>s?(c="bg-green-100",d="text-green-700",u="font-bold"):null!==i&&i<.5*s?(c="bg-red-100",d="text-red-700"):null!==i&&i<s?(c="bg-orange-100",d="text-orange-700"):d=o?"text-green-600":null!==i&&i<0?"text-red-600":"text-gray-600";const m=o?"+":"";return $e.jsx("div",{className:`${c} ${d} ${u} rounded px-2 py-1 inline-block`,children:"-"!==l?`${m}${l}%`:"-"})})()}),Ne.new_customers_percentage&&$e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-indigo-600",children:l>0?`${c.toFixed(1)}%`:"-"}),Ne.ctr&&$e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[(e.impressions>0?e.clicks/e.impressions*100:0).toFixed(2),"%"]}),Ne.cpc&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.clicks>0?bt(e.cost/e.clicks):"—"}),Ne.cpv&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:("origin_stack"===P&&e.transactions_origin_stack||e.transactions)>0?bt(e.cost/("origin_stack"===P&&e.transactions_origin_stack||e.transactions)):"—"}),Ne.cpa&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:("origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first)>0?bt(e.cost/("origin_stack"===P&&e.transactions_first_origin_stack||e.transactions_first)):"—"}),Ne.cpa_delta&&$e.jsx("td",{className:"px-4 py-3 text-sm",children:(()=>{const t=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+t.transactions_first,0):e.transactions_first,s=t>0?e.cost/t:0,a=e.records&&e.records.length>0?e.records.reduce((e,t)=>e+(t.transactions_first_origin_stack||0),0):e.transactions_first_origin_stack,n=a>0?e.cost/a:0,i=s>0?(s-n)/s*100:null,l=null!==i?i.toFixed(1):"-",o=null!==i&&i>0;let c="",d="",u="font-semibold";null!==i&&i>1.5*r?(c="bg-emerald-100",d="text-emerald-800",u="font-bold"):null!==i&&i>r?(c="bg-green-100",d="text-green-700",u="font-bold"):null!==i&&i<.5*r?(c="bg-red-100",d="text-red-700"):null!==i&&i<r?(c="bg-orange-100",d="text-orange-700"):d=o?"text-green-600":null!==i&&i<0?"text-red-600":"text-gray-600";const m=o?"+":"";return $e.jsx("div",{className:`${c} ${d} ${u} rounded px-2 py-1 inline-block`,children:"-"!==l?`${m}${l}%`:"-"})})()}),Ne.roas&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:$e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(n>=2?"bg-green-100 text-green-800":n>=1?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[n.toFixed(1),"x"]})}),De()&&$e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:$e.jsx("button",{onClick:()=>{const t=Ie();var s,r;"campaign"===fe&&"adgroup"===t?(ve(e.campaign_name),je(null),ge("adgroup")):(r=i,ge(s=t),"adgroup"===s&&je(r))},className:"flex items-center space-x-1 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-md transition-colors",children:$e.jsx("span",{children:"Detalhar →"})})})]},t)})})()})]})})]}),Ce&&$e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[$e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>{Se(!1)}}),$e.jsx("div",{className:"absolute top-20 right-6 w-96 max-w-[calc(100vw-3rem)]",children:$e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden animate-in slide-in-from-top-2 duration-300",children:[$e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Selecionar Métricas"}),$e.jsx("p",{className:"text-blue-100 text-sm",children:"Escolha quais colunas exibir na tabela"})]})]}),$e.jsx("button",{onClick:()=>{Se(!1)},className:"w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:$e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Identificação"})]}),$e.jsx("div",{className:"space-y-2",children:[{key:"platform",label:"Plataforma",icon:"🏢"},{key:"campaign_name",label:"Campanha",icon:"📢"}].map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Ne[e],onChange:t=>_e(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]}),$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Financeiro"})]}),$e.jsx("div",{className:"space-y-2",children:[{key:"cost",label:"Investimento",icon:"💰"},{key:"revenue",label:"Receita",icon:"💵"},{key:"revenue_first",label:"Receita 1ª Compra",icon:"💎"},{key:"roas",label:"ROAS",icon:"📈"},{key:"roas_first",label:"ROAS 1ª Compra",icon:"🚀"}].map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Ne[e],onChange:t=>_e(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]}),$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Performance"})]}),$e.jsx("div",{className:"space-y-2",children:[{key:"impressions",label:"Impressões",icon:"👁️"},{key:"clicks",label:"Cliques",icon:"👆"},{key:"ctr",label:"CTR",icon:"📊"},{key:"cpc",label:"CPC",icon:"💸"}].map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Ne[e],onChange:t=>_e(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]}),$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Conversões"})]}),$e.jsx("div",{className:"space-y-2",children:[{key:"leads",label:"Leads",icon:"🎯"},{key:"transactions",label:"Transações",icon:"🛒"},{key:"transactions_first",label:"Trans. 1ª Compra",icon:"🆕"},{key:"transactions_delta",label:"Δ ROAS %",icon:"📊"},{key:"cpv",label:"CPV",icon:"💳"},{key:"cpa",label:"CPA",icon:"🎯"},{key:"cpa_delta",label:"Δ CPA %",icon:"📊"}].map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:Ne[e],onChange:t=>_e(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})]})}),$e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex gap-2",children:[$e.jsx("button",{onClick:()=>{_e({platform:!0,campaign_name:!0,cost:!0,impressions:!0,clicks:!0,ctr:!0,cpc:!0,leads:!0,transactions:!0,transactions_first:!0,revenue:!0,revenue_first:!0,cpv:!0,cpa:!0,roas:!0,roas_first:!0})},className:"px-3 py-1 text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",children:"Selecionar Todas"}),$e.jsx("button",{onClick:()=>{_e({platform:!1,campaign_name:!1,cost:!1,impressions:!1,clicks:!1,ctr:!1,cpc:!1,leads:!1,transactions:!1,transactions_first:!1,revenue:!1,revenue_first:!1,cpv:!1,cpa:!1,roas:!1,roas_first:!1})},className:"px-3 py-1 text-xs font-medium text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded-md transition-colors",children:"Limpar Todas"})]}),$e.jsxs("div",{className:"text-sm text-gray-500",children:[Object.values(Ne).filter(Boolean).length," de ",Object.keys(Ne).length," selecionadas"]})]})})]})})]})]})]})]}):$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(v,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado de mídia paga encontrado"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:"Não foram encontrados dados de campanhas para a tabela selecionada no período."})]})},xm=({selectedTable:t,startDate:a,endDate:n})=>{const[i,l]=e.useState([]),[o,c]=e.useState(!1),[d,u]=e.useState(null),[m,h]=e.useState("calculations"),[b,y]=e.useState("desc"),[w,j]=e.useState("event_date"),[N,k]=e.useState("desc"),[S,T]=e.useState("calculations"),[P,M]=e.useState("desc"),[L,O]=e.useState(!1),[I,F]=e.useState(!1),[B,$]=e.useState(!1),[z,V]=e.useState(100),[U,W]=e.useState(null);e.useEffect(()=>{O(!1)},[S,P]),e.useEffect(()=>{F(!1)},[m,b]),e.useEffect(()=>{O(!1),F(!1)},[z]),e.useEffect(()=>{t&&a&&n?(async()=>{try{c(!0),u(null);const e=localStorage.getItem("auth-token");if(!e)throw new Error("Token de acesso não encontrado");const s=await ls.getFreteData(e,{start_date:a,end_date:n,table_name:t});l(s.data)}catch(e){u(e instanceof Error?e.message:"Erro ao carregar dados")}finally{c(!1)}})():c(!1)},[t,a,n]);const H=s.useMemo(()=>U?i.filter(e=>e.zipcode_region===U):i,[i,U]),G=(()=>{const e=H;if(!e.length)return null;const t=e.reduce((e,t)=>e+t.calculations,0),s=e.reduce((e,t)=>e+t.calculations_freight_unavailable,0),r=e.reduce((e,t)=>e+t.transactions,0);return{totalCalculations:t,totalCalculationsFreightUnavailable:s,totalTransactions:r,totalRevenue:e.reduce((e,t)=>e+(t.revenue||0),0),uniqueZipcodes:new Set(e.map(e=>e.zipcode)).size,uniqueRegions:new Set(e.map(e=>e.zipcode_region)).size,conversionRate:t>0?r/t*100:0,freightSuccessRate:t>0?(t-s)/t*100:0}})(),q=s.useMemo(()=>{const e=i.reduce((e,t)=>(e[t.zipcode_region]||(e[t.zipcode_region]={region:t.zipcode_region,calculations:0,calculations_freight_unavailable:0,transactions:0,revenue:0,zipcodes:new Set}),e[t.zipcode_region].calculations+=t.calculations,e[t.zipcode_region].calculations_freight_unavailable+=t.calculations_freight_unavailable,e[t.zipcode_region].transactions+=t.transactions,e[t.zipcode_region].revenue+=t.revenue||0,e[t.zipcode_region].zipcodes.add(t.zipcode),e),{}),t=Object.values(e).map(e=>({...e,zipcodeCount:e.zipcodes.size,conversionRate:e.calculations>0?e.transactions/e.calculations*100:0,freightSuccessRate:e.calculations>0?(e.calculations-e.calculations_freight_unavailable)/e.calculations*100:0})).filter(e=>e.calculations>=z),s=t.length>0?t.reduce((e,t)=>e+t.conversionRate,0)/t.length:0,r=t.length>0?t.reduce((e,t)=>e+t.freightSuccessRate,0)/t.length:0;return t.sort((e,t)=>{let s=e[m],r=t[m];return"region"===m&&(s=s.toLowerCase(),r=r.toLowerCase()),"asc"===b?s>r?1:s<r?-1:0:s<r?1:s>r?-1:0}),{regionData:t,avgConversionRate:s,avgFreightSuccessRate:r}},[i,m,b,z]),{regionData:Y,avgConversionRate:X,avgFreightSuccessRate:J}=q,Z=s.useMemo(()=>{const e=H.filter(e=>e.item_id&&e.item_name).reduce((e,t)=>{const s=`${t.item_id}_${t.item_name}`;return e[s]||(e[s]={item_id:t.item_id,item_name:t.item_name,item_brand:t.item_brand||"Não informado",item_category:t.item_category||"Não informado",calculations:0,calculations_freight_unavailable:0,transactions:0,revenue:0}),e[s].calculations+=t.calculations,e[s].calculations_freight_unavailable+=t.calculations_freight_unavailable,e[s].transactions+=t.transactions,e[s].revenue+=t.revenue||0,e},{}),t=Object.values(e).map(e=>({...e,conversionRate:e.calculations>0?e.transactions/e.calculations*100:0,freightSuccessRate:e.calculations>0?(e.calculations-e.calculations_freight_unavailable)/e.calculations*100:0})).filter(e=>e.calculations>=z),s=t.length>0?t.reduce((e,t)=>e+t.conversionRate,0)/t.length:0,r=t.length>0?t.reduce((e,t)=>e+t.freightSuccessRate,0)/t.length:0;return t.sort((e,t)=>{let s=e[S],r=t[S];return"item_name"!==S&&"item_brand"!==S&&"item_category"!==S||(s=s.toLowerCase(),r=r.toLowerCase()),"asc"===P?s>r?1:s<r?-1:0:s<r?1:s>r?-1:0}),{productData:t,avgProductConversionRate:s,avgProductFreightSuccessRate:r}},[H,S,P,z]),{productData:Q,avgProductConversionRate:ee,avgProductFreightSuccessRate:te}=Z,se=s.useMemo(()=>[...H].sort((e,t)=>{let s=e[w],r=t[w];if("event_date"===w){const[e,t,a]=s.split("-").map(Number),[n,i,l]=r.split("-").map(Number);s=new Date(e,t-1,a).getTime(),r=new Date(n,i-1,l).getTime()}else("zipcode"===w||"zipcode_region"===w)&&(s=s.toLowerCase(),r=r.toLowerCase());return"asc"===N?s>r?1:s<r?-1:0:s<r?1:s>r?-1:0}),[H,w,N]),re=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),ae=e=>new Intl.NumberFormat("pt-BR").format(e),ce=e=>`${e.toFixed(2)}%`,de=e=>{m===e?y("asc"===b?"desc":"asc"):(h(e),y("desc"))},ue=e=>{w===e?k("asc"===N?"desc":"asc"):(j(e),k("desc"))},me=e=>{S===e?M("asc"===P?"desc":"asc"):(T(e),M("desc"))},he=(e,t,s)=>t!==e?null:"asc"===s?$e.jsx(A,{className:"w-4 h-4"}):$e.jsx(C,{className:"w-4 h-4"});return o?$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:$e.jsx("div",{className:"flex items-center justify-center py-12",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando dados de frete..."})]})})}):d?$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:$e.jsxs("div",{className:"text-center py-12",children:[$e.jsx("div",{className:"text-red-500 mb-4",children:$e.jsx(g,{className:"w-12 h-12 mx-auto"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar dados"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:d}),$e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar novamente"})]})}):i.length?$e.jsxs("div",{className:"space-y-6",children:[$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(g,{className:"w-6 h-6 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Análise de Frete"}),$e.jsxs("p",{className:"text-gray-600",children:["Dados de cálculo de frete de ",a," até ",n]})]})]}),$e.jsxs("div",{className:"flex items-center gap-3",children:[U&&$e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-100 rounded-lg",children:[$e.jsx(ne,{className:"w-4 h-4 text-blue-600"}),$e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["Filtro: ",U]}),$e.jsx("button",{onClick:()=>W(null),className:"ml-1 text-blue-600 hover:text-blue-800",title:"Remover filtro",children:"✕"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Mín. Cálculos:"}),$e.jsx("input",{type:"number",min:"0",value:z,onChange:e=>V(Number(e.target.value)),className:"w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),$e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[$e.jsx(D,{className:"w-4 h-4"}),"Exportar"]})]})]}),G&&$e.jsxs("div",{className:"space-y-6",children:[$e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-blue-200 rounded-lg",children:$e.jsx(ie,{className:"w-6 h-6 text-blue-700"})}),$e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Cálculos de Frete"})]}),$e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:ae(G.totalCalculations)}),$e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Total de consultas realizadas"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-green-200 rounded-lg",children:$e.jsx(f,{className:"w-6 h-6 text-green-700"})}),$e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Transações"})]}),$e.jsx("p",{className:"text-3xl font-bold text-green-900",children:ae(G.totalTransactions)}),$e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Pedidos convertidos"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-purple-200 rounded-lg",children:$e.jsx(R,{className:"w-6 h-6 text-purple-700"})}),$e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Receita Total"})]}),$e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:re(G.totalRevenue)}),$e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Valor gerado"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-orange-200 rounded-lg",children:$e.jsx(v,{className:"w-6 h-6 text-orange-700"})}),$e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Taxa de Conversão"})]}),$e.jsx("p",{className:"text-3xl font-bold text-orange-900",children:ce(G.conversionRate)}),$e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Cálculos → Pedidos"})]})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-green-200 rounded-lg",children:$e.jsx(r,{className:"w-6 h-6 text-green-700"})}),$e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Taxa de Sucesso"})]}),$e.jsx("p",{className:"text-3xl font-bold text-green-900",children:ce(G.freightSuccessRate)}),$e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Frete disponível"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-red-200 rounded-lg",children:$e.jsx(le,{className:"w-6 h-6 text-red-700"})}),$e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Frete Indisponível"})]}),$e.jsx("p",{className:"text-3xl font-bold text-red-900",children:ae(G.totalCalculationsFreightUnavailable)}),$e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Cálculos sem opção de frete"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-indigo-200 rounded-lg",children:$e.jsx(ne,{className:"w-6 h-6 text-indigo-700"})}),$e.jsx("span",{className:"text-sm font-medium text-indigo-700",children:"CEPs Únicos"})]}),$e.jsx("p",{className:"text-3xl font-bold text-indigo-900",children:ae(G.uniqueZipcodes)}),$e.jsx("p",{className:"text-xs text-indigo-600 mt-1",children:"Códigos postais consultados"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 p-6 rounded-xl",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[$e.jsx("div",{className:"p-2 bg-pink-200 rounded-lg",children:$e.jsx(E,{className:"w-6 h-6 text-pink-700"})}),$e.jsx("span",{className:"text-sm font-medium text-pink-700",children:"Regiões Atendidas"})]}),$e.jsx("p",{className:"text-3xl font-bold text-pink-900",children:ae(G.uniqueRegions)}),$e.jsx("p",{className:"text-xs text-pink-600 mt-1",children:"Áreas geográficas diferentes"})]})]})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[$e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(ne,{className:"w-5 h-5 text-blue-600"}),"Performance por Região"]}),$e.jsxs("p",{className:"text-gray-600 mt-1",children:["Análise detalhada dos cálculos de frete por região • ",$e.jsx("span",{className:"font-medium text-blue-600",children:"Clique em uma região para filtrar o dashboard"})]})]}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("region"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Região",he("region",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("zipcodeCount"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["CEPs Únicos",he("zipcodeCount",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("calculations"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Cálculos",he("calculations",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("calculations_freight_unavailable"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Frete Indisponível",he("calculations_freight_unavailable",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("freightSuccessRate"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Taxa de Sucesso",he("freightSuccessRate",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("transactions"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Transações",he("transactions",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("conversionRate"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Taxa de Conversão",he("conversionRate",m,b)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>de("revenue"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Receita",he("revenue",m,b)]})})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(I?Y:Y.slice(0,10)).map((e,t)=>$e.jsxs("tr",{onClick:()=>W(e.region),className:"cursor-pointer transition-colors "+(U===e.region?"bg-blue-100 hover:bg-blue-200":t%2==0?"bg-white hover:bg-gray-100":"bg-gray-50 hover:bg-gray-100"),title:"Clique para filtrar por esta região",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx(ne,{className:"w-4 h-4 text-gray-400 mr-2"}),$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.region})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.zipcodeCount)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.calculations)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.calculations_freight_unavailable>0?"text-red-600":"text-gray-600"),children:ae(e.calculations_freight_unavailable)}),e.calculations_freight_unavailable>0&&$e.jsx(le,{className:"w-4 h-4 text-red-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.freightSuccessRate>=1.1*J?"text-green-600":e.freightSuccessRate>=.9*J?"text-yellow-600":"text-red-600"),children:ce(e.freightSuccessRate)}),e.freightSuccessRate>=1.1*J&&$e.jsx(r,{className:"w-4 h-4 text-green-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.transactions)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.conversionRate>=1.2*X?"text-green-600":e.conversionRate>=.8*X?"text-yellow-600":"text-red-600"),children:ce(e.conversionRate)}),e.conversionRate>=1.2*X&&$e.jsx(v,{className:"w-4 h-4 text-green-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re(e.revenue)})]},e.region))})]})}),Y.length>10&&$e.jsx("div",{className:"p-4 border-t border-gray-200",children:I?$e.jsxs("button",{onClick:()=>F(!1),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium",children:[$e.jsx("span",{children:"Ver menos"}),$e.jsx(A,{className:"w-4 h-4"})]}):$e.jsxs("button",{onClick:()=>F(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[$e.jsxs("span",{children:["Ver mais ",Y.length-10," regiões"]}),$e.jsx(C,{className:"w-4 h-4"})]})})]}),Q.length>0&&$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 "+(B?"fixed inset-0 z-50 overflow-auto":""),children:[$e.jsx("div",{className:"p-6 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(x,{className:"w-5 h-5 text-blue-600"}),"Performance por Produto"]}),$e.jsx("p",{className:"text-gray-600 mt-1",children:"Análise detalhada dos cálculos de frete por produto"})]}),$e.jsx("button",{onClick:()=>$(!B),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:B?"Sair da tela cheia":"Tela cheia",children:B?$e.jsx(oe,{className:"w-5 h-5 text-gray-600"}):$e.jsx(K,{className:"w-5 h-5 text-gray-600"})})]})}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("item_id"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["ID",he("item_id",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("item_name"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Produto",he("item_name",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("item_brand"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Marca",he("item_brand",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("item_category"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Categoria",he("item_category",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("calculations"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Cálculos",he("calculations",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("calculations_freight_unavailable"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Frete Indisponível",he("calculations_freight_unavailable",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("freightSuccessRate"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Taxa de Sucesso",he("freightSuccessRate",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("transactions"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Transações",he("transactions",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("conversionRate"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Taxa de Conversão",he("conversionRate",S,P)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>me("revenue"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Receita",he("revenue",S,P)]})})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(L?Q:Q.slice(0,10)).map((e,t)=>$e.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-600",children:e.item_id}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx(x,{className:"w-4 h-4 text-gray-400 mr-2"}),$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.item_name})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.item_brand}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.item_category}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.calculations)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.calculations_freight_unavailable>0?"text-red-600":"text-gray-600"),children:ae(e.calculations_freight_unavailable)}),e.calculations_freight_unavailable>0&&$e.jsx(le,{className:"w-4 h-4 text-red-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.freightSuccessRate>=1.1*te?"text-green-600":e.freightSuccessRate>=.9*te?"text-yellow-600":"text-red-600"),children:ce(e.freightSuccessRate)}),e.freightSuccessRate>=1.1*te&&$e.jsx(r,{className:"w-4 h-4 text-green-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.transactions)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.conversionRate>=1.2*ee?"text-green-600":e.conversionRate>=.8*ee?"text-yellow-600":"text-red-600"),children:ce(e.conversionRate)}),e.conversionRate>=1.2*ee&&$e.jsx(v,{className:"w-4 h-4 text-green-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re(e.revenue)})]},`${e.item_id}-${e.item_name}`))})]})}),Q.length>10&&$e.jsx("div",{className:"p-4 border-t border-gray-200",children:L?$e.jsxs("button",{onClick:()=>O(!1),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium",children:[$e.jsx("span",{children:"Ver menos"}),$e.jsx(A,{className:"w-4 h-4"})]}):$e.jsxs("button",{onClick:()=>O(!0),className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[$e.jsxs("span",{children:["Ver mais ",Q.length-10," produtos"]}),$e.jsx(C,{className:"w-4 h-4"})]})})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[$e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(p,{className:"w-5 h-5 text-blue-600"}),"Dados Detalhados por CEP"]}),$e.jsx("p",{className:"text-gray-600 mt-1",children:"Visualização completa de todos os cálculos de frete"})]}),$e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:$e.jsxs("p",{className:"text-sm text-blue-700",children:[$e.jsx("strong",{children:"Mostrando os primeiros 100 registros"})," de ",ae(H.length)," registros",U?" filtrados":" totais",".",!U&&" Para ver todos os dados, considere filtrar por um período menor."]})}),$e.jsx("div",{className:"overflow-x-auto max-h-96",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("event_date"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Data",he("event_date",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("zipcode"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["CEP",he("zipcode",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("zipcode_region"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Região",he("zipcode_region",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("calculations"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Cálculos",he("calculations",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("calculations_freight_unavailable"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Frete Indisponível",he("calculations_freight_unavailable",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("transactions"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Transações",he("transactions",w,N)]})}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>ue("revenue"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:["Receita",he("revenue",w,N)]})})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.slice(0,100).map((e,t)=>$e.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx(_,{className:"w-4 h-4 text-gray-400 mr-2"}),(()=>{const[t,s,r]=e.event_date.split("-").map(Number);return new Date(t,s-1,r).toLocaleDateString("pt-BR")})()]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:e.zipcode}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.zipcode_region}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.calculations)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("span",{className:"text-sm font-medium "+(e.calculations_freight_unavailable>0?"text-red-600":"text-gray-600"),children:ae(e.calculations_freight_unavailable)}),e.calculations_freight_unavailable>0&&$e.jsx(le,{className:"w-4 h-4 text-red-600 ml-1"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(e.transactions)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.revenue?re(e.revenue):"-"})]},`frete-${t}-${e.event_date}-${e.zipcode}-${e.zipcode_region}`))})]})})]})]}):$e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:$e.jsxs("div",{className:"text-center py-12",children:[$e.jsx("div",{className:"text-gray-400 mb-4",children:$e.jsx(g,{className:"w-12 h-12 mx-auto"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de cálculo de frete para o período selecionado."})]})})},pm=({selectedTable:t})=>{var s,r;const[n,i]=e.useState([]),[l,o]=e.useState(!0),[c,d]=e.useState(null),[u,m]=e.useState(!1),[h,x]=e.useState(!1),[p,f]=e.useState(!1),[g,b]=e.useState(!1),[w,j]=e.useState(!1),[N,_]=e.useState("revenue"),[k,C]=e.useState("revenue"),[S,T]=e.useState("revenue"),[A,P]=e.useState("revenue"),[M,L]=e.useState("revenue"),[I,D]=e.useState({}),B=()=>new Date,$=e=>{const t=new Date(e);return new Date(t.getTime()-108e5)},z=async()=>{try{const e=localStorage.getItem("auth-token");if(!e||!t)return;if(!is(t))return void d("Tabela inválida selecionada");d(null);const s=await ls.getRealtimeData(e,{table_name:t});i(s.data||[])}catch(e){d("Erro ao buscar dados"),i([])}finally{o(!1)}};e.useEffect(()=>{o(!0),z()},[t]);const V=(e,t)=>{const s=e.toLowerCase(),r=t.toLowerCase();return"direct"===s||"(direct)"===s&&"(none)"===r?"Tráfego Direto":s.includes("google")&&(r.includes("organic")||r.includes("search"))?"Busca Orgânica":s.includes("google")&&(r.includes("cpc")||r.includes("paid"))?"Google Ads":s.includes("facebook")||s.includes("instagram")||r.includes("social")?"Redes Sociais":r.includes("email")?"E-mail Marketing":r.includes("referral")?"Sites de Referência":r.includes("cpc")||r.includes("paid")?"Mídia Paga":"Outros"},U=e=>{switch(e){case"Tráfego Direto":return"bg-gray-500";case"Busca Orgânica":return"bg-blue-500";case"Google Ads":return"bg-green-500";case"Redes Sociais":return"bg-purple-500";case"E-mail Marketing":return"bg-orange-500";case"Sites de Referência":return"bg-yellow-500";case"Mídia Paga":return"bg-red-500";default:return"bg-indigo-500"}},W=(e,t)=>{const s=`${e}/${t}`.toLowerCase();return s.includes("google")||s.includes("search")?"bg-blue-100 text-blue-800":s.includes("facebook")||s.includes("social")?"bg-purple-100 text-purple-800":s.includes("email")?"bg-green-100 text-green-800":s.includes("direct")?"bg-gray-100 text-gray-800":s.includes("referral")?"bg-orange-100 text-orange-800":"bg-indigo-100 text-indigo-800"},H=(()=>{const e=B(),t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);return n.filter(e=>{const r=$(e.event_timestamp);return r>=t&&r<s})})(),q=(()=>{const e=B().getHours(),t=[];for(let r=0;r<24;r++)t.push({hour:r,hourLabel:`${r.toString().padStart(2,"0")}:00`,sessions:0,revenue:0,isCurrentHour:r===e});const s={};return H.forEach(e=>{const t=$(e.event_timestamp).getHours();s[t]||(s[t]=[]),s[t].push(e)}),Object.keys(s).forEach(e=>{const r=parseInt(e),a=s[r];t[r].revenue=a.reduce((e,t)=>e+(t.item_revenue||0),0);const n=new Set(a.map(e=>e.session_id));t[r].sessions=n.size}),t})(),Y=()=>{let e=[...H];return I.trafficCategory&&(e=e.filter(e=>(e.traffic_category||V(e.source,e.medium))===I.trafficCategory)),I.sourceMedium&&(e=e.filter(e=>e.source===I.sourceMedium.source&&e.medium===I.sourceMedium.medium)),I.campaign&&(e=e.filter(e=>(e.campaign||"(not set)")===I.campaign)),I.page&&(e=e.filter(e=>(e.page_location||"(not set)")===I.page)),I.product&&(e=e.filter(e=>e.item_name===I.product)),e},K=Y(),X=(()=>{const e=Object.keys(I).length>0?K:H,t={};e.forEach(e=>{const s=e.traffic_category||V(e.source,e.medium);t[s]||(t[s]={category:s,sessions:0,revenue:0,percentage:0,color:U(s)}),t[s].revenue+=e.item_revenue||0});const s={};e.forEach(e=>{const t=e.traffic_category||V(e.source,e.medium);s[t]||(s[t]=new Set),s[t].add(e.session_id)});const r=new Set(e.map(e=>e.session_id)).size;return Object.keys(t).forEach(e=>{var a;t[e].sessions=(null==(a=s[e])?void 0:a.size)||0,t[e].percentage=r>0?t[e].sessions/r*100:0}),Object.values(t).sort((e,t)=>"sessions"===N?t.sessions-e.sessions:t.revenue-e.revenue)})(),J=(()=>{const e=Object.keys(I).length>0?K:H,t={};e.forEach(e=>{const s=`${e.source}|${e.medium}`;t[s]||(t[s]={source:e.source,medium:e.medium,sessions:0,revenue:0,percentage:0}),t[s].revenue+=e.item_revenue||0});const s={};e.forEach(e=>{const t=`${e.source}|${e.medium}`;s[t]||(s[t]=new Set),s[t].add(e.session_id)});const r=new Set(e.map(e=>e.session_id)).size;return Object.keys(t).forEach(e=>{var a;t[e].sessions=(null==(a=s[e])?void 0:a.size)||0,t[e].percentage=r>0?t[e].sessions/r*100:0}),Object.values(t).sort((e,t)=>"sessions"===k?t.sessions-e.sessions:t.revenue-e.revenue)})(),Z=(()=>{const e=Object.keys(I).length>0?K:H,t={};e.forEach(e=>{const s=e.campaign||"(not set)";t[s]||(t[s]={campaign:s,sessions:0,revenue:0,percentage:0}),t[s].revenue+=e.item_revenue||0});const s={};e.forEach(e=>{const t=e.campaign||"(not set)";s[t]||(s[t]=new Set),s[t].add(e.session_id)});const r=new Set(e.map(e=>e.session_id)).size;return Object.keys(t).forEach(e=>{var a;t[e].sessions=(null==(a=s[e])?void 0:a.size)||0,t[e].percentage=r>0?t[e].sessions/r*100:0}),Object.values(t).sort((e,t)=>"sessions"===S?t.sessions-e.sessions:t.revenue-e.revenue)})(),Q=(()=>{const e=Object.keys(I).length>0?K:H,t={};e.forEach(e=>{const s=e.page_location||"(not set)";t[s]||(t[s]={page:s,sessions:0,revenue:0,percentage:0}),t[s].revenue+=e.item_revenue||0});const s={};e.forEach(e=>{const t=e.page_location||"(not set)";s[t]||(s[t]=new Set),s[t].add(e.session_id)});const r=new Set(e.map(e=>e.session_id)).size;return Object.keys(t).forEach(e=>{var a;t[e].sessions=(null==(a=s[e])?void 0:a.size)||0,t[e].percentage=r>0?t[e].sessions/r*100:0}),Object.values(t).sort((e,t)=>"sessions"===A?t.sessions-e.sessions:t.revenue-e.revenue)})(),ee=(()=>{const e=Object.keys(I).length>0?K:H,t={};e.forEach(e=>{if(e.item_name){const s=e.item_name;t[s]||(t[s]={product:s,sessions:0,revenue:0,percentage:0}),t[s].revenue+=e.item_revenue||0}});const s={};e.forEach(e=>{if(e.item_name){const t=e.item_name;s[t]||(s[t]=new Set),s[t].add(e.session_id)}});const r=new Set(e.map(e=>e.session_id)).size;return Object.keys(t).forEach(e=>{var a;t[e].sessions=(null==(a=s[e])?void 0:a.size)||0,t[e].percentage=r>0?t[e].sessions/r*100:0}),Object.values(t).sort((e,t)=>"sessions"===M?t.sessions-e.sessions:t.revenue-e.revenue)})(),te=(e,t)=>{D(s=>({...s,[e]:t}))},se=e=>{D(t=>{const s={...t};return delete s[e],s})},re=(()=>{if(0===Object.keys(I).length)return q;const e=Y();return Array.from({length:24},(t,s)=>{const r=e.filter(e=>$(e.event_timestamp).getHours()===s);return{hour:s,hourLabel:`${s.toString().padStart(2,"0")}:00`,sessions:new Set(r.map(e=>e.session_id)).size,revenue:r.reduce((e,t)=>e+(t.item_revenue||0),0),isCurrentHour:s===B().getHours()}})})(),ae=Object.keys(I).length>0?K:H,ne=Object.keys(I).length>0?re:q,ie={totalRevenue:ae.reduce((e,t)=>e+(t.item_revenue||0),0),uniqueSessions:new Set(ae.map(e=>e.session_id)).size,activeHours:ne.filter(e=>e.sessions>0).length,currentHourSessions:(null==(s=ne.find(e=>e.isCurrentHour))?void 0:s.sessions)||0,currentHourRevenue:(null==(r=ne.find(e=>e.isCurrentHour))?void 0:r.revenue)||0,peakHour:ne.reduce((e,t)=>t.sessions>e.sessions?t:e,ne[0]),avgSessionsPerHour:ne.filter(e=>e.sessions>0).length>0?Math.round(ne.reduce((e,t)=>e+t.sessions,0)/ne.filter(e=>e.sessions>0).length):0};return l&&0===n.length?$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Carregando dados..."}),$e.jsx("p",{className:"text-gray-600",children:"Aguarde enquanto buscamos os dados"})]}):c?$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx(a,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Erro ao carregar dados"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:c}),$e.jsx("button",{onClick:()=>z(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar novamente"})]}):$e.jsxs("div",{className:"space-y-6",children:[Object.keys(I).length>0&&$e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Filtros ativos:"}),$e.jsxs("div",{className:"flex flex-wrap gap-2",children:[I.trafficCategory&&$e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:["Categoria: ",I.trafficCategory,$e.jsx("button",{onClick:()=>se("trafficCategory"),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),I.sourceMedium&&$e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:["Origem: ",I.sourceMedium.source," / ",I.sourceMedium.medium,$e.jsx("button",{onClick:()=>se("sourceMedium"),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),I.campaign&&$e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:["Campanha: ",I.campaign,$e.jsx("button",{onClick:()=>se("campaign"),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),I.page&&$e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:["Página: ",I.page.length>30?I.page.substring(0,30)+"...":I.page,$e.jsx("button",{onClick:()=>se("page"),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]}),I.product&&$e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:["Produto: ",I.product.length>30?I.product.substring(0,30)+"...":I.product,$e.jsx("button",{onClick:()=>se("product"),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]})]})]}),$e.jsx("button",{onClick:()=>{D({})},className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Limpar todos os filtros"})]})}),$e.jsxs("div",{className:"mb-4",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Object.keys(I).length>0?"Métricas Filtradas":"Métricas do Dia"}),Object.keys(I).length>0&&$e.jsxs("p",{className:"text-sm text-gray-600",children:["Mostrando dados filtrados por ",Object.keys(I).length," critério(s) - Timeline e todas as tabelas atualizadas"]})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(E,{className:"w-5 h-5 text-blue-600"})}),$e.jsx("span",{className:"text-sm text-gray-500",children:"Hoje"})]}),$e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:ie.uniqueSessions}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Sessões únicas"})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:$e.jsx(R,{className:"w-5 h-5 text-green-600"})}),$e.jsx("span",{className:"text-sm text-gray-500",children:"Hoje"})]}),$e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ie.totalRevenue)}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Receita total"})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:$e.jsx(v,{className:"w-5 h-5 text-purple-600"})}),$e.jsx("span",{className:"text-sm text-gray-500",children:"Agora"})]}),$e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:ie.currentHourSessions}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Sessões desta hora"})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[$e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:$e.jsx(y,{className:"w-5 h-5 text-orange-600"})}),$e.jsx("span",{className:"text-sm text-gray-500",children:"Peak"})]}),$e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:ie.peakHour?`${ie.peakHour.hourLabel}`:"--"}),$e.jsx("p",{className:"text-sm text-gray-600",children:ie.peakHour?`${ie.peakHour.sessions} sessões`:"Nenhum pico"})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(y,{className:"w-5 h-5 text-blue-600"}),Object.keys(I).length>0?"Timeline Filtrada":"Timeline Gráfico de Barras"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:Object.keys(I).length>0?`Sessões e receita por hora do dia filtradas (${Object.keys(I).length} filtro(s) ativo(s))`:"Sessões e receita por hora do dia (00:00 - 23:00)"})]}),$e.jsxs("div",{className:"p-6",children:[$e.jsxs("div",{className:"flex items-center justify-center gap-6 mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),$e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Sessões"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-4 h-4 bg-green-600 rounded"}),$e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Receita (R$)"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("div",{className:"w-4 h-4 bg-blue-500 border-2 border-blue-300 rounded"}),$e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Hora Atual"})]})]}),$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"absolute left-0 top-0 h-64 w-12 flex flex-col justify-between text-xs text-gray-500",children:(()=>{const e=Math.max(...q.map(e=>e.sessions)),t=Math.max(...q.map(e=>e.revenue)),s=Math.max(e,t),r=Math.ceil(s/5);return Array.from({length:6},(e,t)=>$e.jsx("div",{className:"text-right pr-2",children:Math.round(r*(5-t))},t))})()}),$e.jsxs("div",{className:"ml-12 relative",children:[$e.jsx("div",{className:"absolute inset-0 h-64",children:Array.from({length:6},(e,t)=>$e.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:t/5*100+"%"}},t))}),$e.jsx("div",{className:"relative h-64 flex items-end justify-between gap-1",children:ne.map(e=>{const t=Math.max(...ne.map(e=>e.sessions)),s=Math.max(...ne.map(e=>e.revenue)),r=Math.max(t,s),a=r>0?e.sessions/r*100:0,n=r>0?e.revenue/r*100:0;return $e.jsxs("div",{className:"flex flex-col items-center group relative",children:[$e.jsxs("div",{className:"invisible group-hover:visible absolute bottom-full mb-2 p-2 bg-gray-800 text-white text-xs rounded shadow-lg whitespace-nowrap z-10",children:[$e.jsx("div",{children:e.hourLabel}),$e.jsxs("div",{children:["Sessões: ",e.sessions]}),$e.jsxs("div",{children:["Receita: R$ ",e.revenue.toFixed(0)]})]}),$e.jsxs("div",{className:"flex items-end gap-0.5 h-64",children:[$e.jsx("div",{className:"w-3 transition-all duration-300 rounded-t "+(e.isCurrentHour?"bg-blue-500 ring-2 ring-blue-300":"bg-blue-600 hover:bg-blue-700"),style:{height:`${a}%`}}),$e.jsx("div",{className:"w-3 transition-all duration-300 rounded-t "+(e.isCurrentHour?"bg-green-500 ring-2 ring-green-300":"bg-green-600 hover:bg-green-700"),style:{height:`${n}%`}})]}),$e.jsx("div",{className:"mt-2 text-xs text-center "+(e.isCurrentHour?"font-bold text-blue-700":"text-gray-600"),children:e.hourLabel}),e.isCurrentHour&&$e.jsx("div",{className:"mt-1",children:$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})})]},e.hour)})}),$e.jsx("div",{className:"border-t border-gray-300 mt-4"})]})]}),$e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[$e.jsxs("div",{className:"text-center",children:[$e.jsx("div",{className:"text-lg font-bold text-blue-600",children:Math.max(...ne.map(e=>e.sessions))}),$e.jsx("div",{className:"text-sm text-gray-600",children:"Pico de Sessões"})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["R$ ",Math.max(...ne.map(e=>e.revenue)).toFixed(0)]}),$e.jsx("div",{className:"text-sm text-gray-600",children:"Pico de Receita"})]}),$e.jsxs("div",{className:"text-center",children:[$e.jsxs("div",{className:"text-lg font-bold text-gray-700",children:[ne.filter(e=>e.sessions>0).length,"h"]}),$e.jsx("div",{className:"text-sm text-gray-600",children:"Horas Ativas"})]})]})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(v,{className:"w-5 h-5 text-blue-600"}),"Totais por Categoria de Tráfego"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Distribuição de sessões e receita por canal de aquisição"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Ordenar por:"}),$e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[$e.jsx("button",{onClick:()=>_("sessions"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("sessions"===N?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Sessões"}),$e.jsx("button",{onClick:()=>_("revenue"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("revenue"===N?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Receita"})]})]})]})}),0===X.length?$e.jsxs("div",{className:"p-12 text-center",children:[$e.jsx(v,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma categoria encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de tráfego para categorizar hoje."})]}):$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{children:$e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoria de Tráfego"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(u?X:X.slice(0,10)).map(e=>$e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer "+(I.trafficCategory===e.category?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>te("trafficCategory",e.category),children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:`w-3 h-3 rounded-full ${e.color}`}),$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.category})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.sessions.toLocaleString("pt-BR")})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.revenue)})})]},e.category))}),$e.jsx("tfoot",{children:$e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-gray-50 font-semibold",children:[$e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-blue-600",children:X.reduce((e,t)=>e+t.sessions,0).toLocaleString("pt-BR")}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(X.reduce((e,t)=>e+t.revenue,0))})]})})]}),X.length>10&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>m(!u),className:"w-full text-center text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:u?`Mostrar apenas top 10 (de ${X.length} categorias)`:`Ver mais ${X.length-10} categorias`})})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(ce,{className:"w-5 h-5 text-blue-600"}),"Detalhamento por Origem e Mídia"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Dados específicos de cada source/medium"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Ordenar por:"}),$e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[$e.jsx("button",{onClick:()=>C("sessions"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("sessions"===k?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Sessões"}),$e.jsx("button",{onClick:()=>C("revenue"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("revenue"===k?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Receita"})]})]})]})}),0===J.length?$e.jsxs("div",{className:"p-12 text-center",children:[$e.jsx(ce,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma origem encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de origem e mídia para hoje."})]}):$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"w-full table-fixed",children:[$e.jsx("thead",{children:$e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},children:"Origem"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"120px"},children:"Mídia"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(h?J:J.slice(0,10)).map(e=>{var t,s;return $e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer "+((null==(t=I.sourceMedium)?void 0:t.source)===e.source&&(null==(s=I.sourceMedium)?void 0:s.medium)===e.medium?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>te("sourceMedium",{source:e.source,medium:e.medium}),children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{width:"150px"},children:$e.jsx("div",{className:"truncate",title:e.source,children:$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.source})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{width:"120px"},children:$e.jsx("div",{className:"truncate",title:e.medium,children:$e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${W(e.source,e.medium)}`,children:e.medium})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.sessions.toLocaleString("pt-BR")})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.revenue)})})]},`${e.source}-${e.medium}`)})}),$e.jsx("tfoot",{children:$e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-gray-50 font-semibold",children:[$e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",colSpan:2,children:"TOTAL"}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-blue-600",children:J.reduce((e,t)=>e+t.sessions,0).toLocaleString("pt-BR")}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(J.reduce((e,t)=>e+t.revenue,0))})]})})]}),J.length>10&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>x(!h),className:"w-full text-center text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:h?`Mostrar apenas top 10 (de ${J.length} origens)`:`Ver mais ${J.length-10} origens`})})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(G,{className:"w-5 h-5 text-blue-600"}),"Detalhamento por Campanha"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Performance de campanhas de marketing"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Ordenar por:"}),$e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[$e.jsx("button",{onClick:()=>T("sessions"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("sessions"===S?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Sessões"}),$e.jsx("button",{onClick:()=>T("revenue"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("revenue"===S?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Receita"})]})]})]})}),0===Z.length?$e.jsxs("div",{className:"p-12 text-center",children:[$e.jsx(G,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma campanha encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de campanhas para hoje."})]}):$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"w-full table-fixed",children:[$e.jsx("thead",{children:$e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"200px"},children:"Campanha"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(p?Z:Z.slice(0,10)).map(e=>$e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer "+(I.campaign===e.campaign?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>te("campaign",e.campaign),children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{width:"200px"},children:$e.jsx("div",{className:"truncate",title:e.campaign,children:$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.campaign})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.sessions.toLocaleString("pt-BR")})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.revenue)})})]},e.campaign))}),$e.jsx("tfoot",{children:$e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-gray-50 font-semibold",children:[$e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-blue-600",children:Z.reduce((e,t)=>e+t.sessions,0).toLocaleString("pt-BR")}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(Z.reduce((e,t)=>e+t.revenue,0))})]})})]}),Z.length>10&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>f(!p),className:"w-full text-center text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:p?`Mostrar apenas top 10 (de ${Z.length} campanhas)`:`Ver mais ${Z.length-10} campanhas`})})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(F,{className:"w-5 h-5 text-blue-600"}),"Detalhamento por Página"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Performance de páginas do site"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Ordenar por:"}),$e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[$e.jsx("button",{onClick:()=>P("sessions"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("sessions"===A?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Sessões"}),$e.jsx("button",{onClick:()=>P("revenue"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("revenue"===A?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Receita"})]})]})]})}),0===Q.length?$e.jsxs("div",{className:"p-12 text-center",children:[$e.jsx(F,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma página encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de páginas para hoje."})]}):$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"w-full table-fixed",children:[$e.jsx("thead",{children:$e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"300px"},children:"Página"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(g?Q:Q.slice(0,10)).map(e=>$e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer "+(I.page===e.page?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>te("page",e.page),children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{width:"300px"},children:$e.jsx("div",{className:"truncate",title:e.page,children:$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.page})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.sessions.toLocaleString("pt-BR")})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.revenue)})})]},e.page))}),$e.jsx("tfoot",{children:$e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-gray-50 font-semibold",children:[$e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-blue-600",children:Q.reduce((e,t)=>e+t.sessions,0).toLocaleString("pt-BR")}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(Q.reduce((e,t)=>e+t.revenue,0))})]})})]}),Q.length>10&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>b(!g),className:"w-full text-center text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:g?`Mostrar apenas top 10 (de ${Q.length} páginas)`:`Ver mais ${Q.length-10} páginas`})})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[$e.jsx(O,{className:"w-5 h-5 text-blue-600"}),"Detalhamento por Produto"]}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Performance de produtos do catálogo"})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Ordenar por:"}),$e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[$e.jsx("button",{onClick:()=>L("sessions"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("sessions"===M?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Sessões"}),$e.jsx("button",{onClick:()=>L("revenue"),className:"px-3 py-1 text-xs font-medium rounded-md transition-colors "+("revenue"===M?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Receita"})]})]})]})}),0===ee.length?$e.jsxs("div",{className:"p-12 text-center",children:[$e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum produto encontrado"}),$e.jsx("p",{className:"text-gray-600",children:"Não há dados de produtos para hoje."})]}):$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"w-full table-fixed",children:[$e.jsx("thead",{children:$e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"300px"},children:"Produto"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sessões"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receita"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(w?ee:ee.slice(0,10)).map(e=>$e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer "+(I.product===e.product?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>te("product",e.product),children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",style:{width:"300px"},children:$e.jsx("div",{className:"truncate",title:e.product,children:$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.product})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.sessions.toLocaleString("pt-BR")})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("span",{className:"text-sm font-semibold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.revenue)})})]},e.product))}),$e.jsx("tfoot",{children:$e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-gray-50 font-semibold",children:[$e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-blue-600",children:ee.reduce((e,t)=>e+t.sessions,0).toLocaleString("pt-BR")}),$e.jsx("td",{className:"px-6 py-4 text-right text-sm text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(ee.reduce((e,t)=>e+t.revenue,0))})]})})]}),ee.length>10&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>j(!w),className:"w-full text-center text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:w?`Mostrar apenas top 10 (de ${ee.length} produtos)`:`Ver mais ${ee.length-10} produtos`})})]})]})]})},fm=({onLogout:t,user:s})=>{const[r,a]=e.useState(!1);return $e.jsxs("div",{className:"relative",children:[$e.jsxs("button",{onClick:()=>a(!r),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[$e.jsx(n,{className:"w-4 h-4"}),$e.jsx("span",{className:"hidden sm:inline",children:(null==s?void 0:s.username)||"Usuário"})]}),r&&$e.jsx("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:$e.jsxs("div",{className:"p-4",children:[$e.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200",children:[$e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:$e.jsx(n,{className:"w-5 h-5 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"font-medium text-gray-900",children:(null==s?void 0:s.username)||"Usuário"}),$e.jsx("p",{className:"text-sm text-gray-500",children:null==s?void 0:s.email})]}),(null==s?void 0:s.admin)&&$e.jsx("div",{className:"ml-auto",children:$e.jsx(de,{className:"w-5 h-5 text-yellow-600"})})]}),$e.jsx("div",{className:"space-y-3 mb-4",children:$e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[$e.jsx("span",{className:"text-gray-600",children:"Último login:"}),$e.jsx("span",{className:"text-gray-900",children:(null==s?void 0:s.lastLogin)?(i=s.lastLogin,new Date(i).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})):"--"})]})}),$e.jsx("div",{className:"flex gap-2",children:$e.jsxs("button",{onClick:t,className:"w-full px-3 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[$e.jsx(ue,{className:"w-4 h-4"}),"Sair"]})})]})}),r&&$e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)})]});var i},gm=({selectedTable:t})=>{var s,r,n;const[i,c]=e.useState("usuarios"),[d,u]=e.useState([]),[m,x]=e.useState([]),[p,f]=e.useState(!1),[g,b]=e.useState(""),[v,y]=e.useState("all"),[j,N]=e.useState(null),[_,k]=e.useState(!1),[C,S]=e.useState(null),[T,A]=e.useState(null),[R,P]=e.useState(!1),[M,L]=e.useState(null),[O,I]=e.useState(!1),[D,F]=e.useState(null),[B,$]=e.useState(!1),[z,V]=e.useState(!1),[U,W]=e.useState(!1),[H,G]=e.useState(!1),[q,Y]=e.useState(null),[K,X]=e.useState({month:"",goal_value:""}),[J,Z]=e.useState(!1),[Q,ee]=e.useState(null),[te,se]=e.useState({category_name:"",description:"",rules:{origem:"",midia:"",campaign:"",page_location:"",parametros_url:"",cupom:""}}),[re,ae]=e.useState(null),[ne,ie]=e.useState({email:"",username:"",admin:!1,access_control:"read",tablename:t}),[le,oe]=e.useState({}),[ce,ue]=e.useState(null),ge=async()=>{try{f(!0),ue(null);const e=localStorage.getItem("auth-token");if(!e)return;const s=await ls.getUsers(e,t);u(s.users||[]),x(s.users||[])}catch(e){u([]),x([]),ue(e.message||"Erro ao conectar com a API")}finally{f(!1)}},be=async()=>{try{k(!0),S(null);const e=localStorage.getItem("auth-token");if(!e)return;const s=await ls.getGoals(e,{table_name:t});N(s)}catch(e){N(null),S(e.message||"Erro ao conectar com a API")}finally{k(!1)}},ve=async()=>{try{P(!0),L(null);const e=localStorage.getItem("auth-token");if(!e)return;const s=await ls.getTrafficCategories(e,{table_name:t});A(s)}catch(e){A(null),L(e.message||"Erro ao conectar com a API")}finally{P(!1)}};e.useEffect(()=>{let e=d;g&&(e=e.filter(e=>e.email.toLowerCase().includes(g.toLowerCase())||e.username.toLowerCase().includes(g.toLowerCase()))),"all"!==v&&("admin"===v?e=e.filter(e=>!0===e.admin):"user"===v&&(e=e.filter(e=>!1===e.admin))),x(e)},[d,g,v]),e.useEffect(()=>{t&&(ge(),ie(e=>({...e,tablename:t})))},[t]),e.useEffect(()=>{"metas"===i&&t&&!j&&be()},[i,t]),e.useEffect(()=>{"clusters"===i&&t&&!T&&ve()},[i,t]);const ye=async()=>{if((()=>{const e={};return ne.email?/\S+@\S+\.\S+/.test(ne.email)||(e.email="Email inválido"):e.email="Email é obrigatório",t&&""!==t.trim()||(e.general="Nenhuma tabela selecionada. Selecione uma tabela antes de criar/editar usuários."),oe(e),0===Object.keys(e).length})())try{$(!0);const e=localStorage.getItem("auth-token");if(!e)return;const s=t&&t.trim()?t:ne.tablename&&ne.tablename.trim()?ne.tablename:D&&D.tablename?D.tablename:"";if(!s)return void oe({general:"Tabela não definida. Selecione uma tabela e tente novamente."});const r={email:ne.email,table_name:s,admin:ne.admin};r.tablename=s;const a=await ls.createUser(e,r);a&&a.generated_password?(ae({message:a.message,generated_password:a.generated_password,note:a.note,type:"user"}),V(!0),I(!1)):(D||(ae({message:(null==a?void 0:a.message)||"Usuário criado com sucesso",generated_password:void 0,note:null==a?void 0:a.note,type:"user"}),V(!0)),I(!1)),ge()}catch(e){oe({general:e.message||"Erro ao salvar usuário. Tente novamente."})}finally{$(!1)}};return $e.jsxs("div",{className:"space-y-6",children:[$e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Configurações"}),$e.jsxs("p",{className:"text-gray-600",children:["Gerencie configurações do sistema para ",t]})]})}),$e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:$e.jsxs("nav",{className:"flex",children:[$e.jsx("button",{onClick:()=>c("usuarios"),className:"flex-1 py-2.5 px-4 font-medium text-sm transition-all duration-200 "+("usuarios"===i?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("div",{className:"p-1.5 rounded-md transition-colors "+("usuarios"===i?"bg-blue-100":"bg-gray-100"),children:$e.jsx(E,{className:"w-4 h-4 "+("usuarios"===i?"text-blue-600":"text-gray-500")})}),$e.jsx("span",{children:"Usuários"})]})}),$e.jsx("button",{onClick:()=>c("metas"),className:"flex-1 py-2.5 px-4 font-medium text-sm transition-all duration-200 "+("metas"===i?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("div",{className:"p-1.5 rounded-md transition-colors "+("metas"===i?"bg-blue-100":"bg-gray-100"),children:$e.jsx(h,{className:"w-4 h-4 "+("metas"===i?"text-blue-600":"text-gray-500")})}),$e.jsx("span",{children:"Metas"})]})}),$e.jsx("button",{onClick:()=>c("clusters"),className:"flex-1 py-2.5 px-4 font-medium text-sm transition-all duration-200 "+("clusters"===i?"bg-blue-50 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("div",{className:"p-1.5 rounded-md transition-colors "+("clusters"===i?"bg-blue-100":"bg-gray-100"),children:$e.jsx(me,{className:"w-4 h-4 "+("clusters"===i?"text-blue-600":"text-gray-500")})}),$e.jsx("span",{children:"Clusters de Tráfego"})]})})]})}),"usuarios"===i&&$e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuração de Usuários"}),$e.jsxs("p",{className:"text-gray-600",children:["Gerencie usuários e permissões para ",t]})]}),$e.jsxs("button",{onClick:()=>{F(null),ie({email:"",username:"",admin:!1,access_control:"read",tablename:t}),oe({}),I(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(he,{className:"w-4 h-4"}),"Novo Usuário"]})]}),$e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:$e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"relative",children:[$e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),$e.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:g,onChange:e=>b(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-gray-50 focus:bg-white"})]}),$e.jsxs("select",{value:v,onChange:e=>y(e.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-gray-50 focus:bg-white",children:[$e.jsx("option",{value:"all",children:"Todos os tipos"}),$e.jsx("option",{value:"admin",children:"Administradores"}),$e.jsx("option",{value:"user",children:"Usuários"})]})]})}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:p?$e.jsxs("div",{className:"p-8 text-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),$e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando usuários..."})]}):ce?$e.jsxs("div",{className:"p-8 text-center",children:[$e.jsx(a,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),$e.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Erro ao carregar usuários"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:ce}),$e.jsx("button",{onClick:ge,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium",children:"Tentar Novamente"})]}):0===m.length?$e.jsxs("div",{className:"p-8 text-center",children:[$e.jsx(E,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:g||"all"!==v?"Nenhum usuário encontrado com os filtros aplicados":0===d.length?"Nenhum usuário encontrado para esta tabela":"Nenhum usuário encontrado"}),0===d.length&&$e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:'Clique em "Novo Usuário" para adicionar o primeiro usuário'})]}):$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-px whitespace-nowrap",children:"Ações"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(e=>$e.jsxs("tr",{className:"hover:bg-gray-50",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:$e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center shadow-sm",children:$e.jsx("span",{className:"text-lg font-semibold text-blue-700",children:(e.username||e.email.split("@")[0]).charAt(0).toUpperCase()})})}),$e.jsxs("div",{className:"ml-4",children:[$e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.username||e.email.split("@")[0]}),$e.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsx("div",{className:"flex items-center gap-2",children:e.admin?$e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-red-50 border border-red-200 rounded-full",children:[$e.jsx(de,{className:"w-4 h-4 text-red-600"}),$e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Administrador"})]}):$e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-50 border border-gray-200 rounded-full",children:[$e.jsx(E,{className:"w-4 h-4 text-gray-600"}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Usuário"})]})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium w-px",children:$e.jsxs("div",{className:"flex items-center justify-end gap-2 ml-auto",children:[$e.jsx("button",{onClick:()=>(e=>{F(e),ie({email:e.email,username:e.username||e.email.split("@")[0],admin:e.admin,access_control:"[]"===e.access_control||""===e.access_control?"read":e.access_control,tablename:t}),oe({}),I(!0)})(e),className:"text-blue-600 hover:text-blue-700 p-2 rounded-lg hover:bg-blue-50 transition-all duration-200 transform hover:scale-110",title:"Editar usuário",children:$e.jsx(xe,{className:"w-4 h-4"})}),$e.jsx("button",{onClick:()=>(async e=>{if(confirm("Tem certeza que deseja remover este usuário?"))try{const t=localStorage.getItem("auth-token");if(!t)return;await ls.deleteUser(t,e),ge()}catch(t){alert("Erro ao remover usuário. Tente novamente.")}})(e.id||e.email),className:"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 transition-all duration-200 transform hover:scale-110",title:"Remover usuário",children:$e.jsx(pe,{className:"w-4 h-4"})})]})})]},e.id||e.email))})]})})})]}),"metas"===i&&$e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuração de Metas"}),$e.jsxs("p",{className:"text-gray-600",children:["Visualize e gerencie metas para ",t]})]}),$e.jsxs("button",{onClick:()=>{X({month:"",goal_value:""}),Y(null),G(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(h,{className:"w-4 h-4"}),"Nova Meta"]})]}),_?$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center shadow-sm",children:[$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando metas..."})]}):C?$e.jsxs("div",{className:"bg-white rounded-xl border border-red-200 p-8 text-center shadow-sm",children:[$e.jsx(a,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),$e.jsx("h4",{className:"text-lg font-medium text-red-600 mb-2",children:"Erro ao carregar metas"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:C}),$e.jsx("button",{onClick:be,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium",children:"Tentar Novamente"})]}):j?$e.jsx("div",{className:"space-y-6",children:(null==(s=j.goals)?void 0:s.metas_mensais)&&Object.keys(j.goals.metas_mensais).length>0?$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[$e.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:[$e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Detalhamento das Metas Mensais"}),$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Metas de receita paga por mês"})]}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mês"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Meta de Receita Paga"}),$e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(j.goals.metas_mensais).sort(([e],[t])=>t.localeCompare(e)).map(([e,s])=>{var r;return $e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:$e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:new Date(e.split("-")[0],parseInt(e.split("-")[1])-1,1).toLocaleDateString("pt-BR",{month:"short"}).toUpperCase()})}),$e.jsxs("div",{children:[$e.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(e.split("-")[0],parseInt(e.split("-")[1])-1,1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),$e.jsx("div",{className:"text-xs text-gray-500",children:e})]})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:$e.jsx("div",{className:"flex items-center justify-end gap-2",children:$e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:["R$ ",(null==(r=s.meta_receita_paga)?void 0:r.toLocaleString("pt-BR",{minimumFractionDigits:2}))||"0,00"]})})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("button",{onClick:()=>{return t=e,r=s.meta_receita_paga||0,X({month:t,goal_value:r.toString()}),Y(t),void G(!0);var t,r},className:"text-blue-600 hover:text-blue-700 p-2 rounded-lg hover:bg-blue-50 transition-all duration-200 transform hover:scale-110",title:"Editar meta",children:$e.jsx(xe,{className:"w-4 h-4"})}),$e.jsx("button",{onClick:()=>(async e=>{if(confirm(`Tem certeza que deseja deletar a meta de ${e}?`))try{const s=localStorage.getItem("auth-token");if(!s)return;await ls.deleteGoal(s,{table_name:t,month:e,goal_type:"revenue_goal"}),be()}catch(s){alert("Erro ao deletar meta. Tente novamente.")}})(e),className:"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 transition-all duration-200 transform hover:scale-110",title:"Deletar meta",children:$e.jsx(pe,{className:"w-4 h-4"})})]})})]},e)})})]})})]}):$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center shadow-sm",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(h,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma meta encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há metas configuradas para esta tabela no momento."})]})}):$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center shadow-sm",children:[$e.jsx(h,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma meta carregada"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:'Clique em "Atualizar" para carregar as metas da API.'}),$e.jsx("button",{onClick:be,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium",children:"Carregar Metas"})]})]}),"clusters"===i&&$e.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Clusters de Tráfego"}),$e.jsxs("p",{className:"text-gray-600",children:["Visualize e gerencie categorias de tráfego para ",t]})]}),$e.jsxs("button",{onClick:()=>{se({category_name:"",description:"",rules:{origem:"",midia:"",campaign:"",page_location:"",parametros_url:"",cupom:""}}),ee(null),Z(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(me,{className:"w-4 h-4"}),"Novo Cluster"]})]}),R?$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center shadow-sm",children:[$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-4"}),$e.jsx("p",{className:"text-gray-600",children:"Carregando categorias de tráfego..."})]}):M?$e.jsxs("div",{className:"bg-white rounded-xl border border-red-200 p-8 text-center shadow-sm",children:[$e.jsx(a,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),$e.jsx("h4",{className:"text-lg font-medium text-red-600 mb-2",children:"Erro ao carregar categorias"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:M}),$e.jsx("button",{onClick:ve,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Tentar Novamente"})]}):T?$e.jsx("div",{className:"space-y-4",children:T.data&&T.data.length>0?$e.jsx("div",{className:"space-y-4",children:T.data.map((e,s)=>$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[$e.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:[$e.jsx("h5",{className:"text-lg font-semibold text-gray-900",children:e.nome}),e.descricao&&$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.descricao})]}),e.regras&&e.regras.rules&&Object.keys(e.regras.rules).length>0&&$e.jsxs("div",{className:"px-6 py-4",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsxs("h6",{className:"text-sm font-medium text-gray-700",children:["Regras de Classificação (",e.regras.type,"):"]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("button",{onClick:()=>(e=>{var t,s,r,a,n,i,l,o,c,d,u,m;se({category_name:e.nome,description:e.descricao||"",rules:{origem:(null==(s=null==(t=e.regras)?void 0:t.rules)?void 0:s.origem)||"",midia:(null==(a=null==(r=e.regras)?void 0:r.rules)?void 0:a.midia)||"",campaign:(null==(i=null==(n=e.regras)?void 0:n.rules)?void 0:i.campaign)||"",page_location:(null==(o=null==(l=e.regras)?void 0:l.rules)?void 0:o.page_location)||"",parametros_url:(null==(d=null==(c=e.regras)?void 0:c.rules)?void 0:d.parametros_url)||"",cupom:(null==(m=null==(u=e.regras)?void 0:u.rules)?void 0:m.cupom)||""}}),ee(e.nome),Z(!0)})(e),className:"text-blue-600 hover:text-blue-700 p-2 rounded-lg hover:bg-blue-50 transition-all duration-200 transform hover:scale-110",title:"Editar categoria",children:$e.jsx(xe,{className:"w-4 h-4"})}),$e.jsx("button",{onClick:()=>(async e=>{if(confirm(`Tem certeza que deseja deletar a categoria "${e}"?`))try{const s=localStorage.getItem("auth-token");if(!s)return;await ls.deleteTrafficCategory(s,{table_name:t,category_name:e}),ve()}catch(s){alert("Erro ao deletar categoria. Tente novamente.")}})(e.nome),className:"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 transition-all duration-200 transform hover:scale-110",title:"Deletar categoria",children:$e.jsx(pe,{className:"w-4 h-4"})})]})]}),$e.jsx("div",{className:"space-y-3",children:Object.entries(e.regras.rules).map(([e,t],s)=>$e.jsxs("div",{className:"flex items-start gap-3",children:[$e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),$e.jsxs("div",{className:"flex-1",children:[$e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[e,":"]}),$e.jsx("span",{className:"text-sm text-gray-600 ml-2 font-mono bg-gray-100 px-2 py-1 rounded",children:t})]})]},s))})]})]},s))}):$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center shadow-sm",children:[$e.jsx(me,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma categoria encontrada"}),$e.jsx("p",{className:"text-gray-600",children:"Não há categorias de tráfego configuradas para esta tabela no momento."})]})}):$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center shadow-sm",children:[$e.jsx(me,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),$e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma categoria carregada"}),$e.jsx("p",{className:"text-gray-600 mb-4",children:'Clique em "Atualizar" para carregar as categorias de tráfego da API.'}),$e.jsx("button",{onClick:ve,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Carregar Categorias"})]})]}),O&&$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:$e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:$e.jsxs("div",{className:"p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:D?"Editar Usuário":"Criar Novo Usuário"}),$e.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600",children:$e.jsx(fe,{className:"w-6 h-6"})})]}),le.general&&$e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:$e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[$e.jsx(a,{className:"w-4 h-4"}),$e.jsx("span",{className:"text-sm",children:le.general})]})}),$e.jsxs("form",{onSubmit:e=>{e.preventDefault(),ye()},className:"space-y-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),$e.jsx("input",{type:"email",value:ne.email,onChange:e=>ie({...ne,email:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(le.email?"border-red-300":"border-gray-300"),placeholder:"usuario@exemplo.com"}),le.email&&$e.jsx("p",{className:"mt-1 text-sm text-red-600",children:le.email})]}),$e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[$e.jsxs("div",{className:"flex items-center",children:[$e.jsx("input",{type:"checkbox",id:"admin",checked:ne.admin,onChange:e=>ie({...ne,admin:e.target.checked}),className:"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),$e.jsx("label",{htmlFor:"admin",className:"ml-3 block text-sm font-medium text-gray-900",children:"Usuário administrador"})]}),$e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Administradores têm acesso total ao sistema e podem gerenciar outros usuários"})]}),$e.jsxs("div",{className:"flex gap-3 pt-4",children:[$e.jsx("button",{type:"button",onClick:()=>I(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),$e.jsx("button",{type:"submit",disabled:B,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:B?"Salvando...":D?"Atualizar":"Criar"})]})]})]})})}),z&&re&&$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:$e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:$e.jsxs("div",{className:"p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["goal"===re.type&&(null==(r=re.message)?void 0:r.includes("atualizada"))?"✅ Meta Atualizada com Sucesso!":"goal"===re.type&&"✅ Meta Cadastrada com Sucesso!","cluster"===re.type&&(null==(n=re.message)?void 0:n.includes("atualizado"))?"✅ Cluster Atualizado com Sucesso!":"cluster"===re.type&&"✅ Cluster Cadastrado com Sucesso!","user"===re.type&&"✅ Usuário Criado com Sucesso!",!re.type&&"✅ Operação Realizada com Sucesso!"]}),$e.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:$e.jsx(fe,{className:"w-6 h-6"})})]}),$e.jsxs("div",{className:"space-y-4",children:[$e.jsx("p",{className:"text-gray-600",children:re.message}),re.note&&$e.jsx("p",{className:"text-gray-600 text-sm",children:re.note}),re.generated_password&&$e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[$e.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"🔑 Senha Gerada Automaticamente"}),$e.jsx("div",{className:"bg-white border border-yellow-300 rounded p-3 font-mono text-lg text-center relative",children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx("span",{className:"flex-1",children:U?re.generated_password:"••••••••"}),$e.jsx("button",{type:"button",onClick:()=>W(!U),className:"text-gray-400 hover:text-gray-600 p-1",children:U?$e.jsx(l,{className:"w-4 h-4"}):$e.jsx(o,{className:"w-4 h-4"})})]})})]}),"user"===re.type&&$e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[$e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"📧 Próximos Passos"}),$e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[$e.jsx("li",{children:"• A senha será enviada por email para o usuário"}),$e.jsx("li",{children:"• O usuário poderá fazer login com o email e senha"}),$e.jsx("li",{children:"• Compartilhe a senha com o usuário de forma segura se necessário"})]})]}),"goal"===re.type&&$e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[$e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"📊 Meta Configurada"}),$e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[$e.jsx("li",{children:"• A meta foi salva no sistema"}),$e.jsx("li",{children:"• Ela aparecerá nos dashboards de acompanhamento"}),$e.jsx("li",{children:"• Você pode editá-la a qualquer momento"})]})]}),"cluster"===re.type&&$e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[$e.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"🎯 Cluster Configurado"}),$e.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[$e.jsx("li",{children:"• As regras de categorização foram salvas"}),$e.jsx("li",{children:"• O cluster será aplicado automaticamente"}),$e.jsx("li",{children:"• Você pode editá-lo a qualquer momento"})]})]}),$e.jsx("button",{onClick:()=>{V(!1),W(!1)},className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Fechar"})]})]})})}),H&&$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md animate-fadeIn",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:q?"Editar Meta":"Nova Meta"}),$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:q?"Edite a meta de receita":"Cadastre uma nova meta de receita"})]}),$e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mês/Ano"}),$e.jsx("input",{type:"month",value:K.month,onChange:e=>X({...K,month:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"2025-10"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta de Receita (R$)"}),$e.jsx("input",{type:"number",value:K.goal_value,onChange:e=>X({...K,goal_value:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"10000000",min:"0",step:"0.01"})]})]}),$e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[$e.jsx("button",{onClick:()=>G(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 font-medium",children:"Cancelar"}),$e.jsxs("button",{onClick:async()=>{if(K.month&&K.goal_value)try{const e=localStorage.getItem("auth-token");if(!e)return;await ls.saveMonthlyGoal(e,{table_name:t,month:K.month,goal_value:parseFloat(K.goal_value),goal_type:"revenue_goal"}),G(!1),X({month:"",goal_value:""}),Y(null),be(),ae({message:q?"Meta atualizada com sucesso!":"Meta cadastrada com sucesso!",note:`Meta de R$ ${parseFloat(K.goal_value).toLocaleString("pt-BR",{minimumFractionDigits:2})} para ${K.month} foi ${q?"atualizada":"salva"}.`,type:"goal"}),V(!0)}catch(e){alert("Erro ao salvar meta. Tente novamente.")}else alert("Por favor, preencha todos os campos.")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(h,{className:"w-4 h-4"}),q?"Atualizar Meta":"Salvar Meta"]})]})]})}),J&&$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto animate-fadeIn",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Q?"Editar Cluster de Tráfego":"Novo Cluster de Tráfego"}),$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Q?"Edite a categoria de tráfego":"Cadastre uma nova categoria de tráfego"})]}),$e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Categoria"}),$e.jsx("input",{type:"text",value:te.category_name,onChange:e=>se({...te,category_name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"SDR Completo"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),$e.jsx("textarea",{value:te.description,onChange:e=>se({...te,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",rows:3,placeholder:"Categoria para tráfego SDR com campanhas, páginas, cupons e parâmetros múltiplos"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Regras de Classificação"}),$e.jsxs("div",{className:"space-y-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Origem"}),$e.jsx("input",{type:"text",value:te.rules.origem,onChange:e=>se({...te,rules:{...te.rules,origem:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"direct|referral|organic"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mídia"}),$e.jsx("input",{type:"text",value:te.rules.midia,onChange:e=>se({...te,rules:{...te.rules,midia:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"referral|social|cpc|email"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Campanha"}),$e.jsx("input",{type:"text",value:te.rules.campaign,onChange:e=>se({...te,rules:{...te.rules,campaign:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"sdr_campaign|lead_generation|outbound_2024"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Localização da Página"}),$e.jsx("input",{type:"text",value:te.rules.page_location,onChange:e=>se({...te,rules:{...te.rules,page_location:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"https://exemplo.com.br/sdr|https://exemplo.com.br/leads"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parâmetros URL"}),$e.jsx("input",{type:"text",value:te.rules.parametros_url,onChange:e=>se({...te,rules:{...te.rules,parametros_url:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"(8023|8001|8017)"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cupom"}),$e.jsx("input",{type:"text",value:te.rules.cupom,onChange:e=>se({...te,rules:{...te.rules,cupom:e.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",placeholder:"JF|Jf|jf|JC|Jc|jc|ES|Es|es"})]})]})]})]}),$e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[$e.jsx("button",{onClick:()=>Z(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 font-medium",children:"Cancelar"}),$e.jsxs("button",{onClick:async()=>{if(!te.category_name||!te.description)return void alert("Por favor, preencha nome e descrição da categoria.");const e=Object.entries(te.rules).filter(([e,t])=>""!==t.trim()).reduce((e,[t,s])=>(e[t]=s,e),{});if(0!==Object.keys(e).length)try{const s=localStorage.getItem("auth-token");if(!s)return;await ls.saveTrafficCategory(s,{table_name:t,category_name:te.category_name,description:te.description,rules:{type:"regex",rules:e}}),Z(!1),se({category_name:"",description:"",rules:{origem:"",midia:"",campaign:"",page_location:"",parametros_url:"",cupom:""}}),ee(null),ve(),ae({message:Q?"Cluster atualizado com sucesso!":"Cluster cadastrado com sucesso!",note:`Categoria "${te.category_name}" foi ${Q?"atualizada":"salva"} com ${Object.keys(e).length} regras.`,type:"cluster"}),V(!0)}catch(s){alert("Erro ao salvar cluster. Tente novamente.")}else alert("Por favor, preencha pelo menos uma regra.")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(me,{className:"w-4 h-4"}),Q?"Atualizar Cluster":"Salvar Cluster"]})]})]})})]})},bm=()=>{var t,s;const[r,a]=e.useState(null),n=e=>{try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}catch(t){return null}};return e.useEffect(()=>{const e=()=>{const e=localStorage.getItem("mymetric-auth-complete");if(e){const t=JSON.parse(e),s=Date.now(),r=t.accessToken?n(t.accessToken):null,i=t.refreshToken?n(t.refreshToken):null;a({stored:t,accessToken:r,refreshToken:i,now:s,accessTokenExpired:t.expiresAt<=s,refreshTokenExpired:t.refreshExpiresAt<=s,timeUntilAccessExpiry:t.expiresAt-s,timeUntilRefreshExpiry:t.refreshExpiresAt-s})}};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[]),r?$e.jsxs("div",{className:"p-4 bg-white border rounded-lg shadow",children:[$e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Token Debug Info"}),$e.jsxs("div",{className:"space-y-4",children:[$e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[$e.jsx("h4",{className:"font-semibold",children:"Access Token"}),$e.jsxs("p",{children:["Exp: ",(null==(t=r.accessToken)?void 0:t.exp)?new Date(1e3*r.accessToken.exp).toLocaleString():"N/A"]}),$e.jsxs("p",{children:["Stored Exp: ",new Date(r.stored.expiresAt).toLocaleString()]}),$e.jsxs("p",{children:["Expired: ",$e.jsx("span",{className:r.accessTokenExpired?"text-red-600":"text-green-600",children:r.accessTokenExpired?"Yes":"No"})]})]}),$e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[$e.jsx("h4",{className:"font-semibold",children:"Refresh Token"}),$e.jsxs("p",{children:["Exp: ",(null==(s=r.refreshToken)?void 0:s.exp)?new Date(1e3*r.refreshToken.exp).toLocaleString():"N/A"]}),$e.jsxs("p",{children:["Stored Exp: ",new Date(r.stored.refreshExpiresAt).toLocaleString()]}),$e.jsxs("p",{children:["Expired: ",$e.jsx("span",{className:r.refreshTokenExpired?"text-red-600":"text-green-600",children:r.refreshTokenExpired?"Yes":"No"})]})]}),$e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[$e.jsx("h4",{className:"font-semibold",children:"Raw Payloads"}),$e.jsxs("details",{children:[$e.jsx("summary",{children:"Access Token Payload"}),$e.jsx("pre",{className:"text-xs mt-2 overflow-auto",children:JSON.stringify(r.accessToken,null,2)})]}),$e.jsxs("details",{className:"mt-2",children:[$e.jsx("summary",{children:"Refresh Token Payload"}),$e.jsx("pre",{className:"text-xs mt-2 overflow-auto",children:JSON.stringify(r.refreshToken,null,2)})]})]})]})]}):$e.jsx("div",{className:"p-4 bg-gray-100 rounded",children:"Nenhum token encontrado"})},vm=({selectedTable:t,startDate:s,endDate:r})=>{const[a,n]=e.useState([]),[i,l]=e.useState(!1),[o,c]=e.useState(null),[d,u]=e.useState("city"),[m,h]=e.useState("revenue"),[p,f]=e.useState("desc"),[g,b]=e.useState(!1);e.useEffect(()=>{b(!1)},[d]);const y=async()=>{if(t&&is(t)){l(!0),c(null);try{const e=localStorage.getItem("auth-token")||"",a={start_date:s,end_date:r,table_name:t,cluster:"Todos"},i=await ls.getMetrics(e,a);if(!i||!i.data)throw new Error("Resposta da API está vazia ou inválida");const l=i.data||[];l.length,n(l),c(null)}catch(e){c(e instanceof Error?e.message:"Erro ao buscar métricas")}finally{l(!1)}}};e.useEffect(()=>{y()},[t,s,r]);const w=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),j=e=>new Intl.NumberFormat("pt-BR").format(e),N=(()=>{const e={};a.forEach(t=>{const s=t[d]||"Não informado";e[s]||(e[s]={city:t.city||"Não informado",region:t.region||"Não informado",country:t.country||"Não informado",orders:0,revenue:0,avgOrderValue:0});const r=e[s];r.orders+=t.Pedidos||0,r.revenue+=t.Receita||0});const t=Object.values(e).map(e=>(e.avgOrderValue=e.orders>0?e.revenue/e.orders:0,e));return t.sort((e,t)=>{const s="asc"===p?1:-1;return"orders"===m?(e.orders-t.orders)*s:(e.revenue-t.revenue)*s}),t})(),_=g?N:N.slice(0,10),k=N.length>10,C=e=>{m===e?f("asc"===p?"desc":"asc"):(h(e),f("desc"))},S=e=>m!==e?$e.jsx("span",{className:"text-gray-300",children:"↕"}):"asc"===p?"↑":"↓",T=a.reduce((e,t)=>e+(t.Pedidos||0),0),A=a.reduce((e,t)=>e+(t.Receita||0),0);return a.filter(e=>e[d]&&"Não informado"!==e[d]).reduce((e,t)=>e+(t.Pedidos||0),0),o?$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-red-200",children:[$e.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-2",children:[$e.jsx(ne,{className:"w-5 h-5"}),$e.jsx("h3",{className:"text-lg font-semibold",children:"Erro ao carregar dados de localização"})]}),$e.jsx("p",{className:"text-sm text-red-600 mb-4",children:o}),$e.jsx("button",{onClick:()=>y(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"Tentar novamente"}),$e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Verifique o console do navegador (F12) para mais detalhes sobre o erro."})]}):$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:$e.jsx(ne,{className:"w-6 h-6 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pedidos por Localização"}),$e.jsx("p",{className:"text-sm text-gray-500",children:"Análise geográfica dos pedidos"})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-sm text-gray-600",children:"Agrupar por:"}),$e.jsxs("select",{value:d,onChange:e=>u(e.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[$e.jsx("option",{value:"city",children:"Cidade"}),$e.jsx("option",{value:"region",children:"Estado/Região"}),$e.jsx("option",{value:"country",children:"País"})]})]})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[$e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[$e.jsx(x,{className:"w-4 h-4 text-blue-600"}),$e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Total de Pedidos"})]}),$e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:j(T)})]}),$e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[$e.jsx(v,{className:"w-4 h-4 text-green-600"}),$e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Receita Total"})]}),$e.jsx("p",{className:"text-2xl font-bold text-green-900",children:w(A)})]}),$e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-100",children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:["city"===d&&$e.jsx(ne,{className:"w-4 h-4 text-purple-600"}),"region"===d&&$e.jsx(ce,{className:"w-4 h-4 text-purple-600"}),"country"===d&&$e.jsx(F,{className:"w-4 h-4 text-purple-600"}),$e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"city"===d?"Cidades":"region"===d?"Estados/Regiões":"Países"})]}),$e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:j(N.length)})]})]}),i&&$e.jsx("div",{className:"flex items-center justify-center py-12",children:$e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),!i&&0===N.length&&$e.jsxs("div",{className:"text-center py-12",children:[$e.jsx(ne,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),$e.jsx("p",{className:"text-gray-500",children:"Nenhum dado de localização disponível"}),$e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Os pedidos podem não conter informações de localização"})]}),!i&&N.length>0&&$e.jsxs("div",{className:"overflow-x-auto",children:[$e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"city"===d?"Cidade":"region"===d?"Estado/Região":"País"}),"city"===d&&$e.jsxs($e.Fragment,{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado/Região"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"País"})]}),"region"===d&&$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"País"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>C("orders"),children:$e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Pedidos ",S("orders")]})}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>C("revenue"),children:$e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Receita ",S("revenue")]})}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket Médio"}),$e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% Pedidos"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map((e,t)=>{const s=T>0?e.orders/T*100:0,r="city"===d?e.city:"region"===d?e.region:e.country;return $e.jsxs("tr",{className:"hover:bg-gray-50",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-2",children:["city"===d&&$e.jsx(ne,{className:"w-4 h-4 text-gray-400"}),"region"===d&&$e.jsx(ce,{className:"w-4 h-4 text-gray-400"}),"country"===d&&$e.jsx(F,{className:"w-4 h-4 text-gray-400"}),$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r})]})}),"city"===d&&$e.jsxs($e.Fragment,{children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.region}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.country})]}),"region"===d&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.country}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900",children:j(e.orders)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-semibold text-green-600",children:w(e.revenue)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-600",children:w(e.avgOrderValue)}),$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-600",children:[s.toFixed(1),"%"]})]},`${r}-${t}`)})})]}),k&&!g&&$e.jsx("div",{className:"mt-4 text-center border-t border-gray-200 pt-4",children:$e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[$e.jsxs("span",{children:["Ver mais ",N.length-10," ","city"===d?"cidades":"region"===d?"estados/regiões":"países"]}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),g&&k&&$e.jsx("div",{className:"mt-4 text-center border-t border-gray-200 pt-4",children:$e.jsxs("button",{onClick:()=>b(!1),className:"inline-flex items-center gap-2 px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium text-sm",children:[$e.jsx("span",{children:"Ver menos"}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})})]})]})},ym=({selectedTable:t,startDate:s,endDate:r})=>{const[a,i]=e.useState([]),[l,o]=e.useState(!1),[c,d]=e.useState(null),[u,m]=e.useState(new Set),[h,p]=e.useState(!1),[f,g]=e.useState([]),[y,w]=e.useState([]),[j,N]=e.useState([]),[_,k]=e.useState([]),[S,T]=e.useState([]),[E,P]=e.useState([]),[M,L]=e.useState([]),[I,D]=e.useState([]),[F,B]=e.useState([]),[$,z]=e.useState([]),[V,U]=e.useState(""),[W,H]=e.useState(0),[G,q]=e.useState(!1),[Y,X]=e.useState(0),[J,Z]=e.useState(!1),[Q,ee]=e.useState(!1),te=e.useRef(null),se=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0),re=(e,t,s)=>{if("Todos"===t)s([]);else{s(e.includes(t)?e.filter(e=>e!==t):[...e,t])}},ae=e=>e.length>0,ne=()=>[ae(f),ae(y),ae(j),ae(_),ae(S),ae(E),ae(M),ae(I),ae(F),ae($)].filter(Boolean).length,ie=ne()>0,le=({label:t,options:s,selectedValues:r,onToggle:a,className:n=""})=>{const[i,l]=e.useState(!1),o=e.useRef(null),c=((e,t)=>0===e.length?t:1===e.length?e[0]:`${e.length} selecionados`)(r,t),d=ae(r);return e.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&l(!1)};return i&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[i]),$e.jsxs("div",{ref:o,className:`relative ${n}`,children:[$e.jsxs("label",{className:"text-sm text-gray-700",children:[$e.jsx("span",{className:"block mb-1 font-medium",children:t}),$e.jsxs("button",{type:"button",onClick:()=>l(!i),className:"w-full px-3 py-2 border rounded-lg text-sm text-left flex items-center justify-between transition-colors "+(d?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"),children:[$e.jsx("span",{className:"truncate",children:c}),$e.jsx(C,{className:"w-4 h-4 transition-transform "+(i?"rotate-180":"")})]})]}),i&&$e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:$e.jsx("div",{className:"p-2",children:s.map(e=>{const t=r.includes(e);return $e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:t,onChange:()=>a(e),className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),$e.jsx("span",{className:"text-sm text-gray-700 flex-1",children:e})]},e)})})})]})},ce=e=>{if(!e)return"—";const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleString("pt-BR",{hour12:!1})},de=e=>{const t=(e??"").toString().trim();return t&&"(not set)"!==t?t:"Não informado"},ue=e=>{const t=(e||"").toLowerCase();return"paid"===t||"pago"===t?"bg-green-100 text-green-800":"pending"===t||"pendente"===t?"bg-yellow-100 text-yellow-800":"cancelled"===t||"cancelado"===t?"bg-red-100 text-red-800":"refunded"===t||"reembolsado"===t?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"},me=e.useCallback(async(e=0,a=!1,n=0)=>{try{0===e?(o(!0),X(0),Z(!1)):q(!0),d(null);const l=localStorage.getItem("auth-token")||"";if(!l)throw new Error("Token não encontrado");const c={start_date:s,end_date:r,table_name:t,limit:100,offset:e};if(0===e&&0===n){l.length>12&&(l.slice(0,6),l.slice(-4)),JSON.stringify(c,null,2)}if(!is(t))return void(0===e?o(!1):q(!1));te.current&&te.current.abort(),te.current=new AbortController;const u=await ls.getOrders(l,c,te.current.signal),m=(null==u?void 0:u.data)||[],h=(null==u?void 0:u.total_rows)||0;a||H(h),X(0),a?i(e=>[...e,...m]):(i(m),o(!1),Z(!0)),100===m.length?(q(!0),me(e+100,!0,0).catch(()=>{q(!1)})):q(!1)}catch(l){if(l instanceof Error&&"AbortError"===l.name)return;if(n<3){const t=n+1;return X(t),await new Promise(e=>setTimeout(e,2e3)),me(e,a,t)}d(l instanceof Error?l.message:"Erro ao obter pedidos"),o(!1),q(!1)}},[t,s,r]);e.useEffect(()=>(me(),()=>{te.current&&te.current.abort()}),[me]);const he=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Categoria_de_Trafico??"").toString().trim()).filter(Boolean)))].slice(0,200),xe=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Categoria_de_Trafico_Primeiro_Clique??"").toString().trim()).filter(Boolean)))].slice(0,200),pe=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Categoria_de_Trafico_Primeiro_Lead??"").toString().trim()).filter(Boolean)))].slice(0,200),fe=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Status??"").toString().trim()).filter(Boolean)))].slice(0,50),be=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Origem??"").toString().trim()).filter(Boolean)))].slice(0,50),ve=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Origem_Primeiro_Clique??"").toString().trim()).filter(Boolean)))].slice(0,50),ye=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Origem_Primeiro_Lead??"").toString().trim()).filter(Boolean)))].slice(0,50),we=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Midia??"").toString().trim()).filter(Boolean)))].slice(0,50),je=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Midia_Primeiro_Clique??"").toString().trim()).filter(Boolean)))].slice(0,50),Ne=["Todos",...Array.from(new Set((a||[]).map(e=>(e.Midia_Primeiro_Lead??"").toString().trim()).filter(Boolean)))].slice(0,50),_e=(a||[]).filter(e=>{const t=(e.Categoria_de_Trafico??"").toString().trim(),s=(e.Categoria_de_Trafico_Primeiro_Clique??"").toString().trim(),r=(e.Categoria_de_Trafico_Primeiro_Lead??"").toString().trim(),a=(e.Origem??"").toString().trim(),n=(e.Origem_Primeiro_Clique??"").toString().trim(),i=(e.Origem_Primeiro_Lead??"").toString().trim(),l=(e.Midia??"").toString().trim(),o=(e.Midia_Primeiro_Clique??"").toString().trim(),c=(e.Midia_Primeiro_Lead??"").toString().trim(),d=(e.Status??"").toString().trim(),u=(e.ID_da_Transacao??"").toString().trim(),m=(e.Primeiro_Nome??"").toString().trim(),h=0===f.length||f.includes(t),x=0===y.length||y.includes(s),p=0===j.length||j.includes(r),g=0===S.length||S.includes(a),b=0===E.length||E.includes(n),v=0===M.length||M.includes(i),w=0===I.length||I.includes(l),N=0===F.length||F.includes(o),k=0===$.length||$.includes(c),C=0===_.length||_.includes(d),T=V.toLowerCase().trim(),A=!V||u.toLowerCase().includes(T)||m.toLowerCase().includes(T);return h&&x&&p&&g&&b&&v&&w&&N&&k&&C&&A}),ke=(()=>{const e=_e.length>0?_e:a,t=e.reduce((e,t)=>e+(t.Receita||0),0),s=e.filter(e=>"paid"===e.Status).length,r=e.filter(e=>"pending"===e.Status).length,n=e.filter(e=>"cancelled"===e.Status).length;return{totalOrders:e.length,totalRevenue:t,paidOrders:s,pendingOrders:r,cancelledOrders:n,averageOrderValue:e.length>0?t/e.length:0}})(),Ce=$e.jsxs("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white shadow-sm",children:[$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Detalhes"}),$e.jsx("th",{title:"ID_da_Transacao",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"ID da Transação"}),$e.jsx("th",{title:"Horario",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Horário"}),$e.jsx("th",{title:"Primeiro_Nome",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Primeiro Nome"}),$e.jsx("th",{title:"Status",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),$e.jsx("th",{title:"Receita",className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Receita"}),$e.jsx("th",{title:"Categoria_de_Trafico",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Categoria de Tráfego"}),$e.jsx("th",{title:"Categoria_de_Trafico_Primeiro_Clique",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Categoria de Tráfego (1º Clique)"}),$e.jsx("th",{title:"Categoria_de_Trafico_Primeiro_Lead",className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Categoria de Tráfego (1º Lead)"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_e.map((e,t)=>{const s=e.ID_da_Transacao||String(t),r=u.has(s);return $e.jsxs($e.Fragment,{children:[$e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors odd:bg-white even:bg-gray-50/40",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("button",{onClick:()=>(e=>{m(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})})(s),className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[r?$e.jsx(C,{className:"w-4 h-4"}):$e.jsx(ge,{className:"w-4 h-4"}),$e.jsx("span",{children:r?"Ocultar":"Detalhes"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(x,{className:"w-4 h-4 text-gray-500"}),$e.jsx("span",{className:"font-medium",children:de(e.ID_da_Transacao)})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:ce(e.Horario)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(n,{className:"w-4 h-4"}),de(e.Primeiro_Nome)]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${ue(e.Status)}`,children:de(e.Status)})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-semibold text-green-600",children:se(e.Receita)}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-blue-50 text-blue-700 border border-blue-200",children:de(e.Categoria_de_Trafico)})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-green-50 text-green-700 border border-green-200",children:de(e.Categoria_de_Trafico_Primeiro_Clique)})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-purple-50 text-purple-700 border border-purple-200",children:de(e.Categoria_de_Trafico_Primeiro_Lead)})})]},s),r&&$e.jsx("tr",{children:$e.jsx("td",{colSpan:9,className:"px-6 pb-6 pt-2 bg-gray-50",children:$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 flex items-center justify-between",children:[$e.jsxs("div",{className:"text-sm text-gray-700",children:[$e.jsx("span",{className:"font-medium text-gray-900",children:de(e.ID_da_Transacao)}),$e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),$e.jsx("span",{children:ce(e.Horario)})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${ue(e.Status)}`,children:de(e.Status)}),$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:se(e.Receita)})]})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[$e.jsxs("div",{className:"border border-blue-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-2",children:"Último Clique Não Direto"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Categoria de Tráfego:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Categoria_de_Trafico)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Origem:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Origem)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Mídia:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Midia)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Canal:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Canal)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Campanha:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Campanha)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Conteúdo:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Conteudo)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Página de Entrada:"})," ","Não informado"!==de(e.Pagina_de_Entrada)?$e.jsx("a",{href:e.Pagina_de_Entrada,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1 truncate inline-block max-w-full align-bottom",title:e.Pagina_de_Entrada,children:e.Pagina_de_Entrada}):$e.jsx("span",{className:"font-medium",children:"Não informado"})]}),e.Parametros_de_URL&&"(not set)"!==e.Parametros_de_URL&&$e.jsxs("div",{className:"text-xs break-all",children:[$e.jsx("span",{className:"text-gray-500",children:"Parâmetros de URL:"})," ",$e.jsx("span",{className:"ml-1 px-1.5 py-0.5 rounded bg-gray-100 font-mono text-[11px] text-gray-700",children:e.Parametros_de_URL})]})]})]}),$e.jsxs("div",{className:"border border-green-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Primeiro Clique"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Categoria de Tráfego:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Categoria_de_Trafico_Primeiro_Clique)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Origem:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Origem_Primeiro_Clique)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Mídia:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Midia_Primeiro_Clique)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Campanha:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Campanha_Primeiro_Clique)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Conteúdo:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Conteudo_Primeiro_Clique)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Página de Entrada:"})," ","Não informado"!==de(e.Pagina_de_Entrada_Primeiro_Clique)?$e.jsx("a",{href:e.Pagina_de_Entrada_Primeiro_Clique,target:"_blank",rel:"noopener noreferrer",className:"text-green-700 hover:underline ml-1 truncate inline-block max-w-full align-bottom",title:e.Pagina_de_Entrada_Primeiro_Clique,children:e.Pagina_de_Entrada_Primeiro_Clique}):$e.jsx("span",{className:"font-medium",children:"Não informado"})]}),e.Parametros_de_URL_Primeiro_Clique&&"(not set)"!==e.Parametros_de_URL_Primeiro_Clique&&$e.jsxs("div",{className:"text-xs break-all",children:[$e.jsx("span",{className:"text-gray-500",children:"Parâmetros de URL (1º Clique):"})," ",$e.jsx("span",{className:"ml-1 px-1.5 py-0.5 rounded bg-gray-100 font-mono text-[11px] text-gray-700",children:e.Parametros_de_URL_Primeiro_Clique})]})]})]}),$e.jsxs("div",{className:"border border-purple-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-purple-700 mb-2",children:"Primeiro Lead"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Categoria de Tráfego:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Categoria_de_Trafico_Primeiro_Lead)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Origem:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Origem_Primeiro_Lead)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Mídia:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Midia_Primeiro_Lead)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Campanha:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Campanha_Primeiro_Lead)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Conteúdo:"})," ",$e.jsx("span",{className:"font-medium",children:de(e.Conteudo_Primeiro_Lead)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Página de Entrada:"})," ","Não informado"!==de(e.Pagina_de_Entrada_Primeiro_Lead)?$e.jsx("a",{href:e.Pagina_de_Entrada_Primeiro_Lead,target:"_blank",rel:"noopener noreferrer",className:"text-purple-700 hover:underline ml-1 truncate inline-block max-w-full align-bottom",title:e.Pagina_de_Entrada_Primeiro_Lead,children:e.Pagina_de_Entrada_Primeiro_Lead}):$e.jsx("span",{className:"font-medium",children:"Não informado"})]}),$e.jsxs("div",{className:"text-xs break-all",children:[$e.jsx("span",{className:"text-gray-500",children:"Parâmetros de URL (1º Lead):"})," ",$e.jsx("span",{className:"ml-1 px-1.5 py-0.5 rounded bg-gray-100 font-mono text-[11px] text-gray-700",children:de(e.Parametros_de_URL_Primeiro_Lead)})]})]})]})]})]})})})]})})})]}),G&&$e.jsx("div",{className:"bg-blue-50 border-t border-blue-200 px-6 py-4",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3 text-blue-700",children:[$e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),$e.jsx("span",{className:"text-sm font-medium",children:Y>0?`Tentativa ${Y}/3 - Carregando mais pedidos...`:"Carregando mais pedidos..."})]})}),!l&&!G&&W>0&&$e.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:$e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[$e.jsxs("span",{children:["Total de pedidos: ",$e.jsx("strong",{children:a.length})," de ",$e.jsx("strong",{children:W})]}),a.length<W&&$e.jsx("span",{className:"text-blue-600",children:"Todos os pedidos foram carregados automaticamente"})]})})]});return $e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:$e.jsx(O,{className:"w-5 h-5 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pedidos"}),$e.jsxs("p",{className:"text-sm text-gray-500",children:[s," • ",r," • ",t,Y>0&&$e.jsxs("span",{className:"ml-2 text-orange-600 font-medium",children:["(Tentativa ",Y,"/3)"]})]})]})]}),$e.jsx("div",{className:"flex items-center gap-2",children:$e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-200 text-sm text-gray-700 hover:bg-gray-50",title:"Tela cheia",children:[$e.jsx(K,{className:"w-4 h-4"}),"Tela cheia"]})})]}),l&&$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-4",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[$e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Carregando pedidos..."}),Y>0&&$e.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:["Tentativa ",Y," de 3"]})]})]})}),G&&$e.jsx("div",{className:"bg-blue-50 rounded-xl border border-blue-200 p-4 mb-4",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[$e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),$e.jsxs("div",{className:"text-center",children:[$e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Carregando mais pedidos..."}),$e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[a.length," pedidos carregados até agora"]}),W>0&&$e.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"Buscando todos os pedidos disponíveis..."})]})]})}),J&&a.length>0&&$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Pedidos"}),$e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ke.totalOrders.toLocaleString()}),_e.length!==a.length&&$e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[_e.length," filtrados"]})]}),$e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:$e.jsx(O,{className:"w-6 h-6 text-blue-600"})})]})}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita Total"}),$e.jsx("p",{className:"text-2xl font-bold text-green-600",children:se(ke.totalRevenue)}),$e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ticket médio: ",se(ke.averageOrderValue)]})]}),$e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:$e.jsx(R,{className:"w-6 h-6 text-green-600"})})]})}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Status"}),$e.jsxs("div",{className:"flex gap-2 mt-1",children:[$e.jsxs("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:[ke.paidOrders," pagos"]}),ke.pendingOrders>0&&$e.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:[ke.pendingOrders," pendentes"]}),ke.cancelledOrders>0&&$e.jsxs("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded",children:[ke.cancelledOrders," cancelados"]})]})]}),$e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:$e.jsx(v,{className:"w-6 h-6 text-orange-600"})})]})})]}),$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-4 space-y-6",children:[$e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-end",children:[$e.jsx("div",{className:"flex-1",children:$e.jsxs("label",{className:"text-sm text-gray-700",children:[$e.jsx("span",{className:"block mb-2 font-semibold text-gray-900",children:"🔍 Pesquisar por ID ou Nome"}),$e.jsx("input",{type:"text",value:V,onChange:e=>U(e.target.value),placeholder:"Digite ID da transação ou nome do cliente...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsxs("button",{onClick:()=>ee(!Q),className:"px-4 py-3 text-sm border rounded-lg transition-colors flex items-center gap-2 "+(ie?"text-blue-700 border-blue-300 bg-blue-50 hover:bg-blue-100":"text-gray-600 border-gray-300 bg-white hover:bg-gray-50 hover:text-gray-800"),children:[$e.jsx(b,{className:"w-4 h-4"}),Q?"Ocultar Filtros":"Mostrar Filtros",Q?$e.jsx(A,{className:"w-4 h-4"}):$e.jsx(C,{className:"w-4 h-4"}),!Q&&ie&&$e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:ne()})]}),$e.jsx("button",{onClick:()=>{U(""),g([]),w([]),N([]),k([]),T([]),P([]),L([]),D([]),B([]),z([])},className:"px-4 py-3 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Limpar Todos os Filtros"})]})]}),Q&&$e.jsxs("div",{className:"space-y-4",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Filtros por Atribuição"}),$e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[$e.jsxs("h4",{className:"text-sm font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[$e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Último Clique (Atribuição Atual)"]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[$e.jsx(le,{label:"Categoria de Tráfego",options:he,selectedValues:f,onToggle:e=>re(f,e,g)}),$e.jsx(le,{label:"Origem",options:be,selectedValues:S,onToggle:e=>re(S,e,T)}),$e.jsx(le,{label:"Mídia",options:we,selectedValues:I,onToggle:e=>re(I,e,D)})]})]}),$e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[$e.jsxs("h4",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center gap-2",children:[$e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Primeiro Clique"]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[$e.jsx(le,{label:"Categoria de Tráfego",options:xe,selectedValues:y,onToggle:e=>re(y,e,w)}),$e.jsx(le,{label:"Origem",options:ve,selectedValues:E,onToggle:e=>re(E,e,P)}),$e.jsx(le,{label:"Mídia",options:je,selectedValues:F,onToggle:e=>re(F,e,B)})]})]}),$e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[$e.jsxs("h4",{className:"text-sm font-semibold text-purple-800 mb-3 flex items-center gap-2",children:[$e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Primeiro Lead"]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[$e.jsx(le,{label:"Categoria de Tráfego",options:pe,selectedValues:j,onToggle:e=>re(j,e,N)}),$e.jsx(le,{label:"Origem",options:ye,selectedValues:M,onToggle:e=>re(M,e,L)}),$e.jsx(le,{label:"Mídia",options:Ne,selectedValues:$,onToggle:e=>re($,e,z)})]})]}),$e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[$e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Filtros Gerais"}),$e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-3",children:$e.jsx(le,{label:"Status do Pedido",options:fe,selectedValues:_,onToggle:e=>re(_,e,k),className:"md:w-1/3"})})]})]}),$e.jsxs("div",{className:"text-sm text-gray-600 border-t border-gray-200 pt-4 flex items-center justify-between",children:[$e.jsxs("div",{children:["Mostrando ",$e.jsx("strong",{className:"text-gray-900",children:_e.length})," de ",$e.jsx("strong",{className:"text-gray-900",children:a.length})," pedidos carregados",(V||ie)&&$e.jsx("span",{className:"text-blue-600 ml-2 font-medium",children:"(filtrados)"}),100===a.length&&$e.jsx("span",{className:"text-orange-600 ml-2 text-xs",children:"(pode haver mais pedidos)"})]}),_e.length!==a.length&&$e.jsxs("div",{className:"text-xs text-gray-500",children:[Math.round(_e.length/a.length*100),"% dos pedidos carregados"]})]})]}),c?$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-red-600",children:c}):J?0===a.length?$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:"Nenhum pedido no período."}):Ce:$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:$e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[$e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),$e.jsx("span",{children:"Carregando pedidos..."})]})}),h&&$e.jsxs("div",{className:"fixed inset-0 z-50 bg-white",children:[$e.jsxs("div",{className:"h-14 px-4 flex items-center justify-between border-b border-gray-200",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(O,{className:"w-4 h-4 text-blue-600"}),$e.jsx("span",{className:"font-semibold",children:"Pedidos (Tela cheia)"})]}),$e.jsx("div",{className:"flex items-center gap-2",children:$e.jsxs("button",{onClick:()=>p(!1),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 text-sm text-gray-700 hover:bg-gray-50",title:"Sair da tela cheia",children:[$e.jsx(oe,{className:"w-4 h-4"}),"Fechar"]})})]}),$e.jsx("div",{className:"pt-14 p-4 sm:p-6 overflow-auto h-full",children:Ce})]})]})},wm=({selectedTable:t,startDate:s,endDate:r})=>{var a,i;const[l,o]=e.useState([]),[d,u]=e.useState(!1),[m,h]=e.useState(null),[x,p]=e.useState(new Set),[f,g]=e.useState(!1),[b,y]=e.useState(""),[w,j]=e.useState(0),[N,k]=e.useState(0),[S,A]=e.useState(!0),[E,P]=e.useState(!1),[M,L]=e.useState(null),[I,D]=e.useState([]),[F,B]=e.useState(!0),$=e.useRef(null);Ur((()=>{if(d&&F&&w>0){return`Leads (${Math.round(I.length/w*100)}%) 🔄`}return d?"Leads 🔄":l.length>0?`Leads (${I.length}${w>I.length?`/${w}`:""})`:"Leads"})());const z=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e||0),V=e=>{if(!e)return"—";const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleString("pt-BR",{hour12:!1})},U=e=>{const t=(e??"").toString().trim();return t&&"(not set)"!==t?t:"Não informado"},W=(e,t)=>{if(e>0)return`${e} dia${e>1?"s":""}`;if(t>0){const e=Math.floor(t/60);return e>0?`${e}h ${t%60}m`:`${t}m`}return"—"},H=e.useCallback(async(e=0,a,n=0,i=!1)=>{try{u(!0),h(null),k(e);const l=localStorage.getItem("auth-token")||"";if(!l)throw new Error("Token não encontrado");const c={table_name:t,limit:5e3,offset:n};if(a||S?c.last_cache=!0:(c.start_date=s,c.end_date=r),!is(t))return void u(!1);$.current&&$.current.abort(),$.current=new AbortController;const d=await ls.getLeadsOrders(l,c,$.current.signal),m=(null==d?void 0:d.data)||[],x=(null==d||d.total_rows,(null==d?void 0:d.total_records)||0),p=(null==d?void 0:d.cache_info)||null,f=(null==d?void 0:d.summary)||null,g=(null==d?void 0:d.pagination)||null;j(x),L(p),X(f),0===n?(o([...m]),D([...m])):(o(e=>[...e,...m]),D(e=>[...e,...m]));const b=(null==g?void 0:g.has_more)||!1,v=n+m.length;if(B(b),i&&b)return void setTimeout(()=>{H(0,a,v,!0)},500);k(0),u(!1)}catch(l){if(l instanceof Error&&"AbortError"===l.name)return;if((l instanceof Error&&(l.message.includes("timeout")||l.message.includes("Timeout")||l.message.includes("Network error")||l.message.includes("Failed to fetch")||l.message.includes("fetch")||l instanceof TypeError&&l.message.includes("Failed"))||l instanceof Error&&l.message.includes("HTTP error! status: 5"))&&e<3){const t=e+1;return k(t),await new Promise(e=>setTimeout(e,2e3)),H(t,a,n,i)}h(l instanceof Error?l.message:"Erro ao obter leads")}finally{u(!1)}},[t,s,r,S]);e.useEffect(()=>(B(!0),H(0,void 0,0,!0),()=>{$.current&&$.current.abort()}),[H]);const G=e.useMemo(()=>(I||[]).filter(e=>{var t,s,r,a,n,i,l,o,c,d;const u=b.toLowerCase().trim();return!b||((null==(t=e.name)?void 0:t.toLowerCase().includes(u))||(null==(s=e.email)?void 0:s.toLowerCase().includes(u))||(null==(r=e.phone)?void 0:r.toLowerCase().includes(u))||(null==(a=e.fsm_source)?void 0:a.toLowerCase().includes(u))||(null==(n=e.fsm_medium)?void 0:n.toLowerCase().includes(u))||(null==(i=e.fsm_campaign)?void 0:i.toLowerCase().includes(u))||(null==(l=e.source)?void 0:l.toLowerCase().includes(u))||(null==(o=e.medium)?void 0:o.toLowerCase().includes(u))||(null==(c=e.campaign)?void 0:c.toLowerCase().includes(u))||(null==(d=e.transaction_id)?void 0:d.toLowerCase().includes(u)))}),[I,b]),q=G.slice(0,30),[Y,X]=e.useState(null),J=e=>{const[t,s,r]=e.split("-").map(Number),a=new Date(t,s-1,r),n=a.getDay(),i=0===n?-6:1-n,l=new Date(a);return l.setDate(a.getDate()+i),us(l)},Z=e.useMemo(()=>{const e={};return I.forEach(t=>{if(t.subscribe_timestamp){const s=t.subscribe_timestamp.split("T")[0],r=J(s);e[r]||(e[r]={leads:0,sales:0,revenue:0}),e[r].leads++}if(t.purchase_timestamp&&t.transaction_id){const s=t.purchase_timestamp.split("T")[0],r=J(s);e[r]||(e[r]={leads:0,sales:0,revenue:0}),e[r].sales++,e[r].revenue+=t.value||0}}),Object.entries(e).map(([e,t])=>({date:e,leads:t.leads,sales:t.sales,revenue:t.revenue})).sort((e,t)=>e.date.localeCompare(t.date))},[I]),Q=e=>{const[t,s,r]=e.split("-").map(Number),a=new Date(t,s-1,r),n=new Date(a);return n.setDate(a.getDate()+6),`${a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})} - ${n.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}`},ee=({active:e,payload:t})=>{var s,r;if(e&&t&&t.length){const e=e=>"leads"===e?"Captura de Leads":"sales"===e?"Vendas":"revenue"===e?"Receita":e,a=(e,t)=>"revenue"===e?z(t):new Intl.NumberFormat("pt-BR").format(t),n=null==(r=null==(s=t[0])?void 0:s.payload)?void 0:r.date,i=n?Q(n):"";return $e.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[$e.jsxs("p",{className:"font-semibold text-gray-900 mb-2",children:["Semana: ",i]}),t.map((t,s)=>$e.jsxs("p",{className:"text-sm",style:{color:t.color},children:[e(t.dataKey),": ",$e.jsx("span",{className:"font-semibold",children:a(t.dataKey,t.value)})]},s))]})}return null},te=$e.jsxs("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white shadow-sm",children:[$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:$e.jsxs("tr",{children:[$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Detalhes"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Nome"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Email"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Telefone"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Data de Inscrição"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Origem"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Mídia"}),$e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Campanha"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map((t,s)=>{const r=t.transaction_id?`tx-${t.transaction_id}-${s}`:`lead-${t.email||"no-email"}-${t.subscribe_timestamp||"no-ts"}-${s}`,a=x.has(r),i=t.transaction_id&&""!==t.transaction_id;return $e.jsxs(e.Fragment,{children:[$e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors odd:bg-white even:bg-gray-50/40",children:[$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("button",{onClick:()=>{return e=r,void p(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s});var e},className:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[a?$e.jsx(C,{className:"w-4 h-4"}):$e.jsx(ge,{className:"w-4 h-4"}),$e.jsx("span",{children:a?"Ocultar":"Detalhes"})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(n,{className:"w-4 h-4 text-gray-500"}),$e.jsx("span",{className:"font-medium",children:U(t.name)})]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(c,{className:"w-4 h-4 text-gray-400"}),U(t.email)]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(be,{className:"w-4 h-4 text-gray-400"}),U(t.phone)]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(_,{className:"w-4 h-4 text-gray-400"}),V(t.subscribe_timestamp)]})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i?$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-green-100 text-green-800",children:"Convertido"}):$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800",children:"Lead"})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-blue-50 text-blue-700 border border-blue-200",children:U(t.fsm_source||t.source)})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-green-50 text-green-700 border border-green-200",children:U(t.fsm_medium||t.medium)})}),$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:$e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-purple-50 text-purple-700 border border-purple-200 truncate max-w-xs",title:U(t.fsm_campaign||t.campaign),children:U(t.fsm_campaign||t.campaign)})})]}),a&&$e.jsx("tr",{children:$e.jsx("td",{colSpan:9,className:"px-6 pb-6 pt-2 bg-gray-50",children:$e.jsxs("div",{className:"space-y-3",children:[$e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 flex items-center justify-between",children:[$e.jsxs("div",{className:"text-sm text-gray-700",children:[$e.jsx("span",{className:"font-medium text-gray-900",children:U(t.name)}),$e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),$e.jsx("span",{children:U(t.email)})]}),$e.jsx("div",{className:"flex items-center gap-2",children:i?$e.jsxs($e.Fragment,{children:[$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-green-100 text-green-800",children:"Convertido"}),$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-emerald-50 text-emerald-700 border border-emerald-200",children:z(t.value)})]}):$e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800",children:"Lead sem conversão"})})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[$e.jsxs("div",{className:"border border-blue-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-blue-700 mb-2",children:"Informações de Contato"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Nome:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.name)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.email)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Telefone:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.phone)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Data de Inscrição:"})," ",$e.jsx("span",{className:"font-medium",children:V(t.subscribe_timestamp)})]})]})]}),$e.jsxs("div",{className:"border border-green-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Informações de Conversão"}),$e.jsx("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:i?$e.jsxs($e.Fragment,{children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"ID da Transação:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.transaction_id)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Data da Compra:"})," ",$e.jsx("span",{className:"font-medium",children:V(t.purchase_timestamp)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Valor:"})," ",$e.jsx("span",{className:"font-medium text-green-600",children:z(t.value)})]}),$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(T,{className:"w-4 h-4 text-gray-400"}),$e.jsx("span",{className:"text-gray-500",children:"Tempo até conversão:"}),$e.jsx("span",{className:"font-medium ml-1",children:W(t.days_between_subscribe_and_purchase,t.minutes_between_subscribe_and_purchase)})]})]}):$e.jsx("div",{className:"text-gray-500 italic",children:"Ainda não converteu"})})]}),$e.jsxs("div",{className:"border border-purple-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-purple-700 mb-2",children:"Atribuição (Primeiro Lead)"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Origem:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.fsm_source)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Mídia:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.fsm_medium)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Campanha:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.fsm_campaign)})]})]})]}),i&&$e.jsxs("div",{className:"border border-orange-100 rounded-lg bg-white p-4 shadow-sm",children:[$e.jsx("h4",{className:"text-sm font-semibold text-orange-700 mb-2",children:"Atribuição na Compra"}),$e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-700",children:[$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Origem:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.source)})]}),$e.jsxs("div",{children:[$e.jsx("span",{className:"text-gray-500",children:"Mídia:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.medium)})]}),$e.jsxs("div",{className:"break-words",children:[$e.jsx("span",{className:"text-gray-500",children:"Campanha:"})," ",$e.jsx("span",{className:"font-medium",children:U(t.campaign)})]})]})]})]})]})})})]},r)})})]}),!d&&w>0&&$e.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-3",children:$e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600",children:$e.jsxs("span",{children:["Mostrando ",$e.jsx("strong",{children:q.length})," de ",$e.jsx("strong",{children:G.length})," leads filtrados",G.length>30&&$e.jsx("span",{className:"ml-2 text-orange-600",children:"(limitado a 30 na exibição)"}),w>G.length&&$e.jsxs("span",{className:"ml-2 text-gray-500",children:["de ",w," total"]})]})})})]});return $e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:$e.jsx(n,{className:"w-5 h-5 text-purple-600"})}),$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Leads"}),$e.jsxs("p",{className:"text-sm text-gray-500",children:[s," • ",r," • ",t,N>0&&$e.jsxs("span",{className:"ml-2 text-orange-600 font-medium",children:["(Tentativa ",N,"/3)"]})]})]})]}),$e.jsx("div",{className:"flex items-center gap-2",children:$e.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-200 text-sm text-gray-700 hover:bg-gray-50",title:"Tela cheia",children:[$e.jsx(K,{className:"w-4 h-4"}),"Tela cheia"]})})]}),(d||F&&w>0)&&$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-4 shadow-sm",children:[$e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[$e.jsx("span",{children:"Progresso do Carregamento"}),$e.jsxs("span",{children:[Math.round(I.length/w*100),"%"]})]}),$e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:$e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(I.length/w*100,100)}%`}})}),$e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-1",children:[$e.jsxs("span",{children:[I.length.toLocaleString()," leads carregados"]}),$e.jsxs("span",{children:[w.toLocaleString()," total"]})]})]}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[$e.jsx("input",{type:"checkbox",checked:S,onChange:e=>A(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),"Usar cache"]}),M&&S&&$e.jsxs("span",{className:"text-xs text-blue-600",children:["Cache de ",new Date(M.cached_at+"Z").toLocaleString("pt-BR",{timeZone:"America/Sao_Paulo",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(",","")]})]}),$e.jsx("div",{className:"flex items-center gap-2",children:$e.jsx("button",{onClick:async()=>{P(!0),B(!0),await H(0,!1,0,!0),P(!1)},disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:E?$e.jsxs($e.Fragment,{children:[$e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Atualizando..."]}):$e.jsxs($e.Fragment,{children:[$e.jsx(v,{className:"w-4 h-4"}),"Atualizar Dados"]})})})]})}),I.length>0&&$e.jsxs("div",{className:"space-y-6 mb-6",children:[$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total de Leads"}),$e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(null==(a=null==Y?void 0:Y.total_leads)?void 0:a.toLocaleString())||0}),q.length!==I.length&&$e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[q.length," na tela"]})]}),$e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:$e.jsx(n,{className:"w-6 h-6 text-purple-600"})})]})}),$e.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-white rounded-xl border-2 border-emerald-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-emerald-700 mb-1",children:"Taxa de Conversão Lead em Cliente"}),$e.jsxs("p",{className:"text-3xl font-bold text-emerald-600",children:[(null==Y?void 0:Y.total_distinct_emails)>0?((((null==Y?void 0:Y.total_distinct_emails_with_purchase)||0)-((null==Y?void 0:Y.total_distinct_emails_with_purchase_no_lead)||0))/(null==Y?void 0:Y.total_distinct_emails)*100).toFixed(1):0,"%"]}),$e.jsxs("p",{className:"text-xs text-emerald-600 mt-1",children:[((null==Y?void 0:Y.total_distinct_emails_with_purchase)||0)-((null==Y?void 0:Y.total_distinct_emails_with_purchase_no_lead)||0)," convertidos"]})]}),$e.jsx("div",{className:"p-3 bg-emerald-100 rounded-lg",children:$e.jsx(v,{className:"w-6 h-6 text-emerald-600"})})]})}),$e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-white rounded-xl border-2 border-blue-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"Taxa de Compras com Leads Antes"}),$e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[(null==Y?void 0:Y.total_distinct_emails_with_purchase)>0?(100*(1-((null==Y?void 0:Y.total_distinct_emails_with_purchase_no_lead)||0)/(null==Y?void 0:Y.total_distinct_emails_with_purchase))).toFixed(1):0,"%"]}),$e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[((null==Y?void 0:Y.total_distinct_emails_with_purchase)||0)-((null==Y?void 0:Y.total_distinct_emails_with_purchase_no_lead)||0)," de ",(null==Y?void 0:Y.total_distinct_emails_with_purchase)||0]})]}),$e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:$e.jsx(O,{className:"w-6 h-6 text-blue-600"})})]})})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Receita Total"}),$e.jsx("p",{className:"text-3xl font-bold text-green-600",children:z((null==Y?void 0:Y.total_revenue)||0)}),(null==Y?void 0:Y.total_distinct_emails_with_purchase)>0&&$e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ticket: ",z(((null==Y?void 0:Y.total_revenue)||0)/(null==Y?void 0:Y.total_distinct_emails_with_purchase))]})]}),$e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:$e.jsx(R,{className:"w-6 h-6 text-green-600"})})]})}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Receita por Lead"}),$e.jsx("p",{className:"text-2xl font-bold text-green-600",children:(null==Y?void 0:Y.total_leads)>0?z(((null==Y?void 0:Y.total_revenue)||0)/(null==Y?void 0:Y.total_leads)):z(0)}),$e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Média de receita por lead"})]}),$e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:$e.jsx(v,{className:"w-6 h-6 text-green-600"})})]})}),$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex-1",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Emails Únicos"}),$e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(null==(i=null==Y?void 0:Y.total_distinct_emails)?void 0:i.toLocaleString())||0}),$e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[(null==Y?void 0:Y.total_distinct_emails_with_purchase)||0," com compra"]})]}),$e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:$e.jsx(T,{className:"w-6 h-6 text-blue-600"})})]})})]})]}),!d&&Z.length>0&&$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6 shadow-sm",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"📈 Timeline de Captura de Leads e Vendas (Agregado por Semana)"}),$e.jsx("div",{className:"h-80",children:$e.jsx(ye,{width:"100%",height:"100%",children:$e.jsxs(we,{data:Z,margin:{top:5,right:30,left:20,bottom:5},children:[$e.jsx(je,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),$e.jsx(Ne,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:Q,interval:"preserveStartEnd"}),$e.jsx(_e,{yAxisId:"left",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>new Intl.NumberFormat("pt-BR").format(e)}),$e.jsx(_e,{yAxisId:"right",orientation:"right",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,notation:"compact"}).format(e)}),$e.jsx(ke,{content:$e.jsx(ee,{})}),$e.jsx(Se,{wrapperStyle:{paddingTop:"20px"},formatter:e=>"leads"===e?"Captura de Leads":"sales"===e?"Vendas":"revenue"===e?"Receita":e}),$e.jsx(Ce,{yAxisId:"left",type:"monotone",dataKey:"leads",stroke:"#9333ea",strokeWidth:3,dot:!1,activeDot:{r:7,stroke:"#9333ea",strokeWidth:2},name:"leads"}),$e.jsx(Ce,{yAxisId:"left",type:"monotone",dataKey:"sales",stroke:"#3b82f6",strokeWidth:3,dot:!1,activeDot:{r:7,stroke:"#3b82f6",strokeWidth:2},name:"sales"}),$e.jsx(Ce,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#10b981",strokeWidth:3,dot:!1,activeDot:{r:7,stroke:"#10b981",strokeWidth:2},name:"revenue"})]})})}),$e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 justify-center",children:[$e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),$e.jsx("span",{className:"text-gray-600",children:"Captura de Leads"})]}),$e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),$e.jsx("span",{className:"text-gray-600",children:"Vendas"})]}),$e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[$e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),$e.jsx("span",{className:"text-gray-600",children:"Receita"})]})]})]}),$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-4",children:[$e.jsxs("label",{className:"text-sm text-gray-700",children:[$e.jsx("span",{className:"block mb-2 font-semibold text-gray-900",children:"🔍 Pesquisar"}),$e.jsx("input",{type:"text",value:b,onChange:e=>y(e.target.value),placeholder:"Digite nome, email, telefone ou ID da transação...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),q.length!==I.length&&$e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Mostrando ",$e.jsx("strong",{className:"text-gray-900",children:q.length})," de ",$e.jsx("strong",{className:"text-gray-900",children:I.length})," leads"]})]}),m?$e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center",children:[$e.jsx("div",{className:"text-red-600 mb-4",children:m}),$e.jsx("button",{onClick:()=>H(0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Tentar novamente"})]}):0===I.length?$e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:"Nenhum lead no período."}):te,f&&$e.jsxs("div",{className:"fixed inset-0 z-50 bg-white",children:[$e.jsxs("div",{className:"h-14 px-4 flex items-center justify-between border-b border-gray-200",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(n,{className:"w-4 h-4 text-purple-600"}),$e.jsx("span",{className:"font-semibold",children:"Leads (Tela cheia)"})]}),$e.jsx("div",{className:"flex items-center gap-2",children:$e.jsxs("button",{onClick:()=>g(!1),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 text-sm text-gray-700 hover:bg-gray-50",title:"Sair da tela cheia",children:[$e.jsx(oe,{className:"w-4 h-4"}),"Fechar"]})})]}),$e.jsx("div",{className:"pt-14 p-4 sm:p-6 overflow-auto h-full",children:te})]})]})},jm=({onLogout:t,user:s})=>{const{getUrlParams:a,updateUrlParams:i}=Vr(),c="undefined"!=typeof window&&localStorage.getItem("auth-token")||"",d=async()=>{try{const e=localStorage.getItem("auth-token");if(!e||!I)return;if(!is(I))return;Ie(!0);const t=await ls.getGoals(e,{table_name:I});Le(t)}catch(e){Le(null)}finally{Ie(!1)}},m=()=>{qe({month:"",goal_value:""}),He(null),Ue(!0)},[w,j]=e.useState([]),[_,k]=e.useState(!0),[S,T]=e.useState(!1),[A,P]=e.useState(""),[M,L]=e.useState(""),[I,$]=e.useState(()=>""),[U,W]=e.useState("receita"),[H,G]=e.useState("desc"),[q,Y]=e.useState(!1),[K,X]=e.useState(!1),[J,Z]=e.useState(!1),te=()=>{const e={cluster:!0,sessoes:!0,taxaAdicaoCarrinho:!0,adicoesCarrinho:!1,taxaConversao:!0,pedidos:!0,pedidosPagos:!0,taxaPagamento:!1,receita:!0,receitaPaga:!0,taxaReceitaPaga:!1,novosClientes:!1,receitaNovosClientes:!1,percentualNovosClientes:!1,leads:!1,pedidosAssinaturaAnualInicial:!1,receitaAssinaturaAnualInicial:!1,pedidosAssinaturaMensalInicial:!1,receitaAssinaturaMensalInicial:!1,pedidosAssinaturaAnualRecorrente:!1,receitaAssinaturaAnualRecorrente:!1,pedidosAssinaturaMensalRecorrente:!1,receitaAssinaturaMensalRecorrente:!1},t=localStorage.getItem("dashboardVisibleColumns");if(t)try{const s=JSON.parse(t);return{...e,...s}}catch{return e}return e},[se,re]=e.useState(te()),[ae,ne]=e.useState(!1),[ie,le]=e.useState("");e.useEffect(()=>{localStorage.setItem("dashboardVisibleColumns",JSON.stringify(se))},[se]);const[oe,ce]=e.useState("visao-geral"),[de,ue]=e.useState(!1),[me,he]=e.useState(!1),[xe,pe]=e.useState("Último Clique Não Direto"),[fe,ge]=e.useState(!1),[be,ye]=e.useState(!0),[we,je]=e.useState(!0),[Ne,_e]=e.useState(""),[ke,Ce]=e.useState(""),[Se,Te]=e.useState(!1),[Ae,Ee]=e.useState([]),[Re,Pe]=e.useState(!1),[Me,Le]=e.useState(null),[Oe,Ie]=e.useState(!1),[De,Fe]=e.useState(null),[Be,ze]=e.useState(!1),[Ve,Ue]=e.useState(!1),[We,He]=e.useState(null),[Ge,qe]=e.useState({month:"",goal_value:""}),[Ye,Ke]=e.useState({isOpen:!1,trafficCategory:""}),[Xe,Je]=e.useState(new Set),[Ze,Qe]=e.useState(new Set),[et,tt]=e.useState(new Map),[st,rt]=e.useState(new Map),[at,nt]=e.useState(0);e.useEffect(()=>{try{const e=localStorage.getItem("login-response");if(e){const t=JSON.parse(e);"all"===t.table_name||"all"===t.access_control?$("coffeemais"):t.table_name?$(t.table_name):$("")}else $("")}catch(e){$("")}},[]),e.useEffect(()=>{const e=a();if(e.table&&"all"!==e.table&&$(e.table),e.tab&&ce(e.tab),e.startDate&&e.endDate)P(e.startDate),L(e.endDate);else{const t=e.tab||"visao-geral",s=xs(t);P(s.start),L(s.end)}},[]),e.useEffect(()=>{try{const e=localStorage.getItem("login-response");e&&JSON.parse(e)}catch(e){}},[I]),e.useEffect(()=>{i({table:I,startDate:A,endDate:M,tab:oe,cluster:"Todos"})},[I,A,M,oe]);const it=e=>{if("configuracao"===e&&!(null==s?void 0:s.admin))return void ce("visao-geral");ce(e);const t=xs(e);P(t.start),L(t.end)};Ur(_?"Carregando Dashboard... | MyMetricHUB":`Dashboard ${J?"Cliente Selecionado":I} | MyMetricHUB`);const lt=async(e,t,s=!1)=>{try{return await ls.getMetrics(e,t)}catch(r){if(r instanceof Error&&(r.message.includes("timeout")||r.message.includes("Timeout")||r.message.includes("demorou muito tempo"))&&!s)return await new Promise(e=>setTimeout(e,5e3)),await lt(e,t,!0);throw r}};e.useEffect(()=>{(async()=>{var e;try{const s=localStorage.getItem("auth-token");if(!s)return;if(!I||""===I.trim())return;if(!is(I))return;T(!0),Pe(!0);const r=M,a=A,n=await lt(s,{start_date:a,end_date:r,table_name:I,attribution_model:xe});j(n.data||[]),nt((null==(e=n.data)?void 0:e.length)||0);const i=(()=>{const e=new Date(A),t=new Date(M),s=Math.ceil((t.getTime()-e.getTime())/864e5);if(0===s){const t=new Date(e);return t.setDate(t.getDate()-1),{start:t.toISOString().split("T")[0],end:t.toISOString().split("T")[0]}}const r=new Date(e);r.setDate(r.getDate()-1);const a=new Date(r);return a.setDate(a.getDate()-s+1),{start:a.toISOString().split("T")[0],end:r.toISOString().split("T")[0]}})();try{const e=await lt(s,{start_date:i.start,end_date:i.end,table_name:I,attribution_model:xe});Ee(e.data||[])}catch(t){Ee([])}k(!1),T(!1),Pe(!1)}catch(s){k(!1),T(!1),Pe(!1),j([]),Ee([])}})(),Je(new Set),Qe(new Set)},[s,I,A,M,xe,oe]),e.useEffect(()=>{Qe(new Set),Je(new Set),tt(new Map),rt(new Map)},[I,A,M,xe]),e.useEffect(()=>{d()},[I]),e.useEffect(()=>{(async()=>{var e;try{const t=localStorage.getItem("auth-token");if(!t||!I)return;if(!is(I))return;ze(!0);const s=new Date,r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,a=`${r}-01`,n=`${r}-${new Date(s.getFullYear(),s.getMonth()+1,0).getDate()}`,i=(null==(e=(await ls.getMetrics(t,{start_date:a,end_date:n,table_name:I,attribution_model:xe})).data)?void 0:e.reduce((e,t)=>e+t.Receita_Paga,0))||0;Fe({currentMonthReceitaPaga:i})}catch(t){Fe(null)}finally{ze(!1)}})()},[I,xe]),e.useEffect(()=>{Ce(""),_e("")},[I]);const ot=w.filter(e=>{const t=!Ne||e.Cluster===Ne,s=!ke||e.Plataforma===ke;return t&&s}),ct=ot.reduce((e,t)=>({receita:e.receita+t.Receita,pedidos:e.pedidos+t.Pedidos,sessoes:e.sessoes+t.Sessoes,novosClientes:e.novosClientes+t.Novos_Clientes,adicoesCarrinho:e.adicoesCarrinho+t.Adicoes_ao_Carrinho,receitaPaga:e.receitaPaga+t.Receita_Paga,pedidosPagos:e.pedidosPagos+t.Pedidos_Pagos,receitaNovosClientes:e.receitaNovosClientes+t.Receita_Novos_Clientes,investimento:e.investimento+t.Investimento,cliques:e.cliques+t.Cliques,leads:e.leads+(t.Leads||0),pedidosAssinaturaAnualInicial:e.pedidosAssinaturaAnualInicial+(t.Pedidos_Assinatura_Anual_Inicial||0),receitaAssinaturaAnualInicial:e.receitaAssinaturaAnualInicial+(t.Receita_Assinatura_Anual_Inicial||0),pedidosAssinaturaMensalInicial:e.pedidosAssinaturaMensalInicial+(t.Pedidos_Assinatura_Mensal_Inicial||0),receitaAssinaturaMensalInicial:e.receitaAssinaturaMensalInicial+(t.Receita_Assinatura_Mensal_Inicial||0),pedidosAssinaturaAnualRecorrente:e.pedidosAssinaturaAnualRecorrente+(t.Pedidos_Assinatura_Anual_Recorrente||0),receitaAssinaturaAnualRecorrente:e.receitaAssinaturaAnualRecorrente+(t.Receita_Assinatura_Anual_Recorrente||0),pedidosAssinaturaMensalRecorrente:e.pedidosAssinaturaMensalRecorrente+(t.Pedidos_Assinatura_Mensal_Recorrente||0),receitaAssinaturaMensalRecorrente:e.receitaAssinaturaMensalRecorrente+(t.Receita_Assinatura_Mensal_Recorrente||0)}),{receita:0,pedidos:0,sessoes:0,novosClientes:0,adicoesCarrinho:0,receitaPaga:0,pedidosPagos:0,receitaNovosClientes:0,investimento:0,cliques:0,leads:0,pedidosAssinaturaAnualInicial:0,receitaAssinaturaAnualInicial:0,pedidosAssinaturaMensalInicial:0,receitaAssinaturaMensalInicial:0,pedidosAssinaturaAnualRecorrente:0,receitaAssinaturaAnualRecorrente:0,pedidosAssinaturaMensalRecorrente:0,receitaAssinaturaMensalRecorrente:0}),dt=Ae.reduce((e,t)=>({receita:e.receita+t.Receita,pedidos:e.pedidos+t.Pedidos,sessoes:e.sessoes+t.Sessoes,novosClientes:e.novosClientes+t.Novos_Clientes,adicoesCarrinho:e.adicoesCarrinho+t.Adicoes_ao_Carrinho,receitaPaga:e.receitaPaga+t.Receita_Paga,pedidosPagos:e.pedidosPagos+t.Pedidos_Pagos,receitaNovosClientes:e.receitaNovosClientes+t.Receita_Novos_Clientes,investimento:e.investimento+t.Investimento,cliques:e.cliques+t.Cliques,leads:e.leads+(t.Leads||0),pedidosAssinaturaAnualInicial:e.pedidosAssinaturaAnualInicial+(t.Pedidos_Assinatura_Anual_Inicial||0),receitaAssinaturaAnualInicial:e.receitaAssinaturaAnualInicial+(t.Receita_Assinatura_Anual_Inicial||0),pedidosAssinaturaMensalInicial:e.pedidosAssinaturaMensalInicial+(t.Pedidos_Assinatura_Mensal_Inicial||0),receitaAssinaturaMensalInicial:e.receitaAssinaturaMensalInicial+(t.Receita_Assinatura_Mensal_Inicial||0),pedidosAssinaturaAnualRecorrente:e.pedidosAssinaturaAnualRecorrente+(t.Pedidos_Assinatura_Anual_Recorrente||0),receitaAssinaturaAnualRecorrente:e.receitaAssinaturaAnualRecorrente+(t.Receita_Assinatura_Anual_Recorrente||0),pedidosAssinaturaMensalRecorrente:e.pedidosAssinaturaMensalRecorrente+(t.Pedidos_Assinatura_Mensal_Recorrente||0),receitaAssinaturaMensalRecorrente:e.receitaAssinaturaMensalRecorrente+(t.Receita_Assinatura_Mensal_Recorrente||0)}),{receita:0,pedidos:0,sessoes:0,novosClientes:0,adicoesCarrinho:0,receitaPaga:0,pedidosPagos:0,receitaNovosClientes:0,investimento:0,cliques:0,leads:0,pedidosAssinaturaAnualInicial:0,receitaAssinaturaAnualInicial:0,pedidosAssinaturaMensalInicial:0,receitaAssinaturaMensalInicial:0,pedidosAssinaturaAnualRecorrente:0,receitaAssinaturaAnualRecorrente:0,pedidosAssinaturaMensalRecorrente:0,receitaAssinaturaMensalRecorrente:0}),ut=ct.pedidos>0?ct.receita/ct.pedidos:0,mt=ct.sessoes>0?ct.pedidos/ct.sessoes*100:0,ht=ct.sessoes>0?ct.receita/ct.sessoes:0,xt=ct.pedidos>0?ct.novosClientes/ct.pedidos*100:0,pt=ct.sessoes>0?Math.min(ct.adicoesCarrinho/ct.sessoes*100,100):0,ft=ct.sessoes>0?ct.pedidos/ct.sessoes*100:0,gt=ct.investimento>0?ct.receitaPaga/ct.investimento:0,bt=dt.pedidos>0?dt.receita/dt.pedidos:0,vt=dt.sessoes>0?dt.pedidos/dt.sessoes*100:0,yt=dt.sessoes>0?dt.receita/dt.sessoes:0,wt=dt.pedidos>0?dt.novosClientes/dt.pedidos*100:0,jt=dt.sessoes>0?Math.min(dt.adicoesCarrinho/dt.sessoes*100,100):0,Nt=dt.sessoes>0?dt.pedidos/dt.sessoes*100:0,_t=dt.investimento>0?dt.receitaPaga/dt.investimento:0,kt=dt.receitaPaga>0?dt.investimento/dt.receitaPaga*100:0,Ct=(()=>{var e,t,s;if(!Me||!De)return null;const r=new Date,a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,n=null==(s=null==(t=null==(e=Me.goals)?void 0:e.metas_mensais)?void 0:t[a])?void 0:s.meta_receita_paga;if(!n)return null;const i=new Date(r.getFullYear(),r.getMonth()+1,0).getDate(),l=r.getDate(),o=De.currentMonthReceitaPaga,c=o*i/l;return{runRate:c,monthlyGoal:n,percentageOfGoal:c/n*100,currentDay:l,daysInMonth:i,currentMonthReceitaPaga:o}})(),St=(e,t=7)=>{if(e.length<t)return[];const s=[];for(let r=t-1;r<e.length;r++){const a=e.slice(r-t+1,r+1).reduce((e,t)=>e+t,0)/t;s.push(Math.round(a))}return s},Tt=ot.reduce((e,t)=>{const s=e.find(e=>e.date===t.Data);if(s)s.sessions+=t.Sessoes,s.revenue+=t.Receita,s.clicks+=t.Cliques,s.addToCart+=t.Adicoes_ao_Carrinho,s.orders+=t.Pedidos,s.newCustomers+=t.Novos_Clientes,s.paidOrders+=t.Pedidos_Pagos,s.paidRevenue+=t.Receita_Paga,s.newCustomerRevenue+=t.Receita_Novos_Clientes,s.investment+=t.Investimento,s.leads+=t.Leads||0,s.averageTicket=s.orders>0?s.revenue/s.orders:0;else{const s=t.Pedidos,r=t.Receita;e.push({date:t.Data,sessions:t.Sessoes,revenue:r,clicks:t.Cliques,addToCart:t.Adicoes_ao_Carrinho,orders:s,newCustomers:t.Novos_Clientes,paidOrders:t.Pedidos_Pagos,paidRevenue:t.Receita_Paga,newCustomerRevenue:t.Receita_Novos_Clientes,investment:t.Investimento,leads:t.Leads||0,averageTicket:s>0?r/s:0})}return e},[]).sort((e,t)=>{const[s,r,a]=e.date.split("-").map(Number),[n,i,l]=t.date.split("-").map(Number),o=new Date(s,r-1,a),c=new Date(n,i-1,l);return o.getTime()-c.getTime()}),At=Se?(()=>{if(Tt.length<7)return[];const e=Tt.map(e=>e.sessions),t=Tt.map(e=>e.revenue),s=Tt.map(e=>e.clicks),r=Tt.map(e=>e.addToCart),a=Tt.map(e=>e.orders),n=Tt.map(e=>e.newCustomers),i=Tt.map(e=>e.paidOrders),l=Tt.map(e=>e.paidRevenue),o=Tt.map(e=>e.newCustomerRevenue),c=Tt.map(e=>e.investment),d=Tt.map(e=>e.leads),u=Tt.map(e=>e.averageTicket),m=St(e),h=St(t),x=St(s),p=St(r),f=St(a),g=St(n),b=St(i),v=St(l),y=St(o),w=St(c),j=St(d),N=St(u);return Tt.slice(6).map((e,t)=>({...e,sessionsMA:m[t],revenueMA:h[t],clicksMA:x[t],addToCartMA:p[t],ordersMA:f[t],newCustomersMA:g[t],paidOrdersMA:b[t],paidRevenueMA:v[t],newCustomerRevenueMA:y[t],investmentMA:w[t],leadsMA:j[t],averageTicketMA:N[t]}))})():Tt,Et=ot.reduce((e,t)=>{const s=t.Cluster;return e[s]||(e[s]=[]),e[s].push(t),e},{}),Rt=Object.entries(Et).map(([e,t])=>({cluster:e,totals:t.reduce((e,t)=>({sessoes:e.sessoes+t.Sessoes,adicoesCarrinho:e.adicoesCarrinho+t.Adicoes_ao_Carrinho,pedidos:e.pedidos+t.Pedidos,receita:e.receita+t.Receita,novosClientes:e.novosClientes+t.Novos_Clientes,receitaPaga:e.receitaPaga+t.Receita_Paga,pedidosPagos:e.pedidosPagos+t.Pedidos_Pagos,receitaNovosClientes:e.receitaNovosClientes+t.Receita_Novos_Clientes,investimento:e.investimento+t.Investimento,cliques:e.cliques+t.Cliques,pedidosAssinaturaAnualInicial:e.pedidosAssinaturaAnualInicial+(t.Pedidos_Assinatura_Anual_Inicial||0),receitaAssinaturaAnualInicial:e.receitaAssinaturaAnualInicial+(t.Receita_Assinatura_Anual_Inicial||0),pedidosAssinaturaMensalInicial:e.pedidosAssinaturaMensalInicial+(t.Pedidos_Assinatura_Mensal_Inicial||0),receitaAssinaturaMensalInicial:e.receitaAssinaturaMensalInicial+(t.Receita_Assinatura_Mensal_Inicial||0),pedidosAssinaturaAnualRecorrente:e.pedidosAssinaturaAnualRecorrente+(t.Pedidos_Assinatura_Anual_Recorrente||0),receitaAssinaturaAnualRecorrente:e.receitaAssinaturaAnualRecorrente+(t.Receita_Assinatura_Anual_Recorrente||0),pedidosAssinaturaMensalRecorrente:e.pedidosAssinaturaMensalRecorrente+(t.Pedidos_Assinatura_Mensal_Recorrente||0),receitaAssinaturaMensalRecorrente:e.receitaAssinaturaMensalRecorrente+(t.Receita_Assinatura_Mensal_Recorrente||0)}),{sessoes:0,adicoesCarrinho:0,pedidos:0,receita:0,novosClientes:0,receitaPaga:0,pedidosPagos:0,receitaNovosClientes:0,investimento:0,cliques:0,pedidosAssinaturaAnualInicial:0,receitaAssinaturaAnualInicial:0,pedidosAssinaturaMensalInicial:0,receitaAssinaturaMensalInicial:0,pedidosAssinaturaAnualRecorrente:0,receitaAssinaturaAnualRecorrente:0,pedidosAssinaturaMensalRecorrente:0,receitaAssinaturaMensalRecorrente:0}),items:t})),Pt=(Mt=Rt,[...Mt].sort((e,t)=>{let s,r;switch(U){case"cluster":default:s=e.cluster,r=t.cluster;break;case"sessoes":s=e.totals.sessoes,r=t.totals.sessoes;break;case"adicoesCarrinho":s=e.totals.adicoesCarrinho,r=t.totals.adicoesCarrinho;break;case"pedidos":s=e.totals.pedidos,r=t.totals.pedidos;break;case"receita":s=e.totals.receita,r=t.totals.receita;break;case"receitaPaga":s=e.totals.receitaPaga,r=t.totals.receitaPaga;break;case"novosClientes":s=e.totals.novosClientes,r=t.totals.novosClientes;break;case"receitaNovosClientes":s=e.totals.receitaNovosClientes,r=t.totals.receitaNovosClientes;break;case"investimento":s=e.totals.investimento,r=t.totals.investimento;break;case"cliques":s=e.totals.cliques,r=t.totals.cliques;break;case"pedidosPagos":s=e.totals.pedidosPagos,r=t.totals.pedidosPagos;break;case"taxaPagamento":s=e.totals.pedidos>0?e.totals.pedidosPagos/e.totals.pedidos*100:0,r=t.totals.pedidos>0?t.totals.pedidosPagos/t.totals.pedidos*100:0;break;case"taxaConversao":s=e.totals.sessoes>0?e.totals.pedidos/e.totals.sessoes*100:0,r=t.totals.sessoes>0?t.totals.pedidos/t.totals.sessoes*100:0;break;case"taxaAdicaoCarrinho":s=e.totals.sessoes>0?e.totals.adicoesCarrinho/e.totals.sessoes*100:0,r=t.totals.sessoes>0?t.totals.adicoesCarrinho/t.totals.sessoes*100:0;break;case"percentualNovosClientes":s=e.totals.pedidos>0?e.totals.novosClientes/e.totals.pedidos*100:0,r=t.totals.pedidos>0?t.totals.novosClientes/t.totals.pedidos*100:0;break;case"pedidosAssinaturaAnualInicial":s=e.totals.pedidosAssinaturaAnualInicial||0,r=t.totals.pedidosAssinaturaAnualInicial||0;break;case"receitaAssinaturaAnualInicial":s=e.totals.receitaAssinaturaAnualInicial||0,r=t.totals.receitaAssinaturaAnualInicial||0;break;case"pedidosAssinaturaMensalInicial":s=e.totals.pedidosAssinaturaMensalInicial||0,r=t.totals.pedidosAssinaturaMensalInicial||0;break;case"receitaAssinaturaMensalInicial":s=e.totals.receitaAssinaturaMensalInicial||0,r=t.totals.receitaAssinaturaMensalInicial||0;break;case"pedidosAssinaturaAnualRecorrente":s=e.totals.pedidosAssinaturaAnualRecorrente||0,r=t.totals.pedidosAssinaturaAnualRecorrente||0;break;case"receitaAssinaturaAnualRecorrente":s=e.totals.receitaAssinaturaAnualRecorrente||0,r=t.totals.receitaAssinaturaAnualRecorrente||0;break;case"pedidosAssinaturaMensalRecorrente":s=e.totals.pedidosAssinaturaMensalRecorrente||0,r=t.totals.pedidosAssinaturaMensalRecorrente||0;break;case"receitaAssinaturaMensalRecorrente":s=e.totals.receitaAssinaturaMensalRecorrente||0,r=t.totals.receitaAssinaturaMensalRecorrente||0}return"string"==typeof s&&(s=s.toLowerCase(),r=r.toLowerCase()),s<r?"asc"===H?-1:1:s>r?"asc"===H?1:-1:0}));var Mt;const Lt=q?Pt:Pt.slice(0,10),Ot=Pt.length>10,It=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),Dt=e=>new Intl.NumberFormat("pt-BR").format(e),Ft=(e,t)=>0===t?e>0?100:0:0===e?t>0?-100:0:(e-t)/t*100,Bt=ct.receitaPaga>0?ct.investimento/ct.receitaPaga*100:0,$t=Ft(gt,_t),zt=Ft(Bt,kt),Vt=()=>{const e=!be;ye(e),"undefined"!=typeof window&&window.gtag&&window.gtag("event","metric_toggle",{metric_name:e?"revenue_per_session":"conversion_rate",previous_metric:be?"revenue_per_session":"conversion_rate",page_location:window.location.href})},Ut=()=>{const e=!we;je(e),"undefined"!=typeof window&&window.gtag&&window.gtag("event","metric_toggle",{metric_name:e?"leads_conversion_rate":"leads_absolute",previous_metric:we?"leads_conversion_rate":"leads_absolute",page_location:window.location.href})},Wt=e=>{U===e?G("asc"===H?"desc":"asc"):(W(e),G("desc"))},Ht=e=>{Ke({isOpen:!0,trafficCategory:e})},Gt=({runRateData:e,isLoadingGoals:t,isLoadingCurrentMonth:s})=>{if(t||s)return $e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4 shadow-sm",children:$e.jsxs("div",{className:"flex items-center justify-center",children:[$e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),$e.jsx("span",{className:"text-sm text-gray-700",children:"Carregando metas..."})]})});if(!e)return $e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4 shadow-sm",children:$e.jsxs("div",{className:"text-center",children:[$e.jsx(h,{className:"w-5 h-5 text-gray-400 mx-auto mb-3"}),$e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-2",children:"Run Rate da Meta"}),$e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Meta não disponível"}),$e.jsxs("button",{onClick:m,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-2 mx-auto",children:[$e.jsx(h,{className:"w-4 h-4"}),"Cadastrar Meta"]})]})});const{runRate:r,monthlyGoal:a,percentageOfGoal:n,currentDay:i,daysInMonth:l}=e,o=n>=100,c=Math.min(n,100);return $e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4 shadow-sm",children:[$e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-3",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl flex items-center justify-center",children:$e.jsx(h,{className:"w-5 h-5 text-blue-600"})}),$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Run Rate da Meta"}),$e.jsx("p",{className:"text-sm text-gray-600",children:"Projeção mensal"})]})]}),$e.jsxs("div",{className:"px-4 py-2 rounded-xl text-center shadow-sm "+(o?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border border-green-200":"bg-gradient-to-r from-red-50 to-pink-50 text-red-700 border border-red-200"),children:[$e.jsx("p",{className:"text-sm font-semibold",children:o?"✅ No caminho":"⚠️ Atrasado"}),$e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Dia ",i," de ",l]})]})]}),$e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[$e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 text-center border border-blue-100",children:[$e.jsx("p",{className:"text-sm font-medium text-blue-700 mb-2",children:"Run Rate Projetado"}),$e.jsx("p",{className:"text-xl font-bold text-blue-900",children:It(r)}),$e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Projeção mensal"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 text-center border border-purple-100",children:[$e.jsx("p",{className:"text-sm font-medium text-purple-700 mb-2",children:"Meta Mensal"}),$e.jsx("p",{className:"text-xl font-bold text-purple-900",children:It(a)}),$e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Objetivo"})]}),$e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-slate-50 rounded-xl p-4 text-center border border-gray-100",children:[$e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Progresso"}),$e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[$e.jsxs("span",{className:"text-2xl font-bold "+(o?"text-green-600":"text-red-600"),children:[n.toFixed(1),"%"]}),o?$e.jsx(Q,{className:"w-5 h-5 text-green-600"}):$e.jsx(ee,{className:"w-5 h-5 text-red-600"})]}),$e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:$e.jsx("div",{className:"h-2 rounded-full transition-all duration-500 ease-out "+(o?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"),style:{width:`${c}%`}})}),$e.jsxs("p",{className:"text-xs text-gray-600",children:[c.toFixed(1),"% da meta"]})]})]}),$e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-4 border border-gray-200",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progresso Visual"}),$e.jsxs("span",{className:"text-xs text-gray-500",children:[i,"/",l," dias"]})]}),$e.jsxs("div",{className:"relative",children:[$e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:$e.jsx("div",{className:"h-3 rounded-full transition-all duration-700 ease-out shadow-sm "+(o?"bg-gradient-to-r from-green-400 via-green-500 to-emerald-500":"bg-gradient-to-r from-red-400 via-red-500 to-pink-500"),style:{width:`${c}%`}})}),$e.jsx("div",{className:"absolute top-0 w-1 h-3 rounded-full shadow-lg "+(o?"bg-green-600":"bg-red-600"),style:{left:`calc(${c}% - 2px)`}})]}),$e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[$e.jsx("span",{children:"0%"}),$e.jsx("span",{children:"50%"}),$e.jsx("span",{children:"100%"})]})]}),$e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:$e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[$e.jsxs("div",{className:"text-center sm:text-left",children:[$e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Baseado em ",i," dias"]}),$e.jsx("p",{className:"text-xs text-gray-500",children:"Dados até hoje"})]}),$e.jsxs("div",{className:"text-center sm:text-right",children:[$e.jsx("p",{className:"text-sm font-semibold "+(o?"text-green-600":"text-red-600"),children:o?"🎯 Meta será atingida":"⚠️ Meta em risco"}),$e.jsx("p",{className:"text-xs text-gray-500",children:o?"Continue assim!":"Ação necessária"})]})]})})]})},qt=({title:e,value:t,icon:s,growth:r,format:a="number",color:n="blue"})=>$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 border border-gray-100 hover:shadow-xl transition-shadow",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("div",{className:`p-2.5 rounded-lg ${{blue:"bg-gray-300",green:"bg-gray-300",purple:"bg-gray-300",orange:"bg-gray-300",red:"bg-gray-300"}[n]} text-gray-700`,children:$e.jsx(s,{className:"w-5 h-5"})}),Re?$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"Comparando..."})]}):void 0!==r&&0!==r&&$e.jsxs("div",{className:"flex items-center gap-1",children:[r>0?$e.jsx(Q,{className:"w-4 h-4 text-green-600"}):r<0?$e.jsx(ee,{className:"w-4 h-4 text-red-600"}):null,$e.jsxs("span",{className:"text-sm font-medium "+(r>0?"text-green-600":r<0?"text-red-600":"text-gray-500"),children:[r>0?"+":"",r.toFixed(1),"%"]})]})]}),$e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:e}),$e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(()=>{switch(a){case"currency":return It(t);case"percentage":return`${t.toFixed(2)}%`;default:return Dt(t)}})()})]});if(_)return $e.jsx(cs,{message:"Carregando métricas..."});const Yt=[..."havaianas"===I?["havaianas"]:[],"dados-detalhados","frete","ab-testing",...(null==s?void 0:s.admin)?["configuracao"]:[]];return $e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[$e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:$e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:$e.jsxs("div",{className:"flex justify-between items-center h-16",children:[$e.jsx("div",{className:"flex items-center gap-4",children:$e.jsx(as,{size:"xl"})}),$e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 relative z-30",children:[(()=>{try{const e=localStorage.getItem("login-response"),t=e?JSON.parse(e):null,r="all"===(null==t?void 0:t.table_name)||"all"===(null==t?void 0:t.access_control);return $e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-28 sm:w-48",children:$e.jsx(ds,{currentTable:I,onTableChange:$,activeTab:oe,onTabChange:ce,useCSV:r,availableTables:r?[]:[(null==t?void 0:t.table_name)||""],hideClientName:!r||J,user:s})}),r&&$e.jsx("button",{onClick:()=>Z(!J),className:"flex items-center justify-center p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-md transition-colors relative z-40",title:"Ocultar dropdown de clientes",children:$e.jsx(l,{className:"w-4 h-4"})})]})}catch(e){return null}})(),(()=>{try{const e=localStorage.getItem("login-response"),t=e?JSON.parse(e):null;return!("all"===(null==t?void 0:t.table_name)||"all"===(null==t?void 0:t.access_control))&&(null==t?void 0:t.table_name)?$e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 rounded-lg border border-blue-200",children:[$e.jsx(u,{className:"w-4 h-4 text-blue-500"}),$e.jsx("span",{className:"text-sm font-medium text-blue-700",children:t.table_name})]}):null}catch(e){return null}})(),$e.jsx(fm,{onLogout:t,user:s})]})]})})}),$e.jsx("div",{className:"bg-white border-b border-gray-200",children:$e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[$e.jsxs("nav",{className:"hidden md:flex",children:[["visao-geral","midia-paga","funil-conversao","produtos","tempo-real","pedidos","leads"].map(e=>{const t={"visao-geral":{label:"Visão Geral",icon:y},"midia-paga":{label:"Mídia Paga",icon:v},"funil-conversao":{label:"Funil de Conversão",icon:b},"dados-detalhados":{label:"Dados Detalhados",icon:u},frete:{label:"Frete",icon:g},produtos:{label:"Produtos",icon:f},"tempo-real":{label:"Tempo Real",icon:p},pedidos:{label:"Pedidos",icon:O},leads:{label:"Leads",icon:n}}[e];if(!t)return null;const s=t.icon,r=oe===e;return $e.jsx("button",{onClick:()=>it(e),className:"flex-1 py-3 px-6 border-b-2 font-medium text-sm transition-colors whitespace-nowrap "+(r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:$e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[$e.jsx(s,{className:"w-4 h-4"}),t.label]})},e)}),Yt.length>0&&$e.jsxs("div",{className:"relative flex-1",children:[$e.jsxs("button",{onClick:()=>he(!me),className:"w-full py-3 px-6 border-b-2 font-medium text-sm transition-colors whitespace-nowrap flex items-center justify-center gap-2 "+(Yt.includes(oe)?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[$e.jsx("span",{children:"Mais"}),$e.jsx(C,{className:"w-4 h-4 transition-transform "+(me?"rotate-180":"")})]}),me&&$e.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:Yt.map(e=>{const t={havaianas:{label:"Product Scoring",icon:x},"dados-detalhados":{label:"Dados Detalhados",icon:u},frete:{label:"Frete",icon:g},"ab-testing":{label:"Testes A/B",icon:h},configuracao:{label:"Configuração",icon:E}}[e];if(!t)return null;const s=t.icon,r=oe===e;return $e.jsxs("button",{onClick:()=>{it(e),he(!1)},className:"w-full px-4 py-3 text-left text-sm transition-colors flex items-center gap-3 "+(r?"bg-blue-50 text-blue-700 border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-50"),children:[$e.jsx(s,{className:"w-4 h-4"}),t.label]},e)})})]})]}),$e.jsxs("div",{className:"md:hidden",children:[$e.jsxs("div",{className:"flex items-center justify-between py-3",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Aba atual:"}),$e.jsxs("span",{className:"text-sm text-blue-600 font-semibold",children:["visao-geral"===oe&&"Visão Geral","midia-paga"===oe&&"Mídia Paga","funil-conversao"===oe&&"Funil de Conversão","dados-detalhados"===oe&&"Dados Detalhados","frete"===oe&&"Frete","havaianas"===oe&&"Product Scoring","produtos"===oe&&"Produtos","ab-testing"===oe&&"Testes A/B","tempo-real"===oe&&"Tempo Real","configuracao"===oe&&(null==s?void 0:s.admin)&&"Configuração","pedidos"===oe&&"Pedidos","leads"===oe&&"Leads"]})]}),$e.jsx("button",{onClick:()=>ue(!de),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Abrir menu de abas",children:$e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),de&&$e.jsxs($e.Fragment,{children:[$e.jsx("div",{className:"fixed inset-0 z-40 md:hidden",onClick:()=>ue(!1)}),$e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-50 md:hidden",children:$e.jsxs("div",{className:"p-2 space-y-1",children:[$e.jsx("button",{onClick:()=>{it("visao-geral"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("visao-geral"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(y,{className:"w-5 h-5"}),$e.jsx("span",{children:"Visão Geral"}),"visao-geral"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("midia-paga"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("midia-paga"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(v,{className:"w-5 h-5"}),$e.jsx("span",{children:"Mídia Paga"}),"midia-paga"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("funil-conversao"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("funil-conversao"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(b,{className:"w-5 h-5"}),$e.jsx("span",{children:"Funil de Conversão"}),"funil-conversao"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("dados-detalhados"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("dados-detalhados"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(u,{className:"w-5 h-5"}),$e.jsx("span",{children:"Dados Detalhados"}),"dados-detalhados"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("frete"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("frete"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(g,{className:"w-5 h-5"}),$e.jsx("span",{children:"Frete"}),"frete"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),"havaianas"===I&&$e.jsx("button",{onClick:()=>{it("havaianas"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("havaianas"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(x,{className:"w-5 h-5"}),$e.jsx("span",{children:"Product Scoring"}),"havaianas"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("produtos"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("produtos"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(f,{className:"w-5 h-5"}),$e.jsx("span",{children:"Produtos"}),"produtos"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("ab-testing"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("ab-testing"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(h,{className:"w-5 h-5"}),$e.jsx("span",{children:"Testes A/B"}),"ab-testing"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("tempo-real"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("tempo-real"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(p,{className:"w-5 h-5"}),$e.jsx("span",{children:"Tempo Real"}),"tempo-real"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("configuracao"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("configuracao"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(E,{className:"w-5 h-5"}),$e.jsx("span",{children:"Configuração"}),"configuracao"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("pedidos"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("pedidos"===oe?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(O,{className:"w-5 h-5"}),$e.jsx("span",{children:"Pedidos"}),"pedidos"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]})}),$e.jsx("button",{onClick:()=>{it("leads"),ue(!1)},className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors "+("leads"===oe?"bg-purple-50 text-purple-700 border border-purple-200":"text-gray-700 hover:bg-gray-50"),children:$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx(n,{className:"w-5 h-5"}),$e.jsx("span",{children:"Leads"}),"leads"===oe&&$e.jsx("div",{className:"ml-auto w-2 h-2 bg-purple-600 rounded-full"})]})})]})})]}),$e.jsx("div",{className:"flex overflow-x-auto scrollbar-hide pb-2 -mx-4 px-4",children:$e.jsxs("div",{className:"flex space-x-2 min-w-max",children:[$e.jsx("button",{onClick:()=>it("visao-geral"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("visao-geral"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(y,{className:"w-3 h-3"}),$e.jsx("span",{children:"Visão Geral"})]})}),$e.jsx("button",{onClick:()=>it("midia-paga"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("midia-paga"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(v,{className:"w-3 h-3"}),$e.jsx("span",{children:"Mídia"})]})}),$e.jsx("button",{onClick:()=>it("funil-conversao"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("funil-conversao"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(b,{className:"w-3 h-3"}),$e.jsx("span",{children:"Funil"})]})}),$e.jsx("button",{onClick:()=>it("dados-detalhados"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("dados-detalhados"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(u,{className:"w-3 h-3"}),$e.jsx("span",{children:"Dados"})]})}),$e.jsx("button",{onClick:()=>it("frete"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("frete"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(g,{className:"w-3 h-3"}),$e.jsx("span",{children:"Frete"})]})}),"havaianas"===I&&$e.jsx("button",{onClick:()=>it("havaianas"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("havaianas"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(x,{className:"w-3 h-3"}),$e.jsx("span",{children:"Scoring"})]})}),$e.jsx("button",{onClick:()=>it("produtos"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("produtos"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(f,{className:"w-3 h-3"}),$e.jsx("span",{children:"Produtos"})]})}),$e.jsx("button",{onClick:()=>it("ab-testing"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("ab-testing"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(h,{className:"w-3 h-3"}),$e.jsx("span",{children:"A/B"})]})}),$e.jsx("button",{onClick:()=>it("tempo-real"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("tempo-real"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(p,{className:"w-3 h-3"}),$e.jsx("span",{children:"Live"})]})}),(null==s?void 0:s.admin)&&$e.jsx("button",{onClick:()=>it("configuracao"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("configuracao"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(E,{className:"w-3 h-3"}),$e.jsx("span",{children:"Config"})]})}),(null==s?void 0:s.admin)&&$e.jsx("button",{onClick:()=>it("tokendebug"),className:"flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-colors whitespace-nowrap "+("tokendebug"===oe?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx(r,{className:"w-3 h-3"}),$e.jsx("span",{children:"Token Debug"})]})})]})})]})]})}),$e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:["tempo-real"!==oe&&"configuracao"!==oe&&"produtos"!==oe&&$e.jsx("div",{className:"mb-6 bg-white rounded-xl shadow-lg p-4 border border-gray-200",children:$e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Filtros de Período"}),$e.jsxs("p",{className:"text-sm text-gray-600",children:["visao-geral"===oe&&"Padrão: Mês atual até hoje","funil-conversao"===oe&&"Padrão: Últimos 60 dias até hoje","dados-detalhados"===oe&&"Padrão: Últimos 7 dias até hoje","pedidos"===oe&&"Padrão: Hoje","leads"===oe&&"Padrão: Últimos 12 meses até hoje",!["visao-geral","funil-conversao","dados-detalhados"].includes(oe)&&"Padrão: Mês atual até hoje"]})]}),"configuracao"!==oe&&$e.jsx("div",{className:"flex items-center gap-4",children:$e.jsx(gs,{startDate:A,endDate:M,onDateRangeChange:(e,t)=>{P(e),L(t)}})})]})}),"visao-geral"===oe&&$e.jsxs($e.Fragment,{children:[$e.jsxs("div",{className:"md:hidden -mx-4 px-4",children:[$e.jsxs("div",{className:"mb-8 bg-gradient-to-br from-blue-50/30 to-purple-50/30 -mx-4 px-4 py-6 rounded-b-3xl",children:[$e.jsxs("div",{className:"mb-2",children:[$e.jsx("h3",{className:"text-lg font-bold text-gray-800 text-center mb-1",children:"📊 Resumo do Mês"}),$e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Acompanhe o progresso das suas metas"})]}),$e.jsx(Gt,{runRateData:Ct,isLoadingGoals:Oe,isLoadingCurrentMonth:Be})]}),$e.jsx("div",{className:"mb-4 bg-white rounded-lg shadow-sm p-3 border border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filtros:"}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{htmlFor:"plataforma-filter-mobile",className:"text-xs text-gray-600",children:"Plataforma:"}),$e.jsxs("div",{className:"relative",children:[$e.jsxs("select",{id:"plataforma-filter-mobile",value:ke,onChange:e=>Ce(e.target.value),className:"px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[$e.jsx("option",{value:"",children:"Todas"}),Array.from(new Set(w.filter(e=>e.Plataforma).map(e=>e.Plataforma))).map(e=>$e.jsx("option",{value:e,children:e},e))]}),ke&&$e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 rounded-full"})]})]})]})}),$e.jsx("div",{className:"mb-8",children:$e.jsx(Fr,{metrics:[{title:"Pedidos Totais",value:ct.pedidos,icon:O,growth:Ft(ct.pedidos,dt.pedidos),color:"blue"},{title:"Pedidos Pagos",value:ct.pedidosPagos,icon:r,growth:Ft(ct.pedidosPagos,dt.pedidosPagos),color:"green"},{title:"Receita Total",value:ct.receita,icon:R,growth:Ft(ct.receita,dt.receita),format:"currency",color:"purple"},{title:"Receita Paga",value:ct.receitaPaga,icon:B,growth:Ft(ct.receitaPaga,dt.receitaPaga),format:"currency",color:"orange"},{title:"Sessões",value:ct.sessoes,icon:F,growth:Ft(ct.sessoes,dt.sessoes),color:"blue"},{title:"Investimento Total",value:ct.investimento,icon:h,growth:Ft(ct.investimento,dt.investimento),format:"currency",color:"red"},{title:fe?"ROAS (Receita/Invest)":"TACoS (Invest/Receita)",value:fe?gt:Bt,icon:v,growth:fe?$t:zt,format:fe?"number":"percentage",color:"green"},{title:"Ticket Médio",value:ut,icon:R,format:"currency",color:"orange",growth:Ft(ut,bt)},{title:be?"Receita por Sessão":"Taxa de Conversão",value:be?ht:mt,icon:be?V:z,format:be?"currency":"percentage",color:be?"blue":"red",growth:be?Ft(ht,yt):Ft(mt,vt),onToggle:Vt,toggleLabel:be?"Taxa de Conversão":"Receita por Sessão"},{title:"Novos Clientes",value:xt,icon:ve,format:"percentage",color:"indigo",growth:Ft(xt,wt)},{title:"Taxa de Adição ao Carrinho",value:pt,icon:O,format:"percentage",color:"blue",growth:Ft(pt,jt)},{title:we?"Taxa de Conversão por Leads":"Leads",value:we?ft:ct.leads,icon:we?h:E,format:we?"percentage":"number",color:"gray",growth:we?Ft(ft,Nt):Ft(ct.leads,dt.leads),onToggle:Ut,toggleLabel:we?"Leads":"Taxa de Conversão por Leads"},...ct.pedidosAssinaturaAnualInicial>0||ct.pedidosAssinaturaMensalInicial>0||ct.pedidosAssinaturaAnualRecorrente>0||ct.pedidosAssinaturaMensalRecorrente>0?[{title:"Novas Assinaturas Anuais",value:ct.pedidosAssinaturaAnualInicial,icon:O,growth:Ft(ct.pedidosAssinaturaAnualInicial,dt.pedidosAssinaturaAnualInicial),color:"purple"},{title:"Receita Novas Anuais",value:ct.receitaAssinaturaAnualInicial,icon:R,growth:Ft(ct.receitaAssinaturaAnualInicial,dt.receitaAssinaturaAnualInicial),format:"currency",color:"purple"},{title:"Novas Assinaturas Mensais",value:ct.pedidosAssinaturaMensalInicial,icon:O,growth:Ft(ct.pedidosAssinaturaMensalInicial,dt.pedidosAssinaturaMensalInicial),color:"indigo"},{title:"Receita Novas Mensais",value:ct.receitaAssinaturaMensalInicial,icon:R,growth:Ft(ct.receitaAssinaturaMensalInicial,dt.receitaAssinaturaMensalInicial),format:"currency",color:"indigo"},{title:"Renovações Anuais",value:ct.pedidosAssinaturaAnualRecorrente,icon:B,growth:Ft(ct.pedidosAssinaturaAnualRecorrente,dt.pedidosAssinaturaAnualRecorrente),color:"cyan"},{title:"Receita Renovações Anuais",value:ct.receitaAssinaturaAnualRecorrente,icon:R,growth:Ft(ct.receitaAssinaturaAnualRecorrente,dt.receitaAssinaturaAnualRecorrente),format:"currency",color:"cyan"},{title:"Renovações Mensais",value:ct.pedidosAssinaturaMensalRecorrente,icon:B,growth:Ft(ct.pedidosAssinaturaMensalRecorrente,dt.pedidosAssinaturaMensalRecorrente),color:"teal"},{title:"Receita Renovações Mensais",value:ct.receitaAssinaturaMensalRecorrente,icon:R,growth:Ft(ct.receitaAssinaturaMensalRecorrente,dt.receitaAssinaturaMensalRecorrente),format:"currency",color:"teal"}]:[]]})})]}),0!==w.length||S?$e.jsxs($e.Fragment,{children:[$e.jsxs("div",{className:"hidden md:block",children:[$e.jsxs("div",{className:"mb-6 bg-gradient-to-br from-blue-50/30 to-purple-50/30 rounded-2xl p-6 border border-blue-100/50",children:[$e.jsxs("div",{className:"mb-4",children:[$e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"📊 Resumo do Mês"}),$e.jsx("p",{className:"text-gray-600",children:"Acompanhe o progresso das suas metas e projeções"})]}),$e.jsx(Gt,{runRateData:Ct,isLoadingGoals:Oe,isLoadingCurrentMonth:Be})]}),$e.jsx("div",{className:"mb-4 bg-white rounded-lg shadow-sm p-3 border border-gray-200",children:$e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filtros:"}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{htmlFor:"plataforma-filter-desktop",className:"text-xs text-gray-600",children:"Plataforma:"}),$e.jsxs("div",{className:"relative",children:[$e.jsxs("select",{id:"plataforma-filter-desktop",value:ke,onChange:e=>Ce(e.target.value),className:"px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[$e.jsx("option",{value:"",children:"Todas"}),Array.from(new Set(w.filter(e=>e.Plataforma).map(e=>e.Plataforma))).map(e=>$e.jsx("option",{value:e,children:e},e))]}),ke&&$e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-500 rounded-full"})]})]})]})}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[$e.jsx(qt,{title:"Pedidos Totais",value:ct.pedidos,icon:O,growth:Ft(ct.pedidos,dt.pedidos),color:"blue"}),$e.jsx(qt,{title:"Pedidos Pagos",value:ct.pedidosPagos,icon:r,growth:Ft(ct.pedidosPagos,dt.pedidosPagos),color:"green"}),$e.jsx(qt,{title:"Receita Total",value:ct.receita,icon:R,growth:Ft(ct.receita,dt.receita),format:"currency",color:"purple"}),$e.jsx(qt,{title:"Receita Paga",value:ct.receitaPaga,icon:B,growth:Ft(ct.receitaPaga,dt.receitaPaga),format:"currency",color:"orange"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[$e.jsx(qt,{title:"Sessões",value:ct.sessoes,icon:F,growth:Ft(ct.sessoes,dt.sessoes),color:"blue"}),$e.jsx(qt,{title:"Investimento Total",value:ct.investimento,icon:h,growth:Ft(ct.investimento,dt.investimento),format:"currency",color:"red"}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 border border-gray-100 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:()=>ge(!fe),children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("div",{className:"p-2.5 rounded-lg bg-gray-300 text-gray-700",children:$e.jsx(v,{className:"w-5 h-5"})}),!Re&&0!==(fe?$t:zt)&&$e.jsxs("div",{className:"flex items-center gap-1",children:[(fe?$t:zt)>0?$e.jsx(Q,{className:"w-4 h-4 text-green-600"}):(fe?$t:zt)<0?$e.jsx(ee,{className:"w-4 h-4 text-red-600"}):null,$e.jsxs("span",{className:"text-sm font-medium "+((fe?$t:zt)>0?"text-green-600":"text-red-600"),children:[(fe?$t:zt)>0?"+":"",(fe?$t:zt).toFixed(1),"%"]})]})]}),$e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:fe?"ROAS (Receita/Invest)":"TACoS (Invest/Receita)"}),$e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:fe?`${gt.toFixed(2)}x`:`${Bt.toFixed(1)}%`}),$e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"Clique para alternar"})]})]}),$e.jsx(qt,{title:"Ticket Médio",value:ut,icon:R,format:"currency",color:"orange",growth:Ft(ut,bt)})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 border border-gray-100 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:Vt,children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("div",{className:"p-2.5 rounded-lg bg-gray-300 text-gray-700",children:be?$e.jsx(V,{className:"w-5 h-5"}):$e.jsx(z,{className:"w-5 h-5"})}),!Re&&0!==(be?Ft(ht,yt):Ft(mt,vt))&&$e.jsxs("div",{className:"flex items-center gap-1",children:[(be?Ft(ht,yt):Ft(mt,vt))>0?$e.jsx(Q,{className:"w-4 h-4 text-green-600"}):(be?Ft(ht,yt):Ft(mt,vt))<0?$e.jsx(ee,{className:"w-4 h-4 text-red-600"}):null,$e.jsxs("span",{className:"text-sm font-medium "+((be?Ft(ht,yt):Ft(mt,vt))>0?"text-green-600":"text-red-600"),children:[(be?Ft(ht,yt):Ft(mt,vt))>0?"+":"",(be?Ft(ht,yt):Ft(mt,vt)).toFixed(1),"%"]})]})]}),$e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:be?"Receita por Sessão":"Taxa de Conversão"}),$e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:be?It(ht):`${mt.toFixed(2)}%`}),$e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"Clique para alternar"})]})]}),$e.jsx(qt,{title:"Novos Clientes",value:xt,icon:ve,format:"percentage",color:"indigo",growth:Ft(xt,wt)}),$e.jsx(qt,{title:"Taxa de Adição ao Carrinho",value:pt,icon:O,format:"percentage",color:"blue",growth:Ft(pt,jt)}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 border border-gray-100 hover:shadow-xl transition-all duration-200 cursor-pointer",onClick:Ut,children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsx("div",{className:"p-2.5 rounded-lg bg-gray-300 text-gray-700",children:we?$e.jsx(h,{className:"w-5 h-5"}):$e.jsx(E,{className:"w-5 h-5"})}),!Re&&0!==(we?Ft(ft,Nt):Ft(ct.leads,dt.leads))&&$e.jsxs("div",{className:"flex items-center gap-1",children:[(we?Ft(ft,Nt):Ft(ct.leads,dt.leads))>0?$e.jsx(Q,{className:"w-4 h-4 text-green-600"}):(we?Ft(ft,Nt):Ft(ct.leads,dt.leads))<0?$e.jsx(ee,{className:"w-4 h-4 text-red-600"}):null,$e.jsxs("span",{className:"text-sm font-medium "+((we?Ft(ft,Nt):Ft(ct.leads,dt.leads))>0?"text-green-600":"text-red-600"),children:[(we?Ft(ft,Nt):Ft(ct.leads,dt.leads))>0?"+":"",(we?Ft(ft,Nt):Ft(ct.leads,dt.leads)).toFixed(1),"%"]})]})]}),$e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:we?"Taxa de Conversão por Leads":"Leads"}),$e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:we?`${ft.toFixed(2)}%`:Dt(ct.leads)}),$e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),$e.jsx("span",{className:"text-xs text-gray-500",children:"Clique para alternar"})]})]})]}),(ct.pedidosAssinaturaAnualInicial>0||ct.pedidosAssinaturaMensalInicial>0||ct.pedidosAssinaturaAnualRecorrente>0||ct.pedidosAssinaturaMensalRecorrente>0)&&$e.jsxs($e.Fragment,{children:[$e.jsx("div",{className:"border-t border-gray-200 my-6 pt-6",children:$e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[$e.jsx(u,{className:"w-5 h-5 text-purple-600"}),"Assinaturas"]})}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[$e.jsx(qt,{title:"Novas Assinaturas Anuais",value:ct.pedidosAssinaturaAnualInicial,icon:O,growth:Ft(ct.pedidosAssinaturaAnualInicial,dt.pedidosAssinaturaAnualInicial),color:"purple"}),$e.jsx(qt,{title:"Receita Novas Anuais",value:ct.receitaAssinaturaAnualInicial,icon:R,growth:Ft(ct.receitaAssinaturaAnualInicial,dt.receitaAssinaturaAnualInicial),format:"currency",color:"purple"}),$e.jsx(qt,{title:"Novas Assinaturas Mensais",value:ct.pedidosAssinaturaMensalInicial,icon:O,growth:Ft(ct.pedidosAssinaturaMensalInicial,dt.pedidosAssinaturaMensalInicial),color:"indigo"}),$e.jsx(qt,{title:"Receita Novas Mensais",value:ct.receitaAssinaturaMensalInicial,icon:R,growth:Ft(ct.receitaAssinaturaMensalInicial,dt.receitaAssinaturaMensalInicial),format:"currency",color:"indigo"})]}),$e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[$e.jsx(qt,{title:"Renovações Anuais",value:ct.pedidosAssinaturaAnualRecorrente,icon:B,growth:Ft(ct.pedidosAssinaturaAnualRecorrente,dt.pedidosAssinaturaAnualRecorrente),color:"cyan"}),$e.jsx(qt,{title:"Receita Renovações Anuais",value:ct.receitaAssinaturaAnualRecorrente,icon:R,growth:Ft(ct.receitaAssinaturaAnualRecorrente,dt.receitaAssinaturaAnualRecorrente),format:"currency",color:"cyan"}),$e.jsx(qt,{title:"Renovações Mensais",value:ct.pedidosAssinaturaMensalRecorrente,icon:B,growth:Ft(ct.pedidosAssinaturaMensalRecorrente,dt.pedidosAssinaturaMensalRecorrente),color:"teal"}),$e.jsx(qt,{title:"Receita Renovações Mensais",value:ct.receitaAssinaturaMensalRecorrente,icon:R,growth:Ft(ct.receitaAssinaturaMensalRecorrente,dt.receitaAssinaturaMensalRecorrente),format:"currency",color:"teal"})]})]})]}),$e.jsx("div",{className:"mb-6",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 border border-gray-200",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[$e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Timeline de Métricas"}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{htmlFor:"moving-average-toggle",className:"text-sm text-gray-600",children:"Média Móvel (7 dias):"}),$e.jsx("input",{id:"moving-average-toggle",type:"checkbox",checked:Se,onChange:e=>Te(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"})]})]}),$e.jsx(ws,{data:At,title:"",showMovingAverage:Se})]})}),$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Dados Agrupados por Cluster"}),$e.jsxs("p",{className:"text-sm text-gray-500",children:["Métricas consolidadas por cluster",at>0&&$e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["• ",at.toLocaleString()," registros"]})]})]}),$e.jsxs("div",{className:"flex items-center gap-4",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Modelo de Atribuição:"}),$e.jsxs("div",{className:"relative",children:[$e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500"}),$e.jsxs("select",{value:xe,onChange:e=>{pe(e.target.value)},className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white min-w-[200px]",children:[$e.jsx("option",{value:"Último Clique Não Direto",children:"Último Clique Não Direto"}),$e.jsx("option",{value:"Primeiro Clique",children:"Primeiro Clique"})]})]})]}),$e.jsxs("button",{onClick:()=>ne(!ae),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(ae?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),title:"Selecionar métricas",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),$e.jsx("span",{children:"Métricas"}),$e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+(ae?"bg-white/20 text-white":"bg-blue-100 text-blue-600"),children:Object.values(se).filter(Boolean).length}),$e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(ae?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),$e.jsx("button",{onClick:()=>X(!0),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Tela cheia",children:$e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),S&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[$e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),$e.jsx("span",{children:"Carregando..."})]})]})]}),$e.jsxs("div",{className:"md:hidden",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Dados Agrupados por Cluster"}),$e.jsxs("p",{className:"text-sm text-gray-500",children:["Métricas consolidadas por cluster",at>0&&$e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["• ",at.toLocaleString()," registros"]})]})]}),S&&$e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[$e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),$e.jsx("span",{children:"Carregando..."})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Modelo de Atribuição:"}),$e.jsxs("div",{className:"relative flex-1",children:[$e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500"}),$e.jsxs("select",{value:xe,onChange:e=>{pe(e.target.value)},className:"w-full pl-10 pr-8 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[$e.jsx("option",{value:"Último Clique Não Direto",children:"Último Clique Não Direto"}),$e.jsx("option",{value:"Primeiro Clique",children:"Primeiro Clique"})]})]})]})]})]}),$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[se.cluster&&$e.jsx(bs,{field:"cluster",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Cluster"}),se.sessoes&&$e.jsx(bs,{field:"sessoes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Sessões"}),se.taxaAdicaoCarrinho&&$e.jsx(bs,{field:"taxaAdicaoCarrinho",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Taxa Carrinho"}),se.adicoesCarrinho&&$e.jsx(bs,{field:"adicoesCarrinho",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Carrinho"}),se.taxaConversao&&$e.jsx(bs,{field:"taxaConversao",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Taxa Conv."}),se.pedidos&&$e.jsx(bs,{field:"pedidos",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Pedidos"}),se.pedidosPagos&&$e.jsx(bs,{field:"pedidosPagos",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Pedidos Pagos"}),se.taxaPagamento&&$e.jsx(bs,{field:"taxaPagamento",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Pagamento"}),se.receita&&$e.jsx(bs,{field:"receita",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita"}),se.receitaPaga&&$e.jsx(bs,{field:"receitaPaga",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Paga"}),se.taxaReceitaPaga&&$e.jsx(bs,{field:"taxaReceitaPaga",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Receita Paga"}),se.novosClientes&&$e.jsx(bs,{field:"novosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novos Clientes"}),se.receitaNovosClientes&&$e.jsx(bs,{field:"receitaNovosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novos"}),se.percentualNovosClientes&&$e.jsx(bs,{field:"percentualNovosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Novos Clientes"}),se.leads&&$e.jsx(bs,{field:"leads",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Leads"}),se.pedidosAssinaturaAnualInicial&&ct.pedidosAssinaturaAnualInicial>0&&$e.jsx(bs,{field:"pedidosAssinaturaAnualInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novas Assinaturas Anuais"}),se.receitaAssinaturaAnualInicial&&ct.receitaAssinaturaAnualInicial>0&&$e.jsx(bs,{field:"receitaAssinaturaAnualInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novas Anuais"}),se.pedidosAssinaturaMensalInicial&&ct.pedidosAssinaturaMensalInicial>0&&$e.jsx(bs,{field:"pedidosAssinaturaMensalInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novas Assinaturas Mensais"}),se.receitaAssinaturaMensalInicial&&ct.receitaAssinaturaMensalInicial>0&&$e.jsx(bs,{field:"receitaAssinaturaMensalInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novas Mensais"}),se.pedidosAssinaturaAnualRecorrente&&ct.pedidosAssinaturaAnualRecorrente>0&&$e.jsx(bs,{field:"pedidosAssinaturaAnualRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Renovações Anuais"}),se.receitaAssinaturaAnualRecorrente&&ct.receitaAssinaturaAnualRecorrente>0&&$e.jsx(bs,{field:"receitaAssinaturaAnualRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Renovações Anuais"}),se.pedidosAssinaturaMensalRecorrente&&ct.pedidosAssinaturaMensalRecorrente>0&&$e.jsx(bs,{field:"pedidosAssinaturaMensalRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Renovações Mensais"}),se.receitaAssinaturaMensalRecorrente&&ct.receitaAssinaturaMensalRecorrente>0&&$e.jsx(bs,{field:"receitaAssinaturaMensalRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Renovações Mensais"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Lt.map((e,t)=>{const{cluster:s,totals:r}=e,a=r.sessoes>0?r.pedidos/r.sessoes*100:0;return $e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200 group "+(Ne===s?"bg-blue-50 border-l-4 border-l-blue-500":""),onClick:()=>{_e(Ne===s?"":s)},title:Ne===s?"Clique para remover filtro":"Clique para filtrar por este cluster",children:[se.cluster&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{className:"text-lg transition-colors "+(Ne===s?"text-blue-600 font-semibold":"group-hover:text-blue-600"),children:s}),$e.jsx(b,{className:"w-3 h-3 transition-opacity "+(Ne===s?"text-blue-600 opacity-100":"text-gray-400 opacity-0 group-hover:opacity-100")}),Ne===s&&$e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:"Filtrado"})]})}),se.sessoes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Dt(r.sessoes)}),se.taxaAdicaoCarrinho&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:[r.sessoes>0?(r.adicoesCarrinho/r.sessoes*100).toFixed(1):"0.0","%"]}),se.adicoesCarrinho&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Dt(r.adicoesCarrinho)}),se.taxaConversao&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:[a.toFixed(2),"%"]}),se.pedidos&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("span",{children:Dt(r.pedidos)}),r.pedidos>0&&(()=>{const e=`${I}-${s}-${A}-${M}-${xe}`,t=Ze.has(e),a=Xe.has(e),n=st.get(e)||"",i=et.get(e)||0,l=i>0?Math.floor((Date.now()-i)/1e3):0,c=Math.max(0,60-l);return $e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsxs("button",{onClick:()=>(async e=>{const t=`${I}-${e}-${A}-${M}-${xe}`;if(!Ze.has(t))if(Xe.has(t))Ht(e);else try{Qe(e=>new Set(e).add(t)),tt(e=>new Map(e).set(t,Date.now())),rt(e=>new Map(e).set(t,"Iniciando download..."));let s=60;const r=setInterval(()=>{s--,rt(e=>{const r=new Map(e);let a="Baixando pedidos...";return a=s>=50?"Iniciando download...":s>=40?"Processando dados...":s>=20?"Analisando atribuições...":s>=10?"Finalizando download...":s>=5?"Quase pronto...":s>0?"Finalizando...":"Aguarde...",r.set(t,a),r}),s<=0&&clearInterval(r)},1e3),a=localStorage.getItem("auth-token");if(!a)throw new Error("Token de autenticação não encontrado");if(!is(I))return;const n={start_date:A,end_date:M,table_name:I,limit:100};"Primeiro Clique"===xe?n.fs_traffic_category=e:n.traffic_category=e,await ls.getOrders(a,n),clearInterval(r),Je(e=>new Set(e).add(t)),tt(e=>{const s=new Map(e);return s.delete(t),s}),rt(e=>{const s=new Map(e);return s.delete(t),s}),Ht(e)}catch(s){}finally{Qe(e=>{const s=new Set(e);return s.delete(t),s}),tt(e=>{const s=new Map(e);return s.delete(t),s}),rt(e=>{const s=new Map(e);return s.delete(t),s})}})(s),disabled:t,className:"p-1 hover:bg-blue-100 rounded transition-colors group relative disabled:opacity-50 disabled:cursor-not-allowed",title:t?`${n} (${c}s restantes)`:a?`Ver ${Dt(r.pedidos)} pedido${1!==r.pedidos?"s":""} baixados`:`Baixar ${Dt(r.pedidos)} pedido${1!==r.pedidos?"s":""}`,children:[t?$e.jsxs("div",{className:"flex items-center gap-1",children:[$e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),$e.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[c,"s"]})]}):a?$e.jsx(o,{className:"w-3 h-3 text-green-600 group-hover:text-green-700"}):$e.jsx(D,{className:"w-3 h-3 text-blue-600 group-hover:text-blue-700"}),a&&$e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full"})]}),t&&$e.jsx("div",{className:"text-xs text-gray-500 max-w-24 truncate",children:n})]})})()]})}),se.pedidosPagos&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:Dt(r.pedidosPagos)}),se.taxaPagamento&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:[r.pedidos>0?(r.pedidosPagos/r.pedidos*100).toFixed(1):"0.0","%"]}),se.receita&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:It(r.receita)}),se.receitaPaga&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:It(r.receitaPaga)}),se.taxaReceitaPaga&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:[r.receita>0?(r.receitaPaga/r.receita*100).toFixed(1):"0.0","%"]}),se.novosClientes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:Dt(r.novosClientes)}),se.receitaNovosClientes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:It(r.receitaNovosClientes)}),se.percentualNovosClientes&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:[r.pedidos>0?(r.novosClientes/r.pedidos*100).toFixed(1):"0.0","%"]}),se.leads&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:Dt(r.leads)}),se.pedidosAssinaturaAnualInicial&&r.pedidosAssinaturaAnualInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:Dt(r.pedidosAssinaturaAnualInicial)}),se.receitaAssinaturaAnualInicial&&r.receitaAssinaturaAnualInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:It(r.receitaAssinaturaAnualInicial)}),se.pedidosAssinaturaMensalInicial&&r.pedidosAssinaturaMensalInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:Dt(r.pedidosAssinaturaMensalInicial)}),se.receitaAssinaturaMensalInicial&&r.receitaAssinaturaMensalInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:It(r.receitaAssinaturaMensalInicial)}),se.pedidosAssinaturaAnualRecorrente&&r.pedidosAssinaturaAnualRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:Dt(r.pedidosAssinaturaAnualRecorrente)}),se.receitaAssinaturaAnualRecorrente&&r.receitaAssinaturaAnualRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:It(r.receitaAssinaturaAnualRecorrente)}),se.pedidosAssinaturaMensalRecorrente&&r.pedidosAssinaturaMensalRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:Dt(r.pedidosAssinaturaMensalRecorrente)}),se.receitaAssinaturaMensalRecorrente&&r.receitaAssinaturaMensalRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:It(r.receitaAssinaturaMensalRecorrente)})]},t)})})]})}),Ot&&$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsx("button",{onClick:()=>Y(!q),className:"flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:q?$e.jsxs($e.Fragment,{children:[$e.jsx("span",{children:"Mostrar menos"}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}):$e.jsxs($e.Fragment,{children:[$e.jsxs("span",{children:["Mostrar todos os ",Pt.length," registros"]}),$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})}),$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:$e.jsxs("button",{onClick:()=>it("dados-detalhados"),className:"flex items-center justify-between w-full text-sm font-medium text-blue-700 hover:text-blue-800 transition-colors group",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx(u,{className:"w-5 h-5 text-blue-600"}),$e.jsx("span",{children:"Ver dados detalhados dos clusters"})]}),$e.jsx(N,{className:"w-4 h-4 text-blue-600 group-hover:translate-x-1 transition-transform"})]})})]}),ae&&$e.jsxs("div",{className:`fixed inset-0 ${K?"z-[9999]":"z-50"} overflow-hidden`,children:[$e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>ne(!1)}),$e.jsx("div",{className:`absolute ${K?"top-24":"top-20"} right-6 w-96 max-w-[calc(100vw-3rem)]`,children:$e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden animate-in slide-in-from-top-2 duration-300",children:[$e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:$e.jsxs("div",{className:"flex items-center justify-between",children:[$e.jsxs("div",{className:"flex items-center gap-3",children:[$e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),$e.jsxs("div",{children:[$e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Selecionar Métricas"}),$e.jsx("p",{className:"text-blue-100 text-sm",children:"Escolha quais colunas exibir na tabela"})]})]}),$e.jsx("button",{onClick:()=>ne(!1),className:"w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:$e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsxs("div",{className:"relative mb-3",children:[$e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("input",{type:"text",placeholder:"Buscar métricas...",value:ie,onChange:e=>le(e.target.value),className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),ie&&$e.jsx("button",{onClick:()=>le(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:$e.jsx("svg",{className:"h-4 w-4 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$e.jsxs("div",{className:"flex gap-2",children:[$e.jsx("button",{onClick:()=>{const e=Object.keys(se).reduce((e,t)=>(e[t]=!0,e),{});re(e)},className:"flex-1 px-3 py-1.5 text-xs font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Selecionar Todas"}),$e.jsx("button",{onClick:()=>{const e=Object.keys(se).reduce((e,t)=>(e[t]=!1,e),{});re(e)},className:"flex-1 px-3 py-1.5 text-xs font-medium text-gray-600 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:"Desselecionar Todas"})]})]}),$e.jsx("div",{className:"p-6 max-h-96 overflow-y-auto",children:$e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[ie&&([{key:"cluster",label:"Cluster"},{key:"sessoes",label:"Sessões"},{key:"adicoesCarrinho",label:"Adições ao Carrinho"},{key:"taxaAdicaoCarrinho",label:"Taxa de Adição ao Carrinho"},{key:"taxaConversao",label:"Taxa de Conversão"},{key:"pedidos",label:"Pedidos"},{key:"pedidosPagos",label:"Pedidos Pagos"},{key:"taxaPagamento",label:"Taxa de Pagamento"},{key:"receita",label:"Receita Total"},{key:"receitaPaga",label:"Receita Paga"},{key:"taxaReceitaPaga",label:"% Receita Paga"},{key:"novosClientes",label:"Novos Clientes"},{key:"receitaNovosClientes",label:"Receita Novos Clientes"},{key:"percentualNovosClientes",label:"% Novos Clientes"},{key:"leads",label:"Leads"}].some(e=>e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()))?null:$e.jsxs("div",{className:"text-center py-8",children:[$e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:$e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),$e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma métrica encontrada"}),$e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'Tente buscar por termos como "receita", "pedidos", "taxa", etc.'}),$e.jsx("button",{onClick:()=>le(""),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:"Limpar busca"})]})),(()=>{const e=[{key:"cluster",label:"Cluster",icon:"📊"}].filter(e=>!ie||e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Identificação"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:se[e],onChange:t=>re(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"sessoes",label:"Sessões",icon:"👥"},{key:"adicoesCarrinho",label:"Adições ao Carrinho",icon:"🛒"},{key:"taxaAdicaoCarrinho",label:"Taxa de Adição ao Carrinho",icon:"📊"},{key:"leads",label:"Leads",icon:"🎯"}].filter(e=>!ie||e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Comportamento"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:se[e],onChange:t=>re(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"taxaConversao",label:"Taxa de Conversão",icon:"📈"},{key:"pedidos",label:"Pedidos",icon:"📦"},{key:"pedidosPagos",label:"Pedidos Pagos",icon:"✅"},{key:"taxaPagamento",label:"Taxa de Pagamento",icon:"💳"}].filter(e=>!ie||e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Conversão"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:se[e],onChange:t=>re(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"receita",label:"Receita Total",icon:"💰"},{key:"receitaPaga",label:"Receita Paga",icon:"💵"},{key:"taxaReceitaPaga",label:"% Receita Paga",icon:"📊"},{key:"novosClientes",label:"Novos Clientes",icon:"🆕"},{key:"receitaNovosClientes",label:"Receita Novos Clientes",icon:"💎"},{key:"percentualNovosClientes",label:"% Novos Clientes",icon:"📈"}].filter(e=>!ie||e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Receita"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:se[e],onChange:t=>re(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})(),(()=>{const e=[{key:"pedidosAssinaturaAnualInicial",label:"Novas Assinaturas Anuais",icon:"📅"},{key:"receitaAssinaturaAnualInicial",label:"Receita Novas Anuais",icon:"💰"},{key:"pedidosAssinaturaMensalInicial",label:"Novas Assinaturas Mensais",icon:"📆"},{key:"receitaAssinaturaMensalInicial",label:"Receita Novas Mensais",icon:"💵"},{key:"pedidosAssinaturaAnualRecorrente",label:"Renovações Anuais",icon:"🔄"},{key:"receitaAssinaturaAnualRecorrente",label:"Receita Renovações Anuais",icon:"💎"},{key:"pedidosAssinaturaMensalRecorrente",label:"Renovações Mensais",icon:"🔁"},{key:"receitaAssinaturaMensalRecorrente",label:"Receita Renovações Mensais",icon:"💸"}].filter(e=>!ie||e.label.toLowerCase().includes(ie.toLowerCase())||e.key.toLowerCase().includes(ie.toLowerCase()));return 0===e.length?null:$e.jsxs("div",{children:[$e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[$e.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),$e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Assinaturas"})]}),$e.jsx("div",{className:"space-y-2",children:e.map(({key:e,label:t,icon:s})=>$e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer",children:[$e.jsx("input",{type:"checkbox",checked:se[e],onChange:t=>re(s=>({...s,[e]:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2"}),$e.jsx("span",{className:"text-lg",children:s}),$e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t})]},e))})]})})()]})}),$e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:$e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[$e.jsxs("span",{className:"text-gray-600",children:[Object.values(se).filter(Boolean).length," métricas selecionadas"]}),$e.jsx("button",{onClick:()=>re(te()),className:"px-3 py-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg font-medium transition-colors",children:"Restaurar padrão"})]})})]})})]}),$e.jsx("div",{className:"mt-6",children:$e.jsx(vm,{selectedTable:I,startDate:A,endDate:M})})]}):$e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[$e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:$e.jsx(y,{className:"w-8 h-8 text-gray-400"})}),$e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum dado encontrado"}),$e.jsxs("p",{className:"text-gray-600 mb-4",children:["Não foram encontrados dados para a tabela ",$e.jsx("strong",{children:J?"Cliente Selecionado":I})," no período selecionado."]}),$e.jsx("div",{className:"text-sm text-gray-500",children:$e.jsx("p",{children:"Tente selecionar uma tabela diferente ou verificar se há dados disponíveis."})})]})]}),K&&$e.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-auto",children:$e.jsxs("div",{className:"p-6",children:[$e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-gray-200 pb-4",children:[$e.jsxs("div",{children:[$e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dados Agrupados por Cluster (Tela Cheia)"}),$e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Métricas consolidadas por cluster",at>0&&$e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["• ",at.toLocaleString()," registros"]})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsxs("button",{onClick:()=>ne(!ae),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center justify-center gap-2 "+(ae?"bg-green-600 text-white hover:bg-green-700 shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"),title:"Selecionar métricas",children:[$e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),$e.jsx("span",{children:"Métricas"}),$e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full "+(ae?"bg-white/20 text-white":"bg-blue-100 text-blue-600"),children:Object.values(se).filter(Boolean).length}),$e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(ae?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),$e.jsx("button",{onClick:()=>X(!1),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Sair da tela cheia",children:$e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:$e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),$e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Modelo de Atribuição:"}),$e.jsxs("div",{className:"relative",children:[$e.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-500"}),$e.jsxs("select",{value:xe,onChange:e=>pe(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white min-w-[200px]",children:[$e.jsx("option",{value:"Último Clique Não Direto",children:"Último Clique Não Direto"}),$e.jsx("option",{value:"Primeiro Clique",children:"Primeiro Clique"})]})]})]}),$e.jsxs("div",{className:"flex items-center gap-2",children:[$e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Plataforma:"}),$e.jsxs("select",{value:ke,onChange:e=>Ce(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[$e.jsx("option",{value:"",children:"Todas"}),Array.from(new Set(w.filter(e=>e.Plataforma).map(e=>e.Plataforma))).map(e=>$e.jsx("option",{value:e,children:e},e))]})]})]}),$e.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200",children:$e.jsx("div",{className:"overflow-x-auto",children:$e.jsxs("table",{className:"w-full",children:[$e.jsx("thead",{className:"bg-gray-50",children:$e.jsxs("tr",{children:[se.cluster&&$e.jsx(bs,{field:"cluster",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Cluster"}),se.sessoes&&$e.jsx(bs,{field:"sessoes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Sessões"}),se.taxaAdicaoCarrinho&&$e.jsx(bs,{field:"taxaAdicaoCarrinho",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Taxa Carrinho"}),se.adicoesCarrinho&&$e.jsx(bs,{field:"adicoesCarrinho",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Carrinho"}),se.taxaConversao&&$e.jsx(bs,{field:"taxaConversao",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Taxa Conv."}),se.pedidos&&$e.jsx(bs,{field:"pedidos",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Pedidos"}),se.pedidosPagos&&$e.jsx(bs,{field:"pedidosPagos",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Pedidos Pagos"}),se.taxaPagamento&&$e.jsx(bs,{field:"taxaPagamento",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Pagamento"}),se.receita&&$e.jsx(bs,{field:"receita",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita"}),se.receitaPaga&&$e.jsx(bs,{field:"receitaPaga",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Paga"}),se.taxaReceitaPaga&&$e.jsx(bs,{field:"taxaReceitaPaga",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Receita Paga"}),se.novosClientes&&$e.jsx(bs,{field:"novosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novos Clientes"}),se.receitaNovosClientes&&$e.jsx(bs,{field:"receitaNovosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novos"}),se.percentualNovosClientes&&$e.jsx(bs,{field:"percentualNovosClientes",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"% Novos Clientes"}),se.pedidosAssinaturaAnualInicial&&ct.pedidosAssinaturaAnualInicial>0&&$e.jsx(bs,{field:"pedidosAssinaturaAnualInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novas Assinaturas Anuais"}),se.receitaAssinaturaAnualInicial&&ct.receitaAssinaturaAnualInicial>0&&$e.jsx(bs,{field:"receitaAssinaturaAnualInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novas Anuais"}),se.pedidosAssinaturaMensalInicial&&ct.pedidosAssinaturaMensalInicial>0&&$e.jsx(bs,{field:"pedidosAssinaturaMensalInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Novas Assinaturas Mensais"}),se.receitaAssinaturaMensalInicial&&ct.receitaAssinaturaMensalInicial>0&&$e.jsx(bs,{field:"receitaAssinaturaMensalInicial",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Novas Mensais"}),se.pedidosAssinaturaAnualRecorrente&&ct.pedidosAssinaturaAnualRecorrente>0&&$e.jsx(bs,{field:"pedidosAssinaturaAnualRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Renovações Anuais"}),se.receitaAssinaturaAnualRecorrente&&ct.receitaAssinaturaAnualRecorrente>0&&$e.jsx(bs,{field:"receitaAssinaturaAnualRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Renovações Anuais"}),se.pedidosAssinaturaMensalRecorrente&&ct.pedidosAssinaturaMensalRecorrente>0&&$e.jsx(bs,{field:"pedidosAssinaturaMensalRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Renovações Mensais"}),se.receitaAssinaturaMensalRecorrente&&ct.receitaAssinaturaMensalRecorrente>0&&$e.jsx(bs,{field:"receitaAssinaturaMensalRecorrente",currentSortField:U,currentSortDirection:H,onSort:Wt,children:"Receita Renovações Mensais"})]})}),$e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Pt.map((e,t)=>{const{cluster:s,totals:r}=e,a=r.sessoes>0?r.pedidos/r.sessoes*100:0;return $e.jsxs("tr",{className:"hover:bg-gray-50 transition-all duration-200 "+(Ne===s?"bg-blue-50 border-l-4 border-l-blue-500":""),children:[se.cluster&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s})}),se.sessoes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Dt(r.sessoes)}),se.taxaAdicaoCarrinho&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:[r.sessoes>0?(r.adicoesCarrinho/r.sessoes*100).toFixed(1):"0.0","%"]}),se.adicoesCarrinho&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Dt(r.adicoesCarrinho)}),se.taxaConversao&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-orange-600",children:[a.toFixed(2),"%"]}),se.pedidos&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Dt(r.pedidos)}),se.pedidosPagos&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:Dt(r.pedidosPagos)}),se.taxaPagamento&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:[r.pedidos>0?(r.pedidosPagos/r.pedidos*100).toFixed(1):"0.0","%"]}),se.receita&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:It(r.receita)}),se.receitaPaga&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:It(r.receitaPaga)}),se.taxaReceitaPaga&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:[r.receita>0?(r.receitaPaga/r.receita*100).toFixed(1):"0.0","%"]}),se.novosClientes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:Dt(r.novosClientes)}),se.receitaNovosClientes&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:It(r.receitaNovosClientes)}),se.percentualNovosClientes&&$e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:[r.pedidos>0?(r.novosClientes/r.pedidos*100).toFixed(1):"0.0","%"]}),se.pedidosAssinaturaAnualInicial&&r.pedidosAssinaturaAnualInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:Dt(r.pedidosAssinaturaAnualInicial)}),se.receitaAssinaturaAnualInicial&&r.receitaAssinaturaAnualInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-purple-600",children:It(r.receitaAssinaturaAnualInicial)}),se.pedidosAssinaturaMensalInicial&&r.pedidosAssinaturaMensalInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:Dt(r.pedidosAssinaturaMensalInicial)}),se.receitaAssinaturaMensalInicial&&r.receitaAssinaturaMensalInicial>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600",children:It(r.receitaAssinaturaMensalInicial)}),se.pedidosAssinaturaAnualRecorrente&&r.pedidosAssinaturaAnualRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:Dt(r.pedidosAssinaturaAnualRecorrente)}),se.receitaAssinaturaAnualRecorrente&&r.receitaAssinaturaAnualRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-cyan-600",children:It(r.receitaAssinaturaAnualRecorrente)}),se.pedidosAssinaturaMensalRecorrente&&r.pedidosAssinaturaMensalRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:Dt(r.pedidosAssinaturaMensalRecorrente)}),se.receitaAssinaturaMensalRecorrente&&r.receitaAssinaturaMensalRecorrente>0&&$e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-teal-600",children:It(r.receitaAssinaturaMensalRecorrente)})]},t)})})]})})})]})}),"funil-conversao"===oe&&$e.jsx(Br,{selectedTable:I,startDate:A,endDate:M,attributionModel:xe}),"dados-detalhados"===oe&&$e.jsx(Wr,{selectedTable:I,startDate:A,endDate:M,attributionModel:xe}),"havaianas"===oe&&$e.jsx(Hr,{selectedTable:I,startDate:A,endDate:M}),"produtos"===oe&&$e.jsxs($e.Fragment,{children:[void 0,$e.jsx(Yr,{selectedTable:I})]}),"ab-testing"===oe&&$e.jsx(qr,{selectedTable:I,startDate:A,endDate:M}),"midia-paga"===oe&&$e.jsx(hm,{selectedTable:I,startDate:A,endDate:M,token:c}),"frete"===oe&&$e.jsx(xm,{selectedTable:I,startDate:A,endDate:M}),"tempo-real"===oe&&$e.jsx(pm,{selectedTable:I}),"configuracao"===oe&&(null==s?void 0:s.admin)&&$e.jsx(gm,{selectedTable:I}),"tokendebug"===oe&&(null==s?void 0:s.admin)&&$e.jsx(bm,{}),"pedidos"===oe&&$e.jsx(ym,{selectedTable:I,startDate:A,endDate:M}),"leads"===oe&&$e.jsx(wm,{selectedTable:I,startDate:A,endDate:M})]}),$e.jsx(vs,{metrics:w,selectedTable:I,isLoading:_,isTableLoading:S}),$e.jsx(zr,{isOpen:Ye.isOpen,onClose:()=>{Ke({isOpen:!1,trafficCategory:""})},trafficCategory:Ye.trafficCategory,startDate:A,endDate:M,tableName:I,attributionModel:xe}),Ve&&$e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:$e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md animate-fadeIn",children:[$e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[$e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:We?"Editar Meta":"Nova Meta"}),$e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:We?"Edite a meta de receita":"Cadastre uma nova meta de receita"})]}),$e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mês"}),$e.jsx("input",{type:"month",value:Ge.month,onChange:e=>qe({...Ge,month:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"2025-10"})]}),$e.jsxs("div",{children:[$e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor da Meta (R$)"}),$e.jsx("input",{type:"number",value:Ge.goal_value,onChange:e=>qe({...Ge,goal_value:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"10000000"})]})]}),$e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[$e.jsx("button",{onClick:()=>Ue(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 font-medium",children:"Cancelar"}),$e.jsxs("button",{onClick:async()=>{if(Ge.month&&Ge.goal_value)try{const e=localStorage.getItem("auth-token");if(!e)return;await ls.saveMonthlyGoal(e,{table_name:I,month:Ge.month,goal_value:parseFloat(Ge.goal_value),goal_type:"revenue_goal"}),Ue(!1),qe({month:"",goal_value:""}),He(null),d(),alert(We?"Meta atualizada com sucesso!":"Meta cadastrada com sucesso!")}catch(e){alert("Erro ao salvar meta. Tente novamente.")}else alert("Por favor, preencha todos os campos.")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2",children:[$e.jsx(h,{className:"w-4 h-4"}),We?"Atualizar Meta":"Salvar Meta"]})]})]})})]})},Nm=e=>{try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}catch(t){return null}};function _m(){const{isAuthenticated:t,user:s,isLoading:r,isInitialized:a,login:n,logout:i,checkTokenExpiry:l}=(()=>{const[t,s]=e.useState({isAuthenticated:!1}),[r,a]=e.useState(!0),[n,i]=e.useState(!1),l=async e=>{try{const t=await ls.refreshToken(e);return{accessToken:t.access_token,refreshToken:t.refresh_token}}catch(t){return null}};e.useEffect(()=>{(async()=>{var e,t;try{const a=localStorage.getItem("mymetric-auth-complete");if(a){const n=JSON.parse(a),i=Date.now();if(n.accessToken&&n.refreshToken){let a=n.accessToken,c=n.refreshToken;if(n.expiresAt<=i){if(!(n.refreshExpiresAt>i))return void o();{const e=await l(n.refreshToken);if(!e)return void o();{a=e.accessToken,c=e.refreshToken;const t=Nm(e.accessToken),s=Nm(e.refreshToken),r=(null==t?void 0:t.exp)?1e3*t.exp:i+864e5,l=(null==s?void 0:s.exp)?1e3*s.exp:i+6048e5,o={...n,accessToken:a,refreshToken:c,expiresAt:r,refreshExpiresAt:l};localStorage.setItem("mymetric-auth-complete",JSON.stringify(o)),localStorage.setItem("auth-token",a)}}}if(n.authData&&n.authData.isAuthenticated)s(n.authData);else try{const r=await ls.getProfile(a),i={isAuthenticated:!0,user:{email:r.email,admin:r.admin,access_control:r.access_control,tablename:r.tablename,username:r.email||(null==(e=n.authData.user)?void 0:e.username)||"",lastLogin:(null==(t=n.authData.user)?void 0:t.lastLogin)||(new Date).toISOString()}};s(i);const l={authData:i,accessToken:a,refreshToken:c,rememberMe:n.rememberMe,expiresAt:n.expiresAt,refreshExpiresAt:n.refreshExpiresAt};localStorage.setItem("mymetric-auth-complete",JSON.stringify(l)),localStorage.setItem("mymetric-auth",JSON.stringify(i))}catch(r){o()}}else o()}}catch(r){o()}finally{a(!1),i(!0)}})()},[]);const o=()=>{localStorage.removeItem("mymetric-auth-complete"),localStorage.removeItem("auth-token"),localStorage.removeItem("mymetric-auth"),localStorage.removeItem("login-response"),s({isAuthenticated:!1})},c=async()=>{const e=localStorage.getItem("mymetric-auth-complete");if(e)try{const t=JSON.parse(e),s=Date.now(),r=t.expiresAt-s;if(r<36e5&&r>0){if(t.refreshExpiresAt>s){const e=await l(t.refreshToken);if(e){const r=Nm(e.accessToken),a=Nm(e.refreshToken),n=(null==r?void 0:r.exp)?1e3*r.exp:s+864e5,i=(null==a?void 0:a.exp)?1e3*a.exp:s+6048e5,l={...t,accessToken:e.accessToken,refreshToken:e.refreshToken,expiresAt:n,refreshExpiresAt:i};return localStorage.setItem("mymetric-auth-complete",JSON.stringify(l)),localStorage.setItem("auth-token",e.accessToken),{shouldRenew:!1,timeUntilExpiry:n-s,isExpired:!1,renewed:!0}}}return{shouldRenew:!0,timeUntilExpiry:r,isExpired:!1,renewed:!1}}if(r<=0)return{shouldRenew:!1,timeUntilExpiry:0,isExpired:!0,renewed:!1}}catch(t){}return{shouldRenew:!1,timeUntilExpiry:0,isExpired:!1,renewed:!1}},d=t.isAuthenticated,u=t.user;return e.useEffect(()=>{if(!d)return;const e=setInterval(async()=>{await c()},18e5);return()=>clearInterval(e)},[d]),{isAuthenticated:d,user:u,isLoading:r,isInitialized:n,login:async(e,t=!1)=>{a(!0);try{const r=localStorage.getItem("auth-token"),a=localStorage.getItem("login-response");if(!r)throw new Error("Token de autenticação não encontrado");if(!a)throw new Error("Dados de login não encontrados");const n=JSON.parse(a),i={isAuthenticated:!0,user:{email:e,admin:n.admin||!1,access_control:n.access_control||"[]",tablename:n.table_name||"all",username:e,lastLogin:(new Date).toISOString()}};s(i);const l=Nm(n.access_token),o=Nm(n.refresh_token),c=Date.now(),d=(null==l?void 0:l.exp)?1e3*l.exp:c+864e5,u=(null==o?void 0:o.exp)?1e3*o.exp:c+6048e5,m={authData:i,accessToken:n.access_token,refreshToken:n.refresh_token,rememberMe:t,expiresAt:d,refreshExpiresAt:u};localStorage.setItem("mymetric-auth-complete",JSON.stringify(m)),localStorage.setItem("mymetric-auth",JSON.stringify(i))}catch(r){throw r}finally{a(!1)}},logout:()=>{s({isAuthenticated:!1}),o()},checkTokenExpiry:c}})();(t=>{const s=e.useCallback(e=>{if(e<=0)return"Expirado";const t=Math.floor(e/36e5),s=Math.floor(e%36e5/6e4);return t>0?`${t}h ${s}m`:`${s}m`},[]),r=e.useCallback(e=>{if(e.shouldRenew&&!e.isExpired){const t=s(e.timeUntilExpiry);if("Notification"in window&&"granted"===Notification.permission&&new Notification("MyMetricHUB - Sessão Expirando",{body:`Sua sessão expira em ${t}. Faça login novamente para continuar.`,icon:"/favicon.ico",tag:"token-expiry"}),!document.getElementById("token-expiry-alert")){const e=document.createElement("div");e.id="token-expiry-alert",e.className="fixed top-4 right-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 shadow-lg z-50 max-w-sm",e.innerHTML=`\n          <div class="flex items-start gap-3">\n            <div class="flex-shrink-0">\n              <svg class="w-5 h-5 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">\n                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>\n              </svg>\n            </div>\n            <div class="flex-1">\n              <h3 class="text-sm font-medium text-yellow-800">Sessão Expirando</h3>\n              <p class="mt-1 text-sm text-yellow-700">Sua sessão expira em ${t}. Faça login novamente para continuar.</p>\n              <div class="mt-3 flex gap-2">\n                <button onclick="window.location.reload()" class="text-xs bg-yellow-600 text-white px-3 py-1 rounded hover:bg-yellow-700 transition-colors">\n                  Renovar Agora\n                </button>\n                <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-xs text-yellow-600 hover:text-yellow-800 transition-colors">\n                  Fechar\n                </button>\n              </div>\n            </div>\n          </div>\n        `,document.body.appendChild(e),setTimeout(()=>{e.parentElement&&e.remove()},3e4)}}},[s]);e.useEffect(()=>{const e=setInterval(()=>{const e=t();r(e)},3e5),s=t();return r(s),()=>clearInterval(e)},[t,r]),e.useEffect(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[])})(l),e.useEffect(()=>{const e=window.fetch;return window.fetch=async(...t)=>{var s;try{const r=await e(...t);if(401===r.status){const e=(null==(s=t[0])?void 0:s.toString())||"";e.includes("/login")||i()}return r}catch(r){throw r}},()=>{window.fetch=e}},[i]),Ur(r?"Carregando... | MyMetricHUB":t?"Dashboard | MyMetricHUB"+((null==s?void 0:s.username)?` - ${s.username}`:""):"Login | MyMetricHUB");if(r||!a){const e=a?"Carregando...":"Inicializando aplicação...";return $e.jsx(cs,{message:e,showAuthStatus:!a&&!t})}return $e.jsx("div",{className:"min-h-screen",children:t?$e.jsx(jm,{onLogout:()=>{i()},user:s}):$e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:$e.jsx(os,{onLogin:async(e,t)=>{await n(e,t)}})})})}ze.createRoot(document.getElementById("root")).render($e.jsx(s.StrictMode,{children:$e.jsx(_m,{})}));
